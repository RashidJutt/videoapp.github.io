/*! For license information please see main-es2015.a170f25cf0c54c62c431.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"+EQa":function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),RemoteTrackPublication=function(_super){function RemoteTrackPublication(signaling,options){var _this=_super.call(this,signaling.name,signaling.sid,options)||this;Object.defineProperties(_this,{_signaling:{value:signaling},_track:{value:null,writable:!0},isSubscribed:{enumerable:!0,get:function(){return!!this._track}},isTrackEnabled:{enumerable:!0,get:function(){return signaling.isEnabled}},kind:{enumerable:!0,value:signaling.kind},publishPriority:{enumerable:!0,get:function(){return signaling.priority}},track:{enumerable:!0,get:function(){return this._track}}});var error=signaling.error,isEnabled=signaling.isEnabled,isSwitchedOff=signaling.isSwitchedOff,priority=signaling.priority;return signaling.on("updated",(function(){if(error!==signaling.error)return error=signaling.error,void _this.emit("subscriptionFailed",signaling.error);isEnabled!==signaling.isEnabled&&(isEnabled=signaling.isEnabled,_this.track&&_this.track._setEnabled(signaling.isEnabled),_this.emit(signaling.isEnabled?"trackEnabled":"trackDisabled")),isSwitchedOff!==signaling.isSwitchedOff&&(_this._log.debug(_this.trackSid+": "+(isSwitchedOff?"OFF":"ON")+" => "+(signaling.isSwitchedOff?"OFF":"ON")),isSwitchedOff=signaling.isSwitchedOff,_this.track?(_this.track._setSwitchedOff(signaling.isSwitchedOff),_this.emit(isSwitchedOff?"trackSwitchedOff":"trackSwitchedOn",_this.track)):isSwitchedOff&&_this._log.warn("Track was not subscribed when switched Off.")),priority!==signaling.priority&&_this.emit("publishPriorityChanged",priority=signaling.priority)})),_this}return __extends(RemoteTrackPublication,_super),RemoteTrackPublication.prototype.toString=function(){return"[RemoteTrackPublication #"+this._instanceId+": "+this.trackSid+"]"},RemoteTrackPublication.prototype._subscribed=function(track){!this._track&&track&&(this._track=track,this.emit("subscribed",track))},RemoteTrackPublication.prototype._unsubscribe=function(){if(this._track){var track=this._track;this._track=null,this.emit("unsubscribed",track)}},RemoteTrackPublication}(__webpack_require__("tjbx"));module.exports=RemoteTrackPublication},"+OFx":function(module,exports,__webpack_require__){"use strict";var canvas=null;module.exports=function(el){return canvas=canvas||document.createElement("canvas"),new Promise((function(resolve){var samplesLeft=3;setTimeout((function doCheckSilence(){return samplesLeft--,function(el){try{var context=canvas.getContext("2d");context.drawImage(el,0,0,50,50);var frameDataWithoutAlpha=context.getImageData(0,0,50,50).data.filter((function(item,i){return(i+1)%4}));return 0===Math.max.apply(Math,frameDataWithoutAlpha)}catch(ex){return console.log("Error checking silence: ",ex),!1}}(el)?samplesLeft>0?setTimeout(doCheckSilence,250):resolve(!0):resolve(!1)}),250)}))}},"+TTF":function(module,exports,__webpack_require__){"use strict";module.exports=function ChromeRTCSessionDescription(descriptionInitDict){if(!(this instanceof ChromeRTCSessionDescription))return new ChromeRTCSessionDescription(descriptionInitDict);var description=descriptionInitDict&&"rollback"===descriptionInitDict.type?null:new RTCSessionDescription(descriptionInitDict);Object.defineProperties(this,{_description:{get:function(){return description}},sdp:{enumerable:!0,value:description?description.sdp:descriptionInitDict.sdp},type:{enumerable:!0,value:description?description.type:descriptionInitDict.type}})}},"+kOg":function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__spreadArray=this&&this.__spreadArray||function(to,from){for(var i=0,il=from.length,j=to.length;i<il;i++,j++)to[j]=from[i];return to},EventEmitter=__webpack_require__("mAYT"),RemoteParticipant=__webpack_require__("1RtY"),StatsReport=__webpack_require__("/Ylb"),valueToJSON=__webpack_require__("ghd6").valueToJSON,nInstances=0,Room=function(_super){function Room(localParticipant,signaling,options){var room,recording,_this=_super.call(this)||this,log=options.log.createLog("default",_this),participants=new Map;return Object.defineProperties(_this,{_log:{value:log},_clientTrackSwitchOffControl:{value:options.clientTrackSwitchOffControl||"disabled"},_contentPreferencesMode:{value:options.contentPreferencesMode||"disabled"},_instanceId:{value:++nInstances},_options:{value:options},_participants:{value:participants},_signaling:{value:signaling},dominantSpeaker:{enumerable:!0,get:function(){return this.participants.get(signaling.dominantSpeakerSid)||null}},isRecording:{enumerable:!0,get:function(){return signaling.recording.isEnabled||!1}},localParticipant:{enumerable:!0,value:localParticipant},name:{enumerable:!0,value:signaling.name},participants:{enumerable:!0,value:participants},sid:{enumerable:!0,value:signaling.sid},state:{enumerable:!0,get:function(){return signaling.state}},mediaRegion:{enumerable:!0,value:signaling.mediaRegion}}),room=_this,(recording=signaling.recording).on("updated",(function(){var started=recording.isEnabled;room._log.info("Recording "+(started?"started":"stopped")),room.emit("recording"+(started?"Started":"Stopped"))})),function(room,signaling){var log=room._log;log.debug("Creating a new RemoteParticipant for each ParticipantSignaling in the RoomSignaling"),signaling.participants.forEach(connectParticipant.bind(null,room)),log.debug("Setting up RemoteParticipant creation for all subsequent ParticipantSignalings that connect to the RoomSignaling"),signaling.on("participantConnected",connectParticipant.bind(null,room)),signaling.on("dominantSpeakerChanged",(function(){return room.emit("dominantSpeakerChanged",room.dominantSpeaker)})),signaling.on("stateChanged",(function stateChanged(state,error){switch(log.info("Transitioned to state:",state),state){case"disconnected":room.participants.forEach((function(participant){participant._unsubscribeTracks()})),room.emit(state,room,error),room.localParticipant.tracks.forEach((function(publication){publication.unpublish()})),signaling.removeListener("stateChanged",stateChanged);break;case"reconnecting":setTimeout((function(){return room.emit("reconnecting",error)}),0);break;default:setTimeout((function(){return room.emit("reconnected")}),0)}}))}(_this,signaling),log.info("Created a new Room:",_this.name),log.debug("Initial RemoteParticipants:",Array.from(_this._participants.values())),_this}return __extends(Room,_super),Room.prototype.toString=function(){return"[Room #"+this._instanceId+": "+this.sid+"]"},Room.prototype.disconnect=function(){return this._log.info("Disconnecting"),this._signaling.disconnect(),this},Room.prototype.getStats=function(){var _this=this;return this._signaling.getStats().then((function(responses){return Array.from(responses).map((function(_a){var _b=__read(_a,2),response=_b[1];return new StatsReport(_b[0],Object.assign({},response,{localAudioTrackStats:rewriteLocalTrackIds(_this,response.localAudioTrackStats),localVideoTrackStats:rewriteLocalTrackIds(_this,response.localVideoTrackStats)}))}))}))},Room.prototype.toJSON=function(){return valueToJSON(this)},Room}(EventEmitter);function rewriteLocalTrackIds(room,trackStats){var localParticipantSignaling=room.localParticipant._signaling;return trackStats.reduce((function(trackStats,trackStat){var publication=localParticipantSignaling.tracks.get(trackStat.trackId),trackSender=localParticipantSignaling.getSender(publication);return trackSender?[Object.assign({},trackStat,{trackId:trackSender.id})].concat(trackStats):trackStats}),[])}function connectParticipant(room,participantSignaling){var log=room._log,participant=new RemoteParticipant(participantSignaling,{log:log,clientTrackSwitchOffControl:room._clientTrackSwitchOffControl,contentPreferencesMode:room._contentPreferencesMode});log.info("A new RemoteParticipant connected:",participant),room._participants.set(participant.sid,participant),room.emit("participantConnected",participant);var eventListeners=[["reconnected","participantReconnected"],["reconnecting","participantReconnecting"],"trackDimensionsChanged","trackDisabled","trackEnabled","trackMessage","trackPublished","trackPublishPriorityChanged","trackStarted","trackSubscribed","trackSubscriptionFailed","trackSwitchedOff","trackSwitchedOn","trackUnpublished","trackUnsubscribed"].map((function(eventOrPair){var _a=__read(Array.isArray(eventOrPair)?eventOrPair:[eventOrPair,eventOrPair],2),event=_a[0],participantEvent=_a[1];function reemit(){var args=[].slice.call(arguments);args.unshift(participantEvent),args.push(participant),room.emit.apply(room,__spreadArray([],__read(args)))}return participant.on(event,reemit),[event,reemit]}));participant.once("disconnected",(function(){var dominantSpeaker=room.dominantSpeaker;log.info("RemoteParticipant disconnected:",participant),room._participants.delete(participant.sid),eventListeners.forEach((function(args){participant.removeListener(args[0],args[1])})),room.emit("participantDisconnected",participant),participant===dominantSpeaker&&room.emit("dominantSpeakerChanged",room.dominantSpeaker)}))}module.exports=Room},"+qE3":function(module,exports,__webpack_require__){"use strict";var ReflectOwnKeys,R="object"==typeof Reflect?Reflect:null,ReflectApply=R&&"function"==typeof R.apply?R.apply:function(target,receiver,args){return Function.prototype.apply.call(target,receiver,args)};ReflectOwnKeys=R&&"function"==typeof R.ownKeys?R.ownKeys:Object.getOwnPropertySymbols?function(target){return Object.getOwnPropertyNames(target).concat(Object.getOwnPropertySymbols(target))}:function(target){return Object.getOwnPropertyNames(target)};var NumberIsNaN=Number.isNaN||function(value){return value!=value};function EventEmitter(){EventEmitter.init.call(this)}module.exports=EventEmitter,module.exports.once=function(emitter,name){return new Promise((function(resolve,reject){function errorListener(err){emitter.removeListener(name,resolver),reject(err)}function resolver(){"function"==typeof emitter.removeListener&&emitter.removeListener("error",errorListener),resolve([].slice.call(arguments))}eventTargetAgnosticAddListener(emitter,name,resolver,{once:!0}),"error"!==name&&function(emitter,handler,flags){"function"==typeof emitter.on&&eventTargetAgnosticAddListener(emitter,"error",handler,{once:!0})}(emitter,errorListener)}))},EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._eventsCount=0,EventEmitter.prototype._maxListeners=void 0;var defaultMaxListeners=10;function checkListener(listener){if("function"!=typeof listener)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof listener)}function _getMaxListeners(that){return void 0===that._maxListeners?EventEmitter.defaultMaxListeners:that._maxListeners}function _addListener(target,type,listener,prepend){var m,events,existing;if(checkListener(listener),void 0===(events=target._events)?(events=target._events=Object.create(null),target._eventsCount=0):(void 0!==events.newListener&&(target.emit("newListener",type,listener.listener?listener.listener:listener),events=target._events),existing=events[type]),void 0===existing)existing=events[type]=listener,++target._eventsCount;else if("function"==typeof existing?existing=events[type]=prepend?[listener,existing]:[existing,listener]:prepend?existing.unshift(listener):existing.push(listener),(m=_getMaxListeners(target))>0&&existing.length>m&&!existing.warned){existing.warned=!0;var w=new Error("Possible EventEmitter memory leak detected. "+existing.length+" "+String(type)+" listeners added. Use emitter.setMaxListeners() to increase limit");w.name="MaxListenersExceededWarning",w.emitter=target,w.type=type,w.count=existing.length,console&&console.warn&&console.warn(w)}return target}function onceWrapper(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function _onceWrap(target,type,listener){var state={fired:!1,wrapFn:void 0,target:target,type:type,listener:listener},wrapped=onceWrapper.bind(state);return wrapped.listener=listener,state.wrapFn=wrapped,wrapped}function _listeners(target,type,unwrap){var events=target._events;if(void 0===events)return[];var evlistener=events[type];return void 0===evlistener?[]:"function"==typeof evlistener?unwrap?[evlistener.listener||evlistener]:[evlistener]:unwrap?function(arr){for(var ret=new Array(arr.length),i=0;i<ret.length;++i)ret[i]=arr[i].listener||arr[i];return ret}(evlistener):arrayClone(evlistener,evlistener.length)}function listenerCount(type){var events=this._events;if(void 0!==events){var evlistener=events[type];if("function"==typeof evlistener)return 1;if(void 0!==evlistener)return evlistener.length}return 0}function arrayClone(arr,n){for(var copy=new Array(n),i=0;i<n;++i)copy[i]=arr[i];return copy}function eventTargetAgnosticAddListener(emitter,name,listener,flags){if("function"==typeof emitter.on)flags.once?emitter.once(name,listener):emitter.on(name,listener);else{if("function"!=typeof emitter.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof emitter);emitter.addEventListener(name,(function wrapListener(arg){flags.once&&emitter.removeEventListener(name,wrapListener),listener(arg)}))}}Object.defineProperty(EventEmitter,"defaultMaxListeners",{enumerable:!0,get:function(){return defaultMaxListeners},set:function(arg){if("number"!=typeof arg||arg<0||NumberIsNaN(arg))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+arg+".");defaultMaxListeners=arg}}),EventEmitter.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},EventEmitter.prototype.setMaxListeners=function(n){if("number"!=typeof n||n<0||NumberIsNaN(n))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+n+".");return this._maxListeners=n,this},EventEmitter.prototype.getMaxListeners=function(){return _getMaxListeners(this)},EventEmitter.prototype.emit=function(type){for(var args=[],i=1;i<arguments.length;i++)args.push(arguments[i]);var doError="error"===type,events=this._events;if(void 0!==events)doError=doError&&void 0===events.error;else if(!doError)return!1;if(doError){var er;if(args.length>0&&(er=args[0]),er instanceof Error)throw er;var err=new Error("Unhandled error."+(er?" ("+er.message+")":""));throw err.context=er,err}var handler=events[type];if(void 0===handler)return!1;if("function"==typeof handler)ReflectApply(handler,this,args);else{var len=handler.length,listeners=arrayClone(handler,len);for(i=0;i<len;++i)ReflectApply(listeners[i],this,args)}return!0},EventEmitter.prototype.on=EventEmitter.prototype.addListener=function(type,listener){return _addListener(this,type,listener,!1)},EventEmitter.prototype.prependListener=function(type,listener){return _addListener(this,type,listener,!0)},EventEmitter.prototype.once=function(type,listener){return checkListener(listener),this.on(type,_onceWrap(this,type,listener)),this},EventEmitter.prototype.prependOnceListener=function(type,listener){return checkListener(listener),this.prependListener(type,_onceWrap(this,type,listener)),this},EventEmitter.prototype.off=EventEmitter.prototype.removeListener=function(type,listener){var list,events,position,i,originalListener;if(checkListener(listener),void 0===(events=this._events))return this;if(void 0===(list=events[type]))return this;if(list===listener||list.listener===listener)0==--this._eventsCount?this._events=Object.create(null):(delete events[type],events.removeListener&&this.emit("removeListener",type,list.listener||listener));else if("function"!=typeof list){for(position=-1,i=list.length-1;i>=0;i--)if(list[i]===listener||list[i].listener===listener){originalListener=list[i].listener,position=i;break}if(position<0)return this;0===position?list.shift():function(list,index){for(;index+1<list.length;index++)list[index]=list[index+1];list.pop()}(list,position),1===list.length&&(events[type]=list[0]),void 0!==events.removeListener&&this.emit("removeListener",type,originalListener||listener)}return this},EventEmitter.prototype.removeAllListeners=function(type){var listeners,events,i;if(void 0===(events=this._events))return this;if(void 0===events.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==events[type]&&(0==--this._eventsCount?this._events=Object.create(null):delete events[type]),this;if(0===arguments.length){var key,keys=Object.keys(events);for(i=0;i<keys.length;++i)"removeListener"!==(key=keys[i])&&this.removeAllListeners(key);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(listeners=events[type]))this.removeListener(type,listeners);else if(void 0!==listeners)for(i=listeners.length-1;i>=0;i--)this.removeListener(type,listeners[i]);return this},EventEmitter.prototype.listeners=function(type){return _listeners(this,type,!0)},EventEmitter.prototype.rawListeners=function(type){return _listeners(this,type,!1)},EventEmitter.listenerCount=function(emitter,type){return"function"==typeof emitter.listenerCount?emitter.listenerCount(type):listenerCount.call(emitter,type)},EventEmitter.prototype.listenerCount=listenerCount,EventEmitter.prototype.eventNames=function(){return this._eventsCount>0?ReflectOwnKeys(this._events):[]}},"/+gY":function(module,exports,__webpack_require__){"use strict";var NativeAudioContext="undefined"!=typeof AudioContext?AudioContext:"undefined"!=typeof webkitAudioContext?webkitAudioContext:null,AudioContextFactory=function(){function AudioContextFactory(options){options=Object.assign({AudioContext:NativeAudioContext},options),Object.defineProperties(this,{_AudioContext:{value:options.AudioContext},_audioContext:{value:null,writable:!0},_holders:{value:new Set},AudioContextFactory:{enumerable:!0,value:AudioContextFactory}})}return AudioContextFactory.prototype.getOrCreate=function(holder){if(!this._holders.has(holder)&&(this._holders.add(holder),this._AudioContext&&!this._audioContext))try{this._audioContext=new this._AudioContext}catch(error){}return this._audioContext},AudioContextFactory.prototype.release=function(holder){this._holders.has(holder)&&(this._holders.delete(holder),!this._holders.size&&this._audioContext&&(this._audioContext.close(),this._audioContext=null))},AudioContextFactory}();module.exports=new AudioContextFactory},"/4oH":function(module,exports,__webpack_require__){"use strict";var flatMap=__webpack_require__("mIkg").flatMap,guessBrowser=__webpack_require__("mIkg").guessBrowser,guessBrowserVersion=__webpack_require__("mIkg").guessBrowserVersion,getSdpFormat=__webpack_require__("L1nb").getSdpFormat,guess=guessBrowser(),guessVersion=guessBrowserVersion(),isChrome="chrome"===guess,isFirefox="firefox"===guess,isSafari="safari"===guess,chromeMajorVersion=isChrome?guessVersion.major:null;function standardizeChromeOrSafariActiveIceCandidatePairStats(stats){var activeCandidatePairStats=Array.from(stats.values()).find((function(stat){return"candidate-pair"===stat.type&&stat.nominated}));if(!activeCandidatePairStats)return null;var activeLocalCandidateStats=stats.get(activeCandidatePairStats.localCandidateId),activeRemoteCandidateStats=stats.get(activeCandidatePairStats.remoteCandidateId),standardizedCandidateStatsKeys=[{key:"candidateType",type:"string"},{key:"ip",type:"string"},{key:"port",type:"number"},{key:"priority",type:"number"},{key:"protocol",type:"string"},{key:"url",type:"string"}],standardizedLocalCandidateStatsKeys=standardizedCandidateStatsKeys.concat([{key:"deleted",type:"boolean"},{key:"relayProtocol",type:"string"}]),standatdizedLocalCandidateStatsReport=activeLocalCandidateStats?standardizedLocalCandidateStatsKeys.reduce((function(report,keyInfo){return report[keyInfo.key]=typeof activeLocalCandidateStats[keyInfo.key]===keyInfo.type?activeLocalCandidateStats[keyInfo.key]:"deleted"!==keyInfo.key&&null,report}),{}):null,standardizedRemoteCandidateStatsReport=activeRemoteCandidateStats?standardizedCandidateStatsKeys.reduce((function(report,keyInfo){return report[keyInfo.key]=typeof activeRemoteCandidateStats[keyInfo.key]===keyInfo.type?activeRemoteCandidateStats[keyInfo.key]:null,report}),{}):null;return[{key:"availableIncomingBitrate",type:"number"},{key:"availableOutgoingBitrate",type:"number"},{key:"bytesReceived",type:"number"},{key:"bytesSent",type:"number"},{key:"consentRequestsSent",type:"number"},{key:"currentRoundTripTime",type:"number"},{key:"lastPacketReceivedTimestamp",type:"number"},{key:"lastPacketSentTimestamp",type:"number"},{key:"nominated",type:"boolean"},{key:"priority",type:"number"},{key:"readable",type:"boolean"},{key:"requestsReceived",type:"number"},{key:"requestsSent",type:"number"},{key:"responsesReceived",type:"number"},{key:"responsesSent",type:"number"},{key:"retransmissionsReceived",type:"number"},{key:"retransmissionsSent",type:"number"},{key:"state",type:"string",fixup:function(state){return"inprogress"===state?"in-progress":state}},{key:"totalRoundTripTime",type:"number"},{key:"transportId",type:"string"},{key:"writable",type:"boolean"}].reduce((function(report,keyInfo){return report[keyInfo.key]=typeof activeCandidatePairStats[keyInfo.key]===keyInfo.type?keyInfo.fixup?keyInfo.fixup(activeCandidatePairStats[keyInfo.key]):activeCandidatePairStats[keyInfo.key]:null,report}),{localCandidate:standatdizedLocalCandidateStatsReport,remoteCandidate:standardizedRemoteCandidateStatsReport})}function standardizeFirefoxActiveIceCandidatePairStats(stats){var activeCandidatePairStats=Array.from(stats.values()).find((function(stat){return"candidate-pair"===stat.type&&stat.nominated}));if(!activeCandidatePairStats)return null;var activeLocalCandidateStats=stats.get(activeCandidatePairStats.localCandidateId),activeRemoteCandidateStats=stats.get(activeCandidatePairStats.remoteCandidateId),standardizedCandidateStatsKeys=[{key:"candidateType",type:"string"},{key:"ip",ffKeys:["address","ipAddress"],type:"string"},{key:"port",ffKeys:["portNumber"],type:"number"},{key:"priority",type:"number"},{key:"protocol",ffKeys:["transport"],type:"string"},{key:"url",type:"string"}],standardizedLocalCandidateStatsKeys=standardizedCandidateStatsKeys.concat([{key:"deleted",type:"boolean"},{key:"relayProtocol",type:"string"}]),candidateTypes={host:"host",peerreflexive:"prflx",relayed:"relay",serverreflexive:"srflx"},standatdizedLocalCandidateStatsReport=activeLocalCandidateStats?standardizedLocalCandidateStatsKeys.reduce((function(report,keyInfo){var key=keyInfo.ffKeys&&keyInfo.ffKeys.find((function(key){return key in activeLocalCandidateStats}))||keyInfo.key;return report[keyInfo.key]=typeof activeLocalCandidateStats[key]===keyInfo.type?"candidateType"===key&&candidateTypes[activeLocalCandidateStats[key]]||activeLocalCandidateStats[key]:"deleted"!==key&&null,report}),{}):null,standardizedRemoteCandidateStatsReport=activeRemoteCandidateStats?standardizedCandidateStatsKeys.reduce((function(report,keyInfo){var key=keyInfo.ffKeys&&keyInfo.ffKeys.find((function(key){return key in activeRemoteCandidateStats}))||keyInfo.key;return report[keyInfo.key]=typeof activeRemoteCandidateStats[key]===keyInfo.type?"candidateType"===key&&candidateTypes[activeRemoteCandidateStats[key]]||activeRemoteCandidateStats[key]:null,report}),{}):null;return[{key:"availableIncomingBitrate",type:"number"},{key:"availableOutgoingBitrate",type:"number"},{key:"bytesReceived",type:"number"},{key:"bytesSent",type:"number"},{key:"consentRequestsSent",type:"number"},{key:"currentRoundTripTime",type:"number"},{key:"lastPacketReceivedTimestamp",type:"number"},{key:"lastPacketSentTimestamp",type:"number"},{key:"nominated",type:"boolean"},{key:"priority",type:"number"},{key:"readable",type:"boolean"},{key:"requestsReceived",type:"number"},{key:"requestsSent",type:"number"},{key:"responsesReceived",type:"number"},{key:"responsesSent",type:"number"},{key:"retransmissionsReceived",type:"number"},{key:"retransmissionsSent",type:"number"},{key:"state",type:"string"},{key:"totalRoundTripTime",type:"number"},{key:"transportId",type:"string"},{key:"writable",type:"boolean"}].reduce((function(report,keyInfo){return report[keyInfo.key]=typeof activeCandidatePairStats[keyInfo.key]===keyInfo.type?activeCandidatePairStats[keyInfo.key]:null,report}),{localCandidate:standatdizedLocalCandidateStatsReport,remoteCandidate:standardizedRemoteCandidateStatsReport})}function getTracks(peerConnection,kind,localOrRemote){var getSendersOrReceivers="local"===localOrRemote?"getSenders":"getReceivers";return peerConnection[getSendersOrReceivers]?peerConnection[getSendersOrReceivers]().map((function(senderOrReceiver){return senderOrReceiver.track})).filter((function(track){return track&&track.kind===kind})):flatMap(peerConnection["local"===localOrRemote?"getLocalStreams":"getRemoteStreams"](),(function(stream){return stream["audio"===kind?"getAudioTracks":"getVideoTracks"]()}))}function chromeOrSafariGetTrackStats(peerConnection,track){return new Promise((function(resolve,reject){chromeMajorVersion&&chromeMajorVersion<67?peerConnection.getStats((function(response){resolve([standardizeChromeLegacyStats(response,track)])}),null,reject):peerConnection.getStats(track).then((function(response){resolve(function(response){var inbound=null,outbound=[],remoteInbound=null,remoteOutbound=null,track=null,codec=null,localMedia=null;response.forEach((function(stat){switch(stat.type){case"inbound-rtp":inbound=stat;break;case"outbound-rtp":outbound.push(stat);break;case"media-source":localMedia=stat;break;case"track":track=stat;break;case"codec":codec=stat;break;case"remote-inbound-rtp":remoteInbound=stat;break;case"remote-outbound-rtp":remoteOutbound=stat}}));var isRemote=track&&track.remoteSource,stats=[],remoteSource=isRemote?remoteOutbound:remoteInbound;return(isRemote?[inbound]:outbound).forEach((function(source){var standardizedStats={},statSources=[source,localMedia,track,codec,remoteSource&&remoteSource.ssrc===source.ssrc?remoteSource:null];function getStatValue(name){var sourceFound=statSources.find((function(statSource){return statSource&&void 0!==statSource[name]}))||null;return sourceFound?sourceFound[name]:null}var ssrc=getStatValue("ssrc");"number"==typeof ssrc&&(standardizedStats.ssrc=String(ssrc));var timestamp=getStatValue("timestamp");standardizedStats.timestamp=Math.round(timestamp);var mimeType=getStatValue("mimeType");"string"==typeof mimeType&&(mimeType=mimeType.split("/"),standardizedStats.codecName=mimeType[mimeType.length-1]);var roundTripTime=getStatValue("roundTripTime");"number"==typeof roundTripTime&&(standardizedStats.roundTripTime=Math.round(1e3*roundTripTime));var jitter=getStatValue("jitter");"number"==typeof jitter&&(standardizedStats.jitter=Math.round(1e3*jitter));var frameWidth=getStatValue("frameWidth");"number"==typeof frameWidth&&(isRemote?standardizedStats.frameWidthReceived=frameWidth:(standardizedStats.frameWidthSent=frameWidth,standardizedStats.frameWidthInput=track.frameWidth));var frameHeight=getStatValue("frameHeight");"number"==typeof frameHeight&&(isRemote?standardizedStats.frameHeightReceived=frameHeight:(standardizedStats.frameHeightSent=frameHeight,standardizedStats.frameHeightInput=track.frameHeight));var framesPerSecond=getStatValue("framesPerSecond");"number"==typeof framesPerSecond&&(standardizedStats[isRemote?"frameRateReceived":"frameRateSent"]=framesPerSecond);var bytesReceived=getStatValue("bytesReceived");"number"==typeof bytesReceived&&(standardizedStats.bytesReceived=bytesReceived);var bytesSent=getStatValue("bytesSent");"number"==typeof bytesSent&&(standardizedStats.bytesSent=bytesSent);var packetsLost=getStatValue("packetsLost");"number"==typeof packetsLost&&(standardizedStats.packetsLost=packetsLost);var packetsReceived=getStatValue("packetsReceived");"number"==typeof packetsReceived&&(standardizedStats.packetsReceived=packetsReceived);var packetsSent=getStatValue("packetsSent");"number"==typeof packetsSent&&(standardizedStats.packetsSent=packetsSent);var audioLevel=getStatValue("audioLevel");"number"==typeof audioLevel&&(audioLevel=Math.round(32767*audioLevel),isRemote?standardizedStats.audioOutputLevel=audioLevel:standardizedStats.audioInputLevel=audioLevel);var totalPacketSendDalay=getStatValue("totalPacketSendDelay");"number"==typeof totalPacketSendDalay&&(standardizedStats.totalPacketSendDelay=totalPacketSendDalay);var totalEncodeTime=getStatValue("totalEncodeTime");"number"==typeof totalEncodeTime&&(standardizedStats.totalEncodeTime=totalEncodeTime);var framesEncoded=getStatValue("framesEncoded");"number"==typeof framesEncoded&&(standardizedStats.framesEncoded=framesEncoded);var estimatedPlayoutTimestamp=getStatValue("estimatedPlayoutTimestamp");"number"==typeof estimatedPlayoutTimestamp&&(standardizedStats.estimatedPlayoutTimestamp=estimatedPlayoutTimestamp);var totalDecodeTime=getStatValue("totalDecodeTime");"number"==typeof totalDecodeTime&&(standardizedStats.totalDecodeTime=totalDecodeTime);var framesDecoded=getStatValue("framesDecoded");"number"==typeof framesDecoded&&(standardizedStats.framesDecoded=framesDecoded);var jitterBufferDelay=getStatValue("jitterBufferDelay");"number"==typeof jitterBufferDelay&&(standardizedStats.jitterBufferDelay=jitterBufferDelay);var jitterBufferEmittedCount=getStatValue("jitterBufferEmittedCount");"number"==typeof jitterBufferEmittedCount&&(standardizedStats.jitterBufferEmittedCount=jitterBufferEmittedCount),stats.push(standardizedStats)})),stats}(response))}),reject)}))}function standardizeChromeLegacyStats(response,track){var ssrcReport=response.result().find((function(report){return"ssrc"===report.type&&report.stat("googTrackId")===track.id})),standardizedStats={};return ssrcReport&&(standardizedStats.timestamp=Math.round(Number(ssrcReport.timestamp)),standardizedStats=ssrcReport.names().reduce((function(stats,name){switch(name){case"googCodecName":stats.codecName=ssrcReport.stat(name);break;case"googRtt":stats.roundTripTime=Number(ssrcReport.stat(name));break;case"googJitterReceived":stats.jitter=Number(ssrcReport.stat(name));break;case"googFrameWidthInput":stats.frameWidthInput=Number(ssrcReport.stat(name));break;case"googFrameHeightInput":stats.frameHeightInput=Number(ssrcReport.stat(name));break;case"googFrameWidthSent":stats.frameWidthSent=Number(ssrcReport.stat(name));break;case"googFrameHeightSent":stats.frameHeightSent=Number(ssrcReport.stat(name));break;case"googFrameWidthReceived":stats.frameWidthReceived=Number(ssrcReport.stat(name));break;case"googFrameHeightReceived":stats.frameHeightReceived=Number(ssrcReport.stat(name));break;case"googFrameRateInput":stats.frameRateInput=Number(ssrcReport.stat(name));break;case"googFrameRateSent":stats.frameRateSent=Number(ssrcReport.stat(name));break;case"googFrameRateReceived":stats.frameRateReceived=Number(ssrcReport.stat(name));break;case"ssrc":stats[name]=ssrcReport.stat(name);break;case"bytesReceived":case"bytesSent":case"packetsLost":case"packetsReceived":case"packetsSent":case"audioInputLevel":case"audioOutputLevel":stats[name]=Number(ssrcReport.stat(name))}return stats}),standardizedStats)),standardizedStats}function standardizeFirefoxStats(response,isRemote){response=response||new Map;var inbound=null,outbound=null;response.forEach((function(stat){if(!stat.isRemote)switch(stat.type){case"inbound-rtp":inbound=stat,outbound=response.get(stat.remoteId);break;case"outbound-rtp":outbound=stat,inbound=response.get(stat.remoteId)}}));var first=isRemote?inbound:outbound,second=isRemote?outbound:inbound;function getStatValue(name){return first&&void 0!==first[name]?first[name]:second&&void 0!==second[name]?second[name]:null}var standardizedStats={},timestamp=getStatValue("timestamp");standardizedStats.timestamp=Math.round(timestamp);var ssrc=getStatValue("ssrc");"number"==typeof ssrc&&(standardizedStats.ssrc=String(ssrc));var bytesSent=getStatValue("bytesSent");"number"==typeof bytesSent&&(standardizedStats.bytesSent=bytesSent);var packetsLost=getStatValue("packetsLost");"number"==typeof packetsLost&&(standardizedStats.packetsLost=packetsLost);var packetsSent=getStatValue("packetsSent");"number"==typeof packetsSent&&(standardizedStats.packetsSent=packetsSent);var roundTripTime=getStatValue("roundTripTime");"number"==typeof roundTripTime&&(standardizedStats.roundTripTime=Math.round(1e3*roundTripTime));var jitter=getStatValue("jitter");"number"==typeof jitter&&(standardizedStats.jitter=Math.round(1e3*jitter));var frameRateSent=getStatValue("framerateMean");"number"==typeof frameRateSent&&(standardizedStats.frameRateSent=Math.round(frameRateSent));var bytesReceived=getStatValue("bytesReceived");"number"==typeof bytesReceived&&(standardizedStats.bytesReceived=bytesReceived);var packetsReceived=getStatValue("packetsReceived");"number"==typeof packetsReceived&&(standardizedStats.packetsReceived=packetsReceived);var frameRateReceived=getStatValue("framerateMean");"number"==typeof frameRateReceived&&(standardizedStats.frameRateReceived=Math.round(frameRateReceived));var totalPacketSendDalay=getStatValue("totalPacketSendDelay");"number"==typeof totalPacketSendDalay&&(standardizedStats.totalPacketSendDelay=totalPacketSendDalay);var totalEncodeTime=getStatValue("totalEncodeTime");"number"==typeof totalEncodeTime&&(standardizedStats.totalEncodeTime=totalEncodeTime);var framesEncoded=getStatValue("framesEncoded");"number"==typeof framesEncoded&&(standardizedStats.framesEncoded=framesEncoded);var estimatedPlayoutTimestamp=getStatValue("estimatedPlayoutTimestamp");"number"==typeof estimatedPlayoutTimestamp&&(standardizedStats.estimatedPlayoutTimestamp=estimatedPlayoutTimestamp);var totalDecodeTime=getStatValue("totalDecodeTime");"number"==typeof totalDecodeTime&&(standardizedStats.totalDecodeTime=totalDecodeTime);var framesDecoded=getStatValue("framesDecoded");"number"==typeof framesDecoded&&(standardizedStats.framesDecoded=framesDecoded);var jitterBufferDelay=getStatValue("jitterBufferDelay");"number"==typeof jitterBufferDelay&&(standardizedStats.jitterBufferDelay=jitterBufferDelay);var jitterBufferEmittedCount=getStatValue("jitterBufferEmittedCount");return"number"==typeof jitterBufferEmittedCount&&(standardizedStats.jitterBufferEmittedCount=jitterBufferEmittedCount),standardizedStats}module.exports=function(peerConnection,options){return peerConnection&&"function"==typeof peerConnection.getStats?function(peerConnection,options){var localAudioTracks=getTracks(peerConnection,"audio","local"),localVideoTracks=getTracks(peerConnection,"video","local"),remoteAudioTracks=getTracks(peerConnection,"audio"),remoteVideoTracks=getTracks(peerConnection,"video"),statsResponse={activeIceCandidatePair:null,localAudioTrackStats:[],localVideoTrackStats:[],remoteAudioTrackStats:[],remoteVideoTrackStats:[]},trackStatsPromises=flatMap([[localAudioTracks,"localAudioTrackStats",!1],[localVideoTracks,"localVideoTrackStats",!1],[remoteAudioTracks,"remoteAudioTrackStats",!0],[remoteVideoTracks,"remoteVideoTrackStats",!0]],(function(triple){var statsArrayName=triple[1],isRemote=triple[2];return triple[0].map((function(track){return function(peerConnection,track,options){return void 0!==(options=options||{}).testForChrome||isChrome?chromeOrSafariGetTrackStats(peerConnection,track):void 0!==options.testForFirefox||isFirefox?function(peerConnection,track,isRemote){return new Promise((function(resolve,reject){peerConnection.getStats(track).then((function(response){resolve([standardizeFirefoxStats(response,isRemote)])}),reject)}))}(peerConnection,track,options.isRemote):void 0!==options.testForSafari||isSafari?void 0!==options.testForSafari||"unified"===getSdpFormat()?chromeOrSafariGetTrackStats(peerConnection,track):Promise.reject(new Error(["getStats() is not supported on this version of Safari","due to this bug: https://bugs.webkit.org/show_bug.cgi?id=192601"].join(" "))):Promise.reject(new Error("RTCPeerConnection#getStats() not supported"))}(peerConnection,track,Object.assign({isRemote:isRemote},options)).then((function(trackStatsArray){trackStatsArray.forEach((function(trackStats){trackStats.trackId=track.id,statsResponse[statsArrayName].push(trackStats)}))}))}))}));return Promise.all(trackStatsPromises).then((function(){return function(peerConnection,options){return void 0!==(options=options||{}).testForChrome||isChrome||void 0!==options.testForSafari||isSafari?peerConnection.getStats().then(standardizeChromeOrSafariActiveIceCandidatePairStats):void 0!==options.testForFirefox||isFirefox?peerConnection.getStats().then(standardizeFirefoxActiveIceCandidatePairStats):Promise.reject(new Error("RTCPeerConnection#getStats() not supported"))}(peerConnection,options)})).then((function(activeIceCandidatePairStatsReport){return statsResponse.activeIceCandidatePair=activeIceCandidatePairStatsReport,statsResponse}))}(peerConnection,options):Promise.reject(new Error("Given PeerConnection does not support getStats"))}},"/E53":function(module,exports,__webpack_require__){var getOwnPropertyDescriptors=Object.getOwnPropertyDescriptors||function(obj){for(var keys=Object.keys(obj),descriptors={},i=0;i<keys.length;i++)descriptors[keys[i]]=Object.getOwnPropertyDescriptor(obj,keys[i]);return descriptors},formatRegExp=/%[sdj%]/g;exports.format=function(f){if(!isString(f)){for(var objects=[],i=0;i<arguments.length;i++)objects.push(inspect(arguments[i]));return objects.join(" ")}i=1;for(var args=arguments,len=args.length,str=String(f).replace(formatRegExp,(function(x){if("%%"===x)return"%";if(i>=len)return x;switch(x){case"%s":return String(args[i++]);case"%d":return Number(args[i++]);case"%j":try{return JSON.stringify(args[i++])}catch(_){return"[Circular]"}default:return x}})),x=args[i];i<len;x=args[++i])isNull(x)||!isObject(x)?str+=" "+x:str+=" "+inspect(x);return str},exports.deprecate=function(fn,msg){if("undefined"!=typeof process&&!0===process.noDeprecation)return fn;if("undefined"==typeof process)return function(){return exports.deprecate(fn,msg).apply(this,arguments)};var warned=!1;return function(){if(!warned){if(process.throwDeprecation)throw new Error(msg);process.traceDeprecation?console.trace(msg):console.error(msg),warned=!0}return fn.apply(this,arguments)}};var debugs={},debugEnvRegex=/^$/;if(process.env.NODE_DEBUG){var debugEnv=process.env.NODE_DEBUG;debugEnv=debugEnv.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),debugEnvRegex=new RegExp("^"+debugEnv+"$","i")}function inspect(obj,opts){var ctx={seen:[],stylize:stylizeNoColor};return arguments.length>=3&&(ctx.depth=arguments[2]),arguments.length>=4&&(ctx.colors=arguments[3]),isBoolean(opts)?ctx.showHidden=opts:opts&&exports._extend(ctx,opts),isUndefined(ctx.showHidden)&&(ctx.showHidden=!1),isUndefined(ctx.depth)&&(ctx.depth=2),isUndefined(ctx.colors)&&(ctx.colors=!1),isUndefined(ctx.customInspect)&&(ctx.customInspect=!0),ctx.colors&&(ctx.stylize=stylizeWithColor),formatValue(ctx,obj,ctx.depth)}function stylizeWithColor(str,styleType){var style=inspect.styles[styleType];return style?"["+inspect.colors[style][0]+"m"+str+"["+inspect.colors[style][1]+"m":str}function stylizeNoColor(str,styleType){return str}function formatValue(ctx,value,recurseTimes){if(ctx.customInspect&&value&&isFunction(value.inspect)&&value.inspect!==exports.inspect&&(!value.constructor||value.constructor.prototype!==value)){var ret=value.inspect(recurseTimes,ctx);return isString(ret)||(ret=formatValue(ctx,ret,recurseTimes)),ret}var primitive=function(ctx,value){if(isUndefined(value))return ctx.stylize("undefined","undefined");if(isString(value)){var simple="'"+JSON.stringify(value).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return ctx.stylize(simple,"string")}return isNumber(value)?ctx.stylize(""+value,"number"):isBoolean(value)?ctx.stylize(""+value,"boolean"):isNull(value)?ctx.stylize("null","null"):void 0}(ctx,value);if(primitive)return primitive;var keys=Object.keys(value),visibleKeys=function(array){var hash={};return array.forEach((function(val,idx){hash[val]=!0})),hash}(keys);if(ctx.showHidden&&(keys=Object.getOwnPropertyNames(value)),isError(value)&&(keys.indexOf("message")>=0||keys.indexOf("description")>=0))return formatError(value);if(0===keys.length){if(isFunction(value))return ctx.stylize("[Function"+(value.name?": "+value.name:"")+"]","special");if(isRegExp(value))return ctx.stylize(RegExp.prototype.toString.call(value),"regexp");if(isDate(value))return ctx.stylize(Date.prototype.toString.call(value),"date");if(isError(value))return formatError(value)}var output,base="",array=!1,braces=["{","}"];return isArray(value)&&(array=!0,braces=["[","]"]),isFunction(value)&&(base=" [Function"+(value.name?": "+value.name:"")+"]"),isRegExp(value)&&(base=" "+RegExp.prototype.toString.call(value)),isDate(value)&&(base=" "+Date.prototype.toUTCString.call(value)),isError(value)&&(base=" "+formatError(value)),0!==keys.length||array&&0!=value.length?recurseTimes<0?isRegExp(value)?ctx.stylize(RegExp.prototype.toString.call(value),"regexp"):ctx.stylize("[Object]","special"):(ctx.seen.push(value),output=array?function(ctx,value,recurseTimes,visibleKeys,keys){for(var output=[],i=0,l=value.length;i<l;++i)hasOwnProperty(value,String(i))?output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,String(i),!0)):output.push("");return keys.forEach((function(key){key.match(/^\d+$/)||output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,key,!0))})),output}(ctx,value,recurseTimes,visibleKeys,keys):keys.map((function(key){return formatProperty(ctx,value,recurseTimes,visibleKeys,key,array)})),ctx.seen.pop(),function(output,base,braces){return output.reduce((function(prev,cur){return cur.indexOf("\n"),prev+cur.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?braces[0]+(""===base?"":base+"\n ")+" "+output.join(",\n  ")+" "+braces[1]:braces[0]+base+" "+output.join(", ")+" "+braces[1]}(output,base,braces)):braces[0]+base+braces[1]}function formatError(value){return"["+Error.prototype.toString.call(value)+"]"}function formatProperty(ctx,value,recurseTimes,visibleKeys,key,array){var name,str,desc;if((desc=Object.getOwnPropertyDescriptor(value,key)||{value:value[key]}).get?str=ctx.stylize(desc.set?"[Getter/Setter]":"[Getter]","special"):desc.set&&(str=ctx.stylize("[Setter]","special")),hasOwnProperty(visibleKeys,key)||(name="["+key+"]"),str||(ctx.seen.indexOf(desc.value)<0?(str=isNull(recurseTimes)?formatValue(ctx,desc.value,null):formatValue(ctx,desc.value,recurseTimes-1)).indexOf("\n")>-1&&(str=array?str.split("\n").map((function(line){return"  "+line})).join("\n").substr(2):"\n"+str.split("\n").map((function(line){return"   "+line})).join("\n")):str=ctx.stylize("[Circular]","special")),isUndefined(name)){if(array&&key.match(/^\d+$/))return str;(name=JSON.stringify(""+key)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(name=name.substr(1,name.length-2),name=ctx.stylize(name,"name")):(name=name.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),name=ctx.stylize(name,"string"))}return name+": "+str}function isArray(ar){return Array.isArray(ar)}function isBoolean(arg){return"boolean"==typeof arg}function isNull(arg){return null===arg}function isNumber(arg){return"number"==typeof arg}function isString(arg){return"string"==typeof arg}function isUndefined(arg){return void 0===arg}function isRegExp(re){return isObject(re)&&"[object RegExp]"===objectToString(re)}function isObject(arg){return"object"==typeof arg&&null!==arg}function isDate(d){return isObject(d)&&"[object Date]"===objectToString(d)}function isError(e){return isObject(e)&&("[object Error]"===objectToString(e)||e instanceof Error)}function isFunction(arg){return"function"==typeof arg}function objectToString(o){return Object.prototype.toString.call(o)}function pad(n){return n<10?"0"+n.toString(10):n.toString(10)}exports.debuglog=function(set){if(set=set.toUpperCase(),!debugs[set])if(debugEnvRegex.test(set)){var pid=process.pid;debugs[set]=function(){var msg=exports.format.apply(exports,arguments);console.error("%s %d: %s",set,pid,msg)}}else debugs[set]=function(){};return debugs[set]},exports.inspect=inspect,inspect.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},inspect.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},exports.types=__webpack_require__("sOna"),exports.isArray=isArray,exports.isBoolean=isBoolean,exports.isNull=isNull,exports.isNullOrUndefined=function(arg){return null==arg},exports.isNumber=isNumber,exports.isString=isString,exports.isSymbol=function(arg){return"symbol"==typeof arg},exports.isUndefined=isUndefined,exports.isRegExp=isRegExp,exports.types.isRegExp=isRegExp,exports.isObject=isObject,exports.isDate=isDate,exports.types.isDate=isDate,exports.isError=isError,exports.types.isNativeError=isError,exports.isFunction=isFunction,exports.isPrimitive=function(arg){return null===arg||"boolean"==typeof arg||"number"==typeof arg||"string"==typeof arg||"symbol"==typeof arg||void 0===arg},exports.isBuffer=__webpack_require__("Jeqd");var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function timestamp(){var d=new Date,time=[pad(d.getHours()),pad(d.getMinutes()),pad(d.getSeconds())].join(":");return[d.getDate(),months[d.getMonth()],time].join(" ")}function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}exports.log=function(){console.log("%s - %s",timestamp(),exports.format.apply(exports,arguments))},exports.inherits=__webpack_require__("P7XM"),exports._extend=function(origin,add){if(!add||!isObject(add))return origin;for(var keys=Object.keys(add),i=keys.length;i--;)origin[keys[i]]=add[keys[i]];return origin};var kCustomPromisifiedSymbol="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function callbackifyOnRejected(reason,cb){if(!reason){var newReason=new Error("Promise was rejected with a falsy value");newReason.reason=reason,reason=newReason}return cb(reason)}exports.promisify=function(original){if("function"!=typeof original)throw new TypeError('The "original" argument must be of type Function');if(kCustomPromisifiedSymbol&&original[kCustomPromisifiedSymbol]){var fn;if("function"!=typeof(fn=original[kCustomPromisifiedSymbol]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(fn,kCustomPromisifiedSymbol,{value:fn,enumerable:!1,writable:!1,configurable:!0}),fn}function fn(){for(var promiseResolve,promiseReject,promise=new Promise((function(resolve,reject){promiseResolve=resolve,promiseReject=reject})),args=[],i=0;i<arguments.length;i++)args.push(arguments[i]);args.push((function(err,value){err?promiseReject(err):promiseResolve(value)}));try{original.apply(this,args)}catch(err){promiseReject(err)}return promise}return Object.setPrototypeOf(fn,Object.getPrototypeOf(original)),kCustomPromisifiedSymbol&&Object.defineProperty(fn,kCustomPromisifiedSymbol,{value:fn,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(fn,getOwnPropertyDescriptors(original))},exports.promisify.custom=kCustomPromisifiedSymbol,exports.callbackify=function(original){if("function"!=typeof original)throw new TypeError('The "original" argument must be of type Function');function callbackified(){for(var args=[],i=0;i<arguments.length;i++)args.push(arguments[i]);var maybeCb=args.pop();if("function"!=typeof maybeCb)throw new TypeError("The last argument must be of type Function");var self=this,cb=function(){return maybeCb.apply(self,arguments)};original.apply(this,args).then((function(ret){process.nextTick(cb.bind(null,null,ret))}),(function(rej){process.nextTick(callbackifyOnRejected.bind(null,rej,cb))}))}return Object.setPrototypeOf(callbackified,Object.getPrototypeOf(original)),Object.defineProperties(callbackified,getOwnPropertyDescriptors(original)),callbackified}},"/Ylb":function(module,exports,__webpack_require__){"use strict";var LocalAudioTrackStats=__webpack_require__("r2dn"),LocalVideoTrackStats=__webpack_require__("BMBc"),RemoteAudioTrackStats=__webpack_require__("yTCf"),RemoteVideoTrackStats=__webpack_require__("b9Z9");module.exports=function(peerConnectionId,statsResponse,prepareForInsights){if("string"!=typeof peerConnectionId)throw new Error("RTCPeerConnection id must be a string");Object.defineProperties(this,{peerConnectionId:{value:peerConnectionId,enumerable:!0},localAudioTrackStats:{value:statsResponse.localAudioTrackStats.map((function(report){return new LocalAudioTrackStats(report.trackId,report,prepareForInsights)})),enumerable:!0},localVideoTrackStats:{value:statsResponse.localVideoTrackStats.map((function(report){return new LocalVideoTrackStats(report.trackId,report,prepareForInsights)})),enumerable:!0},remoteAudioTrackStats:{value:statsResponse.remoteAudioTrackStats.map((function(report){return new RemoteAudioTrackStats(report.trackId,report)})),enumerable:!0},remoteVideoTrackStats:{value:statsResponse.remoteVideoTrackStats.map((function(report){return new RemoteVideoTrackStats(report.trackId,report)})),enumerable:!0}})}},"/kv6":function(module,exports,__webpack_require__){"use strict";var CancelablePromise=__webpack_require__("sYJf");module.exports=function(getLocalTracks,createLocalParticipant,createRoomSignaling,createRoom){var cancelableRoomSignalingPromise,cancellationError=new Error("Canceled");return new CancelablePromise((function(resolve,reject,isCanceled){var localParticipant;getLocalTracks((function(localTracks){return isCanceled()?CancelablePromise.reject(cancellationError):(localParticipant=createLocalParticipant(localTracks),createRoomSignaling(localParticipant).then((function(getCancelableRoomSignalingPromise){if(isCanceled())throw cancellationError;return cancelableRoomSignalingPromise=getCancelableRoomSignalingPromise()})))})).then((function(roomSignaling){if(isCanceled())throw roomSignaling.disconnect(),cancellationError;resolve(createRoom(localParticipant,roomSignaling))})).catch((function(error){reject(error)}))}),(function(){cancelableRoomSignalingPromise&&cancelableRoomSignalingPromise.cancel()}))}},0:function(module,exports,__webpack_require__){module.exports=__webpack_require__("zUnb")},"0Tt/":function(module,exports,__webpack_require__){"use strict";module.exports="function"==typeof MediaStreamTrack?MediaStreamTrack:function(){throw new Error("MediaStreamTrack is not supported")}},"0iCT":function(module,exports,__webpack_require__){"use strict";module.exports=function(trackId,statsReport){if("string"!=typeof trackId)throw new Error("Track id must be a string");Object.defineProperties(this,{trackId:{value:trackId,enumerable:!0},trackSid:{value:statsReport.trackSid,enumerable:!0},timestamp:{value:statsReport.timestamp,enumerable:!0},ssrc:{value:statsReport.ssrc,enumerable:!0},packetsLost:{value:"number"==typeof statsReport.packetsLost?statsReport.packetsLost:null,enumerable:!0},codec:{value:"string"==typeof statsReport.codecName?statsReport.codecName:null,enumerable:!0}})}},"0tP7":function(module,exports,__webpack_require__){"use strict";module.exports=function(track){Object.defineProperties(this,{track:{enumerable:!0,value:track,writable:!0}})}},"14BE":function(module,exports,__webpack_require__){"use strict";var defer=__webpack_require__("mIkg").defer,states={high:new Set(["low"]),low:new Set(["high"])};function Latch(initialState){if(!(this instanceof Latch))return new Latch(initialState);var state=initialState||"low";Object.defineProperties(this,{_state:{set:function(_state){if(state!==_state){var whenDeferreds=this._whenDeferreds.get(state=_state);whenDeferreds.forEach((function(deferred){deferred.resolve(this)}),this),whenDeferreds.clear()}},get:function(){return state}},_whenDeferreds:{value:new Map([["high",new Set],["low",new Set]])},state:{enumerable:!0,get:function(){return this._state}}})}function createUnreachableStateError(from,to){return new Error('Cannot transition from "'+from+'" to "'+to+'"')}Latch.prototype.lower=function(){return this.transition("low")},Latch.prototype.raise=function(){return this.transition("high")},Latch.prototype.transition=function(newState){if(!states[this.state].has(newState))throw createUnreachableStateError(this.state,newState);return this._state=newState,this},Latch.prototype.when=function(state){if(this.state===state)return Promise.resolve(this);if(!states[this.state].has(state))return Promise.reject(createUnreachableStateError(this.state,state));var deferred=defer();return this._whenDeferreds.get(state).add(deferred),deferred.promise},module.exports=Latch},"1I8i":function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},DominantSpeakerSignaling=__webpack_require__("lrhj"),NetworkQualityMonitor=__webpack_require__("pWYA"),NetworkQualitySignaling=__webpack_require__("Aq89"),RecordingV2=__webpack_require__("gBrb"),RoomSignaling=__webpack_require__("Lh68"),RemoteParticipantV2=__webpack_require__("3sVZ"),StatsReport=__webpack_require__("/Ylb"),TrackPrioritySignaling=__webpack_require__("Um2Z"),TrackSwitchOffSignaling=__webpack_require__("muOY"),RenderHintsSignaling=__webpack_require__("OD4n"),PublisherHintsSignaling=__webpack_require__("3Zq6"),_a=__webpack_require__("ghd6"),DEFAULT_SESSION_TIMEOUT_SEC=_a.constants.DEFAULT_SESSION_TIMEOUT_SEC,createBandwidthProfilePayload=_a.createBandwidthProfilePayload,defer=_a.defer,difference=_a.difference,filterObject=_a.filterObject,flatMap=_a.flatMap,oncePerTick=_a.oncePerTick,MovingAverageDelta=__webpack_require__("qOIT"),createTwilioError=__webpack_require__("5wwa").createTwilioError,RoomV2=function(_super){function RoomV2(localParticipant,initialState,transport,peerConnectionManager,options){var _this=this;initialState.options=Object.assign({session_timeout:DEFAULT_SESSION_TIMEOUT_SEC},initialState.options),options=Object.assign({DominantSpeakerSignaling:DominantSpeakerSignaling,NetworkQualityMonitor:NetworkQualityMonitor,NetworkQualitySignaling:NetworkQualitySignaling,RecordingSignaling:RecordingV2,RemoteParticipantV2:RemoteParticipantV2,TrackPrioritySignaling:TrackPrioritySignaling,TrackSwitchOffSignaling:TrackSwitchOffSignaling,bandwidthProfile:null,sessionTimeout:1e3*initialState.options.session_timeout,statsPublishIntervalMs:1e4},options),localParticipant.setBandwidthProfile(options.bandwidthProfile),peerConnectionManager.setIceReconnectTimeout(options.sessionTimeout);var getTrackReceiver=function(id){return _this._getTrackReceiver(id)},log=(_this=_super.call(this,localParticipant,initialState.sid,initialState.name,options)||this)._log;return Object.defineProperties(_this,{_disconnectedParticipantRevisions:{value:new Map},_NetworkQualityMonitor:{value:options.NetworkQualityMonitor},_lastBandwidthProfileRevision:{value:localParticipant.bandwidthProfileRevision,writable:!0},_networkQualityMonitor:{value:null,writable:!0},_networkQualityConfiguration:{value:localParticipant.networkQualityConfiguration},_peerConnectionManager:{value:peerConnectionManager},_published:{value:new Map},_publishedRevision:{value:0,writable:!0},_RemoteParticipantV2:{value:options.RemoteParticipantV2},_subscribed:{value:new Map},_subscribedRevision:{value:0,writable:!0},_subscriptionFailures:{value:new Map},_dominantSpeakerSignaling:{value:new options.DominantSpeakerSignaling(getTrackReceiver,{log:log})},_networkQualitySignaling:{value:new options.NetworkQualitySignaling(getTrackReceiver,localParticipant.networkQualityConfiguration,{log:log})},_renderHintsSignaling:{value:new RenderHintsSignaling(getTrackReceiver,{log:log})},_publisherHintsSignaling:{value:new PublisherHintsSignaling(getTrackReceiver,{log:log})},_trackPrioritySignaling:{value:new options.TrackPrioritySignaling(getTrackReceiver,{log:log})},_trackSwitchOffSignaling:{value:new options.TrackSwitchOffSignaling(getTrackReceiver,{log:log})},_pendingSwitchOffStates:{value:new Map},_transport:{value:transport},_trackReceiverDeferreds:{value:new Map},mediaRegion:{enumerable:!0,value:initialState.options.media_region||null}}),_this._initTrackSwitchOffSignaling(),_this._initDominantSpeakerSignaling(),_this._initNetworkQualityMonitorSignaling(),_this._initPublisherHintSignaling(),function(roomV2,localParticipant){var localParticipantUpdated=oncePerTick((function(){roomV2._publishNewLocalParticipantState()})),renegotiate=oncePerTick((function(){var trackSenders=flatMap(localParticipant.tracks,(function(trackV2){return trackV2.trackTransceiver}));roomV2._peerConnectionManager.setTrackSenders(trackSenders)}));localParticipant.on("trackAdded",renegotiate),localParticipant.on("trackRemoved",renegotiate),localParticipant.on("updated",localParticipantUpdated),roomV2.on("stateChanged",(function stateChanged(state){"disconnected"===state&&(localParticipant.removeListener("trackAdded",renegotiate),localParticipant.removeListener("trackRemoved",renegotiate),localParticipant.removeListener("updated",localParticipantUpdated),roomV2.removeListener("stateChanged",stateChanged),localParticipant.disconnect())})),roomV2.on("signalingConnectionStateChanged",(function(){var localParticipant=roomV2.localParticipant,identity=localParticipant.identity,sid=localParticipant.sid;switch(roomV2.signalingConnectionState){case"connected":localParticipant.connect(sid,identity);break;case"reconnecting":localParticipant.reconnecting()}}))}(_this,localParticipant),function(roomV2,peerConnectionManager){peerConnectionManager.on("description",(function(description){roomV2._publishPeerConnectionState(description)})),peerConnectionManager.dequeue("description"),peerConnectionManager.on("candidates",(function(candidates){roomV2._publishPeerConnectionState(candidates)})),peerConnectionManager.dequeue("candidates"),peerConnectionManager.on("trackAdded",roomV2._addTrackReceiver.bind(roomV2)),peerConnectionManager.dequeue("trackAdded"),peerConnectionManager.getTrackReceivers().forEach(roomV2._addTrackReceiver,roomV2),peerConnectionManager.on("connectionStateChanged",(function(){roomV2.emit("connectionStateChanged")})),peerConnectionManager.on("iceConnectionStateChanged",(function(){roomV2.emit("iceConnectionStateChanged"),"failed"===roomV2.iceConnectionState&&(null!==roomV2.localParticipant.networkQualityLevel&&roomV2.localParticipant.setNetworkQualityLevel(0),roomV2.participants.forEach((function(participant){null!==participant.networkQualityLevel&&participant.setNetworkQualityLevel(0)})))}))}(_this,peerConnectionManager),function(roomV2,transport){transport.on("message",roomV2._update.bind(roomV2)),transport.on("stateChanged",(function stateChanged(state,error){"disconnected"===state&&("disconnected"!==roomV2.state&&roomV2._disconnect(error),transport.removeListener("stateChanged",stateChanged)),roomV2.emit("signalingConnectionStateChanged")}))}(_this,transport),function(roomV2,transport,intervalMs){var movingAverageDeltas=new Map,oddPublishCount=!1,interval=setInterval((function(){roomV2.getStats().then((function(stats){oddPublishCount=!oddPublishCount,stats.forEach((function(response,id){var report=new StatsReport(id,response,!0);transport.publishEvent("quality","stats-report","info",{audioTrackStats:report.remoteAudioTrackStats.map((function(trackStat,i){return addAVSyncMetricsToRemoteTrackStats(trackStat,response.remoteAudioTrackStats[i],movingAverageDeltas)})),localAudioTrackStats:report.localAudioTrackStats.map((function(trackStat,i){return addAVSyncMetricsToLocalTrackStats(trackStat,response.localAudioTrackStats[i],movingAverageDeltas)})),localVideoTrackStats:report.localVideoTrackStats.map((function(trackStat,i){return addAVSyncMetricsToLocalTrackStats(trackStat,response.localVideoTrackStats[i],movingAverageDeltas)})),peerConnectionId:report.peerConnectionId,videoTrackStats:report.remoteVideoTrackStats.map((function(trackStat,i){return addAVSyncMetricsToRemoteTrackStats(trackStat,response.remoteVideoTrackStats[i],movingAverageDeltas)}))});var keys=flatMap(["localAudioTrackStats","localVideoTrackStats","remoteAudioTrackStats","remoteVideoTrackStats"],(function(prop){return report[prop].map((function(_a){return _a.trackSid+"+"+_a.ssrc}))}));if(difference(Array.from(movingAverageDeltas.keys()),keys).forEach((function(key){return movingAverageDeltas.delete(key)})),oddPublishCount){var activeIceCandidatePair=function(activeIceCandidatePair,peerConnectionId){return(activeIceCandidatePair=Object.assign({availableIncomingBitrate:0,availableOutgoingBitrate:0,bytesReceived:0,bytesSent:0,consentRequestsSent:0,currentRoundTripTime:0,lastPacketReceivedTimestamp:0,lastPacketSentTimestamp:0,nominated:!1,peerConnectionId:peerConnectionId,priority:0,readable:!1,requestsReceived:0,requestsSent:0,responsesReceived:0,responsesSent:0,retransmissionsReceived:0,retransmissionsSent:0,state:"failed",totalRoundTripTime:0,transportId:"",writable:!1},filterObject(activeIceCandidatePair||{},null))).localCandidate=Object.assign({candidateType:"host",deleted:!1,ip:"",port:0,priority:0,protocol:"udp",url:""},filterObject(activeIceCandidatePair.localCandidate||{},null)),activeIceCandidatePair.remoteCandidate=Object.assign({candidateType:"host",ip:"",port:0,priority:0,protocol:"udp",url:""},filterObject(activeIceCandidatePair.remoteCandidate||{},null)),activeIceCandidatePair}(response.activeIceCandidatePair,report.peerConnectionId);transport.publishEvent("quality","active-ice-candidate-pair","info",activeIceCandidatePair)}}))}),(function(){}))}),intervalMs);roomV2.on("stateChanged",(function onStateChanged(state){"disconnected"===state&&(clearInterval(interval),roomV2.removeListener("stateChanged",onStateChanged))}))}(_this,transport,options.statsPublishIntervalMs),_this._update(initialState),_this._peerConnectionManager.setEffectiveAdaptiveSimulcast(_this._publisherHintsSignaling.isSetup),_this}return __extends(RoomV2,_super),Object.defineProperty(RoomV2.prototype,"connectionState",{get:function(){return this._peerConnectionManager.connectionState},enumerable:!1,configurable:!0}),Object.defineProperty(RoomV2.prototype,"signalingConnectionState",{get:function(){return"syncing"===this._transport.state?"reconnecting":this._transport.state},enumerable:!1,configurable:!0}),Object.defineProperty(RoomV2.prototype,"iceConnectionState",{get:function(){return this._peerConnectionManager.iceConnectionState},enumerable:!1,configurable:!0}),RoomV2.prototype._deleteTrackReceiverDeferred=function(id){return this._trackReceiverDeferreds.delete(id)},RoomV2.prototype._getOrCreateTrackReceiverDeferred=function(id){var deferred=this._trackReceiverDeferreds.get(id)||defer(),trackReceiver=this._peerConnectionManager.getTrackReceivers().find((function(trackReceiver){return trackReceiver.id===id&&"ended"!==trackReceiver.readyState}));return trackReceiver?deferred.resolve(trackReceiver):this._trackReceiverDeferreds.set(id,deferred),deferred},RoomV2.prototype._addTrackReceiver=function(trackReceiver){return this._getOrCreateTrackReceiverDeferred(trackReceiver.id).resolve(trackReceiver),this},RoomV2.prototype._disconnect=function(error){var didDisconnect=_super.prototype._disconnect.call(this,error);return didDisconnect&&(this._teardownNetworkQualityMonitor(),this._transport.disconnect(),this._peerConnectionManager.close()),this.localParticipant.tracks.forEach((function(track){track.publishFailed(error||new Error("LocalParticipant disconnected"))})),didDisconnect},RoomV2.prototype._getTrackReceiver=function(id){var _this=this;return this._getOrCreateTrackReceiverDeferred(id).promise.then((function(trackReceiver){return _this._deleteTrackReceiverDeferred(id),trackReceiver}))},RoomV2.prototype._getInitialTrackSwitchOffState=function(trackSid){var initiallySwitchedOff=this._pendingSwitchOffStates.get(trackSid)||!1;return this._pendingSwitchOffStates.delete(trackSid),initiallySwitchedOff&&this._log.warn("["+trackSid+"] was initially switched off! "),initiallySwitchedOff},RoomV2.prototype._getTrackSidsToTrackSignalings=function(){var trackSidsToTrackSignalings=flatMap(this.participants,(function(participant){return Array.from(participant.tracks)}));return new Map(trackSidsToTrackSignalings)},RoomV2.prototype._getOrCreateRemoteParticipant=function(participantState){var _this=this,RemoteParticipantV2=this._RemoteParticipantV2,participant=this.participants.get(participantState.sid),self=this;return participant||((participant=new RemoteParticipantV2(participantState,(function(trackSid){return _this._getInitialTrackSwitchOffState(trackSid)}),(function(trackSid,priority){return _this._trackPrioritySignaling.sendTrackPriorityUpdate(trackSid,"subscribe",priority)}),(function(trackSid,hint){return _this._renderHintsSignaling.setTrackHint(trackSid,hint)}),(function(trackSid){return _this._renderHintsSignaling.clearTrackHint(trackSid)}))).on("stateChanged",(function stateChanged(state){"disconnected"===state&&(participant.removeListener("stateChanged",stateChanged),self.participants.delete(participant.sid),self._disconnectedParticipantRevisions.set(participant.sid,participant.revision))})),this.connectParticipant(participant)),participant},RoomV2.prototype._getState=function(){return{participant:this.localParticipant.getState()}},RoomV2.prototype._maybeAddBandwidthProfile=function(update){var _a=this.localParticipant,bandwidthProfile=_a.bandwidthProfile,bandwidthProfileRevision=_a.bandwidthProfileRevision;return bandwidthProfile&&this._lastBandwidthProfileRevision<bandwidthProfileRevision?(this._lastBandwidthProfileRevision=bandwidthProfileRevision,Object.assign({bandwidth_profile:createBandwidthProfilePayload(bandwidthProfile)},update)):update},RoomV2.prototype._publishNewLocalParticipantState=function(){this._transport.publish(this._maybeAddBandwidthProfile(this._getState()))},RoomV2.prototype._publishPeerConnectionState=function(peerConnectionState){this._transport.publish(Object.assign({peer_connections:[peerConnectionState]},this._getState()))},RoomV2.prototype._update=function(roomState){var _this=this;if(roomState.subscribed&&roomState.subscribed.revision>this._subscribedRevision){this._subscribedRevision=roomState.subscribed.revision,roomState.subscribed.tracks.forEach((function(trackState){trackState.id?(_this._subscriptionFailures.delete(trackState.sid),_this._subscribed.set(trackState.sid,trackState.id)):trackState.error&&!_this._subscriptionFailures.has(trackState.sid)&&_this._subscriptionFailures.set(trackState.sid,trackState.error)}));var subscribedTrackSids_1=new Set(roomState.subscribed.tracks.filter((function(trackState){return!!trackState.id})).map((function(trackState){return trackState.sid})));this._subscribed.forEach((function(trackId,trackSid){subscribedTrackSids_1.has(trackSid)||_this._subscribed.delete(trackSid)}))}var room,trackSidsToTrackSignalings,participantsToKeep=new Set;return(roomState.participants||[]).forEach((function(participantState){if(participantState.sid!==_this.localParticipant.sid){var disconnectedParticipantRevision=_this._disconnectedParticipantRevisions.get(participantState.sid);if(!(disconnectedParticipantRevision&&participantState.revision<=disconnectedParticipantRevision)){disconnectedParticipantRevision&&_this._disconnectedParticipantRevisions.delete(participantState.sid);var participant=_this._getOrCreateRemoteParticipant(participantState);participant.update(participantState),participantsToKeep.add(participant)}}})),"synced"===roomState.type&&this.participants.forEach((function(participant){participantsToKeep.has(participant)||participant.disconnect()})),trackSidsToTrackSignalings=(room=this)._getTrackSidsToTrackSignalings(),room._subscriptionFailures.forEach((function(error,trackSid){var trackSignaling=trackSidsToTrackSignalings.get(trackSid);trackSignaling&&(room._subscriptionFailures.delete(trackSid),trackSignaling.subscribeFailed(createTwilioError(error.code,error.message)))})),trackSidsToTrackSignalings.forEach((function(trackSignaling){var trackId=room._subscribed.get(trackSignaling.sid);(!trackId||trackSignaling.isSubscribed&&trackSignaling.trackTransceiver.id!==trackId)&&trackSignaling.setTrackTransceiver(null),trackId&&room._getTrackReceiver(trackId).then((function(trackReceiver){return trackSignaling.setTrackTransceiver(trackReceiver)}))})),roomState.peer_connections&&this._peerConnectionManager.update(roomState.peer_connections,"synced"===roomState.type),roomState.recording&&this.recording.update(roomState.recording),roomState.published&&roomState.published.revision>this._publishedRevision&&(this._publishedRevision=roomState.published.revision,roomState.published.tracks.forEach((function(track){track.sid&&_this._published.set(track.id,track.sid)})),this.localParticipant.update(roomState.published)),roomState.participant&&this.localParticipant.connect(roomState.participant.sid,roomState.participant.identity),[this._dominantSpeakerSignaling,this._networkQualitySignaling,this._trackPrioritySignaling,this._trackSwitchOffSignaling,this._renderHintsSignaling,this._publisherHintsSignaling].forEach((function(mediaSignaling){var channel=mediaSignaling.channel;!mediaSignaling.isSetup&&roomState.media_signaling&&roomState.media_signaling[channel]&&roomState.media_signaling[channel].transport&&"data-channel"===roomState.media_signaling[channel].transport.type&&mediaSignaling.setup(roomState.media_signaling[channel].transport.label)})),this},RoomV2.prototype._initPublisherHintSignaling=function(){var _this=this;this._publisherHintsSignaling.on("updated",(function(hints,id){Promise.all(hints.map((function(hint){return _this.localParticipant.setPublisherHint(hint.track,hint.encodings).then((function(result){return{track:hint.track,result:result}}))}))).then((function(hintResponses){_this._publisherHintsSignaling.sendHintResponse({id:id,hints:hintResponses})}))}));var handleReplaced=function(track){"video"===track.kind&&track.trackTransceiver.on("replaced",(function(){_this._publisherHintsSignaling.sendTrackReplaced({trackSid:track.sid})}))};Array.from(this.localParticipant.tracks.values()).forEach((function(track){return handleReplaced(track)})),this.localParticipant.on("trackAdded",(function(track){return handleReplaced(track)}))},RoomV2.prototype._initTrackSwitchOffSignaling=function(){var _this=this;this._trackSwitchOffSignaling.on("updated",(function(tracksOff,tracksOn){try{_this._log.debug("received trackSwitch: ",{tracksOn:tracksOn,tracksOff:tracksOff});var trackUpdates_1=new Map;tracksOn.forEach((function(trackSid){return trackUpdates_1.set(trackSid,!0)})),tracksOff.forEach((function(trackSid){trackUpdates_1.get(trackSid)&&_this._log.warn(trackSid+" is DUPLICATED in both tracksOff and tracksOn list"),trackUpdates_1.set(trackSid,!1)})),_this.participants.forEach((function(participant){participant.tracks.forEach((function(track){var isOn=trackUpdates_1.get(track.sid);void 0!==isOn&&(track.setSwitchedOff(!isOn),trackUpdates_1.delete(track.sid))}))})),trackUpdates_1.forEach((function(isOn,trackSid){return _this._pendingSwitchOffStates.set(trackSid,!isOn)}))}catch(ex){_this._log.error("error processing track switch off:",ex)}}))},RoomV2.prototype._initDominantSpeakerSignaling=function(){var _this=this;this._dominantSpeakerSignaling.on("updated",(function(){return _this.setDominantSpeaker(_this._dominantSpeakerSignaling.loudestParticipantSid)}))},RoomV2.prototype._initNetworkQualityMonitorSignaling=function(){var _this=this;this._networkQualitySignaling.on("ready",(function(){var networkQualityMonitor=new _this._NetworkQualityMonitor(_this._peerConnectionManager,_this._networkQualitySignaling);_this._networkQualityMonitor=networkQualityMonitor,networkQualityMonitor.on("updated",(function(){"failed"!==_this.iceConnectionState&&(_this.localParticipant.setNetworkQualityLevel(networkQualityMonitor.level,networkQualityMonitor.levels),_this.participants.forEach((function(participant){var levels=networkQualityMonitor.remoteLevels.get(participant.sid);levels&&participant.setNetworkQualityLevel(levels.level,levels)})))})),networkQualityMonitor.start()})),this._networkQualitySignaling.on("teardown",(function(){return _this._teardownNetworkQualityMonitor()}))},RoomV2.prototype._teardownNetworkQualityMonitor=function(){this._networkQualityMonitor&&(this._networkQualityMonitor.stop(),this._networkQualityMonitor=null)},RoomV2.prototype.getStats=function(){var _this=this;return this._peerConnectionManager.getStats().then((function(responses){return new Map(Array.from(responses).map((function(_a){var _b=__read(_a,2),response=_b[1];return[_b[0],Object.assign({},response,{localAudioTrackStats:filterAndAddLocalTrackSids(_this,response.localAudioTrackStats),localVideoTrackStats:filterAndAddLocalTrackSids(_this,response.localVideoTrackStats),remoteAudioTrackStats:filterAndAddRemoteTrackSids(_this,response.remoteAudioTrackStats),remoteVideoTrackStats:filterAndAddRemoteTrackSids(_this,response.remoteVideoTrackStats)})]})))}))},RoomV2}(RoomSignaling);function filterAndAddTrackSids(idToSid,trackStats){return trackStats.reduce((function(trackStats,trackStat){var trackSid=idToSid.get(trackStat.trackId);return trackSid?[Object.assign({},trackStat,{trackSid:trackSid})].concat(trackStats):trackStats}),[])}function filterAndAddLocalTrackSids(roomV2,localTrackStats){return filterAndAddTrackSids(roomV2._published,localTrackStats)}function filterAndAddRemoteTrackSids(roomV2,remoteTrackStats){return filterAndAddTrackSids(new Map(Array.from(roomV2._subscribed.entries()).map((function(_a){var _b=__read(_a,2);return[_b[1],_b[0]]}))),remoteTrackStats)}function addAVSyncMetricsToLocalTrackStats(trackStats,trackResponse,movingAverageDeltas){var framesEncoded=trackResponse.framesEncoded,packetsSent=trackResponse.packetsSent,totalEncodeTime=trackResponse.totalEncodeTime,totalPacketSendDelay=trackResponse.totalPacketSendDelay,augmentedTrackStats=Object.assign({},trackStats),key=trackStats.trackSid+"+"+trackStats.ssrc,trackMovingAverageDeltas=movingAverageDeltas.get(key)||new Map;if("number"==typeof totalEncodeTime&&"number"==typeof framesEncoded){var trackAvgEncodeDelayMovingAverageDelta=trackMovingAverageDeltas.get("avgEncodeDelay")||new MovingAverageDelta;trackAvgEncodeDelayMovingAverageDelta.putSample(1e3*totalEncodeTime,framesEncoded),augmentedTrackStats.avgEncodeDelay=Math.round(trackAvgEncodeDelayMovingAverageDelta.get()),trackMovingAverageDeltas.set("avgEncodeDelay",trackAvgEncodeDelayMovingAverageDelta)}if("number"==typeof totalPacketSendDelay&&"number"==typeof packetsSent){var trackAvgPacketSendDelayMovingAverageDelta=trackMovingAverageDeltas.get("avgPacketSendDelay")||new MovingAverageDelta;trackAvgPacketSendDelayMovingAverageDelta.putSample(1e3*totalPacketSendDelay,packetsSent),augmentedTrackStats.avgPacketSendDelay=Math.round(trackAvgPacketSendDelayMovingAverageDelta.get()),trackMovingAverageDeltas.set("avgPacketSendDelay",trackAvgPacketSendDelayMovingAverageDelta)}return movingAverageDeltas.set(key,trackMovingAverageDeltas),augmentedTrackStats}function addAVSyncMetricsToRemoteTrackStats(trackStats,trackResponse,movingAverageDeltas){var estimatedPlayoutTimestamp=trackResponse.estimatedPlayoutTimestamp,framesDecoded=trackResponse.framesDecoded,jitterBufferDelay=trackResponse.jitterBufferDelay,jitterBufferEmittedCount=trackResponse.jitterBufferEmittedCount,totalDecodeTime=trackResponse.totalDecodeTime,augmentedTrackStats=Object.assign({},trackStats),key=trackStats.trackSid+"+"+trackStats.ssrc,trackMovingAverageDeltas=movingAverageDeltas.get(key)||new Map;if("number"==typeof estimatedPlayoutTimestamp&&(augmentedTrackStats.estimatedPlayoutTimestamp=estimatedPlayoutTimestamp),"number"==typeof framesDecoded&&"number"==typeof totalDecodeTime){var trackAvgDecodeDelayMovingAverageDelta=trackMovingAverageDeltas.get("avgDecodeDelay")||new MovingAverageDelta;trackAvgDecodeDelayMovingAverageDelta.putSample(1e3*totalDecodeTime,framesDecoded),augmentedTrackStats.avgDecodeDelay=Math.round(trackAvgDecodeDelayMovingAverageDelta.get()),trackMovingAverageDeltas.set("avgDecodeDelay",trackAvgDecodeDelayMovingAverageDelta)}if("number"==typeof jitterBufferDelay&&"number"==typeof jitterBufferEmittedCount){var trackAvgJitterBufferDelayMovingAverageDelta=trackMovingAverageDeltas.get("avgJitterBufferDelay")||new MovingAverageDelta;trackAvgJitterBufferDelayMovingAverageDelta.putSample(1e3*jitterBufferDelay,jitterBufferEmittedCount),augmentedTrackStats.avgJitterBufferDelay=Math.round(trackAvgJitterBufferDelayMovingAverageDelta.get()),trackMovingAverageDeltas.set("avgJitterBufferDelay",trackAvgJitterBufferDelayMovingAverageDelta)}return movingAverageDeltas.set(key,trackMovingAverageDeltas),augmentedTrackStats}module.exports=RoomV2},"1RtY":function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__spreadArray=this&&this.__spreadArray||function(to,from){for(var i=0,il=from.length,j=to.length;i<il;i++,j++)to[j]=from[i];return to},RemoteParticipant=function(_super){function RemoteParticipant(signaling,options){var _this=_super.call(this,signaling,options)||this;return _this._handleTrackSignalingEvents(),_this.once("disconnected",_this._unsubscribeTracks.bind(_this)),_this}return __extends(RemoteParticipant,_super),RemoteParticipant.prototype.toString=function(){return"[RemoteParticipant #"+this._instanceId+(this.sid?": "+this.sid:"")+"]"},RemoteParticipant.prototype._addTrack=function(remoteTrack,publication,id){return _super.prototype._addTrack.call(this,remoteTrack,id)?(publication._subscribed(remoteTrack),this.emit("trackSubscribed",remoteTrack,publication),remoteTrack):null},RemoteParticipant.prototype._addTrackPublication=function(publication){var addedPublication=_super.prototype._addTrackPublication.call(this,publication);return addedPublication?(this.emit("trackPublished",addedPublication),addedPublication):null},RemoteParticipant.prototype._getTrackPublicationEvents=function(){return __spreadArray(__spreadArray([],__read(_super.prototype._getTrackPublicationEvents.call(this))),[["subscriptionFailed","trackSubscriptionFailed"],["trackDisabled","trackDisabled"],["trackEnabled","trackEnabled"],["publishPriorityChanged","trackPublishPriorityChanged"],["trackSwitchedOff","trackSwitchedOff"],["trackSwitchedOn","trackSwitchedOn"]])},RemoteParticipant.prototype._unsubscribeTracks=function(){var _this=this;this.tracks.forEach((function(publication){if(publication.isSubscribed){var track=publication.track;publication._unsubscribe(),_this.emit("trackUnsubscribed",track,publication)}}))},RemoteParticipant.prototype._removeTrack=function(remoteTrack,publication,id){var unsubscribedTrack=this._tracks.get(id);return unsubscribedTrack?(_super.prototype._removeTrack.call(this,unsubscribedTrack,id),publication._unsubscribe(),this.emit("trackUnsubscribed",unsubscribedTrack,publication),unsubscribedTrack):null},RemoteParticipant.prototype._removeTrackPublication=function(publication){this._signaling.clearTrackHint(publication.trackSid);var removedPublication=_super.prototype._removeTrackPublication.call(this,publication);return removedPublication?(this.emit("trackUnpublished",removedPublication),removedPublication):null},RemoteParticipant}(__webpack_require__("TTpt"));module.exports=RemoteParticipant},"1go7":function(module,exports,__webpack_require__){"use strict";module.exports="function"==typeof MediaStream?MediaStream:function(){throw new Error("MediaStream is not supported")}},"1gqn":function(module,exports){module.exports=function(arg){return arg&&"object"==typeof arg&&"function"==typeof arg.copy&&"function"==typeof arg.fill&&"function"==typeof arg.readUInt8}},"2NPH":function(module,exports,__webpack_require__){"use strict";var inherits=__webpack_require__("/E53").inherits,LocalVideoTrackClass=__webpack_require__("uxdj");function LocalVideoTrack(mediaStreamTrack,options){var track=new LocalVideoTrackClass(mediaStreamTrack,options);return Object.setPrototypeOf(track,LocalVideoTrack.prototype),track}inherits(LocalVideoTrack,LocalVideoTrackClass),module.exports=LocalVideoTrack},"2mUf":function(module,exports,__webpack_require__){"use strict";module.exports=function(_a){var _b=_a.fractionLost,_c=_a.level;Object.defineProperties(this,{fractionLost:{value:void 0===_b?null:_b,enumerable:!0},level:{value:void 0===_c?null:_c,enumerable:!0}})}},"2xLa":function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),average=__webpack_require__("4o7n"),SenderOrReceiverReport=__webpack_require__("8WNc"),sum=__webpack_require__("Ihm+"),ReceiverReport=function(_super){function ReceiverReport(id,trackId,bitrate,deltaPacketsLost,deltaPacketsReceived,fractionLost,jitter){var _this=_super.call(this,id,trackId,bitrate)||this;return Object.defineProperties(_this,{deltaPacketsLost:{enumerable:!0,value:deltaPacketsLost},deltaPacketsReceived:{enumerable:!0,value:deltaPacketsReceived},fractionLost:{enumerable:!0,value:fractionLost},jitter:{enumerable:!0,value:jitter},phonyFractionLost:{enumerable:!0,value:deltaPacketsReceived>0?deltaPacketsLost/deltaPacketsReceived:0}}),_this}return __extends(ReceiverReport,_super),ReceiverReport.of=function(trackId,olderStats,newerStats){if(olderStats.id!==newerStats.id)throw new Error("RTCStats IDs must match");var secondsElapsed=(newerStats.timestamp-olderStats.timestamp)/1e3,bitrate=secondsElapsed>0?(newerStats.bytesReceived-olderStats.bytesReceived)/secondsElapsed*8:0,deltaPacketsLost=Math.max(newerStats.packetsLost-olderStats.packetsLost,0);return new ReceiverReport(olderStats.id,trackId,bitrate,deltaPacketsLost,newerStats.packetsReceived-olderStats.packetsReceived,newerStats.fractionLost,newerStats.jitter)},ReceiverReport.summarize=function(reports){var summaries=reports.map((function(report){return report.summarize()}));return{bitrate:sum(summaries.map((function(summary){return summary.bitrate}))),fractionLost:average(summaries.map((function(summary){return summary.fractionLost}))),jitter:average(summaries.map((function(summary){return summary.jitter})))}},ReceiverReport.prototype.summarize=function(){return{bitrate:this.bitrate,fractionLost:"number"==typeof this.fractionLost?this.fractionLost:this.phonyFractionLost,jitter:this.jitter}},ReceiverReport}(SenderOrReceiverReport);module.exports=ReceiverReport},"31MG":function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__spreadArray=this&&this.__spreadArray||function(to,from){for(var i=0,il=from.length,j=to.length;i<il;i++,j++)to[j]=from[i];return to},guessBrowser=__webpack_require__("mIkg").guessBrowser,PeerConnectionV2=__webpack_require__("d6fC"),MediaTrackSender=__webpack_require__("O22K"),QueueingEventEmitter=__webpack_require__("F/ro"),util=__webpack_require__("ghd6"),MediaConnectionError=__webpack_require__("5wwa").MediaConnectionError,isFirefox="firefox"===guessBrowser(),PeerConnectionManager=function(_super){function PeerConnectionManager(encodingParameters,preferredCodecs,options){var _this=_super.call(this)||this,audioContext=(options=Object.assign({audioContextFactory:isFirefox?__webpack_require__("/+gY"):null,PeerConnectionV2:PeerConnectionV2},options)).audioContextFactory?options.audioContextFactory.getOrCreate(_this):null,offerOptions=audioContext?{offerToReceiveVideo:!0}:{offerToReceiveAudio:!0,offerToReceiveVideo:!0};return Object.defineProperties(_this,{_audioContextFactory:{value:options.audioContextFactory},_closedPeerConnectionIds:{value:new Set},_configuration:{writable:!0,value:null},_configurationDeferred:{writable:!0,value:util.defer()},_connectionState:{value:"new",writable:!0},_dummyAudioTrackSender:{value:audioContext?new MediaTrackSender(createDummyAudioMediaStreamTrack(audioContext)):null},_encodingParameters:{value:encodingParameters},_iceConnectionState:{writable:!0,value:"new"},_dataTrackSenders:{writable:!0,value:new Set},_lastConnectionState:{value:"new",writable:!0},_lastIceConnectionState:{writable:!0,value:"new"},_mediaTrackSenders:{writable:!0,value:new Set},_offerOptions:{value:offerOptions},_peerConnections:{value:new Map},_preferredCodecs:{value:preferredCodecs},_sessionTimeout:{value:null,writable:!0},_PeerConnectionV2:{value:options.PeerConnectionV2}}),_this}return __extends(PeerConnectionManager,_super),PeerConnectionManager.prototype.setEffectiveAdaptiveSimulcast=function(effectiveAdaptiveSimulcast){this._peerConnections.forEach((function(pc){return pc.setEffectiveAdaptiveSimulcast(effectiveAdaptiveSimulcast)})),this._preferredCodecs.video.forEach((function(cs){"adaptiveSimulcast"in cs&&(cs.adaptiveSimulcast=effectiveAdaptiveSimulcast)}))},Object.defineProperty(PeerConnectionManager.prototype,"connectionState",{get:function(){return this._connectionState},enumerable:!1,configurable:!0}),Object.defineProperty(PeerConnectionManager.prototype,"iceConnectionState",{get:function(){return this._iceConnectionState},enumerable:!1,configurable:!0}),PeerConnectionManager.prototype._closeAbsentPeerConnections=function(peerConnectionStates){var peerConnectionIds=new Set(peerConnectionStates.map((function(peerConnectionState){return peerConnectionState.id})));return this._peerConnections.forEach((function(peerConnection){peerConnectionIds.has(peerConnection.id)||peerConnection._close()})),this},PeerConnectionManager.prototype._getConfiguration=function(){return this._configurationDeferred.promise},PeerConnectionManager.prototype._getOrCreate=function(id,configuration){var _this=this,self=this,peerConnection=this._peerConnections.get(id);if(!peerConnection){var PeerConnectionV2_1=this._PeerConnectionV2,options=Object.assign({dummyAudioMediaStreamTrack:this._dummyAudioTrackSender?this._dummyAudioTrackSender.track:null,offerOptions:this._offerOptions},this._sessionTimeout?{sessionTimeout:this._sessionTimeout}:{},configuration);try{peerConnection=new PeerConnectionV2_1(id,this._encodingParameters,this._preferredCodecs,options)}catch(e){throw new MediaConnectionError}this._peerConnections.set(peerConnection.id,peerConnection),peerConnection.on("candidates",this.queue.bind(this,"candidates")),peerConnection.on("description",this.queue.bind(this,"description")),peerConnection.on("trackAdded",this.queue.bind(this,"trackAdded")),peerConnection.on("stateChanged",(function stateChanged(state){"closed"===state&&(peerConnection.removeListener("stateChanged",stateChanged),self._dataTrackSenders.forEach((function(sender){return peerConnection.removeDataTrackSender(sender)})),self._mediaTrackSenders.forEach((function(sender){return peerConnection.removeMediaTrackSender(sender)})),self._peerConnections.delete(peerConnection.id),self._closedPeerConnectionIds.add(peerConnection.id),updateConnectionState(self),updateIceConnectionState(self))})),peerConnection.on("connectionStateChanged",(function(){return updateConnectionState(_this)})),peerConnection.on("iceConnectionStateChanged",(function(){return updateIceConnectionState(_this)})),this._dataTrackSenders.forEach(peerConnection.addDataTrackSender,peerConnection),this._mediaTrackSenders.forEach(peerConnection.addMediaTrackSender,peerConnection),updateIceConnectionState(this)}return peerConnection},PeerConnectionManager.prototype.close=function(){return this._peerConnections.forEach((function(peerConnection){peerConnection.close()})),this._dummyAudioTrackSender&&this._dummyAudioTrackSender.stop(),this._audioContextFactory&&this._audioContextFactory.release(this),updateIceConnectionState(this),this},PeerConnectionManager.prototype.createAndOffer=function(){var _this=this;return this._getConfiguration().then((function(configuration){var id;do{id=util.makeUUID()}while(_this._peerConnections.has(id));return _this._getOrCreate(id,configuration)})).then((function(peerConnection){return peerConnection.offer()})).then((function(){return _this}))},PeerConnectionManager.prototype.getTrackReceivers=function(){return util.flatMap(this._peerConnections,(function(peerConnection){return peerConnection.getTrackReceivers()}))},PeerConnectionManager.prototype.getStates=function(){var peerConnectionStates=[];return this._peerConnections.forEach((function(peerConnection){var peerConnectionState=peerConnection.getState();peerConnectionState&&peerConnectionStates.push(peerConnectionState)})),peerConnectionStates},PeerConnectionManager.prototype.setConfiguration=function(configuration){return this._configuration&&(this._configurationDeferred=util.defer(),this._peerConnections.forEach((function(peerConnection){peerConnection.setConfiguration(configuration)}))),this._configuration=configuration,this._configurationDeferred.resolve(configuration),this},PeerConnectionManager.prototype.setIceReconnectTimeout=function(period){return null===this._sessionTimeout&&(this._peerConnections.forEach((function(peerConnection){peerConnection.setIceReconnectTimeout(period)})),this._sessionTimeout=period),this},PeerConnectionManager.prototype.setTrackSenders=function(trackSenders){var dataTrackSenders=new Set(trackSenders.filter((function(trackSender){return"data"===trackSender.kind}))),mediaTrackSenders=new Set(trackSenders.filter((function(trackSender){return trackSender&&("audio"===trackSender.kind||"video"===trackSender.kind)}))),changes=function(peerConnectionManager,dataTrackSenders,mediaTrackSenders){return{data:getDataTrackSenderChanges(peerConnectionManager,dataTrackSenders),media:getMediaTrackSenderChanges(peerConnectionManager,mediaTrackSenders)}}(this,dataTrackSenders,mediaTrackSenders);return this._dataTrackSenders=dataTrackSenders,this._mediaTrackSenders=mediaTrackSenders,function(peerConnectionManager,changes){(changes.data.add.size||changes.data.remove.size||changes.media.add.size||changes.media.remove.size)&&peerConnectionManager._peerConnections.forEach((function(peerConnection){changes.data.remove.forEach(peerConnection.removeDataTrackSender,peerConnection),changes.media.remove.forEach(peerConnection.removeMediaTrackSender,peerConnection),changes.data.add.forEach(peerConnection.addDataTrackSender,peerConnection),changes.media.add.forEach(peerConnection.addMediaTrackSender,peerConnection),(changes.media.add.size||changes.media.remove.size||changes.data.add.size&&!peerConnection.isApplicationSectionNegotiated)&&peerConnection.offer()}))}(this,changes),this},PeerConnectionManager.prototype.update=function(peerConnectionStates,synced){var _this=this;return void 0===synced&&(synced=!1),synced&&this._closeAbsentPeerConnections(peerConnectionStates),this._getConfiguration().then((function(configuration){return Promise.all(peerConnectionStates.map((function(peerConnectionState){return _this._closedPeerConnectionIds.has(peerConnectionState.id)?null:_this._getOrCreate(peerConnectionState.id,configuration).update(peerConnectionState)})))})).then((function(){return _this}))},PeerConnectionManager.prototype.getStats=function(){var peerConnections=Array.from(this._peerConnections.values());return Promise.all(peerConnections.map((function(peerConnection){return peerConnection.getStats().then((function(response){return[peerConnection.id,response]}))}))).then((function(responses){return new Map(responses)}))},PeerConnectionManager}(QueueingEventEmitter);function createDummyAudioMediaStreamTrack(audioContext){return audioContext.createMediaStreamDestination().stream.getAudioTracks()[0]}function getDataTrackSenderChanges(peerConnectionManager,dataTrackSenders){return{add:util.difference(dataTrackSenders,peerConnectionManager._dataTrackSenders),remove:util.difference(peerConnectionManager._dataTrackSenders,dataTrackSenders)}}function getMediaTrackSenderChanges(peerConnectionManager,mediaTrackSenders){return{add:util.difference(mediaTrackSenders,peerConnectionManager._mediaTrackSenders),remove:util.difference(peerConnectionManager._mediaTrackSenders,mediaTrackSenders)}}var fromRank,toRank={new:0,checking:1,connecting:2,connected:3,completed:4,disconnected:-1,failed:-2,closed:-3};function summarizeIceOrPeerConnectionStates(states){return states.length?(fromRank=fromRank||Object.keys(toRank).reduce((function(fromRank,state){var _a;return Object.assign(fromRank,((_a={})[toRank[state]]=state,_a))}),{}),states.reduce((function(state1,state2){return fromRank[Math.max(toRank[state1],toRank[state2])]}))):"new"}function updateIceConnectionState(pcm){pcm._lastIceConnectionState=pcm.iceConnectionState,pcm._iceConnectionState=summarizeIceOrPeerConnectionStates(__spreadArray([],__read(pcm._peerConnections.values())).map((function(pcv2){return pcv2.iceConnectionState}))),pcm.iceConnectionState!==pcm._lastIceConnectionState&&pcm.emit("iceConnectionStateChanged")}function updateConnectionState(pcm){pcm._lastConnectionState=pcm.connectionState,pcm._connectionState=summarizeIceOrPeerConnectionStates(__spreadArray([],__read(pcm._peerConnections.values())).map((function(pcv2){return pcv2.connectionState}))),pcm.connectionState!==pcm._lastConnectionState&&pcm.emit("connectionStateChanged")}module.exports=PeerConnectionManager},"3Zq6":function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),MediaSignaling=__webpack_require__("zbom"),messageId=1,PublisherHintsSignaling=function(_super){function PublisherHintsSignaling(getReceiver,options){var _this=_super.call(this,getReceiver,"publisher_hints",options)||this;return _this.on("ready",(function(transport){_this._log.debug("publisher_hints transport ready:",transport),transport.on("message",(function(message){switch(_this._log.debug("Incoming: ",message),message.type){case"publisher_hints":message.publisher&&message.publisher.hints&&message.publisher.id&&_this._processPublisherHints(message.publisher.hints,message.publisher.id);break;default:_this._log.warn("Unknown message type: ",message.type)}}))})),_this}return __extends(PublisherHintsSignaling,_super),PublisherHintsSignaling.prototype.sendTrackReplaced=function(_a){if(this._transport){var payLoad={type:"client_reset",track:_a.trackSid,id:messageId++};this._log.debug("Outgoing: ",payLoad),this._transport.publish(payLoad)}},PublisherHintsSignaling.prototype.sendHintResponse=function(_a){if(this._transport){var payLoad={type:"publisher_hints",id:_a.id,hints:_a.hints};this._log.debug("Outgoing: ",payLoad),this._transport.publish(payLoad)}},PublisherHintsSignaling.prototype._processPublisherHints=function(hints,id){try{this.emit("updated",hints,id)}catch(ex){this._log.error("error processing hints:",ex)}},PublisherHintsSignaling}(MediaSignaling);module.exports=PublisherHintsSignaling},"3h4Y":function(module,exports,__webpack_require__){"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0});var createlocaltracks_1=__webpack_require__("Qvpb"),preflighttest_1=__webpack_require__("CQu1"),internals={connect:__webpack_require__("9/wP"),createLocalAudioTrack:__webpack_require__("M1q1").audio,createLocalVideoTrack:__webpack_require__("M1q1").video,isSupported:__webpack_require__("t472")(),version:__webpack_require__("iqXr").version,Logger:__webpack_require__("cmf6"),LocalAudioTrack:__webpack_require__("VR5W").LocalAudioTrack,LocalDataTrack:__webpack_require__("VR5W").LocalDataTrack,LocalVideoTrack:__webpack_require__("VR5W").LocalVideoTrack};module.exports={connect:function(token,options){var internalOptions=__assign({createLocalTracks:createlocaltracks_1.createLocalTracks},options);return internals.connect(token,internalOptions)},createLocalAudioTrack:function(options){var internalOptions=__assign({createLocalTracks:createlocaltracks_1.createLocalTracks},options);return internals.createLocalAudioTrack(internalOptions)},createLocalVideoTrack:function(options){var internalOptions=__assign({createLocalTracks:createlocaltracks_1.createLocalTracks},options);return internals.createLocalVideoTrack(internalOptions)},createLocalTracks:createlocaltracks_1.createLocalTracks,runPreflight:preflighttest_1.runPreflight,isSupported:internals.isSupported,version:internals.version,Logger:internals.Logger,LocalAudioTrack:internals.LocalAudioTrack,LocalVideoTrack:internals.LocalVideoTrack,LocalDataTrack:internals.LocalDataTrack}},"3oWx":function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),LocalParticipantSignaling=function(_super){function LocalParticipantSignaling(){var _this=_super.call(this)||this;return Object.defineProperties(_this,{_publicationsToTrackSenders:{value:new Map},_trackSendersToPublications:{value:new Map}}),_this}return __extends(LocalParticipantSignaling,_super),LocalParticipantSignaling.prototype.addTrack=function(trackSender,name,priority){var publication=this._createLocalTrackPublicationSignaling(trackSender,name,priority);return this._trackSendersToPublications.set(trackSender,publication),this._publicationsToTrackSenders.set(publication,trackSender),_super.prototype.addTrack.call(this,publication),this},LocalParticipantSignaling.prototype.getPublication=function(trackSender){return this._trackSendersToPublications.get(trackSender)||null},LocalParticipantSignaling.prototype.getSender=function(trackPublication){return this._publicationsToTrackSenders.get(trackPublication)||null},LocalParticipantSignaling.prototype.removeTrack=function(trackSender){var publication=this._trackSendersToPublications.get(trackSender);return publication?(this._trackSendersToPublications.delete(trackSender),this._publicationsToTrackSenders.delete(publication),_super.prototype.removeTrack.call(this,publication)&&publication.stop(),publication):null},LocalParticipantSignaling}(__webpack_require__("EYe3"));module.exports=LocalParticipantSignaling},"3sVZ":function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),RemoteParticipantSignaling=__webpack_require__("HsAx"),RemoteTrackPublicationV2=__webpack_require__("xVU0"),RemoteParticipantV2=function(_super){function RemoteParticipantV2(participantState,getInitialTrackSwitchOffState,setPriority,setRenderHint,clearTrackHint,options){var _this=_super.call(this,participantState.sid,participantState.identity)||this;return options=Object.assign({RemoteTrackPublicationV2:RemoteTrackPublicationV2},options),Object.defineProperties(_this,{_revision:{writable:!0,value:null},_RemoteTrackPublicationV2:{value:options.RemoteTrackPublicationV2},_getInitialTrackSwitchOffState:{value:getInitialTrackSwitchOffState},updateSubscriberTrackPriority:{value:function(trackSid,priority){return setPriority(trackSid,priority)}},updateTrackRenderHint:{value:function(trackSid,renderHint){return setRenderHint(trackSid,renderHint)}},clearTrackHint:{value:function(trackSid){return clearTrackHint(trackSid)}},revision:{enumerable:!0,get:function(){return this._revision}}}),_this.update(participantState)}return __extends(RemoteParticipantV2,_super),RemoteParticipantV2.prototype._getOrCreateTrack=function(trackState){var RemoteTrackPublicationV2=this._RemoteTrackPublicationV2,track=this.tracks.get(trackState.sid);return track||(track=new RemoteTrackPublicationV2(trackState,this._getInitialTrackSwitchOffState(trackState.sid)),this.addTrack(track)),track},RemoteParticipantV2.prototype.update=function(participantState){var _this=this;if(null!==this.revision&&participantState.revision<=this.revision)return this;this._revision=participantState.revision;var tracksToKeep=new Set;switch(participantState.tracks.forEach((function(trackState){var track=_this._getOrCreateTrack(trackState);track.update(trackState),tracksToKeep.add(track)})),this.tracks.forEach((function(track){tracksToKeep.has(track)||_this.removeTrack(track)})),participantState.state){case"disconnected":this.disconnect();break;case"reconnecting":this.reconnecting();break;case"connected":this.connect(this.sid,this.identity)}return this},RemoteParticipantV2}(RemoteParticipantSignaling);module.exports=RemoteParticipantV2},"45zb":function(module,exports,__webpack_require__){"use strict";var hasToStringTag=__webpack_require__("B6Q+")(),$toString=__webpack_require__("VF6F")("Object.prototype.toString"),isStandardArguments=function(value){return!(hasToStringTag&&value&&"object"==typeof value&&Symbol.toStringTag in value)&&"[object Arguments]"===$toString(value)},isLegacyArguments=function(value){return!!isStandardArguments(value)||null!==value&&"object"==typeof value&&"number"==typeof value.length&&value.length>=0&&"[object Array]"!==$toString(value)&&"[object Function]"===$toString(value.callee)},supportsStandardArguments=function(){return isStandardArguments(arguments)}();isStandardArguments.isLegacyArguments=isLegacyArguments,module.exports=supportsStandardArguments?isStandardArguments:isLegacyArguments},"4N67":function(module,exports,__webpack_require__){"use strict";if("function"==typeof RTCSessionDescription)switch((0,__webpack_require__("mIkg").guessBrowser)()){case"chrome":module.exports=__webpack_require__("+TTF");break;case"firefox":module.exports=__webpack_require__("ro1H");break;default:module.exports=RTCSessionDescription}else module.exports=function(){throw new Error("RTCSessionDescription is not supported")}},"4o7n":function(module,exports,__webpack_require__){"use strict";module.exports=function(xs){return(xs=xs.filter((function(x){return"number"==typeof x}))).length<1?void 0:xs.reduce((function(y,x){return x+y}))/xs.length}},"52Yu":function(module,exports,__webpack_require__){"use strict";module.exports="function"==typeof RTCIceCandidate?RTCIceCandidate:function(){throw new Error("RTCIceCandidate is not supported")}},"5UJR":function(module,exports,__webpack_require__){"use strict";var NetworkQualityBandwidthStats=__webpack_require__("NSCw"),NetworkQualityFractionLostStats=__webpack_require__("2mUf"),NetworkQualityLatencyStats=__webpack_require__("q6IO");module.exports=function(_a){var _b=_a.bandwidth,bandwidth=void 0===_b?null:_b,_c=_a.fractionLost,fractionLost=void 0===_c?null:_c,_d=_a.latency,latency=void 0===_d?null:_d;Object.defineProperties(this,{bandwidth:{value:bandwidth?new NetworkQualityBandwidthStats(bandwidth):null,enumerable:!0},fractionLost:{value:fractionLost?new NetworkQualityFractionLostStats(fractionLost):null,enumerable:!0},latency:{value:latency?new NetworkQualityLatencyStats(latency):null,enumerable:!0}})}},"5wwa":function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),TwilioError=__webpack_require__("SAu+"),TwilioErrorByCode={};exports.createTwilioError=function(code,message){return message="string"==typeof message&&message?message:"Unknown error",TwilioErrorByCode[code="number"==typeof code?code:0]?new TwilioErrorByCode[code]:new TwilioError(code,message)};var AccessTokenInvalidError=function(_super){function AccessTokenInvalidError(){var _this=_super.call(this,20101,"Invalid Access Token")||this;return Object.setPrototypeOf(_this,AccessTokenInvalidError.prototype),_this}return __extends(AccessTokenInvalidError,_super),AccessTokenInvalidError}(TwilioError);exports.AccessTokenInvalidError=AccessTokenInvalidError,Object.defineProperty(TwilioErrorByCode,20101,{value:AccessTokenInvalidError});var AccessTokenHeaderInvalidError=function(_super){function AccessTokenHeaderInvalidError(){var _this=_super.call(this,20102,"Invalid Access Token header")||this;return Object.setPrototypeOf(_this,AccessTokenHeaderInvalidError.prototype),_this}return __extends(AccessTokenHeaderInvalidError,_super),AccessTokenHeaderInvalidError}(TwilioError);exports.AccessTokenHeaderInvalidError=AccessTokenHeaderInvalidError,Object.defineProperty(TwilioErrorByCode,20102,{value:AccessTokenHeaderInvalidError});var AccessTokenIssuerInvalidError=function(_super){function AccessTokenIssuerInvalidError(){var _this=_super.call(this,20103,"Invalid Access Token issuer/subject")||this;return Object.setPrototypeOf(_this,AccessTokenIssuerInvalidError.prototype),_this}return __extends(AccessTokenIssuerInvalidError,_super),AccessTokenIssuerInvalidError}(TwilioError);exports.AccessTokenIssuerInvalidError=AccessTokenIssuerInvalidError,Object.defineProperty(TwilioErrorByCode,20103,{value:AccessTokenIssuerInvalidError});var AccessTokenExpiredError=function(_super){function AccessTokenExpiredError(){var _this=_super.call(this,20104,"Access Token expired or expiration date invalid")||this;return Object.setPrototypeOf(_this,AccessTokenExpiredError.prototype),_this}return __extends(AccessTokenExpiredError,_super),AccessTokenExpiredError}(TwilioError);exports.AccessTokenExpiredError=AccessTokenExpiredError,Object.defineProperty(TwilioErrorByCode,20104,{value:AccessTokenExpiredError});var AccessTokenNotYetValidError=function(_super){function AccessTokenNotYetValidError(){var _this=_super.call(this,20105,"Access Token not yet valid")||this;return Object.setPrototypeOf(_this,AccessTokenNotYetValidError.prototype),_this}return __extends(AccessTokenNotYetValidError,_super),AccessTokenNotYetValidError}(TwilioError);exports.AccessTokenNotYetValidError=AccessTokenNotYetValidError,Object.defineProperty(TwilioErrorByCode,20105,{value:AccessTokenNotYetValidError});var AccessTokenGrantsInvalidError=function(_super){function AccessTokenGrantsInvalidError(){var _this=_super.call(this,20106,"Invalid Access Token grants")||this;return Object.setPrototypeOf(_this,AccessTokenGrantsInvalidError.prototype),_this}return __extends(AccessTokenGrantsInvalidError,_super),AccessTokenGrantsInvalidError}(TwilioError);exports.AccessTokenGrantsInvalidError=AccessTokenGrantsInvalidError,Object.defineProperty(TwilioErrorByCode,20106,{value:AccessTokenGrantsInvalidError});var AccessTokenSignatureInvalidError=function(_super){function AccessTokenSignatureInvalidError(){var _this=_super.call(this,20107,"Invalid Access Token signature")||this;return Object.setPrototypeOf(_this,AccessTokenSignatureInvalidError.prototype),_this}return __extends(AccessTokenSignatureInvalidError,_super),AccessTokenSignatureInvalidError}(TwilioError);exports.AccessTokenSignatureInvalidError=AccessTokenSignatureInvalidError,Object.defineProperty(TwilioErrorByCode,20107,{value:AccessTokenSignatureInvalidError});var SignalingConnectionError=function(_super){function SignalingConnectionError(){var _this=_super.call(this,53e3,"Signaling connection error")||this;return Object.setPrototypeOf(_this,SignalingConnectionError.prototype),_this}return __extends(SignalingConnectionError,_super),SignalingConnectionError}(TwilioError);exports.SignalingConnectionError=SignalingConnectionError,Object.defineProperty(TwilioErrorByCode,53e3,{value:SignalingConnectionError});var SignalingConnectionDisconnectedError=function(_super){function SignalingConnectionDisconnectedError(){var _this=_super.call(this,53001,"Signaling connection disconnected")||this;return Object.setPrototypeOf(_this,SignalingConnectionDisconnectedError.prototype),_this}return __extends(SignalingConnectionDisconnectedError,_super),SignalingConnectionDisconnectedError}(TwilioError);exports.SignalingConnectionDisconnectedError=SignalingConnectionDisconnectedError,Object.defineProperty(TwilioErrorByCode,53001,{value:SignalingConnectionDisconnectedError});var SignalingConnectionTimeoutError=function(_super){function SignalingConnectionTimeoutError(){var _this=_super.call(this,53002,"Signaling connection timed out")||this;return Object.setPrototypeOf(_this,SignalingConnectionTimeoutError.prototype),_this}return __extends(SignalingConnectionTimeoutError,_super),SignalingConnectionTimeoutError}(TwilioError);exports.SignalingConnectionTimeoutError=SignalingConnectionTimeoutError,Object.defineProperty(TwilioErrorByCode,53002,{value:SignalingConnectionTimeoutError});var SignalingIncomingMessageInvalidError=function(_super){function SignalingIncomingMessageInvalidError(){var _this=_super.call(this,53003,"Client received an invalid signaling message")||this;return Object.setPrototypeOf(_this,SignalingIncomingMessageInvalidError.prototype),_this}return __extends(SignalingIncomingMessageInvalidError,_super),SignalingIncomingMessageInvalidError}(TwilioError);exports.SignalingIncomingMessageInvalidError=SignalingIncomingMessageInvalidError,Object.defineProperty(TwilioErrorByCode,53003,{value:SignalingIncomingMessageInvalidError});var SignalingOutgoingMessageInvalidError=function(_super){function SignalingOutgoingMessageInvalidError(){var _this=_super.call(this,53004,"Client sent an invalid signaling message")||this;return Object.setPrototypeOf(_this,SignalingOutgoingMessageInvalidError.prototype),_this}return __extends(SignalingOutgoingMessageInvalidError,_super),SignalingOutgoingMessageInvalidError}(TwilioError);exports.SignalingOutgoingMessageInvalidError=SignalingOutgoingMessageInvalidError,Object.defineProperty(TwilioErrorByCode,53004,{value:SignalingOutgoingMessageInvalidError});var SignalingServerBusyError=function(_super){function SignalingServerBusyError(){var _this=_super.call(this,53006,"Video server is busy")||this;return Object.setPrototypeOf(_this,SignalingServerBusyError.prototype),_this}return __extends(SignalingServerBusyError,_super),SignalingServerBusyError}(TwilioError);exports.SignalingServerBusyError=SignalingServerBusyError,Object.defineProperty(TwilioErrorByCode,53006,{value:SignalingServerBusyError});var RoomNameInvalidError=function(_super){function RoomNameInvalidError(){var _this=_super.call(this,53100,"Room name is invalid")||this;return Object.setPrototypeOf(_this,RoomNameInvalidError.prototype),_this}return __extends(RoomNameInvalidError,_super),RoomNameInvalidError}(TwilioError);exports.RoomNameInvalidError=RoomNameInvalidError,Object.defineProperty(TwilioErrorByCode,53100,{value:RoomNameInvalidError});var RoomNameTooLongError=function(_super){function RoomNameTooLongError(){var _this=_super.call(this,53101,"Room name is too long")||this;return Object.setPrototypeOf(_this,RoomNameTooLongError.prototype),_this}return __extends(RoomNameTooLongError,_super),RoomNameTooLongError}(TwilioError);exports.RoomNameTooLongError=RoomNameTooLongError,Object.defineProperty(TwilioErrorByCode,53101,{value:RoomNameTooLongError});var RoomNameCharsInvalidError=function(_super){function RoomNameCharsInvalidError(){var _this=_super.call(this,53102,"Room name contains invalid characters")||this;return Object.setPrototypeOf(_this,RoomNameCharsInvalidError.prototype),_this}return __extends(RoomNameCharsInvalidError,_super),RoomNameCharsInvalidError}(TwilioError);exports.RoomNameCharsInvalidError=RoomNameCharsInvalidError,Object.defineProperty(TwilioErrorByCode,53102,{value:RoomNameCharsInvalidError});var RoomCreateFailedError=function(_super){function RoomCreateFailedError(){var _this=_super.call(this,53103,"Unable to create Room")||this;return Object.setPrototypeOf(_this,RoomCreateFailedError.prototype),_this}return __extends(RoomCreateFailedError,_super),RoomCreateFailedError}(TwilioError);exports.RoomCreateFailedError=RoomCreateFailedError,Object.defineProperty(TwilioErrorByCode,53103,{value:RoomCreateFailedError});var RoomConnectFailedError=function(_super){function RoomConnectFailedError(){var _this=_super.call(this,53104,"Unable to connect to Room")||this;return Object.setPrototypeOf(_this,RoomConnectFailedError.prototype),_this}return __extends(RoomConnectFailedError,_super),RoomConnectFailedError}(TwilioError);exports.RoomConnectFailedError=RoomConnectFailedError,Object.defineProperty(TwilioErrorByCode,53104,{value:RoomConnectFailedError});var RoomMaxParticipantsExceededError=function(_super){function RoomMaxParticipantsExceededError(){var _this=_super.call(this,53105,"Room contains too many Participants")||this;return Object.setPrototypeOf(_this,RoomMaxParticipantsExceededError.prototype),_this}return __extends(RoomMaxParticipantsExceededError,_super),RoomMaxParticipantsExceededError}(TwilioError);exports.RoomMaxParticipantsExceededError=RoomMaxParticipantsExceededError,Object.defineProperty(TwilioErrorByCode,53105,{value:RoomMaxParticipantsExceededError});var RoomNotFoundError=function(_super){function RoomNotFoundError(){var _this=_super.call(this,53106,"Room not found")||this;return Object.setPrototypeOf(_this,RoomNotFoundError.prototype),_this}return __extends(RoomNotFoundError,_super),RoomNotFoundError}(TwilioError);exports.RoomNotFoundError=RoomNotFoundError,Object.defineProperty(TwilioErrorByCode,53106,{value:RoomNotFoundError});var RoomMaxParticipantsOutOfRangeError=function(_super){function RoomMaxParticipantsOutOfRangeError(){var _this=_super.call(this,53107,"MaxParticipants is out of range")||this;return Object.setPrototypeOf(_this,RoomMaxParticipantsOutOfRangeError.prototype),_this}return __extends(RoomMaxParticipantsOutOfRangeError,_super),RoomMaxParticipantsOutOfRangeError}(TwilioError);exports.RoomMaxParticipantsOutOfRangeError=RoomMaxParticipantsOutOfRangeError,Object.defineProperty(TwilioErrorByCode,53107,{value:RoomMaxParticipantsOutOfRangeError});var RoomTypeInvalidError=function(_super){function RoomTypeInvalidError(){var _this=_super.call(this,53108,"RoomType is not valid")||this;return Object.setPrototypeOf(_this,RoomTypeInvalidError.prototype),_this}return __extends(RoomTypeInvalidError,_super),RoomTypeInvalidError}(TwilioError);exports.RoomTypeInvalidError=RoomTypeInvalidError,Object.defineProperty(TwilioErrorByCode,53108,{value:RoomTypeInvalidError});var RoomTimeoutOutOfRangeError=function(_super){function RoomTimeoutOutOfRangeError(){var _this=_super.call(this,53109,"Timeout is out of range")||this;return Object.setPrototypeOf(_this,RoomTimeoutOutOfRangeError.prototype),_this}return __extends(RoomTimeoutOutOfRangeError,_super),RoomTimeoutOutOfRangeError}(TwilioError);exports.RoomTimeoutOutOfRangeError=RoomTimeoutOutOfRangeError,Object.defineProperty(TwilioErrorByCode,53109,{value:RoomTimeoutOutOfRangeError});var RoomStatusCallbackMethodInvalidError=function(_super){function RoomStatusCallbackMethodInvalidError(){var _this=_super.call(this,53110,"StatusCallbackMethod is invalid")||this;return Object.setPrototypeOf(_this,RoomStatusCallbackMethodInvalidError.prototype),_this}return __extends(RoomStatusCallbackMethodInvalidError,_super),RoomStatusCallbackMethodInvalidError}(TwilioError);exports.RoomStatusCallbackMethodInvalidError=RoomStatusCallbackMethodInvalidError,Object.defineProperty(TwilioErrorByCode,53110,{value:RoomStatusCallbackMethodInvalidError});var RoomStatusCallbackInvalidError=function(_super){function RoomStatusCallbackInvalidError(){var _this=_super.call(this,53111,"StatusCallback is invalid")||this;return Object.setPrototypeOf(_this,RoomStatusCallbackInvalidError.prototype),_this}return __extends(RoomStatusCallbackInvalidError,_super),RoomStatusCallbackInvalidError}(TwilioError);exports.RoomStatusCallbackInvalidError=RoomStatusCallbackInvalidError,Object.defineProperty(TwilioErrorByCode,53111,{value:RoomStatusCallbackInvalidError});var RoomStatusInvalidError=function(_super){function RoomStatusInvalidError(){var _this=_super.call(this,53112,"Status is invalid")||this;return Object.setPrototypeOf(_this,RoomStatusInvalidError.prototype),_this}return __extends(RoomStatusInvalidError,_super),RoomStatusInvalidError}(TwilioError);exports.RoomStatusInvalidError=RoomStatusInvalidError,Object.defineProperty(TwilioErrorByCode,53112,{value:RoomStatusInvalidError});var RoomRoomExistsError=function(_super){function RoomRoomExistsError(){var _this=_super.call(this,53113,"Room exists")||this;return Object.setPrototypeOf(_this,RoomRoomExistsError.prototype),_this}return __extends(RoomRoomExistsError,_super),RoomRoomExistsError}(TwilioError);exports.RoomRoomExistsError=RoomRoomExistsError,Object.defineProperty(TwilioErrorByCode,53113,{value:RoomRoomExistsError});var RoomInvalidParametersError=function(_super){function RoomInvalidParametersError(){var _this=_super.call(this,53114,"Room creation parameter(s) incompatible with the Room type")||this;return Object.setPrototypeOf(_this,RoomInvalidParametersError.prototype),_this}return __extends(RoomInvalidParametersError,_super),RoomInvalidParametersError}(TwilioError);exports.RoomInvalidParametersError=RoomInvalidParametersError,Object.defineProperty(TwilioErrorByCode,53114,{value:RoomInvalidParametersError});var RoomMediaRegionInvalidError=function(_super){function RoomMediaRegionInvalidError(){var _this=_super.call(this,53115,"MediaRegion is invalid")||this;return Object.setPrototypeOf(_this,RoomMediaRegionInvalidError.prototype),_this}return __extends(RoomMediaRegionInvalidError,_super),RoomMediaRegionInvalidError}(TwilioError);exports.RoomMediaRegionInvalidError=RoomMediaRegionInvalidError,Object.defineProperty(TwilioErrorByCode,53115,{value:RoomMediaRegionInvalidError});var RoomMediaRegionUnavailableError=function(_super){function RoomMediaRegionUnavailableError(){var _this=_super.call(this,53116,"There are no media servers available in the MediaRegion")||this;return Object.setPrototypeOf(_this,RoomMediaRegionUnavailableError.prototype),_this}return __extends(RoomMediaRegionUnavailableError,_super),RoomMediaRegionUnavailableError}(TwilioError);exports.RoomMediaRegionUnavailableError=RoomMediaRegionUnavailableError,Object.defineProperty(TwilioErrorByCode,53116,{value:RoomMediaRegionUnavailableError});var RoomSubscriptionOperationNotSupportedError=function(_super){function RoomSubscriptionOperationNotSupportedError(){var _this=_super.call(this,53117,"The subscription operation requested is not supported for the Room type")||this;return Object.setPrototypeOf(_this,RoomSubscriptionOperationNotSupportedError.prototype),_this}return __extends(RoomSubscriptionOperationNotSupportedError,_super),RoomSubscriptionOperationNotSupportedError}(TwilioError);exports.RoomSubscriptionOperationNotSupportedError=RoomSubscriptionOperationNotSupportedError,Object.defineProperty(TwilioErrorByCode,53117,{value:RoomSubscriptionOperationNotSupportedError});var RoomCompletedError=function(_super){function RoomCompletedError(){var _this=_super.call(this,53118,"Room completed")||this;return Object.setPrototypeOf(_this,RoomCompletedError.prototype),_this}return __extends(RoomCompletedError,_super),RoomCompletedError}(TwilioError);exports.RoomCompletedError=RoomCompletedError,Object.defineProperty(TwilioErrorByCode,53118,{value:RoomCompletedError});var RoomAudioOnlyFlagNotSupportedError=function(_super){function RoomAudioOnlyFlagNotSupportedError(){var _this=_super.call(this,53124,"The AudioOnly flag is not supported for the Room type")||this;return Object.setPrototypeOf(_this,RoomAudioOnlyFlagNotSupportedError.prototype),_this}return __extends(RoomAudioOnlyFlagNotSupportedError,_super),RoomAudioOnlyFlagNotSupportedError}(TwilioError);exports.RoomAudioOnlyFlagNotSupportedError=RoomAudioOnlyFlagNotSupportedError,Object.defineProperty(TwilioErrorByCode,53124,{value:RoomAudioOnlyFlagNotSupportedError});var RoomTrackKindNotSupportedError=function(_super){function RoomTrackKindNotSupportedError(){var _this=_super.call(this,53125,"The track kind is not supported by the Room")||this;return Object.setPrototypeOf(_this,RoomTrackKindNotSupportedError.prototype),_this}return __extends(RoomTrackKindNotSupportedError,_super),RoomTrackKindNotSupportedError}(TwilioError);exports.RoomTrackKindNotSupportedError=RoomTrackKindNotSupportedError,Object.defineProperty(TwilioErrorByCode,53125,{value:RoomTrackKindNotSupportedError});var ParticipantIdentityInvalidError=function(_super){function ParticipantIdentityInvalidError(){var _this=_super.call(this,53200,"Participant identity is invalid")||this;return Object.setPrototypeOf(_this,ParticipantIdentityInvalidError.prototype),_this}return __extends(ParticipantIdentityInvalidError,_super),ParticipantIdentityInvalidError}(TwilioError);exports.ParticipantIdentityInvalidError=ParticipantIdentityInvalidError,Object.defineProperty(TwilioErrorByCode,53200,{value:ParticipantIdentityInvalidError});var ParticipantIdentityTooLongError=function(_super){function ParticipantIdentityTooLongError(){var _this=_super.call(this,53201,"Participant identity is too long")||this;return Object.setPrototypeOf(_this,ParticipantIdentityTooLongError.prototype),_this}return __extends(ParticipantIdentityTooLongError,_super),ParticipantIdentityTooLongError}(TwilioError);exports.ParticipantIdentityTooLongError=ParticipantIdentityTooLongError,Object.defineProperty(TwilioErrorByCode,53201,{value:ParticipantIdentityTooLongError});var ParticipantIdentityCharsInvalidError=function(_super){function ParticipantIdentityCharsInvalidError(){var _this=_super.call(this,53202,"Participant identity contains invalid characters")||this;return Object.setPrototypeOf(_this,ParticipantIdentityCharsInvalidError.prototype),_this}return __extends(ParticipantIdentityCharsInvalidError,_super),ParticipantIdentityCharsInvalidError}(TwilioError);exports.ParticipantIdentityCharsInvalidError=ParticipantIdentityCharsInvalidError,Object.defineProperty(TwilioErrorByCode,53202,{value:ParticipantIdentityCharsInvalidError});var ParticipantMaxTracksExceededError=function(_super){function ParticipantMaxTracksExceededError(){var _this=_super.call(this,53203,"The maximum number of published tracks allowed in the Room at the same time has been reached")||this;return Object.setPrototypeOf(_this,ParticipantMaxTracksExceededError.prototype),_this}return __extends(ParticipantMaxTracksExceededError,_super),ParticipantMaxTracksExceededError}(TwilioError);exports.ParticipantMaxTracksExceededError=ParticipantMaxTracksExceededError,Object.defineProperty(TwilioErrorByCode,53203,{value:ParticipantMaxTracksExceededError});var ParticipantNotFoundError=function(_super){function ParticipantNotFoundError(){var _this=_super.call(this,53204,"Participant not found")||this;return Object.setPrototypeOf(_this,ParticipantNotFoundError.prototype),_this}return __extends(ParticipantNotFoundError,_super),ParticipantNotFoundError}(TwilioError);exports.ParticipantNotFoundError=ParticipantNotFoundError,Object.defineProperty(TwilioErrorByCode,53204,{value:ParticipantNotFoundError});var ParticipantDuplicateIdentityError=function(_super){function ParticipantDuplicateIdentityError(){var _this=_super.call(this,53205,"Participant disconnected because of duplicate identity")||this;return Object.setPrototypeOf(_this,ParticipantDuplicateIdentityError.prototype),_this}return __extends(ParticipantDuplicateIdentityError,_super),ParticipantDuplicateIdentityError}(TwilioError);exports.ParticipantDuplicateIdentityError=ParticipantDuplicateIdentityError,Object.defineProperty(TwilioErrorByCode,53205,{value:ParticipantDuplicateIdentityError});var TrackInvalidError=function(_super){function TrackInvalidError(){var _this=_super.call(this,53300,"Track is invalid")||this;return Object.setPrototypeOf(_this,TrackInvalidError.prototype),_this}return __extends(TrackInvalidError,_super),TrackInvalidError}(TwilioError);exports.TrackInvalidError=TrackInvalidError,Object.defineProperty(TwilioErrorByCode,53300,{value:TrackInvalidError});var TrackNameInvalidError=function(_super){function TrackNameInvalidError(){var _this=_super.call(this,53301,"Track name is invalid")||this;return Object.setPrototypeOf(_this,TrackNameInvalidError.prototype),_this}return __extends(TrackNameInvalidError,_super),TrackNameInvalidError}(TwilioError);exports.TrackNameInvalidError=TrackNameInvalidError,Object.defineProperty(TwilioErrorByCode,53301,{value:TrackNameInvalidError});var TrackNameTooLongError=function(_super){function TrackNameTooLongError(){var _this=_super.call(this,53302,"Track name is too long")||this;return Object.setPrototypeOf(_this,TrackNameTooLongError.prototype),_this}return __extends(TrackNameTooLongError,_super),TrackNameTooLongError}(TwilioError);exports.TrackNameTooLongError=TrackNameTooLongError,Object.defineProperty(TwilioErrorByCode,53302,{value:TrackNameTooLongError});var TrackNameCharsInvalidError=function(_super){function TrackNameCharsInvalidError(){var _this=_super.call(this,53303,"Track name contains invalid characters")||this;return Object.setPrototypeOf(_this,TrackNameCharsInvalidError.prototype),_this}return __extends(TrackNameCharsInvalidError,_super),TrackNameCharsInvalidError}(TwilioError);exports.TrackNameCharsInvalidError=TrackNameCharsInvalidError,Object.defineProperty(TwilioErrorByCode,53303,{value:TrackNameCharsInvalidError});var TrackNameIsDuplicatedError=function(_super){function TrackNameIsDuplicatedError(){var _this=_super.call(this,53304,"Track name is duplicated")||this;return Object.setPrototypeOf(_this,TrackNameIsDuplicatedError.prototype),_this}return __extends(TrackNameIsDuplicatedError,_super),TrackNameIsDuplicatedError}(TwilioError);exports.TrackNameIsDuplicatedError=TrackNameIsDuplicatedError,Object.defineProperty(TwilioErrorByCode,53304,{value:TrackNameIsDuplicatedError});var TrackServerTrackCapacityReachedError=function(_super){function TrackServerTrackCapacityReachedError(){var _this=_super.call(this,53305,"The server has reached capacity and cannot fulfill this request")||this;return Object.setPrototypeOf(_this,TrackServerTrackCapacityReachedError.prototype),_this}return __extends(TrackServerTrackCapacityReachedError,_super),TrackServerTrackCapacityReachedError}(TwilioError);exports.TrackServerTrackCapacityReachedError=TrackServerTrackCapacityReachedError,Object.defineProperty(TwilioErrorByCode,53305,{value:TrackServerTrackCapacityReachedError});var MediaClientLocalDescFailedError=function(_super){function MediaClientLocalDescFailedError(){var _this=_super.call(this,53400,"Client is unable to create or apply a local media description")||this;return Object.setPrototypeOf(_this,MediaClientLocalDescFailedError.prototype),_this}return __extends(MediaClientLocalDescFailedError,_super),MediaClientLocalDescFailedError}(TwilioError);exports.MediaClientLocalDescFailedError=MediaClientLocalDescFailedError,Object.defineProperty(TwilioErrorByCode,53400,{value:MediaClientLocalDescFailedError});var MediaServerLocalDescFailedError=function(_super){function MediaServerLocalDescFailedError(){var _this=_super.call(this,53401,"Server is unable to create or apply a local media description")||this;return Object.setPrototypeOf(_this,MediaServerLocalDescFailedError.prototype),_this}return __extends(MediaServerLocalDescFailedError,_super),MediaServerLocalDescFailedError}(TwilioError);exports.MediaServerLocalDescFailedError=MediaServerLocalDescFailedError,Object.defineProperty(TwilioErrorByCode,53401,{value:MediaServerLocalDescFailedError});var MediaClientRemoteDescFailedError=function(_super){function MediaClientRemoteDescFailedError(){var _this=_super.call(this,53402,"Client is unable to apply a remote media description")||this;return Object.setPrototypeOf(_this,MediaClientRemoteDescFailedError.prototype),_this}return __extends(MediaClientRemoteDescFailedError,_super),MediaClientRemoteDescFailedError}(TwilioError);exports.MediaClientRemoteDescFailedError=MediaClientRemoteDescFailedError,Object.defineProperty(TwilioErrorByCode,53402,{value:MediaClientRemoteDescFailedError});var MediaServerRemoteDescFailedError=function(_super){function MediaServerRemoteDescFailedError(){var _this=_super.call(this,53403,"Server is unable to apply a remote media description")||this;return Object.setPrototypeOf(_this,MediaServerRemoteDescFailedError.prototype),_this}return __extends(MediaServerRemoteDescFailedError,_super),MediaServerRemoteDescFailedError}(TwilioError);exports.MediaServerRemoteDescFailedError=MediaServerRemoteDescFailedError,Object.defineProperty(TwilioErrorByCode,53403,{value:MediaServerRemoteDescFailedError});var MediaNoSupportedCodecError=function(_super){function MediaNoSupportedCodecError(){var _this=_super.call(this,53404,"No supported codec")||this;return Object.setPrototypeOf(_this,MediaNoSupportedCodecError.prototype),_this}return __extends(MediaNoSupportedCodecError,_super),MediaNoSupportedCodecError}(TwilioError);exports.MediaNoSupportedCodecError=MediaNoSupportedCodecError,Object.defineProperty(TwilioErrorByCode,53404,{value:MediaNoSupportedCodecError});var MediaConnectionError=function(_super){function MediaConnectionError(){var _this=_super.call(this,53405,"Media connection failed or Media activity ceased")||this;return Object.setPrototypeOf(_this,MediaConnectionError.prototype),_this}return __extends(MediaConnectionError,_super),MediaConnectionError}(TwilioError);exports.MediaConnectionError=MediaConnectionError,Object.defineProperty(TwilioErrorByCode,53405,{value:MediaConnectionError});var MediaDTLSTransportFailedError=function(_super){function MediaDTLSTransportFailedError(){var _this=_super.call(this,53407,"Media connection failed due to DTLS handshake failure")||this;return Object.setPrototypeOf(_this,MediaDTLSTransportFailedError.prototype),_this}return __extends(MediaDTLSTransportFailedError,_super),MediaDTLSTransportFailedError}(TwilioError);exports.MediaDTLSTransportFailedError=MediaDTLSTransportFailedError,Object.defineProperty(TwilioErrorByCode,53407,{value:MediaDTLSTransportFailedError});var ConfigurationAcquireFailedError=function(_super){function ConfigurationAcquireFailedError(){var _this=_super.call(this,53500,"Unable to acquire configuration")||this;return Object.setPrototypeOf(_this,ConfigurationAcquireFailedError.prototype),_this}return __extends(ConfigurationAcquireFailedError,_super),ConfigurationAcquireFailedError}(TwilioError);exports.ConfigurationAcquireFailedError=ConfigurationAcquireFailedError,Object.defineProperty(TwilioErrorByCode,53500,{value:ConfigurationAcquireFailedError});var ConfigurationAcquireTurnFailedError=function(_super){function ConfigurationAcquireTurnFailedError(){var _this=_super.call(this,53501,"Unable to acquire TURN credentials")||this;return Object.setPrototypeOf(_this,ConfigurationAcquireTurnFailedError.prototype),_this}return __extends(ConfigurationAcquireTurnFailedError,_super),ConfigurationAcquireTurnFailedError}(TwilioError);exports.ConfigurationAcquireTurnFailedError=ConfigurationAcquireTurnFailedError,Object.defineProperty(TwilioErrorByCode,53501,{value:ConfigurationAcquireTurnFailedError})},"6frX":function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),AudioTrack=__webpack_require__("wxsB"),RemoteAudioTrack=function(_super){function RemoteAudioTrack(sid,mediaTrackReceiver,isEnabled,isSwitchedOff,setPriority,setRenderHint,options){return _super.call(this,sid,mediaTrackReceiver,isEnabled,isSwitchedOff,setPriority,setRenderHint,options)||this}return __extends(RemoteAudioTrack,_super),RemoteAudioTrack.prototype.toString=function(){return"[RemoteAudioTrack #"+this._instanceId+": "+this.sid+"]"},RemoteAudioTrack.prototype.setPriority=function(priority){return _super.prototype.setPriority.call(this,priority)},RemoteAudioTrack}(__webpack_require__("A/ij")(AudioTrack));module.exports=RemoteAudioTrack},"6kkQ":function(module,exports){function createSID(prefix){for(var result="",i=0;i<32;i++)result+="1234567890abcdef".charAt(Math.floor(Math.random()*"1234567890abcdef".length));return""+prefix+result}exports.sessionSID=createSID("SS"),exports.createSID=createSID},"6ltx":function(module,exports,__webpack_require__){"use strict";var NetworkQualityAudioStats=__webpack_require__("j4sL"),NetworkQualityVideoStats=__webpack_require__("XI6i");module.exports=function(_a){var audio=_a.audio,video=_a.video;Object.defineProperties(this,{level:{value:_a.level,enumerable:!0},audio:{value:audio?new NetworkQualityAudioStats(audio):null,enumerable:!0},video:{value:video?new NetworkQualityVideoStats(video):null,enumerable:!0}})}},"6vXP":function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),RemoteVideoTrackPublication=function(_super){function RemoteVideoTrackPublication(signaling,options){return _super.call(this,signaling,options)||this}return __extends(RemoteVideoTrackPublication,_super),RemoteVideoTrackPublication.prototype.toString=function(){return"[RemoteVideoTrackPublication #"+this._instanceId+": "+this.trackSid+"]"},RemoteVideoTrackPublication}(__webpack_require__("+EQa"));module.exports=RemoteVideoTrackPublication},"7C7v":function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),NetworkQualitySendStats=function(_super){function NetworkQualitySendStats(sendOrRecvStats){return _super.call(this,sendOrRecvStats)||this}return __extends(NetworkQualitySendStats,_super),NetworkQualitySendStats}(__webpack_require__("5UJR"));module.exports=NetworkQualitySendStats},"7bK7":function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),MediaTrackReceiver=function(_super){function MediaTrackReceiver(id,mediaStreamTrack){return _super.call(this,id,mediaStreamTrack)||this}return __extends(MediaTrackReceiver,_super),MediaTrackReceiver}(__webpack_require__("uBG5"));module.exports=MediaTrackReceiver},"7cSL":function(module,exports,__webpack_require__){"use strict";var forEach=__webpack_require__("v61W"),availableTypedArrays=__webpack_require__("cibw"),callBound=__webpack_require__("VF6F"),$toString=callBound("Object.prototype.toString"),hasToStringTag=__webpack_require__("B6Q+")(),g="undefined"==typeof globalThis?global:globalThis,typedArrays=availableTypedArrays(),$slice=callBound("String.prototype.slice"),toStrTags={},gOPD=__webpack_require__("HdHG"),getPrototypeOf=Object.getPrototypeOf;hasToStringTag&&gOPD&&getPrototypeOf&&forEach(typedArrays,(function(typedArray){if("function"==typeof g[typedArray]){var arr=new g[typedArray];if(Symbol.toStringTag in arr){var proto=getPrototypeOf(arr),descriptor=gOPD(proto,Symbol.toStringTag);if(!descriptor){var superProto=getPrototypeOf(proto);descriptor=gOPD(superProto,Symbol.toStringTag)}toStrTags[typedArray]=descriptor.get}}}));var isTypedArray=__webpack_require__("9OO9");module.exports=function(value){return!!isTypedArray(value)&&(hasToStringTag&&Symbol.toStringTag in value?function(value){var foundName=!1;return forEach(toStrTags,(function(getter,typedArray){if(!foundName)try{var name=getter.call(value);name===typedArray&&(foundName=name)}catch(e){}})),foundName}(value):$slice($toString(value),8,-1))}},"89tg":function(module,exports,__webpack_require__){var util=__webpack_require__("MCLT"),precond=__webpack_require__("zMHY"),BackoffStrategy=__webpack_require__("kThA");function ExponentialBackoffStrategy(options){BackoffStrategy.call(this,options),this.backoffDelay_=0,this.nextBackoffDelay_=this.getInitialDelay(),this.factor_=ExponentialBackoffStrategy.DEFAULT_FACTOR,options&&void 0!==options.factor&&(precond.checkArgument(options.factor>1,"Exponential factor should be greater than 1 but got %s.",options.factor),this.factor_=options.factor)}util.inherits(ExponentialBackoffStrategy,BackoffStrategy),ExponentialBackoffStrategy.DEFAULT_FACTOR=2,ExponentialBackoffStrategy.prototype.next_=function(){return this.backoffDelay_=Math.min(this.nextBackoffDelay_,this.getMaxDelay()),this.nextBackoffDelay_=this.backoffDelay_*this.factor_,this.backoffDelay_},ExponentialBackoffStrategy.prototype.reset_=function(){this.backoffDelay_=0,this.nextBackoffDelay_=this.getInitialDelay()},module.exports=ExponentialBackoffStrategy},"8WNc":function(module,exports,__webpack_require__){"use strict";module.exports=function(id,trackId,bitrate){Object.defineProperties(this,{id:{enumerable:!0,value:id},trackId:{enumerable:!0,value:trackId},bitrate:{enumerable:!0,value:bitrate}})}},"8vSI":function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),RemoteAudioTrackPublication=function(_super){function RemoteAudioTrackPublication(signaling,options){return _super.call(this,signaling,options)||this}return __extends(RemoteAudioTrackPublication,_super),RemoteAudioTrackPublication.prototype.toString=function(){return"[RemoteAudioTrackPublication #"+this._instanceId+": "+this.trackSid+"]"},RemoteAudioTrackPublication}(__webpack_require__("+EQa"));module.exports=RemoteAudioTrackPublication},"9/wP":function(module,exports,__webpack_require__){"use strict";var MediaStreamTrack=__webpack_require__("NBph").MediaStreamTrack,_a=__webpack_require__("mIkg"),guessBrowser=_a.guessBrowser,guessBrowserVersion=_a.guessBrowserVersion,createCancelableRoomPromise=__webpack_require__("/kv6"),EncodingParametersImpl=__webpack_require__("o2QH"),LocalParticipant=__webpack_require__("MItk"),InsightsPublisher=__webpack_require__("tPbP"),NullInsightsPublisher=__webpack_require__("sJKT"),_b=__webpack_require__("VR5W"),LocalAudioTrack=_b.LocalAudioTrack,LocalDataTrack=_b.LocalDataTrack,LocalVideoTrack=_b.LocalVideoTrack,NetworkQualityConfigurationImpl=__webpack_require__("nj3X"),Room=__webpack_require__("+kOg"),SignalingV2=__webpack_require__("wAda"),_c=__webpack_require__("ghd6"),asLocalTrack=_c.asLocalTrack,buildLogLevels=_c.buildLogLevels,filterObject=_c.filterObject,isNonArrayObject=_c.isNonArrayObject,_d=__webpack_require__("xwWy"),DEFAULT_ENVIRONMENT=_d.DEFAULT_ENVIRONMENT,DEFAULT_LOG_LEVEL=_d.DEFAULT_LOG_LEVEL,DEFAULT_LOGGER_NAME=_d.DEFAULT_LOGGER_NAME,DEFAULT_REALM=_d.DEFAULT_REALM,DEFAULT_REGION=_d.DEFAULT_REGION,WS_SERVER=_d.WS_SERVER,SDK_NAME=_d.SDK_NAME,SDK_VERSION=_d.SDK_VERSION,E=_d.typeErrors,CancelablePromise=__webpack_require__("sYJf"),EventObserver=__webpack_require__("VgEY"),DefaultLog=__webpack_require__("S3Hu"),validateBandwidthProfile=__webpack_require__("N7NK").validateBandwidthProfile,safariVersion="safari"===guessBrowser()&&guessBrowserVersion(),connectCalls=0,didPrintSafariWarning=!1,isSafariWithoutVP8Support=!1;if(safariVersion){var safariMajorVersion=safariVersion.major;isSafariWithoutVP8Support=safariMajorVersion<12||12===safariMajorVersion&&safariVersion.minor<1}var deprecatedConnectOptionsProps=new Set([{didWarn:!1,shouldDelete:!0,name:"abortOnIceServersTimeout"},{didWarn:!1,shouldDelete:!0,name:"dscpTagging",newName:"enableDscp"},{didWarn:!1,shouldDelete:!0,name:"iceServersTimeout"},{didWarn:!1,shouldDelete:!1,name:"eventListener",newName:"Video.Logger"},{didWarn:!1,shouldDelete:!1,name:"logLevel",newName:"Video.Logger"}]),deprecatedBandwidthProfileOptions=new Set([{didWarn:!1,shouldDelete:!1,name:"maxTracks",newName:"bandwidthProfile.video.clientTrackSwitchOffControl"},{didWarn:!1,shouldDelete:!1,name:"renderDimensions",newName:"bandwidthProfile.video.contentPreferencesMode"}]);function deprecateOptions(options,log,deprecationTable){deprecationTable.forEach((function(prop){var didWarn=prop.didWarn,name=prop.name,newName=prop.newName,shouldDelete=prop.shouldDelete;name in options&&void 0!==options[name]&&(newName&&shouldDelete&&(options[newName]=options[name]),shouldDelete&&delete options[name],didWarn||["error","off"].includes(log.level)||(log.warn('The ConnectOptions "'+name+'" is '+(newName?'deprecated and scheduled for removal. Please use "'+newName+'" instead.':"no longer applicable and will be ignored.")),prop.didWarn=!0))}))}function createLocalParticipant(signaling,log,encodingParameters,networkQualityConfiguration,options,localTracks){var localParticipantSignaling=signaling.createLocalParticipantSignaling(encodingParameters,networkQualityConfiguration);return log.debug("Creating a new LocalParticipant:",localParticipantSignaling),new options.LocalParticipant(localParticipantSignaling,localTracks,options)}function createRoom(options,localParticipant,roomSignaling){var room=new Room(localParticipant,roomSignaling,options),log=options.log;return log.debug("Creating a new Room:",room),roomSignaling.on("stateChanged",(function stateChanged(state){"disconnected"===state&&(log.info("Disconnected from Room:",room.toString()),roomSignaling.removeListener("stateChanged",stateChanged))})),room}function createRoomSignaling(token,options,signaling,encodingParameters,preferredCodecs,localParticipant){return options.log.debug("Creating a new RoomSignaling"),signaling.connect(localParticipant._signaling,token,encodingParameters,preferredCodecs,options)}function getLocalTracks(options,handleLocalTracks){var log=options.log;return options.shouldStopLocalTracks=!options.tracks,options.shouldStopLocalTracks?log.info("LocalTracks were not provided, so they will be acquired automatically before connecting to the Room. LocalTracks will be released if connecting to the Room fails or if the Room is disconnected"):(log.info("Getting LocalTracks"),log.debug("Options:",options)),options.createLocalTracks(options).then((function(localTracks){var promise=handleLocalTracks(localTracks);return promise.catch((function(){options.shouldStopLocalTracks&&(log.info("The automatically acquired LocalTracks will now be stopped"),localTracks.forEach((function(track){track.stop()})))})),promise}))}function normalizeCodecSettings(nameOrSettings){var settings="string"==typeof nameOrSettings?{codec:nameOrSettings}:nameOrSettings;switch(settings.codec.toLowerCase()){case"opus":return Object.assign({dtx:!0},settings);case"vp8":return Object.assign({simulcast:!1},settings);default:return settings}}module.exports=function(token,options){if(void 0===options&&(options={}),!isNonArrayObject(options))return CancelablePromise.reject(E.INVALID_TYPE("options","object"));var log,Log=options.Log||DefaultLog,loggerName=options.loggerName||DEFAULT_LOGGER_NAME,logLevel=options.logLevel||DEFAULT_LOG_LEVEL,logLevels=buildLogLevels(logLevel),logComponentName="[connect #"+ ++connectCalls+"]";try{log=new Log("default",logComponentName,logLevels,loggerName)}catch(error){return CancelablePromise.reject(error)}deprecateOptions(options,log,deprecatedConnectOptionsProps);var adaptiveSimulcast="auto"===options.preferredVideoCodecs;if(adaptiveSimulcast&&(options.preferredVideoCodecs=[{codec:"VP8",simulcast:!0,adaptiveSimulcast:!0}]),options.maxVideoBitrate&&adaptiveSimulcast)return log.error('ConnectOptions "maxVideoBitrate" is not compatible with "preferredVideoCodecs=auto"'),CancelablePromise.reject(E.ILLEGAL_INVOKE("connect",'ConnectOptions "maxVideoBitrate" is not compatible with "preferredVideoCodecs=auto"'));var eventPublisherOptions={};"string"==typeof(options=Object.assign({automaticSubscription:!0,dominantSpeaker:!1,enableDscp:!1,environment:DEFAULT_ENVIRONMENT,eventListener:null,insights:!0,LocalAudioTrack:LocalAudioTrack,LocalDataTrack:LocalDataTrack,LocalParticipant:LocalParticipant,LocalVideoTrack:LocalVideoTrack,Log:Log,MediaStreamTrack:MediaStreamTrack,loggerName:loggerName,logLevel:logLevel,maxAudioBitrate:null,maxVideoBitrate:null,name:null,networkMonitor:!0,networkQuality:!1,preferredAudioCodecs:[],preferredVideoCodecs:[],realm:DEFAULT_REALM,region:DEFAULT_REGION,signaling:SignalingV2},filterObject(options))).wsServerInsights&&(eventPublisherOptions.gateway=options.wsServerInsights);var eventPublisher=new(options.insights?InsightsPublisher:NullInsightsPublisher)(token,SDK_NAME,SDK_VERSION,options.environment,options.realm,eventPublisherOptions),wsServer=WS_SERVER(options.environment,options.region),eventObserver=new EventObserver(eventPublisher,Date.now(),log,options.eventListener);if((options=Object.assign({eventObserver:eventObserver,wsServer:wsServer},options)).log=log,isSafariWithoutVP8Support&&!didPrintSafariWarning&&"error"!==log.logLevel&&"off"!==log.logLevel&&(didPrintSafariWarning=!0,log.warn(["Support for Safari 12.0 and below is limited because it does not support VP8.","This means you may experience codec issues in Group Rooms. You may also","experience codec issues in Peer-to-Peer (P2P) Rooms containing Android- or","iOS-based Participants who do not support H.264. However, P2P Rooms","with browser-based Participants should work. For more information, please","refer to this guide: https://www.twilio.com/docs/video/javascript-v2-developing-safari-11"].join(" "))),"string"!=typeof token)return CancelablePromise.reject(E.INVALID_TYPE("token","string"));var localTrackOptions=Object.assign({},options);if(delete localTrackOptions.name,"tracks"in options){if(!Array.isArray(options.tracks))return CancelablePromise.reject(E.INVALID_TYPE("options.tracks","Array of LocalAudioTrack, LocalVideoTrack or MediaStreamTrack"));try{options.tracks=options.tracks.map((function(track){return asLocalTrack(track,localTrackOptions)}))}catch(error){return CancelablePromise.reject(error)}}var error=validateBandwidthProfile(options.bandwidthProfile);if(error)return CancelablePromise.reject(error);options.clientTrackSwitchOffControl="disabled",options.contentPreferencesMode="disabled",options.bandwidthProfile&&(options.clientTrackSwitchOffControl="auto",options.contentPreferencesMode="auto",options.bandwidthProfile.video&&(deprecateOptions(options.bandwidthProfile.video,log,deprecatedBandwidthProfileOptions),options.clientTrackSwitchOffControl="maxTracks"in options.bandwidthProfile.video?"disabled":"manual"===options.bandwidthProfile.video.clientTrackSwitchOffControl?"manual":"auto",options.contentPreferencesMode="renderDimensions"in options.bandwidthProfile.video?"disabled":"manual"===options.bandwidthProfile.video.contentPreferencesMode?"manual":"auto"));var signaling=new(0,options.signaling)(options.wsServer,options);log.info("Connecting to a Room"),log.debug("Options:",options);var encodingParameters=new EncodingParametersImpl({maxAudioBitrate:options.maxAudioBitrate,maxVideoBitrate:options.maxVideoBitrate},adaptiveSimulcast),preferredCodecs={audio:options.preferredAudioCodecs.map(normalizeCodecSettings),video:options.preferredVideoCodecs.map(normalizeCodecSettings)},networkQualityConfiguration=new NetworkQualityConfigurationImpl(isNonArrayObject(options.networkQuality)?options.networkQuality:{}),cancelableRoomPromise=createCancelableRoomPromise(getLocalTracks.bind(null,options),createLocalParticipant.bind(null,signaling,log,encodingParameters,networkQualityConfiguration,options),createRoomSignaling.bind(null,token,options,signaling,encodingParameters,preferredCodecs),createRoom.bind(null,options));return cancelableRoomPromise.then((function(room){return eventPublisher.connect(room.sid,room.localParticipant.sid),log.info("Connected to Room:",room.toString()),log.info("Room name:",room.name),log.debug("Room:",room),room.once("disconnected",(function(){return eventPublisher.disconnect()})),room}),(function(error){eventPublisher.disconnect(),cancelableRoomPromise._isCanceled?log.info("Attempt to connect to a Room was canceled"):log.info("Error while connecting to a Room:",error)})),cancelableRoomPromise}},"9FmL":function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),MediaTrack=__webpack_require__("B32u"),VideoProcessorEventObserver=__webpack_require__("oy54"),DEFAULT_FRAME_RATE=__webpack_require__("xwWy").DEFAULT_FRAME_RATE,VideoTrack=function(_super){function VideoTrack(mediaTrackTransceiver,options){var _this=_super.call(this,mediaTrackTransceiver,options)||this;return Object.defineProperties(_this,{_captureTimeoutId:{value:null,writable:!0},_isCapturing:{value:!1,writable:!0},_inputFrame:{value:null,writable:!0},_outputFrame:{value:null,writable:!0},_processorEventObserver:{value:null,writable:!0},_unmuteHandler:{value:null,writable:!0},dimensions:{enumerable:!0,value:{width:null,height:null}},processor:{enumerable:!0,value:null,writable:!0}}),_this._processorEventObserver=new(options.VideoProcessorEventObserver||VideoProcessorEventObserver)(_this._log),_this}return __extends(VideoTrack,_super),VideoTrack.prototype._checkIfCanCaptureFrames=function(isPublishing){void 0===isPublishing&&(isPublishing=!1);var canCaptureFrames=!0,message="",_a=this.mediaStreamTrack;return _a.enabled||(canCaptureFrames=!1,message="MediaStreamTrack is disabled"),"ended"===_a.readyState&&(canCaptureFrames=!1,message="MediaStreamTrack is ended"),this.processor||(canCaptureFrames=!1,message="VideoProcessor not detected."),this._attachments.size||isPublishing||(canCaptureFrames=!1,message="VideoTrack is not publishing and there is no attached element."),message&&this._log.debug(message),{canCaptureFrames:canCaptureFrames,message:message}},VideoTrack.prototype._captureFrames=function(){var _this=this;if(this._isCapturing)this._log.debug("Ignoring captureFrames call. Capture is already in progress");else{if(!this._checkIfCanCaptureFrames().canCaptureFrames)return this._isCapturing=!1,void this._log.debug("Cannot capture frames. Ignoring captureFrames call.");this._isCapturing=!0,this._processorEventObserver.emit("start"),this._log.debug("Start capturing frames");var processFramePeriodMs,startTime=Date.now();this._dummyEl.play().then((function(){var captureFrame=function(cb){clearTimeout(_this._captureTimeoutId);var _a=_this.mediaStreamTrack.getSettings().frameRate,delay=Math.floor(1e3/(void 0===_a?DEFAULT_FRAME_RATE:_a))-processFramePeriodMs;(delay<0||"number"!=typeof processFramePeriodMs)&&(delay=0),_this._captureTimeoutId=setTimeout(cb,delay)},process=function(){var checkResult=_this._checkIfCanCaptureFrames();if(!checkResult.canCaptureFrames)return _this._isCapturing=!1,_this._processorEventObserver.emit("stop",checkResult.message),void _this._log.debug("Cannot capture frames. Stopping capturing frames.");startTime=Date.now();var _a=_this.mediaStreamTrack.getSettings(),_b=_a.width,width=void 0===_b?0:_b,_c=_a.height,height=void 0===_c?0:_c;_this._inputFrame.width!==width&&(_this._inputFrame.width=width,_this._inputFrame.height=height,_this._outputFrame&&(_this._outputFrame.width=width,_this._outputFrame.height=height)),_this._inputFrame.getContext("2d").drawImage(_this._dummyEl,0,0,width,height);var result=null;try{result=_this.processor.processFrame(_this._inputFrame,_this._outputFrame)}catch(ex){_this._log.debug("Exception detected after calling processFrame.",ex)}(result instanceof Promise?result:Promise.resolve(result)).then((function(){_this._outputFrame&&(_this.processedTrack.requestFrame(),_this._processorEventObserver.emit("stats"))})).finally((function(){processFramePeriodMs=Date.now()-startTime,captureFrame(process)}))};captureFrame(process)})).catch((function(error){return _this._log.error("Video element cannot be played",{error:error,track:_this})}))}},VideoTrack.prototype._initialize=function(){var _this=this;_super.prototype._initialize.call(this),this._dummyEl&&(this._dummyEl.onloadedmetadata=function(){dimensionsChanged(_this,_this._dummyEl)&&(_this.dimensions.width=_this._dummyEl.videoWidth,_this.dimensions.height=_this._dummyEl.videoHeight)},this._dummyEl.onresize=function(){dimensionsChanged(_this,_this._dummyEl)&&(_this.dimensions.width=_this._dummyEl.videoWidth,_this.dimensions.height=_this._dummyEl.videoHeight,_this.isStarted&&(_this._log.debug("Dimensions changed:",_this.dimensions),_this.emit(VideoTrack.DIMENSIONS_CHANGED,_this)))})},VideoTrack.prototype._restartProcessor=function(){var processor=this.processor;processor&&(this.removeProcessor(processor),this.addProcessor(processor))},VideoTrack.prototype._start=function(dummyEl){return this.dimensions.width=dummyEl.videoWidth,this.dimensions.height=dummyEl.videoHeight,this._log.debug("Dimensions:",this.dimensions),_super.prototype._start.call(this,dummyEl)},VideoTrack.prototype.addProcessor=function(processor){var _this=this;if("function"!=typeof OffscreenCanvas)return this._log.warn("Adding a VideoProcessor is not supported in this browser.");if(!processor||"function"!=typeof processor.processFrame)throw new Error("Received an invalid VideoProcessor from addProcessor.");if(this.processor)throw new Error("A VideoProcessor has already been added.");if(!this._dummyEl)throw new Error("VideoTrack has not been initialized.");this._log.debug("Adding VideoProcessor to the VideoTrack",processor),this._unmuteHandler||(this._unmuteHandler=function(){_this._log.debug("mediaStreamTrack unmuted"),_this.processedTrack.muted&&(_this._log.debug("mediaStreamTrack is unmuted but processedTrack is muted. Restarting processor."),_this._restartProcessor())},this.mediaStreamTrack.addEventListener("unmute",this._unmuteHandler));var _a=this.mediaStreamTrack.getSettings(),_b=_a.width,width=void 0===_b?0:_b,_c=_a.height,height=void 0===_c?0:_c,_d=_a.frameRate,frameRate=void 0===_d?DEFAULT_FRAME_RATE:_d;return this._inputFrame=new OffscreenCanvas(width,height),this._outputFrame=document.createElement("canvas"),this._outputFrame.width=width,this._outputFrame.height=height,this.processedTrack=this._outputFrame.captureStream(0).getTracks()[0],this.processedTrack.enabled=this.mediaStreamTrack.enabled,this.processor=processor,this._processorEventObserver.emit("add",{processor:processor,captureHeight:height,captureWidth:width,inputFrameRate:frameRate,isRemoteVideoTrack:this.toString().includes("RemoteVideoTrack")}),this._updateElementsMediaStreamTrack(),this._captureFrames(),this},VideoTrack.prototype.attach=function(){var result=_super.prototype.attach.apply(this,arguments);return this.processor&&this._captureFrames(),result},VideoTrack.prototype.detach=function(){return _super.prototype.detach.apply(this,arguments)},VideoTrack.prototype.removeProcessor=function(processor){if(!processor)throw new Error("Received an invalid VideoProcessor from removeProcessor.");if(!this.processor)throw new Error("No existing VideoProcessor detected.");if(processor!==this.processor)throw new Error("The provided VideoProcessor is different than the existing one.");return this._processorEventObserver.emit("remove"),this._log.debug("Removing VideoProcessor from the VideoTrack",processor),clearTimeout(this._captureTimeoutId),this.mediaStreamTrack.removeEventListener("unmute",this._unmuteHandler),this._unmuteHandler=null,this._isCapturing=!1,this.processor=null,this.processedTrack=null,this._inputFrame.getContext("2d").clearRect(0,0,this._inputFrame.width,this._inputFrame.height),this._outputFrame.getContext("2d").clearRect(0,0,this._outputFrame.width,this._outputFrame.height),this._inputFrame=null,this._outputFrame=null,this._updateElementsMediaStreamTrack(),this},VideoTrack}(MediaTrack);function dimensionsChanged(track,elem){return track.dimensions.width!==elem.videoWidth||track.dimensions.height!==elem.videoHeight}VideoTrack.DIMENSIONS_CHANGED="dimensionsChanged",module.exports=VideoTrack},"9OO9":function(module,exports,__webpack_require__){"use strict";var forEach=__webpack_require__("v61W"),availableTypedArrays=__webpack_require__("cibw"),callBound=__webpack_require__("VF6F"),$toString=callBound("Object.prototype.toString"),hasToStringTag=__webpack_require__("B6Q+")(),g="undefined"==typeof globalThis?global:globalThis,typedArrays=availableTypedArrays(),$indexOf=callBound("Array.prototype.indexOf",!0)||function(array,value){for(var i=0;i<array.length;i+=1)if(array[i]===value)return i;return-1},$slice=callBound("String.prototype.slice"),toStrTags={},gOPD=__webpack_require__("HdHG"),getPrototypeOf=Object.getPrototypeOf;hasToStringTag&&gOPD&&getPrototypeOf&&forEach(typedArrays,(function(typedArray){var arr=new g[typedArray];if(Symbol.toStringTag in arr){var proto=getPrototypeOf(arr),descriptor=gOPD(proto,Symbol.toStringTag);if(!descriptor){var superProto=getPrototypeOf(proto);descriptor=gOPD(superProto,Symbol.toStringTag)}toStrTags[typedArray]=descriptor.get}})),module.exports=function(value){if(!value||"object"!=typeof value)return!1;if(!hasToStringTag||!(Symbol.toStringTag in value)){var tag=$slice($toString(value),8,-1);return $indexOf(typedArrays,tag)>-1}return!!gOPD&&function(value){var anyTrue=!1;return forEach(toStrTags,(function(getter,typedArray){if(!anyTrue)try{anyTrue=getter.call(value)===typedArray}catch(e){}})),anyTrue}(value)}},"9dY8":function(module,exports,__webpack_require__){"use strict";var __read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},_a=__webpack_require__("ghd6"),difference=_a.difference,flatMap=_a.flatMap,setSimulcastInMediaSection=__webpack_require__("qRNy"),ptToFixedBitrateAudioCodecName={0:"PCMU",8:"PCMA"};function createCodecMapForMediaSection(section){return Array.from(createPtToCodecName(section)).reduce((function(codecMap,pair){var pt=pair[0],codecName=pair[1],pts=codecMap.get(codecName)||[];return codecMap.set(codecName,pts.concat(pt))}),new Map)}function createMidToMediaSectionMap(sdp){return getMediaSections(sdp).reduce((function(midsToMediaSections,mediaSection){var mid=getMidForMediaSection(mediaSection);return mid?midsToMediaSections.set(mid,mediaSection):midsToMediaSections}),new Map)}function createPtToCodecName(mediaSection){return getPayloadTypesInMediaSection(mediaSection).reduce((function(ptToCodecName,pt){var rtpmapPattern=new RegExp("a=rtpmap:"+pt+" ([^/]+)"),matches=mediaSection.match(rtpmapPattern),codecName=matches?matches[1].toLowerCase():ptToFixedBitrateAudioCodecName[pt]?ptToFixedBitrateAudioCodecName[pt].toLowerCase():"";return ptToCodecName.set(pt,codecName)}),new Map)}function getFmtpAttributesForPt(pt,mediaSection){var fmtpRegex=new RegExp("^a=fmtp:"+pt+" (.+)$","m"),matches=mediaSection.match(fmtpRegex);return matches&&matches[1].split(";").reduce((function(attrs,nvPair){var _a=__read(nvPair.split("="),2),value=_a[1];return attrs[_a[0]]=isNaN(value)?value:parseInt(value,10),attrs}),{})}function getMidForMediaSection(mediaSection){var midMatches=mediaSection.match(/^a=mid:(.+)$/m);return midMatches&&midMatches[1]}function getMediaSections(sdp,kind,direction){return sdp.replace(/\r\n\r\n$/,"\r\n").split("\r\nm=").slice(1).map((function(mediaSection){return"m="+mediaSection})).filter((function(mediaSection){var kindPattern=new RegExp("m="+(kind||".*"),"gm"),directionPattern=new RegExp("a="+(direction||".*"),"gm");return kindPattern.test(mediaSection)&&directionPattern.test(mediaSection)}))}function getPayloadTypesInMediaSection(section){var matches=section.split("\r\n")[0].match(/([0-9]+)/g);return matches?matches.slice(1).map((function(match){return parseInt(match,10)})):[]}function setPayloadTypesInMediaSection(payloadTypes,section){var lines=section.split("\r\n"),mLine=lines[0],otherLines=lines.slice(1);return[mLine=mLine.replace(/([0-9]+\s?)+$/,payloadTypes.join(" "))].concat(otherLines).join("\r\n")}function addOrRewriteTrackIds(sdp,midsToTrackIds){var mediaSections=getMediaSections(sdp);return[sdp.split("\r\nm=")[0]].concat(mediaSections.map((function(mediaSection){if(!/^m=(audio|video)/.test(mediaSection))return mediaSection;var mid=getMidForMediaSection(mediaSection);if(!mid)return mediaSection;var trackId=midsToTrackIds.get(mid);if(!trackId)return mediaSection;var attributes=(mediaSection.match(/^a=msid:(.+)$/m)||[])[1];if(!attributes)return mediaSection;var _a=__read(attributes.split(" "),2),msid=_a[0],trackIdToRewrite=_a[1],msidRegex=new RegExp("msid:"+msid+(trackIdToRewrite?" "+trackIdToRewrite:"")+"$","gm");return mediaSection.replace(msidRegex,"msid:"+msid+" "+trackId)}))).join("\r\n")}function generateFmtpLineFromPtAndAttributes(pt,fmtpAttrs){return"a=fmtp:"+pt+" "+Object.entries(fmtpAttrs).map((function(_a){var _b=__read(_a,2);return _b[0]+"="+_b[1]})).join(";")}exports.addOrRewriteNewTrackIds=function(sdp,activeMidsToTrackIds,trackIdsByKind){var newMidsToTrackIds=Array.from(trackIdsByKind).reduce((function(midsToTrackIds,_a){var _b=__read(_a,2),trackIds=_b[1];return getMediaSections(sdp,_b[0],"send(only|recv)").map(getMidForMediaSection).filter((function(mid){return!activeMidsToTrackIds.has(mid)})).forEach((function(mid,i){return midsToTrackIds.set(mid,trackIds[i])})),midsToTrackIds}),new Map);return addOrRewriteTrackIds(sdp,newMidsToTrackIds)},exports.addOrRewriteTrackIds=addOrRewriteTrackIds,exports.createCodecMapForMediaSection=createCodecMapForMediaSection,exports.createPtToCodecName=createPtToCodecName,exports.disableRtx=function(sdp){var mediaSections=getMediaSections(sdp);return[sdp.split("\r\nm=")[0]].concat(mediaSections.map((function(mediaSection){if(!/^m=video/.test(mediaSection))return mediaSection;var rtxPts=createCodecMapForMediaSection(mediaSection).get("rtx");if(!rtxPts)return mediaSection;var pts=new Set(getPayloadTypesInMediaSection(mediaSection));rtxPts.forEach((function(rtxPt){return pts.delete(rtxPt)}));var rtxSSRCMatches=mediaSection.match(/a=ssrc-group:FID [0-9]+ ([0-9]+)/),rtxSSRC=rtxSSRCMatches&&rtxSSRCMatches[1],filterRegexes=[/^a=fmtp:.+ apt=.+$/,/^a=rtpmap:.+ rtx\/.+$/,/^a=ssrc-group:.+$/].concat(rtxSSRC?[new RegExp("^a=ssrc:"+rtxSSRC+" .+$")]:[]);return mediaSection=mediaSection.split("\r\n").filter((function(line){return filterRegexes.every((function(regex){return!regex.test(line)}))})).join("\r\n"),setPayloadTypesInMediaSection(Array.from(pts),mediaSection)}))).join("\r\n")},exports.enableDtxForOpus=function(sdp,mids){var mediaSections=getMediaSections(sdp),session=sdp.split("\r\nm=")[0];return mids=mids||mediaSections.filter((function(section){return/^m=audio/.test(section)})).map(getMidForMediaSection),[session].concat(mediaSections.map((function(section){if(!/^m=audio/.test(section))return section;var opusPt=createCodecMapForMediaSection(section).get("opus");if(!opusPt)return section;var opusFmtpAttrs=getFmtpAttributesForPt(opusPt,section);if(!opusFmtpAttrs)return section;var origOpusFmtpLine=generateFmtpLineFromPtAndAttributes(opusPt,opusFmtpAttrs),origOpusFmtpRegex=new RegExp(origOpusFmtpLine),mid=getMidForMediaSection(section);mids.includes(mid)?opusFmtpAttrs.usedtx=1:delete opusFmtpAttrs.usedtx;var opusFmtpLineWithDtx=generateFmtpLineFromPtAndAttributes(opusPt,opusFmtpAttrs);return section.replace(origOpusFmtpRegex,opusFmtpLineWithDtx)}))).join("\r\n")},exports.filterLocalCodecs=function(localSdp,remoteSdp){var localMediaSections=getMediaSections(localSdp),localSession=localSdp.split("\r\nm=")[0],remoteMidsToMediaSections=createMidToMediaSectionMap(remoteSdp);return[localSession].concat(localMediaSections.map((function(localSection){return function(section,peerMidsToMediaSections,codecsToRemove){if(!/^m=(audio|video)/.test(section))return section;var mid=getMidForMediaSection(section),peerSection=mid&&peerMidsToMediaSections.get(mid);if(!peerSection)return section;var peerPtToCodecs=createPtToCodecName(peerSection),codecsToPts=createCodecMapForMediaSection(section),pts=flatMap(Array.from(peerPtToCodecs),(function(_a){var _b=__read(_a,2),peerPt=_b[0],peerCodec=_b[1];return"rtx"===peerCodec||codecsToRemove.includes(peerCodec)?[]:function(peerCodec,peerPt,codecsToPts,section,peerSection){var matchingPts=codecsToPts.get(peerCodec)||[];if(matchingPts.length<=1)return matchingPts;var peerFmtpAttrs=getFmtpAttributesForPt(peerPt,peerSection);if(!peerFmtpAttrs)return matchingPts;var matchingPt=matchingPts.find((function(pt){var fmtpAttrs=getFmtpAttributesForPt(pt,section);return fmtpAttrs&&Object.keys(peerFmtpAttrs).every((function(attr){return peerFmtpAttrs[attr]===fmtpAttrs[attr]}))}));return"number"==typeof matchingPt?[matchingPt]:matchingPts}(peerCodec,peerPt,codecsToPts,section,peerSection)})),rtxPts=codecsToPts.get("rtx")||[];pts=pts.concat(rtxPts.filter((function(rtxPt){var fmtpAttrs=getFmtpAttributesForPt(rtxPt,section);return fmtpAttrs&&pts.includes(fmtpAttrs.apt)})));var lines=section.split("\r\n").filter((function(line){var ptMatches=line.match(/^a=(rtpmap|fmtp|rtcp-fb):(.+) .+$/),pt=ptMatches&&ptMatches[2];return!ptMatches||pt&&pts.includes(parseInt(pt,10))}));return setPayloadTypesInMediaSection(getPayloadTypesInMediaSection(section).filter((function(pt){return pts.includes(pt)})),lines.join("\r\n"))}(localSection,remoteMidsToMediaSections,[])}))).join("\r\n")},exports.getMediaSections=getMediaSections,exports.removeSSRCAttributes=function(sdp,ssrcAttributesToRemove){return sdp.split("\r\n").filter((function(line){return!ssrcAttributesToRemove.find((function(srcAttribute){return new RegExp("a=ssrc:.*"+srcAttribute+":","g").test(line)}))})).join("\r\n")},exports.revertSimulcast=function(localSdp,localSdpWithoutSimulcast,remoteSdp,revertForAll){void 0===revertForAll&&(revertForAll=!1);var remoteMidToMediaSections=createMidToMediaSectionMap(remoteSdp),localMidToMediaSectionsWithoutSimulcast=createMidToMediaSectionMap(localSdpWithoutSimulcast),mediaSections=getMediaSections(localSdp);return[localSdp.split("\r\nm=")[0]].concat(mediaSections.map((function(section){if(section=section.replace(/\r\n$/,""),!/^m=video/.test(section))return section;var midMatches=section.match(/^a=mid:(.+)$/m),mid=midMatches&&midMatches[1];if(!mid)return section;var remoteSection=remoteMidToMediaSections.get(mid),remotePtToCodecs=createPtToCodecName(remoteSection),remotePayloadTypes=getPayloadTypesInMediaSection(remoteSection),isVP8ThePreferredCodec=remotePayloadTypes.length&&"vp8"===remotePtToCodecs.get(remotePayloadTypes[0]);return revertForAll||!isVP8ThePreferredCodec?localMidToMediaSectionsWithoutSimulcast.get(mid).replace(/\r\n$/,""):section}))).concat("").join("\r\n")},exports.setCodecPreferences=function(sdp,preferredAudioCodecs,preferredVideoCodecs){var mediaSections=getMediaSections(sdp);return[sdp.split("\r\nm=")[0]].concat(mediaSections.map((function(section){if(!/^m=(audio|video)/.test(section))return section;var kind=section.match(/^m=(audio|video)/)[1],codecMap=createCodecMapForMediaSection(section),payloadTypes=function(codecMap,preferredCodecs){preferredCodecs=preferredCodecs.map((function(_a){return _a.codec.toLowerCase()}));var preferredPayloadTypes=flatMap(preferredCodecs,(function(codecName){return codecMap.get(codecName)||[]})),remainingCodecs=difference(Array.from(codecMap.keys()),preferredCodecs),remainingPayloadTypes=flatMap(remainingCodecs,(function(codecName){return codecMap.get(codecName)}));return preferredPayloadTypes.concat(remainingPayloadTypes)}(codecMap,"audio"===kind?preferredAudioCodecs:preferredVideoCodecs),newSection=setPayloadTypesInMediaSection(payloadTypes,section),pcmaPayloadTypes=codecMap.get("pcma")||[],pcmuPayloadTypes=codecMap.get("pcmu")||[];return("audio"===kind?new Set(pcmaPayloadTypes.concat(pcmuPayloadTypes)):new Set).has(payloadTypes[0])?newSection.replace(/\r\nb=(AS|TIAS):([0-9]+)/g,""):newSection}))).join("\r\n")},exports.setSimulcast=function(sdp,trackIdsToAttributes){var mediaSections=getMediaSections(sdp);return[sdp.split("\r\nm=")[0]].concat(mediaSections.map((function(section){if(section=section.replace(/\r\n$/,""),!/^m=video/.test(section))return section;var codecMap=createCodecMapForMediaSection(section),payloadTypes=getPayloadTypesInMediaSection(section),vp8PayloadTypes=new Set(codecMap.get("vp8")||[]);return payloadTypes.some((function(payloadType){return vp8PayloadTypes.has(payloadType)}))?setSimulcastInMediaSection(section,trackIdsToAttributes):section}))).concat("").join("\r\n")}},"A/ij":function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__spreadArray=this&&this.__spreadArray||function(to,from){for(var i=0,il=from.length,j=to.length;i<il;i++,j++)to[j]=from[i];return to},_a=__webpack_require__("xwWy"),E=_a.typeErrors,trackPriority=_a.trackPriority,_b=__webpack_require__("mIkg"),guessBrowser=_b.guessBrowser,isIOSChrome=_b.isIOSChrome,documentVisibilityMonitor=__webpack_require__("UBwA");module.exports=function(AudioOrVideoTrack){return function(_super){function RemoteMediaTrack(sid,mediaTrackReceiver,isEnabled,isSwitchedOff,setPriority,setRenderHint,options){var _this=this;return options=Object.assign({workaroundWebKitBug212780:("safari"===guessBrowser()||isIOSChrome())&&"object"==typeof document&&"function"==typeof document.addEventListener&&"string"==typeof document.visibilityState},options),_this=_super.call(this,mediaTrackReceiver,options)||this,Object.defineProperties(_this,{_isEnabled:{value:isEnabled,writable:!0},_isSwitchedOff:{value:isSwitchedOff,writable:!0},_priority:{value:null,writable:!0},_setPriority:{value:setPriority},_setRenderHint:{value:function(renderHint){_this._log.debug("updating render hint:",renderHint),setRenderHint(renderHint)}},isEnabled:{enumerable:!0,get:function(){return this._isEnabled}},isSwitchedOff:{enumerable:!0,get:function(){return this._isSwitchedOff}},priority:{enumerable:!0,get:function(){return this._priority}},sid:{enumerable:!0,value:sid},_workaroundWebKitBug212780:{value:options.workaroundWebKitBug212780},_workaroundWebKitBug212780Cleanup:{value:null,writable:!0}}),_this}return __extends(RemoteMediaTrack,_super),RemoteMediaTrack.prototype.setPriority=function(priority){var priorityValues=__spreadArray([null],__read(Object.values(trackPriority)));if(!priorityValues.includes(priority))throw E.INVALID_VALUE("priority",priorityValues);return this._priority!==priority&&(this._priority=priority,this._setPriority(priority)),this},RemoteMediaTrack.prototype._setEnabled=function(isEnabled){this._isEnabled!==isEnabled&&(this._isEnabled=isEnabled,this.emit(this._isEnabled?"enabled":"disabled",this))},RemoteMediaTrack.prototype._setSwitchedOff=function(isSwitchedOff){this._isSwitchedOff!==isSwitchedOff&&(this._isSwitchedOff=isSwitchedOff,this.emit(isSwitchedOff?"switchedOff":"switchedOn",this))},RemoteMediaTrack.prototype.attach=function(el){var result=_super.prototype.attach.call(this,el);return!0!==this.mediaStreamTrack.enabled&&(this.mediaStreamTrack.enabled=!0,this.processedTrack&&(this.processedTrack.enabled=!0),this.processor&&this._captureFrames()),this._workaroundWebKitBug212780&&(this._workaroundWebKitBug212780Cleanup=this._workaroundWebKitBug212780Cleanup||function(remoteMediaTrack){var log=remoteMediaTrack._log,kind=remoteMediaTrack.kind;function onVisibilityChanged(isVisible){isVisible&&remoteMediaTrack._attachments.forEach((function(el){var shim=remoteMediaTrack._elShims.get(el);el.paused&&shim&&!shim.pausedIntentionally()&&(log.info("Playing inadvertently paused <"+kind+"> element"),log.debug("Element:",el),log.debug("RemoteMediaTrack:",remoteMediaTrack),el.play().then((function(){log.info("Successfully played inadvertently paused <"+kind+"> element"),log.debug("Element:",el),log.debug("RemoteMediaTrack:",remoteMediaTrack)})).catch((function(err){log.warn("Error while playing inadvertently paused <"+kind+"> element:",{err:err,el:el,remoteMediaTrack:remoteMediaTrack})})))}))}return documentVisibilityMonitor.onVisibilityChange(2,onVisibilityChanged),function(){documentVisibilityMonitor.offVisibilityChange(2,onVisibilityChanged)}}(this)),result},RemoteMediaTrack.prototype.detach=function(el){var result=_super.prototype.detach.call(this,el);return 0===this._attachments.size&&(this.mediaStreamTrack.enabled=!1,this.processedTrack&&(this.processedTrack.enabled=!1),this._workaroundWebKitBug212780Cleanup&&(this._workaroundWebKitBug212780Cleanup(),this._workaroundWebKitBug212780Cleanup=null)),result},RemoteMediaTrack}(AudioOrVideoTrack)}},AM7I:function(module,exports,__webpack_require__){"use strict";var $SyntaxError=SyntaxError,$Function=Function,$TypeError=TypeError,getEvalledConstructor=function(expressionSyntax){try{return $Function('"use strict"; return ('+expressionSyntax+").constructor;")()}catch(e){}},$gOPD=Object.getOwnPropertyDescriptor;if($gOPD)try{$gOPD({},"")}catch(e){$gOPD=null}var throwTypeError=function(){throw new $TypeError},ThrowTypeError=$gOPD?function(){try{return throwTypeError}catch(calleeThrows){try{return $gOPD(arguments,"callee").get}catch(gOPDthrows){return throwTypeError}}}():throwTypeError,hasSymbols=__webpack_require__("UVaH")(),getProto=Object.getPrototypeOf||function(x){return x.__proto__},needsEval={},TypedArray="undefined"==typeof Uint8Array?void 0:getProto(Uint8Array),INTRINSICS={"%AggregateError%":"undefined"==typeof AggregateError?void 0:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?void 0:ArrayBuffer,"%ArrayIteratorPrototype%":hasSymbols?getProto([][Symbol.iterator]()):void 0,"%AsyncFromSyncIteratorPrototype%":void 0,"%AsyncFunction%":needsEval,"%AsyncGenerator%":needsEval,"%AsyncGeneratorFunction%":needsEval,"%AsyncIteratorPrototype%":needsEval,"%Atomics%":"undefined"==typeof Atomics?void 0:Atomics,"%BigInt%":"undefined"==typeof BigInt?void 0:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?void 0:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?void 0:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?void 0:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?void 0:FinalizationRegistry,"%Function%":$Function,"%GeneratorFunction%":needsEval,"%Int8Array%":"undefined"==typeof Int8Array?void 0:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?void 0:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?void 0:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":hasSymbols?getProto(getProto([][Symbol.iterator]())):void 0,"%JSON%":"object"==typeof JSON?JSON:void 0,"%Map%":"undefined"==typeof Map?void 0:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&hasSymbols?getProto((new Map)[Symbol.iterator]()):void 0,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?void 0:Promise,"%Proxy%":"undefined"==typeof Proxy?void 0:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?void 0:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?void 0:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&hasSymbols?getProto((new Set)[Symbol.iterator]()):void 0,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?void 0:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":hasSymbols?getProto(""[Symbol.iterator]()):void 0,"%Symbol%":hasSymbols?Symbol:void 0,"%SyntaxError%":$SyntaxError,"%ThrowTypeError%":ThrowTypeError,"%TypedArray%":TypedArray,"%TypeError%":$TypeError,"%Uint8Array%":"undefined"==typeof Uint8Array?void 0:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?void 0:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?void 0:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?void 0:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?void 0:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?void 0:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?void 0:WeakSet},LEGACY_ALIASES={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},bind=__webpack_require__("D3zA"),hasOwn=__webpack_require__("oNNP"),$concat=bind.call(Function.call,Array.prototype.concat),$spliceApply=bind.call(Function.apply,Array.prototype.splice),$replace=bind.call(Function.call,String.prototype.replace),$strSlice=bind.call(Function.call,String.prototype.slice),rePropName=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=function(string){var first=$strSlice(string,0,1),last=$strSlice(string,-1);if("%"===first&&"%"!==last)throw new $SyntaxError("invalid intrinsic syntax, expected closing `%`");if("%"===last&&"%"!==first)throw new $SyntaxError("invalid intrinsic syntax, expected opening `%`");var result=[];return $replace(string,rePropName,(function(match,number,quote,subString){result[result.length]=quote?$replace(subString,reEscapeChar,"$1"):number||match})),result},getBaseIntrinsic=function(name,allowMissing){var alias,intrinsicName=name;if(hasOwn(LEGACY_ALIASES,intrinsicName)&&(intrinsicName="%"+(alias=LEGACY_ALIASES[intrinsicName])[0]+"%"),hasOwn(INTRINSICS,intrinsicName)){var value=INTRINSICS[intrinsicName];if(value===needsEval&&(value=function doEval(name){var value;if("%AsyncFunction%"===name)value=getEvalledConstructor("async function () {}");else if("%GeneratorFunction%"===name)value=getEvalledConstructor("function* () {}");else if("%AsyncGeneratorFunction%"===name)value=getEvalledConstructor("async function* () {}");else if("%AsyncGenerator%"===name){var fn=doEval("%AsyncGeneratorFunction%");fn&&(value=fn.prototype)}else if("%AsyncIteratorPrototype%"===name){var gen=doEval("%AsyncGenerator%");gen&&(value=getProto(gen.prototype))}return INTRINSICS[name]=value,value}(intrinsicName)),void 0===value&&!allowMissing)throw new $TypeError("intrinsic "+name+" exists, but is not available. Please file an issue!");return{alias:alias,name:intrinsicName,value:value}}throw new $SyntaxError("intrinsic "+name+" does not exist!")};module.exports=function(name,allowMissing){if("string"!=typeof name||0===name.length)throw new $TypeError("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof allowMissing)throw new $TypeError('"allowMissing" argument must be a boolean');var parts=stringToPath(name),intrinsicBaseName=parts.length>0?parts[0]:"",intrinsic=getBaseIntrinsic("%"+intrinsicBaseName+"%",allowMissing),intrinsicRealName=intrinsic.name,value=intrinsic.value,skipFurtherCaching=!1,alias=intrinsic.alias;alias&&(intrinsicBaseName=alias[0],$spliceApply(parts,$concat([0,1],alias)));for(var i=1,isOwn=!0;i<parts.length;i+=1){var part=parts[i],first=$strSlice(part,0,1),last=$strSlice(part,-1);if(('"'===first||"'"===first||"`"===first||'"'===last||"'"===last||"`"===last)&&first!==last)throw new $SyntaxError("property names with quotes must have matching quotes");if("constructor"!==part&&isOwn||(skipFurtherCaching=!0),hasOwn(INTRINSICS,intrinsicRealName="%"+(intrinsicBaseName+="."+part)+"%"))value=INTRINSICS[intrinsicRealName];else if(null!=value){if(!(part in value)){if(!allowMissing)throw new $TypeError("base intrinsic for "+name+" exists, but the property is not available.");return}if($gOPD&&i+1>=parts.length){var desc=$gOPD(value,part);value=(isOwn=!!desc)&&"get"in desc&&!("originalValue"in desc.get)?desc.get:value[part]}else isOwn=hasOwn(value,part),value=value[part];isOwn&&!skipFurtherCaching&&(INTRINSICS[intrinsicRealName]=value)}}return value}},Aq89:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),MediaSignaling=__webpack_require__("zbom"),AsyncVar=__webpack_require__("EHr0"),Timeout=__webpack_require__("Y1/N"),NetworkQualitySignaling=function(_super){function NetworkQualitySignaling(getReceiver,networkQualityConfiguration,options){var _this=_super.call(this,getReceiver,"network_quality",options)||this;return Object.defineProperties(_this,{_level:{value:null,writable:!0},_levels:{value:null,writable:!0},_remoteLevels:{value:new Map,writable:!0},_networkQualityInputs:{value:new AsyncVar},_resendTimer:{value:new Timeout((function(){_this._resendTimer.setDelay(1.5*_this._resendTimer.delay),_this._sendNetworkQualityInputs()}),5e3,!1)},_networkQualityReportLevels:{get:function(){return{reportLevel:networkQualityConfiguration.local,remoteReportLevel:networkQualityConfiguration.remote}}}}),_this.on("ready",(function(transport){transport.on("message",(function(message){switch(_this._log.debug("Incoming: ",message),message.type){case"network_quality":_this._handleNetworkQualityMessage(message)}}))})),_this._sendNetworkQualityInputs(),_this}return __extends(NetworkQualitySignaling,_super),Object.defineProperty(NetworkQualitySignaling.prototype,"level",{get:function(){return this._level},enumerable:!1,configurable:!0}),Object.defineProperty(NetworkQualitySignaling.prototype,"levels",{get:function(){return this._levels},enumerable:!1,configurable:!0}),Object.defineProperty(NetworkQualitySignaling.prototype,"remoteLevels",{get:function(){return this._remoteLevels},enumerable:!1,configurable:!0}),NetworkQualitySignaling.prototype._handleNetworkQualityMessage=function(message){var _this=this,updated=!1,level=null,local=message?message.local:null;"number"==typeof local?(level=local,this._levels=null):"object"==typeof local&&local&&(this._levels=local,level="number"==typeof local.level?local.level:Math.min(local.audio.send,local.audio.recv,local.video.send,local.video.recv)),null!==level&&this.level!==level&&(this._level=level,updated=!0),this._remoteLevels=message&&message.remotes?message.remotes.reduce((function(levels,obj){return(_this._remoteLevels.get(obj.sid)||{}).level!==obj.level&&(updated=!0),levels.set(obj.sid,obj)}),new Map):this._remoteLevels,updated&&this.emit("updated"),this._resendTimer.setDelay(5e3),this._resendTimer.isSet&&setTimeout((function(){return _this._sendNetworkQualityInputs()}),1e3)},NetworkQualitySignaling.prototype._sendNetworkQualityInputs=function(){var _this=this;return this._resendTimer.clear(),this._networkQualityInputs.take().then((function(networkQualityInputs){_this._transport&&_this._transport.publish(function(networkQualityInputs,networkQualityReportLevels){return Object.assign({type:"network_quality"},networkQualityInputs,networkQualityReportLevels)}(networkQualityInputs,_this._networkQualityReportLevels))})).finally((function(){_this._resendTimer.start()}))},NetworkQualitySignaling.prototype.put=function(networkQualityInputs){this._networkQualityInputs.put(networkQualityInputs)},NetworkQualitySignaling}(MediaSignaling);module.exports=NetworkQualitySignaling},B32u:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),_a=__webpack_require__("mIkg"),guessBrowser=_a.guessBrowser,isIOSChrome=_a.isIOSChrome,MediaStream=__webpack_require__("NBph").MediaStream,_b=__webpack_require__("ghd6"),waitForEvent=_b.waitForEvent,waitForSometime=_b.waitForSometime,localMediaRestartDeferreds=__webpack_require__("jxCJ"),MediaTrack=function(_super){function MediaTrack(mediaTrackTransceiver,options){var _this=this;options=Object.assign({playPausedElementsIfNotBackgrounded:("safari"===guessBrowser()||isIOSChrome())&&"object"==typeof document&&"function"==typeof document.addEventListener&&"string"==typeof document.visibilityState},options),_this=_super.call(this,mediaTrackTransceiver.id,mediaTrackTransceiver.kind,options)||this;var isStarted=!1;return options=Object.assign({MediaStream:MediaStream},options),Object.defineProperties(_this,{_attachments:{value:new Set},_dummyEl:{value:null,writable:!0},_elShims:{value:new WeakMap},_isStarted:{get:function(){return isStarted},set:function(_isStarted){isStarted=_isStarted}},_playPausedElementsIfNotBackgrounded:{value:options.playPausedElementsIfNotBackgrounded},_shouldShimAttachedElements:{value:options.workaroundWebKitBug212780||options.playPausedElementsIfNotBackgrounded},_unprocessedTrack:{value:null,writable:!0},_MediaStream:{value:options.MediaStream},isStarted:{enumerable:!0,get:function(){return isStarted}},mediaStreamTrack:{enumerable:!0,get:function(){return this._unprocessedTrack||mediaTrackTransceiver.track}},processedTrack:{enumerable:!0,value:null,writable:!0}}),_this._initialize(),_this}return __extends(MediaTrack,_super),MediaTrack.prototype._start=function(){this._log.debug("Started"),this._isStarted=!0,this._dummyEl&&(this._dummyEl.oncanplay=null),this.emit("started",this)},MediaTrack.prototype._initialize=function(){var self=this;this._log.debug("Initializing"),this._dummyEl=this._createElement(),this.mediaStreamTrack.addEventListener("ended",(function onended(){self._end(),self.mediaStreamTrack.removeEventListener("ended",onended)})),this._dummyEl&&(this._dummyEl.muted=!0,this._dummyEl.oncanplay=this._start.bind(this,this._dummyEl),this._attach(this._dummyEl,this.mediaStreamTrack),this._attachments.delete(this._dummyEl))},MediaTrack.prototype._end=function(){this._log.debug("Ended"),this._dummyEl&&(this._dummyEl.remove(),this._dummyEl.srcObject=null,this._dummyEl.oncanplay=null,this._dummyEl=null)},MediaTrack.prototype.attach=function(el){var _this=this;if("string"==typeof el?el=this._selectElement(el):el||(el=this._createElement()),this._log.debug("Attempting to attach to element:",el),el=this._attach(el),this._shouldShimAttachedElements&&!this._elShims.has(el)){var onUnintentionallyPaused=this._playPausedElementsIfNotBackgrounded?function(){return function(el,log){var tag=el.tagName.toLowerCase();log.warn("Unintentionally paused:",el),Promise.race([waitForEvent(document,"visibilitychange"),waitForSometime(1e3)]).then((function(){"visible"===document.visibilityState&&localMediaRestartDeferreds.whenResolved("audio").then((function(){return log.info("Playing unintentionally paused <"+tag+"> element"),log.debug("Element:",el),el.play()})).then((function(){log.info("Successfully played unintentionally paused <"+tag+"> element"),log.debug("Element:",el)})).catch((function(error){log.warn("Error while playing unintentionally paused <"+tag+"> element:",{error:error,el:el})}))}))}(el,_this._log)}:null;this._elShims.set(el,function(el,onUnintentionallyPaused){void 0===onUnintentionallyPaused&&(onUnintentionallyPaused=null);var origPause=el.pause,origPlay=el.play,pausedIntentionally=!1;el.pause=function(){return pausedIntentionally=!0,origPause.call(el)},el.play=function(){return pausedIntentionally=!1,origPlay.call(el)};var onPause=onUnintentionallyPaused?function(){pausedIntentionally||onUnintentionallyPaused()}:null;return onPause&&el.addEventListener("pause",onPause),{pausedIntentionally:function(){return pausedIntentionally},unShim:function(){el.pause=origPause,el.play=origPlay,onPause&&el.removeEventListener("pause",onPause)}}}(el,onUnintentionallyPaused))}return el},MediaTrack.prototype._attach=function(el,mediaStreamTrack){void 0===mediaStreamTrack&&(mediaStreamTrack=this.processedTrack||this.mediaStreamTrack);var mediaStream=el.srcObject;return mediaStream instanceof this._MediaStream||(mediaStream=new this._MediaStream),mediaStream["audio"===mediaStreamTrack.kind?"getAudioTracks":"getVideoTracks"]().forEach((function(track){mediaStream.removeTrack(track)})),mediaStream.addTrack(mediaStreamTrack),el.srcObject=mediaStream,el.autoplay=!0,el.playsInline=!0,this._attachments.has(el)||this._attachments.add(el),el},MediaTrack.prototype._selectElement=function(selector){var el=document.querySelector(selector);if(!el)throw new Error("Selector matched no element: "+selector);return el},MediaTrack.prototype._updateElementsMediaStreamTrack=function(){var _this=this;this._log.debug("Reattaching all elements to update mediaStreamTrack"),this._getAllAttachedElements().forEach((function(el){return _this._attach(el)}))},MediaTrack.prototype._createElement=function(){return"undefined"!=typeof document?document.createElement(this.kind):null},MediaTrack.prototype.detach=function(el){var els;return els="string"==typeof el?[this._selectElement(el)]:el?[el]:this._getAllAttachedElements(),this._log.debug("Attempting to detach from elements:",els),this._detachElements(els),el?els[0]:els},MediaTrack.prototype._detachElements=function(elements){return elements.map(this._detachElement.bind(this))},MediaTrack.prototype._detachElement=function(el){if(!this._attachments.has(el))return el;var mediaStream=el.srcObject;return mediaStream instanceof this._MediaStream&&mediaStream.removeTrack(this.processedTrack||this.mediaStreamTrack),this._attachments.delete(el),this._shouldShimAttachedElements&&this._elShims.has(el)&&(this._elShims.get(el).unShim(),this._elShims.delete(el)),el},MediaTrack.prototype._getAllAttachedElements=function(){var els=[];return this._attachments.forEach((function(el){els.push(el)})),els},MediaTrack}(__webpack_require__("NCuz"));module.exports=MediaTrack},"B6Q+":function(module,exports,__webpack_require__){"use strict";var hasSymbols=__webpack_require__("FpZJ");module.exports=function(){return hasSymbols()&&!!Symbol.toStringTag}},BG0f:function(module,exports,__webpack_require__){"use strict";var ChromeRTCSessionDescription=__webpack_require__("+TTF"),EventTarget=__webpack_require__("bQMn"),inherits=__webpack_require__("/E53").inherits,Latch=__webpack_require__("14BE"),MediaStream=__webpack_require__("1go7"),RTCRtpSenderShim=__webpack_require__("0tP7"),sdpUtils=__webpack_require__("L1nb"),util=__webpack_require__("mIkg"),isIOSChrome=__webpack_require__("mIkg").isIOSChrome,isUnifiedPlan="unified"===sdpUtils.getSdpFormat();function ChromeRTCPeerConnection(configuration,constraints){if(!(this instanceof ChromeRTCPeerConnection))return new ChromeRTCPeerConnection(configuration,constraints);EventTarget.call(this),configuration=configuration||{};var newConfiguration=Object.assign(configuration.iceTransportPolicy?{iceTransports:configuration.iceTransportPolicy}:{},configuration);util.interceptEvent(this,"datachannel"),util.interceptEvent(this,"signalingstatechange");var sdpFormat=sdpUtils.getSdpFormat(newConfiguration.sdpSemantics),peerConnection=new RTCPeerConnection(newConfiguration,constraints);Object.defineProperties(this,{_appliedTracksToSSRCs:{value:new Map,writable:!0},_localStream:{value:new MediaStream},_peerConnection:{value:peerConnection},_pendingLocalOffer:{value:null,writable:!0},_pendingRemoteOffer:{value:null,writable:!0},_rolledBackTracksToSSRCs:{value:new Map,writable:!0},_sdpFormat:{value:sdpFormat},_senders:{value:new Map},_signalingStateLatch:{value:new Latch},_tracksToSSRCs:{value:new Map,writable:!0},localDescription:{enumerable:!0,get:function(){return this._pendingLocalOffer?this._pendingLocalOffer:peerConnection.localDescription}},remoteDescription:{enumerable:!0,get:function(){return this._pendingRemoteOffer?this._pendingRemoteOffer:peerConnection.remoteDescription}},signalingState:{enumerable:!0,get:function(){return this._pendingLocalOffer?"have-local-offer":this._pendingRemoteOffer?"have-remote-offer":peerConnection.signalingState}}});var self=this;peerConnection.addEventListener("datachannel",(function(event){shimDataChannel(event.channel),self.dispatchEvent(event)})),peerConnection.addEventListener("signalingstatechange",(function(){"stable"===peerConnection.signalingState&&(self._appliedTracksToSSRCs=new Map(self._tracksToSSRCs)),self._pendingLocalOffer||self._pendingRemoteOffer||self.dispatchEvent.apply(self,arguments)})),peerConnection.ontrack=function(){},"function"!=typeof RTCPeerConnection.prototype.addTrack&&peerConnection.addStream(this._localStream),util.proxyProperties(RTCPeerConnection.prototype,this,peerConnection)}function setDescription(peerConnection,local,description){var promise,offer,pendingLocalOffer=local?peerConnection._pendingLocalOffer:peerConnection._pendingRemoteOffer,intermediateState=local?"have-local-offer":"have-remote-offer",setLocalDescription=local?"setLocalDescription":"setRemoteDescription";if(!local&&(local?peerConnection._pendingRemoteOffer:peerConnection._pendingLocalOffer)&&"answer"===description.type)promise=function(peerConnection,answer){return peerConnection._peerConnection.setLocalDescription(peerConnection._pendingLocalOffer).then((function(){return peerConnection._pendingLocalOffer=null,peerConnection.setRemoteDescription(answer)})).then((function(){peerConnection._signalingStateLatch.lower()}))}(peerConnection,description);else if("offer"===description.type){if(peerConnection.signalingState!==intermediateState&&"stable"!==peerConnection.signalingState)return Promise.reject(new Error("Cannot set "+(local?"local":"remote")+" offer in state "+peerConnection.signalingState));pendingLocalOffer||"low"!==peerConnection._signalingStateLatch.state||peerConnection._signalingStateLatch.raise();var previousSignalingState=peerConnection.signalingState;offer=unwrap(description),local?peerConnection._pendingLocalOffer=offer:peerConnection._pendingRemoteOffer=offer,promise=Promise.resolve(),peerConnection.signalingState!==previousSignalingState&&promise.then((function(){peerConnection.dispatchEvent(new Event("signalingstatechange"))}))}else"rollback"===description.type&&(peerConnection.signalingState!==intermediateState?promise=Promise.reject(new Error("Cannot rollback "+(local?"local":"remote")+" description in "+peerConnection.signalingState)):(local?peerConnection._pendingLocalOffer=null:peerConnection._pendingRemoteOffer=null,peerConnection._rolledBackTracksToSSRCs=new Map(peerConnection._tracksToSSRCs),peerConnection._tracksToSSRCs=new Map(peerConnection._appliedTracksToSSRCs),(promise=Promise.resolve()).then((function(){peerConnection.dispatchEvent(new Event("signalingstatechange"))}))));return promise||peerConnection._peerConnection[setLocalDescription](unwrap(description))}function hasReceiversForTracksOfKind(peerConnection,kind){return!!peerConnection.getTransceivers().find((function(transceiver){return transceiver.receiver&&transceiver.receiver.track&&transceiver.receiver.track.kind===kind}))}function unwrap(description){return description instanceof ChromeRTCSessionDescription&&description._description?description._description:new RTCSessionDescription(description)}function needsMaxPacketLifeTimeShim(){return"maxRetransmitTime"in RTCDataChannel.prototype&&!("maxPacketLifeTime"in RTCDataChannel.prototype)}function shimDataChannel(dataChannel){return Object.defineProperty(dataChannel,"maxRetransmits",{value:65535===dataChannel.maxRetransmits?null:dataChannel.maxRetransmits}),needsMaxPacketLifeTimeShim()&&Object.defineProperty(dataChannel,"maxPacketLifeTime",{value:65535===dataChannel.maxRetransmitTime?null:dataChannel.maxRetransmitTime}),dataChannel}function updateTrackIdsToSSRCs(sdpFormat,tracksToSSRCs,sdp){return"unified"===sdpFormat?sdpUtils.updateUnifiedPlanTrackIdsToSSRCs(tracksToSSRCs,sdp):sdpUtils.updatePlanBTrackIdsToSSRCs(tracksToSSRCs,sdp)}inherits(ChromeRTCPeerConnection,EventTarget),"function"!=typeof RTCPeerConnection.prototype.addTrack?(ChromeRTCPeerConnection.prototype.addTrack=function(){var args=[].slice.call(arguments),track=args[0];if("closed"===this._peerConnection.signalingState)throw new Error("Cannot add MediaStreamTrack ["+track.id+", "+track.kind+"]: RTCPeerConnection is closed");var sender=this._senders.get(track);if(sender&&sender.track)throw new Error("Cannot add MediaStreamTrack ["+track.id+", "+track.kind+"]: RTCPeerConnection already has it");return this._peerConnection.removeStream(this._localStream),this._localStream.addTrack(track),this._peerConnection.addStream(this._localStream),sender=new RTCRtpSenderShim(track),this._senders.set(track,sender),sender},ChromeRTCPeerConnection.prototype.removeTrack=function(sender){if("closed"===this._peerConnection.signalingState)throw new Error("Cannot remove MediaStreamTrack: RTCPeerConnection is closed");var track=sender.track;track&&(sender=this._senders.get(track))&&sender.track&&(sender.track=null,this._peerConnection.removeStream(this._localStream),this._localStream.removeTrack(track),this._peerConnection.addStream(this._localStream))},ChromeRTCPeerConnection.prototype.getSenders=function(){return Array.from(this._senders.values())}):ChromeRTCPeerConnection.prototype.removeTrack=function(sender){if("closed"===this._peerConnection.signalingState)throw new Error("Cannot remove MediaStreamTrack: RTCPeerConnection is closed");try{this._peerConnection.removeTrack(sender)}catch(e){}},ChromeRTCPeerConnection.prototype.addIceCandidate=function(candidate){var promise,args=[].slice.call(arguments),self=this;return promise="have-remote-offer"===this.signalingState?this._signalingStateLatch.when("low").then((function(){return self._peerConnection.addIceCandidate(candidate)})):this._peerConnection.addIceCandidate(candidate),args.length>1?util.legacyPromise(promise,args[1],args[2]):promise},ChromeRTCPeerConnection.prototype.close=function(){"closed"!==this.signalingState&&(this._pendingLocalOffer=null,this._pendingRemoteOffer=null,this._peerConnection.close())},ChromeRTCPeerConnection.prototype.createAnswer=function(){var promise,args=[].slice.call(arguments),self=this;return promise=this._pendingRemoteOffer?this._peerConnection.setRemoteDescription(this._pendingRemoteOffer).then((function(){return self._signalingStateLatch.lower(),self._peerConnection.createAnswer()})).then((function(answer){return self._pendingRemoteOffer=null,self._rolledBackTracksToSSRCs.clear(),new ChromeRTCSessionDescription({type:"answer",sdp:updateTrackIdsToSSRCs(self._sdpFormat,self._tracksToSSRCs,answer.sdp)})}),(function(error){throw self._pendingRemoteOffer=null,error})):this._peerConnection.createAnswer().then((function(answer){return self._rolledBackTracksToSSRCs.clear(),new ChromeRTCSessionDescription({type:"answer",sdp:updateTrackIdsToSSRCs(self._sdpFormat,self._tracksToSSRCs,answer.sdp)})})),args.length>1?util.legacyPromise(promise,args[0],args[1]):promise},ChromeRTCPeerConnection.prototype.createOffer=function(){var args=[].slice.call(arguments),options=(args.length>1?args[2]:args[0])||{},self=this;if(isIOSChrome()){if(options.offerToReceiveVideo&&!this._audioTransceiver&&(!isUnifiedPlan||!hasReceiversForTracksOfKind(this,"audio"))){delete options.offerToReceiveAudio;try{this._audioTransceiver=isUnifiedPlan?this.addTransceiver("audio",{direction:"recvonly"}):this.addTransceiver("audio")}catch(e){return Promise.reject(e)}}if(options.offerToReceiveVideo&&!this._videoTransceiver&&(!isUnifiedPlan||!hasReceiversForTracksOfKind(this,"video"))){delete options.offerToReceiveVideo;try{this._videoTransceiver=isUnifiedPlan?this.addTransceiver("video",{direction:"recvonly"}):this.addTransceiver("video")}catch(e){return Promise.reject(e)}}}var promise=this._peerConnection.createOffer(options).then((function(offer){return self._rolledBackTracksToSSRCs.clear(),new ChromeRTCSessionDescription({type:offer.type,sdp:updateTrackIdsToSSRCs(self._sdpFormat,self._tracksToSSRCs,offer.sdp)})}));return args.length>1?util.legacyPromise(promise,args[0],args[1]):promise},ChromeRTCPeerConnection.prototype.createDataChannel=function(label,dataChannelDict){dataChannelDict=function(dataChannelDict){return dataChannelDict=Object.assign({},dataChannelDict),needsMaxPacketLifeTimeShim()&&"maxPacketLifeTime"in dataChannelDict&&(dataChannelDict.maxRetransmitTime=dataChannelDict.maxPacketLifeTime),dataChannelDict}(dataChannelDict);var dataChannel=this._peerConnection.createDataChannel(label,dataChannelDict);return shimDataChannel(dataChannel),dataChannel},ChromeRTCPeerConnection.prototype.setLocalDescription=function(){var args=[].slice.call(arguments),description=args[0];this._rolledBackTracksToSSRCs.size>0&&(this._tracksToSSRCs=new Map(this._rolledBackTracksToSSRCs),this._rolledBackTracksToSSRCs.clear());var promise=setDescription(this,!0,description);return args.length>1?util.legacyPromise(promise,args[1],args[2]):promise},ChromeRTCPeerConnection.prototype.setRemoteDescription=function(){var args=[].slice.call(arguments),description=args[0];this._rolledBackTracksToSSRCs.clear();var promise=setDescription(this,!1,description);return args.length>1?util.legacyPromise(promise,args[1],args[2]):promise},util.delegateMethods(RTCPeerConnection.prototype,ChromeRTCPeerConnection.prototype,"_peerConnection"),module.exports=ChromeRTCPeerConnection},BMBc:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),LocalVideoTrackStats=function(_super){function LocalVideoTrackStats(trackId,statsReport,prepareForInsights){var _this=_super.call(this,trackId,statsReport,prepareForInsights)||this,captureDimensions=null;"number"==typeof statsReport.frameWidthInput&&"number"==typeof statsReport.frameHeightInput&&(captureDimensions={},Object.defineProperties(captureDimensions,{width:{value:statsReport.frameWidthInput,enumerable:!0},height:{value:statsReport.frameHeightInput,enumerable:!0}}));var dimensions=null;return"number"==typeof statsReport.frameWidthSent&&"number"==typeof statsReport.frameHeightSent&&(dimensions={},Object.defineProperties(dimensions,{width:{value:statsReport.frameWidthSent,enumerable:!0},height:{value:statsReport.frameHeightSent,enumerable:!0}})),Object.defineProperties(_this,{captureDimensions:{value:captureDimensions,enumerable:!0},dimensions:{value:dimensions,enumerable:!0},captureFrameRate:{value:"number"==typeof statsReport.frameRateInput?statsReport.frameRateInput:null,enumerable:!0},frameRate:{value:"number"==typeof statsReport.frameRateSent?statsReport.frameRateSent:null,enumerable:!0}}),_this}return __extends(LocalVideoTrackStats,_super),LocalVideoTrackStats}(__webpack_require__("zYCr"));module.exports=LocalVideoTrackStats},CQu1:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},__awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):(value=result.value,value instanceof P?value:new P((function(resolve){resolve(value)}))).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!((t=(t=_.trys).length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.runPreflight=exports.PreflightTest=void 0;var constants_1=__webpack_require__("xwWy"),timer_1=__webpack_require__("mbHc"),mos_1=__webpack_require__("ok1L"),getCombinedConnectionStats_1=__webpack_require__("VueP"),getturncredentials_1=__webpack_require__("eqpY"),makestat_1=__webpack_require__("W/pi"),syntheticaudio_1=__webpack_require__("JRNH"),syntheticvideo_1=__webpack_require__("thyc"),util_1=__webpack_require__("ghd6"),WS_SERVER=__webpack_require__("xwWy").WS_SERVER,Log=__webpack_require__("S3Hu"),EventEmitter=__webpack_require__("mAYT"),MovingAverageDelta=__webpack_require__("qOIT"),EventObserver=__webpack_require__("VgEY"),InsightsPublisher=__webpack_require__("tPbP"),_a=__webpack_require__("6kkQ"),createSID=_a.createSID,sessionSID=_a.sessionSID,_b=__webpack_require__("5wwa"),SignalingConnectionTimeoutError=_b.SignalingConnectionTimeoutError,MediaConnectionError=_b.MediaConnectionError;function notEmpty(value){return null!=value}var nInstances=0,PreflightTest=function(_super){function PreflightTest(token,options){var _this=_super.call(this)||this;_this._testTiming=new timer_1.Timer,_this._dtlsTiming=new timer_1.Timer,_this._iceTiming=new timer_1.Timer,_this._peerConnectionTiming=new timer_1.Timer,_this._mediaTiming=new timer_1.Timer,_this._connectTiming=new timer_1.Timer,_this._sentBytesMovingAverage=new MovingAverageDelta,_this._packetLossMovingAverage=new MovingAverageDelta,_this._progressEvents=[],_this._receivedBytesMovingAverage=new MovingAverageDelta;var _a=options.environment,environment=void 0===_a?"prod":_a,_b=options.region,_c=options.duration,duration=void 0===_c?1e4:_c,wsServer=options.wsServer||WS_SERVER(environment,void 0===_b?"gll":_b);return _this._log=new Log("default",_this,constants_1.DEFAULT_LOG_LEVEL,constants_1.DEFAULT_LOGGER_NAME),_this._testDuration=duration,_this._instanceId=nInstances++,_this._testTiming.start(),_this._runPreflightTest(token,environment,wsServer),_this}return __extends(PreflightTest,_super),PreflightTest.prototype.toString=function(){return"[Preflight #"+this._instanceId+"]"},PreflightTest.prototype.stop=function(){this._stopped=!0},PreflightTest.prototype._generatePreflightReport=function(collectedStats){return this._testTiming.stop(),{testTiming:this._testTiming.getTimeMeasurement(),networkTiming:{dtls:this._dtlsTiming.getTimeMeasurement(),ice:this._iceTiming.getTimeMeasurement(),peerConnection:this._peerConnectionTiming.getTimeMeasurement(),connect:this._connectTiming.getTimeMeasurement(),media:this._mediaTiming.getTimeMeasurement()},stats:{jitter:makestat_1.makeStat(null==collectedStats?void 0:collectedStats.jitter),rtt:makestat_1.makeStat(null==collectedStats?void 0:collectedStats.rtt),packetLoss:makestat_1.makeStat(null==collectedStats?void 0:collectedStats.packetLoss)},selectedIceCandidatePairStats:collectedStats?collectedStats.selectedIceCandidatePairStats:null,iceCandidateStats:collectedStats?collectedStats.iceCandidateStats:[],progressEvents:this._progressEvents,mos:makestat_1.makeStat(null==collectedStats?void 0:collectedStats.mos)}},PreflightTest.prototype._executePreflightStep=function(stepName,step,timeoutError){return __awaiter(this,void 0,void 0,(function(){var MAX_STEP_DURATION,stepPromise,timer,timeoutPromise;return __generator(this,(function(_a){switch(_a.label){case 0:if(this._log.debug("Executing step: ",stepName),MAX_STEP_DURATION=this._testDuration+1e4,this._stopped)throw new Error("stopped");stepPromise=Promise.resolve().then(step),timer=null,timeoutPromise=new Promise((function(_resolve,reject){timer=setTimeout((function(){reject(timeoutError||new Error(stepName+" timeout."))}),MAX_STEP_DURATION)})),_a.label=1;case 1:return _a.trys.push([1,,3,4]),[4,Promise.race([timeoutPromise,stepPromise])];case 2:return[2,_a.sent()];case 3:return null!==timer&&clearTimeout(timer),[7];case 4:return[2]}}))}))},PreflightTest.prototype._collectNetworkTimings=function(pc){var _this=this;return new Promise((function(resolve){var dtlsTransport;pc.addEventListener("iceconnectionstatechange",(function(){"checking"===pc.iceConnectionState&&_this._iceTiming.start(),"connected"===pc.iceConnectionState&&(_this._iceTiming.stop(),_this._updateProgress("iceConnected"),(!dtlsTransport||dtlsTransport&&"connected"===dtlsTransport.state)&&resolve())})),pc.addEventListener("connectionstatechange",(function(){"connecting"===pc.connectionState&&_this._peerConnectionTiming.start(),"connected"===pc.connectionState&&(_this._peerConnectionTiming.stop(),_this._updateProgress("peerConnectionConnected"))}));var transport=pc.getSenders().map((function(sender){return sender.transport})).find(notEmpty);void 0!==transport&&(dtlsTransport=transport).addEventListener("statechange",(function(){"connecting"===dtlsTransport.state&&_this._dtlsTiming.start(),"connected"===dtlsTransport.state&&(_this._dtlsTiming.stop(),_this._updateProgress("dtlsConnected"),"connected"===pc.iceConnectionState&&resolve())}))}))},PreflightTest.prototype._setupInsights=function(_a){var _b=_a.environment,_c=_a.realm,eventPublisher=new InsightsPublisher(_a.token,constants_1.SDK_NAME,constants_1.SDK_VERSION,void 0===_b?constants_1.DEFAULT_ENVIRONMENT:_b,void 0===_c?constants_1.DEFAULT_REALM:_c,{});eventPublisher.connect("PREFLIGHT_ROOM_SID","PREFLIGHT_PARTICIPANT");var eventObserver=new EventObserver(eventPublisher,Date.now(),this._log);return{reportToInsights:function(_a){var _b,_c,report=_a.report,jitterStats=report.stats.jitter||void 0,rttStats=report.stats.rtt||void 0,packetLossStats=report.stats.packetLoss||void 0,mosStats=report.mos||void 0,candidateTypeToProtocols=new Map;report.iceCandidateStats.forEach((function(candidateStats){if(candidateStats.candidateType&&candidateStats.protocol){var protocols=candidateTypeToProtocols.get(candidateStats.candidateType)||[];protocols.indexOf(candidateStats.protocol)<0&&protocols.push(candidateStats.protocol),candidateTypeToProtocols.set(candidateStats.candidateType,protocols)}}));var iceCandidateStats=JSON.stringify(Object.fromEntries(candidateTypeToProtocols)),insightsReport={name:"report",group:"preflight",level:report.error?"error":"info",payload:{sessionSID:sessionSID,preflightSID:createSID("PF"),progressEvents:JSON.stringify(report.progressEvents),testTiming:report.testTiming,dtlsTiming:report.networkTiming.dtls,iceTiming:report.networkTiming.ice,peerConnectionTiming:report.networkTiming.peerConnection,connectTiming:report.networkTiming.connect,mediaTiming:report.networkTiming.media,selectedLocalCandidate:null===(_b=report.selectedIceCandidatePairStats)||void 0===_b?void 0:_b.localCandidate,selectedRemoteCandidate:null===(_c=report.selectedIceCandidatePairStats)||void 0===_c?void 0:_c.remoteCandidate,iceCandidateStats:iceCandidateStats,jitterStats:jitterStats,rttStats:rttStats,packetLossStats:packetLossStats,mosStats:mosStats,error:report.error}};eventObserver.emit("event",insightsReport),setTimeout((function(){return eventPublisher.disconnect()}),2e3)}}},PreflightTest.prototype._runPreflightTest=function(token,environment,wsServer){return __awaiter(this,void 0,void 0,(function(){var localTracks,pcs,reportToInsights,elements_1,iceServers,senderPC_1,receiverPC_1,remoteTracks_1,collectedStats_1,report,error_1,preflightReport,_this=this;return __generator(this,(function(_a){switch(_a.label){case 0:localTracks=[],pcs=[],reportToInsights=this._setupInsights({token:token,environment:environment}).reportToInsights,_a.label=1;case 1:return _a.trys.push([1,8,9,10]),elements_1=[],[4,this._executePreflightStep("Acquire media",(function(){return[syntheticaudio_1.syntheticAudio(),syntheticvideo_1.syntheticVideo({width:640,height:480})]}))];case 2:return localTracks=_a.sent(),this._updateProgress("mediaAcquired"),this.emit("debug",{localTracks:localTracks}),this._connectTiming.start(),[4,this._executePreflightStep("Get turn credentials",(function(){return getturncredentials_1.getTurnCredentials(token,wsServer)}),new SignalingConnectionTimeoutError)];case 3:return iceServers=_a.sent(),this._connectTiming.stop(),this._updateProgress("connected"),senderPC_1=new RTCPeerConnection({iceServers:iceServers,iceTransportPolicy:"relay",bundlePolicy:"max-bundle"}),receiverPC_1=new RTCPeerConnection({iceServers:iceServers,bundlePolicy:"max-bundle"}),pcs.push(senderPC_1),pcs.push(receiverPC_1),this._mediaTiming.start(),[4,this._executePreflightStep("Setup Peer Connections",(function(){return __awaiter(_this,void 0,void 0,(function(){var remoteTracksPromise,offer,updatedOffer,answer;return __generator(this,(function(_a){switch(_a.label){case 0:return senderPC_1.addEventListener("icecandidate",(function(event){return event.candidate&&receiverPC_1.addIceCandidate(event.candidate)})),receiverPC_1.addEventListener("icecandidate",(function(event){return event.candidate&&senderPC_1.addIceCandidate(event.candidate)})),localTracks.forEach((function(track){return senderPC_1.addTrack(track)})),remoteTracksPromise=new Promise((function(resolve){var remoteTracks=[];receiverPC_1.addEventListener("track",(function(event){remoteTracks.push(event.track),remoteTracks.length===localTracks.length&&resolve(remoteTracks)}))})),[4,senderPC_1.createOffer()];case 1:return offer=_a.sent(),[4,senderPC_1.setLocalDescription(updatedOffer=offer)];case 2:return _a.sent(),[4,receiverPC_1.setRemoteDescription(updatedOffer)];case 3:return _a.sent(),[4,receiverPC_1.createAnswer()];case 4:return answer=_a.sent(),[4,receiverPC_1.setLocalDescription(answer)];case 5:return _a.sent(),[4,senderPC_1.setRemoteDescription(answer)];case 6:return _a.sent(),[4,this._collectNetworkTimings(senderPC_1)];case 7:return _a.sent(),[2,remoteTracksPromise]}}))}))}),new MediaConnectionError)];case 4:return remoteTracks_1=_a.sent(),this.emit("debug",{remoteTracks:remoteTracks_1}),remoteTracks_1.forEach((function(track){track.addEventListener("ended",(function(){return _this._log.warn(track.kind+":ended")})),track.addEventListener("mute",(function(){return _this._log.warn(track.kind+":muted")})),track.addEventListener("unmute",(function(){return _this._log.warn(track.kind+":unmuted")}))})),this._updateProgress("mediaSubscribed"),[4,this._executePreflightStep("Wait for tracks to start",(function(){return new Promise((function(resolve){var element=document.createElement("video");element.autoplay=!0,element.playsInline=!0,element.muted=!0,element.srcObject=new MediaStream(remoteTracks_1),elements_1.push(element),_this.emit("debugElement",element),element.oncanplay=resolve}))}),new MediaConnectionError)];case 5:return _a.sent(),this._mediaTiming.stop(),this._updateProgress("mediaStarted"),[4,this._executePreflightStep("Collect stats for duration",(function(){return _this._collectRTCStatsForDuration(_this._testDuration,{mos:[],jitter:[],rtt:[],outgoingBitrate:[],incomingBitrate:[],packetLoss:[],selectedIceCandidatePairStats:null,iceCandidateStats:[]},senderPC_1,receiverPC_1)}))];case 6:return collectedStats_1=_a.sent(),[4,this._executePreflightStep("Generate report",(function(){return _this._generatePreflightReport(collectedStats_1)}))];case 7:return report=_a.sent(),reportToInsights({report:report}),this.emit("completed",report),[3,10];case 8:return error_1=_a.sent(),preflightReport=this._generatePreflightReport(),reportToInsights({report:__assign(__assign({},preflightReport),{error:null==error_1?void 0:error_1.toString()})}),this.emit("failed",error_1,preflightReport),[3,10];case 9:return pcs.forEach((function(pc){return pc.close()})),localTracks.forEach((function(track){return track.stop()})),[7];case 10:return[2]}}))}))},PreflightTest.prototype._collectRTCStats=function(collectedStats,senderPC,receiverPC){return __awaiter(this,void 0,void 0,(function(){var combinedStats,timestamp,bytesSent,bytesReceived,packets,packetsLost,roundTripTime,jitter,selectedIceCandidatePairStats,iceCandidateStats,hasLastData,fractionPacketLost,percentPacketsLost,score;return __generator(this,(function(_a){switch(_a.label){case 0:return[4,getCombinedConnectionStats_1.getCombinedConnectionStats({publisher:senderPC,subscriber:receiverPC})];case 1:return combinedStats=_a.sent(),timestamp=combinedStats.timestamp,bytesSent=combinedStats.bytesSent,bytesReceived=combinedStats.bytesReceived,packets=combinedStats.packets,packetsLost=combinedStats.packetsLost,roundTripTime=combinedStats.roundTripTime,selectedIceCandidatePairStats=combinedStats.selectedIceCandidatePairStats,iceCandidateStats=combinedStats.iceCandidateStats,hasLastData=collectedStats.jitter.length>0,collectedStats.jitter.push(jitter=combinedStats.jitter),collectedStats.rtt.push(roundTripTime),this._sentBytesMovingAverage.putSample(bytesSent,timestamp),this._receivedBytesMovingAverage.putSample(bytesReceived,timestamp),this._packetLossMovingAverage.putSample(packetsLost,packets),hasLastData&&(collectedStats.outgoingBitrate.push(1e3*this._sentBytesMovingAverage.get()*8),collectedStats.incomingBitrate.push(1e3*this._receivedBytesMovingAverage.get()*8),fractionPacketLost=this._packetLossMovingAverage.get(),percentPacketsLost=Math.min(100,100*fractionPacketLost),collectedStats.packetLoss.push(percentPacketsLost),score=mos_1.calculateMOS(roundTripTime,jitter,fractionPacketLost),collectedStats.mos.push(score)),collectedStats.selectedIceCandidatePairStats||(collectedStats.selectedIceCandidatePairStats=selectedIceCandidatePairStats),0===collectedStats.iceCandidateStats.length&&(collectedStats.iceCandidateStats=iceCandidateStats),[2]}}))}))},PreflightTest.prototype._collectRTCStatsForDuration=function(duration,collectedStats,senderPC,receiverPC){return __awaiter(this,void 0,void 0,(function(){var startTime,STAT_INTERVAL,remainingDuration;return __generator(this,(function(_a){switch(_a.label){case 0:return startTime=Date.now(),STAT_INTERVAL=Math.min(1e3,duration),[4,util_1.waitForSometime(STAT_INTERVAL)];case 1:return _a.sent(),[4,this._collectRTCStats(collectedStats,senderPC,receiverPC)];case 2:return _a.sent(),(remainingDuration=duration-(Date.now()-startTime))>0?[4,this._collectRTCStatsForDuration(remainingDuration,collectedStats,senderPC,receiverPC)]:[3,4];case 3:collectedStats=_a.sent(),_a.label=4;case 4:return[2,collectedStats]}}))}))},PreflightTest.prototype._updateProgress=function(name){var duration=Date.now()-this._testTiming.getTimeMeasurement().start;this._progressEvents.push({duration:duration,name:name}),this.emit("progress",name)},PreflightTest}(EventEmitter);exports.PreflightTest=PreflightTest,exports.runPreflight=function(token,options){return void 0===options&&(options={}),new PreflightTest(token,options)}},CSzv:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),LocalAudioTrackPublication=function(_super){function LocalAudioTrackPublication(signaling,track,unpublish,options){return _super.call(this,signaling,track,unpublish,options)||this}return __extends(LocalAudioTrackPublication,_super),LocalAudioTrackPublication.prototype.toString=function(){return"[LocalAudioTrackPublication #"+this._instanceId+": "+this.trackSid+"]"},LocalAudioTrackPublication}(__webpack_require__("mb7l"));module.exports=LocalAudioTrackPublication},Cj46:function(module,exports,__webpack_require__){"use strict";var GeneratorFunction,toStr=Object.prototype.toString,fnToStr=Function.prototype.toString,isFnRegex=/^\s*(?:function)?\*/,hasToStringTag=__webpack_require__("B6Q+")(),getProto=Object.getPrototypeOf;module.exports=function(fn){if("function"!=typeof fn)return!1;if(isFnRegex.test(fnToStr.call(fn)))return!0;if(!hasToStringTag)return"[object GeneratorFunction]"===toStr.call(fn);if(!getProto)return!1;if(void 0===GeneratorFunction){var generatorFunc=function(){if(!hasToStringTag)return!1;try{return Function("return function*() {}")()}catch(e){}}();GeneratorFunction=!!generatorFunc&&getProto(generatorFunc)}return getProto(fn)===GeneratorFunction}},Czg6:function(module,exports,__webpack_require__){var Backoff=__webpack_require__("KGUp"),ExponentialBackoffStrategy=__webpack_require__("89tg"),FibonacciBackoffStrategy=__webpack_require__("HOot"),FunctionCall=__webpack_require__("QsSX");module.exports.Backoff=Backoff,module.exports.FunctionCall=FunctionCall,module.exports.FibonacciStrategy=FibonacciBackoffStrategy,module.exports.ExponentialStrategy=ExponentialBackoffStrategy,module.exports.fibonacci=function(options){return new Backoff(new FibonacciBackoffStrategy(options))},module.exports.exponential=function(options){return new Backoff(new ExponentialBackoffStrategy(options))},module.exports.call=function(fn,vargs,callback){var args=Array.prototype.slice.call(arguments);return fn=args[0],vargs=args.slice(1,args.length-1),new FunctionCall(fn,vargs,callback=args[args.length-1])}},D3zA:function(module,exports,__webpack_require__){"use strict";var implementation=__webpack_require__("aI7X");module.exports=Function.prototype.bind||implementation},"Ds+w":function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},mixinRemoteMediaTrack=__webpack_require__("A/ij"),VideoTrack=__webpack_require__("9FmL"),documentVisibilityMonitor=__webpack_require__("UBwA"),NullObserver=__webpack_require__("dI/0").NullObserver,Timeout=__webpack_require__("Y1/N"),RemoteVideoTrack=function(_super){function RemoteVideoTrack(sid,mediaTrackReceiver,isEnabled,isSwitchedOff,setPriority,setRenderHint,options){var _this=this;return options=Object.assign({clientTrackSwitchOffControl:"auto",contentPreferencesMode:"auto",enableDocumentVisibilityTurnOff:!0},options),options=Object.assign({IntersectionObserver:"undefined"==typeof IntersectionObserver||"auto"!==options.clientTrackSwitchOffControl?NullObserver:IntersectionObserver,ResizeObserver:"undefined"==typeof ResizeObserver||"auto"!==options.contentPreferencesMode?NullObserver:ResizeObserver},options),_this=_super.call(this,sid,mediaTrackReceiver,isEnabled,isSwitchedOff,setPriority,setRenderHint,options)||this,Object.defineProperties(_this,{_enableDocumentVisibilityTurnOff:{value:!0===options.enableDocumentVisibilityTurnOff&&"auto"===options.clientTrackSwitchOffControl},_documentVisibilityTurnOffCleanup:{value:null,writable:!0},_clientTrackSwitchOffControl:{value:options.clientTrackSwitchOffControl},_contentPreferencesMode:{value:options.contentPreferencesMode},_invisibleElements:{value:new WeakSet},_elToPipCallbacks:{value:new WeakMap},_elToPipWindows:{value:new WeakMap},_turnOffTimer:{value:new Timeout((function(){_this._setRenderHint({enabled:!1})}),50,!1)},_resizeObserver:{value:new options.ResizeObserver((function(entries){entries.find((function(entry){return!_this._invisibleElements.has(entry.target)}))&&maybeUpdateDimensionHint(_this)}))},_intersectionObserver:{value:new options.IntersectionObserver((function(entries){var shouldSetRenderHint=!1;entries.forEach((function(entry){!_this._invisibleElements.has(entry.target)!==entry.isIntersecting&&(entry.isIntersecting?(_this._log.debug("intersectionObserver detected: Off => On"),_this._invisibleElements.delete(entry.target)):(_this._log.debug("intersectionObserver detected: On => Off"),_this._invisibleElements.add(entry.target)),shouldSetRenderHint=!0)})),shouldSetRenderHint&&(maybeUpdateEnabledHint(_this),maybeUpdateDimensionHint(_this))}),{threshold:.25})}}),_this}return __extends(RemoteVideoTrack,_super),RemoteVideoTrack.prototype._start=function(dummyEl){var result=_super.prototype._start.call(this,dummyEl);return maybeUpdateEnabledHint(this),result},RemoteVideoTrack.prototype.switchOn=function(){if("manual"!==this._clientTrackSwitchOffControl)throw new Error('Invalid state. You can call switchOn only when bandwidthProfile.video.clientTrackSwitchOffControl is set to "manual"');return this._setRenderHint({enabled:!0}),this},RemoteVideoTrack.prototype.switchOff=function(){if("manual"!==this._clientTrackSwitchOffControl)throw new Error('Invalid state. You can call switchOff only when bandwidthProfile.video.clientTrackSwitchOffControl is set to "manual"');return this._setRenderHint({enabled:!1}),this},RemoteVideoTrack.prototype.setContentPreferences=function(contentPreferences){if("manual"!==this._contentPreferencesMode)throw new Error('Invalid state. You can call switchOn only when bandwidthProfile.video.contentPreferencesMode is set to "manual"');return contentPreferences.renderDimensions&&this._setRenderHint({renderDimensions:contentPreferences.renderDimensions}),this},RemoteVideoTrack.prototype._unObservePip=function(el){var pipCallbacks=this._elToPipCallbacks.get(el);pipCallbacks&&(el.removeEventListener("enterpictureinpicture",pipCallbacks.onEnterPip),el.removeEventListener("leavepictureinpicture",pipCallbacks.onLeavePip),this._elToPipCallbacks.delete(el))},RemoteVideoTrack.prototype._observePip=function(el){var _this=this;if(!this._elToPipCallbacks.get(el)){var onEnterPip=function(event){return _this._onEnterPip(event,el)},onLeavePip=function(event){return _this._onLeavePip(event,el)};el.addEventListener("enterpictureinpicture",onEnterPip),el.addEventListener("leavepictureinpicture",onLeavePip),this._elToPipCallbacks.set(el,{onEnterPip:onEnterPip,onLeavePip:onLeavePip,onResizePip:function(event){return _this._onResizePip(event,el)}})}},RemoteVideoTrack.prototype._onEnterPip=function(event,videoEl){this._log.debug("onEnterPip");var pipWindow=event.pictureInPictureWindow;this._elToPipWindows.set(videoEl,pipWindow);var onResizePip=this._elToPipCallbacks.get(videoEl).onResizePip;pipWindow.addEventListener("resize",onResizePip),maybeUpdateEnabledHint(this)},RemoteVideoTrack.prototype._onLeavePip=function(event,videoEl){this._log.debug("onLeavePip"),this._elToPipWindows.delete(videoEl);var onResizePip=this._elToPipCallbacks.get(videoEl).onResizePip;event.pictureInPictureWindow.removeEventListener("resize",onResizePip),maybeUpdateEnabledHint(this)},RemoteVideoTrack.prototype._onResizePip=function(){maybeUpdateDimensionHint(this)},RemoteVideoTrack.prototype.attach=function(el){var result=_super.prototype.attach.call(this,el);return"auto"===this._clientTrackSwitchOffControl&&this._invisibleElements.add(result),this._intersectionObserver.observe(result),this._resizeObserver.observe(result),this._enableDocumentVisibilityTurnOff&&(this._documentVisibilityTurnOffCleanup=this._documentVisibilityTurnOffCleanup||function(removeVideoTrack){function onVisibilityChanged(){maybeUpdateEnabledHint(removeVideoTrack)}return documentVisibilityMonitor.onVisibilityChange(1,onVisibilityChanged),function(){documentVisibilityMonitor.offVisibilityChange(1,onVisibilityChanged)}}(this)),this._observePip(result),result},RemoteVideoTrack.prototype.detach=function(el){var _this=this,result=_super.prototype.detach.call(this,el);return(Array.isArray(result)?result:[result]).forEach((function(element){_this._intersectionObserver.unobserve(element),_this._resizeObserver.unobserve(element),_this._invisibleElements.delete(element),_this._unObservePip(element)})),0===this._attachments.size&&this._documentVisibilityTurnOffCleanup&&(this._documentVisibilityTurnOffCleanup(),this._documentVisibilityTurnOffCleanup=null),maybeUpdateEnabledHint(this),maybeUpdateDimensionHint(this),result},RemoteVideoTrack.prototype.addProcessor=function(){return _super.prototype.addProcessor.apply(this,arguments)},RemoteVideoTrack.prototype.removeProcessor=function(){return _super.prototype.removeProcessor.apply(this,arguments)},RemoteVideoTrack.prototype.toString=function(){return"[RemoteVideoTrack #"+this._instanceId+": "+this.sid+"]"},RemoteVideoTrack.prototype.setPriority=function(priority){return _super.prototype.setPriority.call(this,priority)},RemoteVideoTrack}(mixinRemoteMediaTrack(VideoTrack));function maybeUpdateEnabledHint(remoteVideoTrack){if("auto"===remoteVideoTrack._clientTrackSwitchOffControl){var visibleElements=remoteVideoTrack._getAllAttachedElements().filter((function(el){return!remoteVideoTrack._invisibleElements.has(el)}));1==(remoteVideoTrack._getAllAttachedElements().filter((function(el){return remoteVideoTrack._elToPipWindows.has(el)})).length>0||"visible"===document.visibilityState&&visibleElements.length>0)?(remoteVideoTrack._turnOffTimer.clear(),remoteVideoTrack._setRenderHint({enabled:!0})):remoteVideoTrack._turnOffTimer.isSet||remoteVideoTrack._turnOffTimer.start()}}function maybeUpdateDimensionHint(remoteVideoTrack){if("auto"===remoteVideoTrack._contentPreferencesMode){var visibleElements=remoteVideoTrack._getAllAttachedElements().filter((function(el){return!remoteVideoTrack._invisibleElements.has(el)})),pipElements=remoteVideoTrack._getAllAttachedElements().map((function(el){var pipWindow=remoteVideoTrack._elToPipWindows.get(el);return pipWindow?{clientHeight:pipWindow.height,clientWidth:pipWindow.width}:{clientHeight:0,clientWidth:0}})),totalElements=visibleElements.concat(pipElements);if(totalElements.length>0){var _b=__read(totalElements.sort((function(el1,el2){return el2.clientHeight+el2.clientWidth-el1.clientHeight-el1.clientWidth-1})),1)[0];remoteVideoTrack._setRenderHint({renderDimensions:{height:_b.clientHeight,width:_b.clientWidth}})}}}module.exports=RemoteVideoTrack},EHr0:function(module,exports,__webpack_require__){"use strict";var defer=__webpack_require__("ghd6").defer,AsyncVar=function(){function AsyncVar(){Object.defineProperties(this,{_deferreds:{value:[]},_hasValue:{value:!1,writable:!0},_value:{value:null,writable:!0}})}return AsyncVar.prototype.put=function(value){this._hasValue=!0,this._value=value;var deferred=this._deferreds.shift();return deferred&&deferred.resolve(value),this},AsyncVar.prototype.take=function(){var _this=this;if(this._hasValue&&!this._deferreds.length)return this._hasValue=!1,Promise.resolve(this._value);var deferred=defer();return this._deferreds.push(deferred),deferred.promise.then((function(value){return _this._hasValue=!1,value}))},AsyncVar}();module.exports=AsyncVar},EYe3:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),StateMachine=__webpack_require__("gEVb"),NetworkQualityStats=__webpack_require__("6ltx"),states={connecting:["connected"],connected:["disconnected","reconnecting"],reconnecting:["connected","disconnected"],disconnected:[]},ParticipantSignaling=function(_super){function ParticipantSignaling(){var _this=_super.call(this,"connecting",states)||this;return Object.defineProperties(_this,{_identity:{writable:!0,value:null},_networkQualityLevel:{value:null,writable:!0},_networkQualityStats:{value:null,writable:!0},_sid:{writable:!0,value:null},identity:{enumerable:!0,get:function(){return this._identity}},sid:{enumerable:!0,get:function(){return this._sid}},tracks:{enumerable:!0,value:new Map}}),_this}return __extends(ParticipantSignaling,_super),Object.defineProperty(ParticipantSignaling.prototype,"networkQualityLevel",{get:function(){return this._networkQualityLevel},enumerable:!1,configurable:!0}),Object.defineProperty(ParticipantSignaling.prototype,"networkQualityStats",{get:function(){return this._networkQualityStats},enumerable:!1,configurable:!0}),ParticipantSignaling.prototype.addTrack=function(track){return this.tracks.set(track.id||track.sid,track),this.emit("trackAdded",track),this},ParticipantSignaling.prototype.disconnect=function(){return"disconnected"!==this.state&&(this.preempt("disconnected"),!0)},ParticipantSignaling.prototype.removeTrack=function(track){var signaling=this.tracks.get(track.id||track.sid);return this.tracks.delete(track.id||track.sid),signaling&&this.emit("trackRemoved",track),signaling||null},ParticipantSignaling.prototype.setNetworkQualityLevel=function(networkQualityLevel,networkQualityLevels){this._networkQualityLevel!==networkQualityLevel&&(this._networkQualityLevel=networkQualityLevel,this._networkQualityStats=networkQualityLevels&&(networkQualityLevels.audio||networkQualityLevels.video)?new NetworkQualityStats(networkQualityLevels):null,this.emit("networkQualityLevelChanged"))},ParticipantSignaling.prototype.connect=function(sid,identity){return("connecting"===this.state||"reconnecting"===this.state)&&(this._sid||(this._sid=sid),this._identity||(this._identity=identity),this.preempt("connected"),!0)},ParticipantSignaling.prototype.reconnecting=function(){return("connecting"===this.state||"connected"===this.state)&&(this.preempt("reconnecting"),!0)},ParticipantSignaling}(StateMachine);module.exports=ParticipantSignaling},"F/ro":function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__spreadArray=this&&this.__spreadArray||function(to,from){for(var i=0,il=from.length,j=to.length;i<il;i++,j++)to[j]=from[i];return to},QueueingEventEmitter=function(_super){function QueueingEventEmitter(){var _this=_super.call(this)||this;return Object.defineProperties(_this,{_queuedEvents:{value:new Map}}),_this}return __extends(QueueingEventEmitter,_super),QueueingEventEmitter.prototype.dequeue=function(event){var _this=this,result=!0;if(!event)return this._queuedEvents.forEach((function(_,queuedEvent){result=this.dequeue(queuedEvent)&&result}),this),result;var queue=this._queuedEvents.get(event)||[];return this._queuedEvents.delete(event),queue.reduce((function(result,args){return _this.emit.apply(_this,__spreadArray([],__read([event].concat(args))))&&result}),result)},QueueingEventEmitter.prototype.queue=function(){var args=[].slice.call(arguments);if(this.emit.apply(this,__spreadArray([],__read(args))))return!0;var event=args[0];return this._queuedEvents.has(event)||this._queuedEvents.set(event,[]),this._queuedEvents.get(event).push(args.slice(1)),!1},QueueingEventEmitter}(__webpack_require__("+qE3").EventEmitter);module.exports=QueueingEventEmitter},FjKE:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__spreadArray=this&&this.__spreadArray||function(to,from){for(var i=0,il=from.length,j=to.length;i<il;i++,j++)to[j]=from[i];return to},StateMachine=__webpack_require__("gEVb"),_a=__webpack_require__("ghd6"),buildLogLevels=_a.buildLogLevels,makeUUID=_a.makeUUID,Log=__webpack_require__("S3Hu"),NetworkMonitor=__webpack_require__("d+6x"),Timeout=__webpack_require__("Y1/N"),nInstances=0,states={closed:[],connecting:["closed","open","waiting"],early:["closed","connecting"],open:["closed"],waiting:["closed","connecting","early","open"]},events={closed:"close",open:"open",waiting:"waiting"},toplevel=global.window||global,WebSocket=toplevel.WebSocket?toplevel.WebSocket:__webpack_require__("vaDk"),CloseReason={BUSY:"busy",FAILED:"failed",LOCAL:"local",REMOTE:"remote",TIMEOUT:"timeout"},wsCloseCodesToCloseReasons=new Map([[3e3,CloseReason.TIMEOUT],[3001,CloseReason.TIMEOUT],[3002,CloseReason.FAILED],[3003,CloseReason.FAILED],[3004,CloseReason.TIMEOUT],[3006,CloseReason.BUSY],[3007,CloseReason.TIMEOUT]]),TwilioConnection=function(_super){function TwilioConnection(serverUrl,options){var _this=_super.call(this,"early",states)||this;options=Object.assign({helloBody:null,maxConsecutiveFailedHellos:3,maxConsecutiveMissedHeartbeats:3,requestedHeartbeatTimeout:5e3,openTimeout:15e3,welcomeTimeout:5e3,Log:Log,WebSocket:WebSocket},options);var logLevels=buildLogLevels(options.logLevel),log=new options.Log("default",_this,logLevels,options.loggerName),networkMonitor=options.networkMonitor?new NetworkMonitor((function(){var type=networkMonitor.type,reason="Network changed"+(type?" to "+type:"");log.debug(reason),_this._close({code:3004,reason:reason})})):null;Object.defineProperties(_this,{_busyWaitTimeout:{value:null,writable:!0},_consecutiveHeartbeatsMissed:{value:0,writable:!0},_cookie:{value:null,writable:!0},_eventObserver:{value:options.eventObserver},_heartbeatTimeout:{value:null,writable:!0},_hellosLeft:{value:options.maxConsecutiveFailedHellos,writable:!0},_instanceId:{value:++nInstances},_log:{value:log},_messageQueue:{value:[]},_networkMonitor:{value:networkMonitor},_options:{value:options},_openTimeout:{value:null,writable:!0},_sendHeartbeatTimeout:{value:null,writable:!0},_serverUrl:{value:serverUrl},_welcomeTimeout:{value:null,writable:!0},_ws:{value:null,writable:!0}});var eventsToLevels={connecting:"info",early:"info",open:"info",waiting:"warning",closed:"info"};return _this.on("stateChanged",(function(state){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];state in events&&_this.emit.apply(_this,__spreadArray([events[state]],__read(args)));var event={name:state,group:"signaling",level:eventsToLevels[_this.state]};if("closed"===state){var _a=__read(args,1),reason=_a[0];event.payload={reason:reason},event.level=reason===CloseReason.LOCAL?"info":"error"}_this._eventObserver.emit("event",event)})),_this._eventObserver.emit("event",{name:_this.state,group:"signaling",level:eventsToLevels[_this.state]}),_this._connect(),_this}return __extends(TwilioConnection,_super),TwilioConnection.prototype.toString=function(){return"[TwilioConnection #"+this._instanceId+": "+this._ws.url+"]"},TwilioConnection.prototype._close=function(_a){var code=_a.code,reason=_a.reason;if("closed"!==this.state){this._openTimeout&&this._openTimeout.clear(),this._welcomeTimeout&&this._welcomeTimeout.clear(),this._heartbeatTimeout&&this._heartbeatTimeout.clear(),this._sendHeartbeatTimeout&&this._sendHeartbeatTimeout.clear(),this._networkMonitor&&this._networkMonitor.stop(),this._busyWaitTimeout&&3005!==code&&this._busyWaitTimeout.clear(),this._messageQueue.splice(0);var log=this._log;1e3===code?(log.debug("Closed"),this.transition("closed",null,[CloseReason.LOCAL])):(log.warn("Closed: "+code+" - "+reason),3005!==code&&this.transition("closed",null,[wsCloseCodesToCloseReasons.get(code)||CloseReason.REMOTE]));var readyState=this._ws.readyState,WebSocket=this._options.WebSocket;readyState!==WebSocket.CLOSING&&readyState!==WebSocket.CLOSED&&this._ws.close(code,reason)}},TwilioConnection.prototype._connect=function(){var _this=this,log=this._log;if("waiting"===this.state)this.transition("early");else if("early"!==this.state)return void log.warn('Unexpected state "'+this.state+'" for connecting to the TCMP server.');this._ws=new this._options.WebSocket(this._serverUrl);var ws=this._ws;log.debug("Created a new WebSocket:",ws),ws.addEventListener("close",(function(event){return _this._close(event)}));var openTimeout=this._options.openTimeout;this._openTimeout=new Timeout((function(){_this._close({code:3007,reason:"Failed to open in "+openTimeout+" ms"})}),openTimeout),ws.addEventListener("open",(function(){log.debug("WebSocket opened:",ws),_this._openTimeout.clear(),_this._startHandshake(),_this._networkMonitor&&_this._networkMonitor.start()})),ws.addEventListener("message",(function(message){log.debug("Incoming: "+message.data);try{message=JSON.parse(message.data)}catch(error){return void _this.emit("error",error)}switch(message.type){case"bad":_this._handleBad(message);break;case"busy":_this._handleBusy(message);break;case"bye":break;case"msg":_this._handleMessage(message);case"heartbeat":_this._handleHeartbeat();break;case"welcome":_this._handleWelcome(message);break;default:_this._log.debug("Unknown message type: "+message.type),_this.emit("error",new Error("Unknown message type: "+message.type))}}))},TwilioConnection.prototype._handleBad=function(_a){var reason=_a.reason,log=this._log;if(["connecting","open"].includes(this.state)){if("connecting"===this.state)return log.warn("Closing: 3002 - "+reason),void this._close({code:3002,reason:reason});log.debug("Error: "+reason),this.emit("error",new Error(reason))}else log.warn('Unexpected state "'+this.state+'" for handling a "bad" message from the TCMP server.')},TwilioConnection.prototype._handleBusy=function(_a){var _this=this,cookie=_a.cookie,keepAlive=_a.keepAlive,retryAfter=_a.retryAfter,log=this._log;if(["connecting","waiting"].includes(this.state)){this._busyWaitTimeout&&this._busyWaitTimeout.clear(),this._welcomeTimeout&&this._welcomeTimeout.clear();var reason=retryAfter<0?'Received terminal "busy" message':'Received "busy" message, retrying after '+retryAfter+" ms";if(retryAfter<0)return log.warn("Closing: 3006 - "+reason),void this._close({code:3006,reason:reason});this._hellosLeft=this._options.maxConsecutiveFailedHellos,this._cookie=cookie||null,keepAlive?(log.warn(reason),this._busyWaitTimeout=new Timeout((function(){return _this._startHandshake()}),retryAfter)):(log.warn("Closing: 3005 - "+reason),this._close({code:3005,reason:reason}),this._busyWaitTimeout=new Timeout((function(){return _this._connect()}),retryAfter)),this.transition("waiting",null,[keepAlive,retryAfter])}else log.warn('Unexpected state "'+this.state+'" for handling a "busy" message from the TCMP server.')},TwilioConnection.prototype._handleHeartbeat=function(){"open"===this.state?this._heartbeatTimeout.reset():this._log.warn('Unexpected state "'+this.state+'" for handling a "heartbeat" message from the TCMP server.')},TwilioConnection.prototype._handleHeartbeatTimeout=function(){if("open"===this.state){var log=this._log,maxConsecutiveMissedHeartbeats=this._options.maxConsecutiveMissedHeartbeats;log.debug("Consecutive heartbeats missed: "+maxConsecutiveMissedHeartbeats);var reason="Missed "+maxConsecutiveMissedHeartbeats+' "heartbeat" messages';log.warn("Closing: 3001 - "+reason),this._close({code:3001,reason:reason})}},TwilioConnection.prototype._handleMessage=function(_a){"open"===this.state?this.emit("message",_a.body):this._log.warn('Unexpected state "'+this.state+'" for handling a "msg" message from the TCMP server.')},TwilioConnection.prototype._handleWelcome=function(_a){var _this=this,negotiatedTimeout=_a.negotiatedTimeout,log=this._log;if(["connecting","waiting"].includes(this.state)){"waiting"===this.state&&(log.debug('Received "welcome" message, no need to retry connection.'),this._busyWaitTimeout.clear());var heartbeatTimeout=negotiatedTimeout*this._options.maxConsecutiveMissedHeartbeats,outgoingHeartbeatTimeout=negotiatedTimeout-200;this._welcomeTimeout.clear(),this._heartbeatTimeout=new Timeout((function(){return _this._handleHeartbeatTimeout()}),heartbeatTimeout),this._messageQueue.splice(0).forEach((function(message){return _this._send(message)})),this._sendHeartbeatTimeout=new Timeout((function(){return _this._sendHeartbeat()}),outgoingHeartbeatTimeout),this.transition("open")}else log.warn('Unexpected state "'+this.state+'" for handling a "welcome" message from the TCMP server.')},TwilioConnection.prototype._handleWelcomeTimeout=function(){if("connecting"===this.state){var log=this._log;if(this._hellosLeft<=0){var reason="All handshake attempts failed";return log.warn("Closing: 3000 - "+reason),void this._close({code:3e3,reason:reason})}log.warn("Handshake attempt "+(this._options.maxConsecutiveFailedHellos-this._hellosLeft)+" failed"),this._startHandshake()}},TwilioConnection.prototype._send=function(message){if(this._ws.readyState===this._options.WebSocket.OPEN){var data=JSON.stringify(message);this._log.debug("Outgoing: "+data);try{this._ws.send(data),this._sendHeartbeatTimeout&&this._sendHeartbeatTimeout.reset()}catch(error){var reason="Failed to send message";this._log.warn("Closing: 3003 - "+reason),this._close({code:3003,reason:reason})}}},TwilioConnection.prototype._sendHeartbeat=function(){"closed"!==this.state&&this._send({type:"heartbeat"})},TwilioConnection.prototype._sendHello=function(){var _a=this._options,helloBody=_a.helloBody,timeout=_a.requestedHeartbeatTimeout,hello={id:makeUUID(),timeout:timeout,type:"hello",version:2};this._cookie&&(hello.cookie=this._cookie),helloBody&&(hello.body=helloBody),this._send(hello)},TwilioConnection.prototype._sendOrEnqueue=function(message){var _this=this;"closed"!==this.state&&("open"===this.state?function(message){return _this._send(message)}:function(message){return _this._messageQueue.push(message)})(message)},TwilioConnection.prototype._startHandshake=function(){var _this=this;["early","waiting"].includes(this.state)&&this.transition("connecting"),"connecting"===this.state&&(this._hellosLeft--,this._sendHello(),this._welcomeTimeout=new Timeout((function(){return _this._handleWelcomeTimeout()}),this._options.welcomeTimeout))},TwilioConnection.prototype.close=function(){"closed"!==this.state&&(this._sendOrEnqueue({type:"bye"}),this._close({code:1e3,reason:"Normal"}))},TwilioConnection.prototype.sendMessage=function(body){this._sendOrEnqueue({body:body,type:"msg"})},TwilioConnection}(StateMachine);TwilioConnection.CloseReason=CloseReason,module.exports=TwilioConnection},FpZJ:function(module,exports,__webpack_require__){"use strict";module.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var obj={},sym=Symbol("test"),symObj=Object(sym);if("string"==typeof sym)return!1;if("[object Symbol]"!==Object.prototype.toString.call(sym))return!1;if("[object Symbol]"!==Object.prototype.toString.call(symObj))return!1;for(sym in obj[sym]=42,obj)return!1;if("function"==typeof Object.keys&&0!==Object.keys(obj).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(obj).length)return!1;var syms=Object.getOwnPropertySymbols(obj);if(1!==syms.length||syms[0]!==sym)return!1;if(!Object.prototype.propertyIsEnumerable.call(obj,sym))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var descriptor=Object.getOwnPropertyDescriptor(obj,sym);if(42!==descriptor.value||!0!==descriptor.enumerable)return!1}return!0}},HHTs:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),ParticipantSignaling=__webpack_require__("EYe3"),RoomSignaling=__webpack_require__("Lh68"),StateMachine=__webpack_require__("gEVb"),states={closed:["opening"],opening:["closed","open"],open:["closed","closing"],closing:["closed","open"]},Signaling=function(_super){function Signaling(){return _super.call(this,"closed",states)||this}return __extends(Signaling,_super),Signaling.prototype._close=function(key){return this.transition("closing",key),this.transition("closed",key),Promise.resolve(this)},Signaling.prototype._connect=function(localParticipant,token,encodingParameters,preferredCodecs,options){localParticipant.connect("PA00000000000000000000000000000000","test");var promise=Promise.resolve(new RoomSignaling(localParticipant,"RM00000000000000000000000000000000",options));return promise.cancel=function(){},promise},Signaling.prototype._open=function(key){return this.transition("opening",key),this.transition("open",key),Promise.resolve(this)},Signaling.prototype.close=function(){var _this=this;return this.bracket("close",(function(key){switch(_this.state){case"closed":return _this;case"open":return _this._close(key);default:throw new Error('Unexpected Signaling state "'+_this.state+'"')}}))},Signaling.prototype.connect=function(localParticipant,token,encodingParameters,preferredCodecs,options){var self=this;return this.bracket("connect",(function transition(key){switch(self.state){case"closed":return self._open(key).then(transition.bind(null,key));case"open":return self.releaseLockCompletely(key),self._connect(localParticipant,token,encodingParameters,preferredCodecs,options);default:throw new Error('Unexpected Signaling state "'+self.state+'"')}}))},Signaling.prototype.createLocalParticipantSignaling=function(){return new ParticipantSignaling},Signaling.prototype.open=function(){var _this=this;return this.bracket("open",(function(key){switch(_this.state){case"closed":return _this._open(key);case"open":return _this;default:throw new Error('Unexpected Signaling state "'+_this.state+'"')}}))},Signaling}(StateMachine);module.exports=Signaling},HNKe:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),average=__webpack_require__("4o7n"),SenderOrReceiverReport=__webpack_require__("8WNc"),sum=__webpack_require__("Ihm+"),SenderReport=function(_super){function SenderReport(id,trackId,bitrate,rtt){var _this=_super.call(this,id,trackId,bitrate)||this;return Object.defineProperties(_this,{rtt:{enumerable:!0,value:rtt}}),_this}return __extends(SenderReport,_super),SenderReport.of=function(trackId,olderStats,newerStats,newerRemoteStats){if(olderStats.id!==newerStats.id)throw new Error("RTCStats IDs must match");var secondsElapsed=(newerStats.timestamp-olderStats.timestamp)/1e3;return new SenderReport(olderStats.id,trackId,secondsElapsed>0?(newerStats.bytesSent-olderStats.bytesSent)/secondsElapsed*8:0,newerRemoteStats&&"number"==typeof newerRemoteStats.roundTripTime?newerRemoteStats.roundTripTime/1e3:void 0)},SenderReport.summarize=function(reports){return{bitrate:sum(reports.map((function(report){return report.bitrate}))),rtt:average(reports.map((function(report){return report.rtt})))}},SenderReport}(SenderOrReceiverReport);module.exports=SenderReport},HNxM:function(module,exports,__webpack_require__){var util=__webpack_require__("MCLT"),errors=module.exports=__webpack_require__("d75R");function failCheck(ExceptionConstructor,callee,messageFormat,formatArgs){var error=new ExceptionConstructor(util.format.apply(this,[messageFormat=messageFormat||""].concat(formatArgs)));throw Error.captureStackTrace(error,callee),error}function failArgumentCheck(callee,message,formatArgs){failCheck(errors.IllegalArgumentError,callee,message,formatArgs)}function failStateCheck(callee,message,formatArgs){failCheck(errors.IllegalStateError,callee,message,formatArgs)}function typeOf(value){var s=typeof value;if("object"==s){if(!value)return"null";if(value instanceof Array)return"array"}return s}function typeCheck(expect){return function(value,message){var type=typeOf(value);if(type==expect)return value;failArgumentCheck(arguments.callee,message||'Expected "'+expect+'" but got "'+type+'".',Array.prototype.slice.call(arguments,2))}}module.exports.checkArgument=function(value,message){value||failArgumentCheck(arguments.callee,message,Array.prototype.slice.call(arguments,2))},module.exports.checkState=function(value,message){value||failStateCheck(arguments.callee,message,Array.prototype.slice.call(arguments,2))},module.exports.checkIsDef=function(value,message){if(void 0!==value)return value;failArgumentCheck(arguments.callee,message||"Expected value to be defined but was undefined.",Array.prototype.slice.call(arguments,2))},module.exports.checkIsDefAndNotNull=function(value,message){if(null!=value)return value;failArgumentCheck(arguments.callee,message||'Expected value to be defined and not null but got "'+typeOf(value)+'".',Array.prototype.slice.call(arguments,2))},module.exports.checkIsString=typeCheck("string"),module.exports.checkIsArray=typeCheck("array"),module.exports.checkIsNumber=typeCheck("number"),module.exports.checkIsBoolean=typeCheck("boolean"),module.exports.checkIsFunction=typeCheck("function"),module.exports.checkIsObject=typeCheck("object")},HOot:function(module,exports,__webpack_require__){var util=__webpack_require__("MCLT"),BackoffStrategy=__webpack_require__("kThA");function FibonacciBackoffStrategy(options){BackoffStrategy.call(this,options),this.backoffDelay_=0,this.nextBackoffDelay_=this.getInitialDelay()}util.inherits(FibonacciBackoffStrategy,BackoffStrategy),FibonacciBackoffStrategy.prototype.next_=function(){var backoffDelay=Math.min(this.nextBackoffDelay_,this.getMaxDelay());return this.nextBackoffDelay_+=this.backoffDelay_,this.backoffDelay_=backoffDelay,backoffDelay},FibonacciBackoffStrategy.prototype.reset_=function(){this.nextBackoffDelay_=this.getInitialDelay(),this.backoffDelay_=0},module.exports=FibonacciBackoffStrategy},HdHG:function(module,exports,__webpack_require__){"use strict";var $gOPD=__webpack_require__("AM7I")("%Object.getOwnPropertyDescriptor%",!0);if($gOPD)try{$gOPD([],"length")}catch(e){$gOPD=null}module.exports=$gOPD},HsAx:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),RemoteParticipantSignaling=function(_super){function RemoteParticipantSignaling(sid,identity){var _this=_super.call(this)||this;return _this.connect(sid,identity),_this}return __extends(RemoteParticipantSignaling,_super),RemoteParticipantSignaling}(__webpack_require__("EYe3"));module.exports=RemoteParticipantSignaling},"I/VV":function(module,exports,__webpack_require__){"use strict";var __read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__spreadArray=this&&this.__spreadArray||function(to,from){for(var i=0,il=from.length,j=to.length;i<il;i++,j++)to[j]=from[i];return to},__values=this&&this.__values||function(o){var s="function"==typeof Symbol&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&"number"==typeof o.length)return{next:function(){return o&&i>=o.length&&(o=void 0),{value:o&&o[i++],done:!o}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")},guessBrowser=__webpack_require__("mIkg").guessBrowser,IceReportFactory=__webpack_require__("ZfiD"),PeerConnectionReport=__webpack_require__("JEtZ"),ReceiverReportFactory=__webpack_require__("UZ/N"),SenderReportFactory=__webpack_require__("NXBa"),PeerConnectionReportFactory=function(){function PeerConnectionReportFactory(pc){Object.defineProperties(this,{pc:{enumerable:!0,value:pc},ice:{enumerable:!0,value:new IceReportFactory},audio:{enumerable:!0,value:{send:new Map,recv:new Map}},video:{enumerable:!0,value:{send:new Map,recv:new Map}},lastReport:{enumerable:!0,value:null,writable:!0}})}return PeerConnectionReportFactory.prototype.next=function(){var factory,senders,receivers,_this=this;return("firefox"===guessBrowser()?(senders=(factory=this).pc.getTransceivers().filter((function(transceiver){return transceiver.currentDirection&&transceiver.currentDirection.match(/send/)&&transceiver.sender.track})).map((function(transceiver){return transceiver.sender})),receivers=factory.pc.getTransceivers().filter((function(transceiver){return transceiver.currentDirection&&transceiver.currentDirection.match(/recv/)})).map((function(transceiver){return transceiver.receiver})),Promise.all([getSenderOrReceiverReports(senders),getSenderOrReceiverReports(receivers),factory.pc.getStats()]).then((function(_a){var _b=__read(_a,3),senderReports=_b[0],receiverReports=_b[1],pcReport=_b[2],senderReportFactoriesByMediaType=getSenderReportFactoriesByMediaType(factory),senderReportFactoryIdsToDeleteByMediaType=getSenderReportFactoryIdsByMediaType(factory);senderReports.forEach((function(report,trackId){return updateSenderReports(factory,report,senderReportFactoryIdsToDeleteByMediaType,trackId)})),deleteSenderOrReceiverReportFactories(senderReportFactoriesByMediaType,senderReportFactoryIdsToDeleteByMediaType);var receiverReportFactoriesByMediaType=getReceiverReportFactoriesByMediaType(factory),receiverReportFactoryIdsToDeleteByMediaType=getReceiverReportFactoryIdsByMediaType(factory);receiverReports.forEach((function(report,trackId){return updateReceiverReports(factory,report,receiverReportFactoryIdsToDeleteByMediaType,trackId)})),deleteSenderOrReceiverReportFactories(receiverReportFactoriesByMediaType,receiverReportFactoryIdsToDeleteByMediaType),updateIceReport(factory.ice,pcReport)}))):function(factory){return factory.pc.getStats().then((function(report){var senderReportFactoriesByMediaType=getSenderReportFactoriesByMediaType(factory),senderReportFactoryIdsToDeleteByMediaType=getSenderReportFactoryIdsByMediaType(factory);updateSenderReports(factory,report,senderReportFactoryIdsToDeleteByMediaType),deleteSenderOrReceiverReportFactories(senderReportFactoriesByMediaType,senderReportFactoryIdsToDeleteByMediaType);var receiverReportFactoriesByMediaType=getReceiverReportFactoriesByMediaType(factory),receiverReportFactoryIdsToDeleteByMediaType=getReceiverReportFactoryIdsByMediaType(factory);updateReceiverReports(factory,report,receiverReportFactoryIdsToDeleteByMediaType),deleteSenderOrReceiverReportFactories(receiverReportFactoriesByMediaType,receiverReportFactoryIdsToDeleteByMediaType),updateIceReport(factory.ice,report)}))}(this)).then((function(){var audioSenderReportFactories=__spreadArray([],__read(_this.audio.send.values())),videoSenderReportFactories=__spreadArray([],__read(_this.video.send.values())),audioReceiverReportFactories=__spreadArray([],__read(_this.audio.recv.values())),videoReceiverReportFactories=__spreadArray([],__read(_this.video.recv.values())),report=new PeerConnectionReport(_this.ice.lastReport,{send:audioSenderReportFactories.map((function(factory){return factory.lastReport})).filter((function(report){return report})),recv:audioReceiverReportFactories.map((function(factory){return factory.lastReport})).filter((function(report){return report}))},{send:videoSenderReportFactories.map((function(factory){return factory.lastReport})).filter((function(report){return report})),recv:videoReceiverReportFactories.map((function(factory){return factory.lastReport})).filter((function(report){return report}))});return _this.lastReport=report,report}))},PeerConnectionReportFactory}();function getSenderOrReceiverReports(sendersOrReceivers){return Promise.all(sendersOrReceivers.map((function(senderOrReceiver){var trackId=senderOrReceiver.track.id;return senderOrReceiver.getStats().then((function(report){var e_1,_a;try{for(var _b=__values(report.values()),_c=_b.next();!_c.done;_c=_b.next()){var stats=_c.value;"inbound-rtp"===stats.type&&(stats.id=trackId+"-"+stats.id)}}catch(e_1_1){e_1={error:e_1_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_1)throw e_1.error}}return[trackId,report]}))}))).then((function(pairs){return new Map(pairs)}))}function getOrCreateSenderOrReceiverReportFactory(SenderOrReceiverReportFactory,sendersOrReceiversByMediaType,report,stats,trackId){var sendersOrReceivers=sendersOrReceiversByMediaType[stats.mediaType];if(!trackId){var trackStats=report.get(stats.trackId);trackStats&&(trackId=trackStats.trackIdentifier)}if(sendersOrReceivers&&trackId){if(sendersOrReceivers.has(stats.id))return sendersOrReceivers.get(stats.id);var senderOrReceiverFactory=new SenderOrReceiverReportFactory(trackId,stats);sendersOrReceivers.set(stats.id,senderOrReceiverFactory)}return null}function getSenderReportFactoriesByMediaType(factory){return{audio:factory.audio.send,video:factory.video.send}}function getReceiverReportFactoriesByMediaType(factory){return{audio:factory.audio.recv,video:factory.video.recv}}function getOrCreateSenderReportFactory(factory,report,stats,trackId){return getOrCreateSenderOrReceiverReportFactory(SenderReportFactory,getSenderReportFactoriesByMediaType(factory),report,stats,trackId)}function getOrCreateReceiverReportFactory(factory,report,stats,trackId){return getOrCreateSenderOrReceiverReportFactory(ReceiverReportFactory,getReceiverReportFactoriesByMediaType(factory),report,stats,trackId)}function getSenderReportFactoryIdsByMediaType(factory){return{audio:new Set(factory.audio.send.keys()),video:new Set(factory.video.send.keys())}}function getReceiverReportFactoryIdsByMediaType(factory){return{audio:new Set(factory.audio.recv.keys()),video:new Set(factory.video.recv.keys())}}function updateSenderReports(factory,report,senderReportFactoryIdsToDeleteByMediaType,trackId){var e_2,_a;try{for(var _b=__values(report.values()),_c=_b.next();!_c.done;_c=_b.next()){var stats=_c.value;if("outbound-rtp"===stats.type&&!stats.isRemote){if("firefox"!==guessBrowser()&&!stats.trackId)continue;var senderReportFactoryIdsToDelete=senderReportFactoryIdsToDeleteByMediaType[stats.mediaType];senderReportFactoryIdsToDelete&&senderReportFactoryIdsToDelete.delete(stats.id);var senderReportFactory=getOrCreateSenderReportFactory(factory,report,stats,trackId);if(senderReportFactory){var remoteInboundStats=report.get(stats.remoteId);senderReportFactory.next(trackId||senderReportFactory.trackId,stats,remoteInboundStats)}}}}catch(e_2_1){e_2={error:e_2_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_2)throw e_2.error}}}function updateReceiverReports(factory,report,receiverReportFactoryIdsToDeleteByMediaType,trackId){var e_3,_a;try{for(var _b=__values(report.values()),_c=_b.next();!_c.done;_c=_b.next()){var stats=_c.value;if("inbound-rtp"===stats.type&&!stats.isRemote){var receiverReportFactoryIdsToDelete=receiverReportFactoryIdsToDeleteByMediaType[stats.mediaType];receiverReportFactoryIdsToDelete&&receiverReportFactoryIdsToDelete.delete(stats.id);var receiverReportFactory=getOrCreateReceiverReportFactory(factory,report,stats,trackId);receiverReportFactory&&receiverReportFactory.next(trackId||receiverReportFactory.trackId,stats)}}}catch(e_3_1){e_3={error:e_3_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_3)throw e_3.error}}}function deleteSenderOrReceiverReportFactories(senderOrReceiverReportFactoriesByMediaType,senderOrReceiverReportFactoryIdsByMediaType){var _loop_1=function(mediaType){var senderOrReceiverReportFactories=senderOrReceiverReportFactoriesByMediaType[mediaType];senderOrReceiverReportFactoryIdsByMediaType[mediaType].forEach((function(senderOrReceiverReportFactoryId){return senderOrReceiverReportFactories.delete(senderOrReceiverReportFactoryId)}))};for(var mediaType in senderOrReceiverReportFactoryIdsByMediaType)_loop_1(mediaType)}function updateIceReport(ice,report){var e_4,_a,e_5,_b,selectedCandidatePair;try{for(var _c=__values(report.values()),_d=_c.next();!_d.done;_d=_c.next())"transport"===(stats=_d.value).type&&(selectedCandidatePair=report.get(stats.selectedCandidatePairId))}catch(e_4_1){e_4={error:e_4_1}}finally{try{_d&&!_d.done&&(_a=_c.return)&&_a.call(_c)}finally{if(e_4)throw e_4.error}}if(selectedCandidatePair)ice.next(selectedCandidatePair);else try{for(var _e=__values(report.values()),_f=_e.next();!_f.done;_f=_e.next()){var stats;"candidate-pair"!==(stats=_f.value).type||!stats.nominated||"selected"in stats&&!stats.selected||ice.next(stats)}}catch(e_5_1){e_5={error:e_5_1}}finally{try{_f&&!_f.done&&(_b=_e.return)&&_b.call(_e)}finally{if(e_5)throw e_5.error}}}module.exports=PeerConnectionReportFactory},"Ihm+":function(module,exports,__webpack_require__){"use strict";module.exports=function(xs){return xs.reduce((function(y,x){return"number"==typeof x?x+y:y}),0)}},Ivmz:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),TrackSignaling=function(_super){function TrackSignaling(name,kind,isEnabled,priority){var _this=_super.call(this)||this,sid=null;return Object.defineProperties(_this,{_error:{value:null,writable:!0},_isEnabled:{value:isEnabled,writable:!0},_priority:{value:priority,writable:!0},_trackTransceiver:{value:null,writable:!0},_sid:{get:function(){return sid},set:function(_sid){null===sid&&(sid=_sid)}},kind:{enumerable:!0,value:kind},name:{enumerable:!0,value:name}}),_this}return __extends(TrackSignaling,_super),Object.defineProperty(TrackSignaling.prototype,"error",{get:function(){return this._error},enumerable:!1,configurable:!0}),Object.defineProperty(TrackSignaling.prototype,"isEnabled",{get:function(){return this._isEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(TrackSignaling.prototype,"priority",{get:function(){return this._priority},enumerable:!1,configurable:!0}),Object.defineProperty(TrackSignaling.prototype,"sid",{get:function(){return this._sid},enumerable:!1,configurable:!0}),Object.defineProperty(TrackSignaling.prototype,"trackTransceiver",{get:function(){return this._trackTransceiver},enumerable:!1,configurable:!0}),TrackSignaling.prototype.disable=function(){return this.enable(!1)},TrackSignaling.prototype.enable=function(enabled){return this.isEnabled!==(enabled="boolean"!=typeof enabled||enabled)&&(this._isEnabled=enabled,this.emit("updated")),this},TrackSignaling.prototype.setTrackTransceiver=function(trackTransceiver){return this.trackTransceiver!==(trackTransceiver=trackTransceiver||null)&&(this._trackTransceiver=trackTransceiver,this.emit("updated")),this},TrackSignaling.prototype.setSid=function(sid){return null===this.sid&&(this._sid=sid,this.emit("updated")),this},TrackSignaling}(__webpack_require__("+qE3").EventEmitter);module.exports=TrackSignaling},JEtZ:function(module,exports,__webpack_require__){"use strict";var ReceiverReport=__webpack_require__("2xLa"),SenderReport=__webpack_require__("HNKe"),PeerConnectionReport=function(){function PeerConnectionReport(ice,audio,video){Object.defineProperties(this,{ice:{enumerable:!0,value:ice},audio:{enumerable:!0,value:audio},video:{enumerable:!0,value:video}})}return PeerConnectionReport.prototype.summarize=function(){var senderReports=this.audio.send.concat(this.video.send),send=SenderReport.summarize(senderReports),receiverReports=this.audio.recv.concat(this.video.recv),recv=ReceiverReport.summarize(receiverReports);return{ice:this.ice,send:send,recv:recv,audio:{send:SenderReport.summarize(this.audio.send),recv:ReceiverReport.summarize(this.audio.recv)},video:{send:SenderReport.summarize(this.video.send),recv:ReceiverReport.summarize(this.video.recv)}}},PeerConnectionReport}();module.exports=PeerConnectionReport},JRNH:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.syntheticAudio=void 0,exports.syntheticAudio=function(){var audioContextFactory=__webpack_require__("/+gY"),holder={},audioContext=audioContextFactory.getOrCreate(holder),oscillator=audioContext.createOscillator(),dst=oscillator.connect(audioContext.createMediaStreamDestination());oscillator.start();var track=dst.stream.getAudioTracks()[0],originalStop=track.stop;return track.stop=function(){originalStop.call(track),audioContextFactory.release(holder)},track}},Jeqd:function(module,exports){module.exports=function(arg){return arg&&"object"==typeof arg&&"function"==typeof arg.copy&&"function"==typeof arg.fill&&"function"==typeof arg.readUInt8}},Jhn5:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),TrackTransceiver=function(_super){function TrackTransceiver(id,kind){var _this=_super.call(this)||this;return Object.defineProperties(_this,{id:{enumerable:!0,value:id},kind:{enumerable:!0,value:kind}}),_this}return __extends(TrackTransceiver,_super),TrackTransceiver.prototype.stop=function(){this.emit("stopped")},TrackTransceiver}(__webpack_require__("+qE3").EventEmitter);module.exports=TrackTransceiver},KGUp:function(module,exports,__webpack_require__){var events=__webpack_require__("+qE3"),precond=__webpack_require__("zMHY");function Backoff(backoffStrategy){events.EventEmitter.call(this),this.backoffStrategy_=backoffStrategy,this.maxNumberOfRetry_=-1,this.backoffNumber_=0,this.backoffDelay_=0,this.timeoutID_=-1,this.handlers={backoff:this.onBackoff_.bind(this)}}__webpack_require__("MCLT").inherits(Backoff,events.EventEmitter),Backoff.prototype.failAfter=function(maxNumberOfRetry){precond.checkArgument(maxNumberOfRetry>0,"Expected a maximum number of retry greater than 0 but got %s.",maxNumberOfRetry),this.maxNumberOfRetry_=maxNumberOfRetry},Backoff.prototype.backoff=function(err){precond.checkState(-1===this.timeoutID_,"Backoff in progress."),this.backoffNumber_===this.maxNumberOfRetry_?(this.emit("fail",err),this.reset()):(this.backoffDelay_=this.backoffStrategy_.next(),this.timeoutID_=setTimeout(this.handlers.backoff,this.backoffDelay_),this.emit("backoff",this.backoffNumber_,this.backoffDelay_,err))},Backoff.prototype.onBackoff_=function(){this.timeoutID_=-1,this.emit("ready",this.backoffNumber_,this.backoffDelay_),this.backoffNumber_++},Backoff.prototype.reset=function(){this.backoffNumber_=0,this.backoffStrategy_.reset(),clearTimeout(this.timeoutID_),this.timeoutID_=-1},module.exports=Backoff},KKCa:function(module,exports){module.exports="function"==typeof Object.create?function(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})}:function(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype,ctor.prototype=new TempCtor,ctor.prototype.constructor=ctor}},Kg6A:function(module,exports,__webpack_require__){"use strict";var CancelablePromise=__webpack_require__("sYJf"),DefaultPeerConnectionManager=__webpack_require__("31MG"),DefaultRoomV2=__webpack_require__("1I8i"),DefaultTransport=__webpack_require__("T/xC"),_a=__webpack_require__("5wwa"),SignalingConnectionDisconnectedError=_a.SignalingConnectionDisconnectedError,SignalingIncomingMessageInvalidError=_a.SignalingIncomingMessageInvalidError,_b=__webpack_require__("ghd6"),flatMap=_b.flatMap,createRoomConnectEventPayload=_b.createRoomConnectEventPayload;module.exports=function(token,wsServer,localParticipant,encodingParameters,preferredCodecs,options){options=Object.assign({PeerConnectionManager:DefaultPeerConnectionManager,RoomV2:DefaultRoomV2,Transport:DefaultTransport},options);var adaptiveSimulcast=preferredCodecs.video[0]&&!0===preferredCodecs.video[0].adaptiveSimulcast,RoomV2=options.RoomV2,Transport=options.Transport,iceServers=options.iceServers,log=options.log,peerConnectionManager=new(0,options.PeerConnectionManager)(encodingParameters,preferredCodecs,options),trackSenders=flatMap(localParticipant.tracks,(function(trackV2){return[trackV2.trackTransceiver]}));peerConnectionManager.setTrackSenders(trackSenders);var transport,cancellationError=new Error("Canceled"),cancelablePromise=new CancelablePromise((function(resolve,reject,isCanceled){var bandwidthProfile=options.bandwidthProfile,eventObserver=options.eventObserver,name=options.name,transportOptions=Object.assign({adaptiveSimulcast:adaptiveSimulcast,automaticSubscription:options.automaticSubscription,dominantSpeaker:options.dominantSpeaker,environment:options.environment,eventObserver:eventObserver,loggerName:options.loggerName,logLevel:options.logLevel,networkMonitor:options.networkMonitor,networkQuality:options.networkQuality,iceServers:iceServers,onIced:function(iceServers){return isCanceled()?(reject(cancellationError),Promise.reject(cancellationError)):(log.debug("Got ICE servers:",iceServers),options.iceServers=iceServers,peerConnectionManager.setConfiguration(options),peerConnectionManager.createAndOffer().then((function(){if(isCanceled())throw reject(cancellationError),cancellationError;log.debug("createAndOffer() succeeded."),peerConnectionManager.dequeue("description")})).catch((function(error){throw log.error("createAndOffer() failed:",error),reject(error),error})))},realm:options.realm,renderHints:!!bandwidthProfile&&("disabled"!==options.clientTrackSwitchOffControl||"disabled"!==options.contentPreferencesMode),sdpSemantics:options.sdpSemantics,trackPriority:!!bandwidthProfile,trackSwitchOff:!!bandwidthProfile},bandwidthProfile?{bandwidthProfile:bandwidthProfile}:{});transport=new Transport(name,token,localParticipant,peerConnectionManager,wsServer,transportOptions);var connectEventPayload=createRoomConnectEventPayload(options);eventObserver.emit("event",connectEventPayload),transport.once("connected",(function(initialState){log.debug("Transport connected:",initialState),isCanceled()?reject(cancellationError):initialState.participant?(localParticipant.setSignalingRegion(initialState.options.signaling_region),resolve(new RoomV2(localParticipant,initialState,transport,peerConnectionManager,options))):reject(new SignalingIncomingMessageInvalidError)})),transport.once("stateChanged",(function(state,error){"disconnected"===state?(transport=null,reject(error||new SignalingConnectionDisconnectedError)):log.debug("Transport state changed:",state)}))}),(function(){transport&&(transport.disconnect(),transport=null)}));return cancelablePromise.catch((function(){transport&&(transport.disconnect(),transport=null),peerConnectionManager.close()})),cancelablePromise}},L1nb:function(module,exports,__webpack_require__){"use strict";var flatMap=__webpack_require__("mIkg").flatMap,guessBrowser=__webpack_require__("mIkg").guessBrowser,isSdpSemanticsSupported=null,chromeSdpFormat=null;function getChromeSdpFormat(sdpSemantics){return sdpSemantics&&function(){if("boolean"==typeof isSdpSemanticsSupported)return isSdpSemanticsSupported;if("undefined"==typeof RTCPeerConnection)return isSdpSemanticsSupported=!1;try{new RTCPeerConnection({sdpSemantics:"foo"}),isSdpSemanticsSupported=!1}catch(e){isSdpSemanticsSupported=!0}return isSdpSemanticsSupported}()?{"plan-b":"planb","unified-plan":"unified"}[sdpSemantics]:function(){if(!chromeSdpFormat)if("undefined"!=typeof RTCPeerConnection&&"addTransceiver"in RTCPeerConnection.prototype)try{(new RTCPeerConnection).addTransceiver("audio"),chromeSdpFormat="unified"}catch(e){chromeSdpFormat="planb"}else chromeSdpFormat="planb";return chromeSdpFormat}()}function getMatches(pattern,lines){return(lines.match(new RegExp(pattern,"gm"))||[]).reduce((function(results,line){var match=line.match(new RegExp(pattern));return match?results.add(match[1]):results}),new Set)}function getTrackIds(pattern,sdp){return getMatches(pattern,sdp)}function getPlanBTrackIds(sdp){return getTrackIds("^a=ssrc:[0-9]+ +msid:.+ +(.+) *$",sdp)}function getUnifiedPlanTrackIds(sdp){return getTrackIds("^a=msid:.+ +(.+) *$",sdp)}function getPlanBSSRCs(sdp,trackId){return getMatches("^a=ssrc:([0-9]+) +msid:[^ ]+ +"+trackId+" *$",sdp)}function getMediaSections(sdp,kind,direction){return kind=kind||".*",direction=direction||".*",sdp.split("\r\nm=").slice(1).map((function(mediaSection){return"m="+mediaSection})).filter((function(mediaSection){var kindPattern=new RegExp("m="+kind,"gm"),directionPattern=new RegExp("a="+direction,"gm");return kindPattern.test(mediaSection)&&directionPattern.test(mediaSection)}))}function getMediaSectionSSRCs(mediaSection){return Array.from(getMatches("^a=ssrc:([0-9]+) +.*$",mediaSection))}function getUnifiedPlanSSRCs(sdp,trackId){var mediaSections=getMediaSections(sdp),msidAttrRegExp=new RegExp("^a=msid:[^ ]+ +"+trackId+" *$","gm"),matchingMediaSections=mediaSections.filter((function(mediaSection){return mediaSection.match(msidAttrRegExp)}));return new Set(flatMap(matchingMediaSections,getMediaSectionSSRCs))}function getTrackIdsToSSRCs(getTrackIds,getSSRCs,sdp){return new Map(Array.from(getTrackIds(sdp)).map((function(trackId){return[trackId,getSSRCs(sdp,trackId)]})))}function getPlanBTrackIdsToSSRCs(sdp){return getTrackIdsToSSRCs(getPlanBTrackIds,getPlanBSSRCs,sdp)}function getUnifiedPlanTrackIdsToSSRCs(sdp){return getTrackIdsToSSRCs(getUnifiedPlanTrackIds,getUnifiedPlanSSRCs,sdp)}function updateTrackIdsToSSRCs(getTrackIdsToSSRCs,trackIdsToSSRCs,sdp){var newTrackIdsToSSRCs=getTrackIdsToSSRCs(sdp),newSSRCsToOldSSRCs=new Map;newTrackIdsToSSRCs.forEach((function(ssrcs,trackId){if(trackIdsToSSRCs.has(trackId)){var oldSSRCs=Array.from(trackIdsToSSRCs.get(trackId)),newSSRCs=Array.from(ssrcs);oldSSRCs.forEach((function(oldSSRC,i){var newSSRC=newSSRCs[i];newSSRCsToOldSSRCs.set(newSSRC,oldSSRC);var replacement="a=ssrc:"+oldSSRC+" $1";sdp=sdp.replace(new RegExp("^a=ssrc:"+newSSRC+" (.*)$","gm"),replacement)}))}else trackIdsToSSRCs.set(trackId,ssrcs)}));var pattern="^(a=ssrc-group:[^ ]+ +)(.*)$";return(sdp.match(new RegExp(pattern,"gm"))||[]).forEach((function(line){var match=line.match(new RegExp(pattern));if(match){var prefix=match[1],oldSSRCs=match[2].split(" ").map((function(newSSRC){return newSSRCsToOldSSRCs.get(newSSRC)||newSSRC})).join(" ");sdp=sdp.replace(match[0],prefix+oldSSRCs)}})),sdp}exports.getSdpFormat=function(sdpSemantics){return{chrome:getChromeSdpFormat(sdpSemantics),firefox:"unified",safari:"undefined"!=typeof RTCRtpTransceiver&&"currentDirection"in RTCRtpTransceiver.prototype?"unified":"planb"}[guessBrowser()]||null},exports.getMediaSections=getMediaSections,exports.getPlanBTrackIds=getPlanBTrackIds,exports.getUnifiedPlanTrackIds=getUnifiedPlanTrackIds,exports.getPlanBSSRCs=getPlanBSSRCs,exports.getUnifiedPlanSSRCs=getUnifiedPlanSSRCs,exports.updatePlanBTrackIdsToSSRCs=function(trackIdsToSSRCs,sdp){return updateTrackIdsToSSRCs(getPlanBTrackIdsToSSRCs,trackIdsToSSRCs,sdp)},exports.updateUnifiedPlanTrackIdsToSSRCs=function(trackIdsToSSRCs,sdp){return updateTrackIdsToSSRCs(getUnifiedPlanTrackIdsToSSRCs,trackIdsToSSRCs,sdp)}},LFO1:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),LocalVideoTrackPublication=function(_super){function LocalVideoTrackPublication(signaling,track,unpublish,options){return _super.call(this,signaling,track,unpublish,options)||this}return __extends(LocalVideoTrackPublication,_super),LocalVideoTrackPublication.prototype.toString=function(){return"[LocalVideoTrackPublication #"+this._instanceId+": "+this.trackSid+"]"},LocalVideoTrackPublication}(__webpack_require__("mb7l"));module.exports=LocalVideoTrackPublication},Lh68:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),DefaultRecordingSignaling=__webpack_require__("wl3V"),StateMachine=__webpack_require__("gEVb"),DefaultTimeout=__webpack_require__("Y1/N"),buildLogLevels=__webpack_require__("ghd6").buildLogLevels,DEFAULT_LOG_LEVEL=__webpack_require__("xwWy").DEFAULT_LOG_LEVEL,Log=__webpack_require__("S3Hu"),_a=__webpack_require__("5wwa"),MediaConnectionError=_a.MediaConnectionError,MediaDTLSTransportFailedError=_a.MediaDTLSTransportFailedError,SignalingConnectionDisconnectedError=_a.SignalingConnectionDisconnectedError,nInstances=0,states={connected:["reconnecting","disconnected"],reconnecting:["connected","disconnected"],disconnected:[]},RoomSignaling=function(_super){function RoomSignaling(localParticipant,sid,name,options){var _this=this;options=Object.assign({logLevel:DEFAULT_LOG_LEVEL,RecordingSignaling:DefaultRecordingSignaling,Timeout:DefaultTimeout},options);var logLevels=buildLogLevels(options.logLevel);_this=_super.call(this,"connected",states)||this;var RecordingSignaling=options.RecordingSignaling,sessionTimeout=new options.Timeout((function(){_this._disconnect(_this._reconnectingError)}),options.sessionTimeout,!1);return Object.defineProperties(_this,{_instanceId:{value:nInstances++},_log:{value:options.log?options.log.createLog("default",_this):new Log("default",_this,logLevels,options.loggerName)},_mediaConnectionIsReconnecting:{writable:!0,value:!1},_options:{value:options},_reconnectingError:{value:null,writable:!0},_sessionTimeout:{value:sessionTimeout},dominantSpeakerSid:{enumerable:!0,value:null,writable:!0},localParticipant:{enumerable:!0,value:localParticipant},name:{enumerable:!0,value:name},participants:{enumerable:!0,value:new Map},recording:{enumerable:!0,value:new RecordingSignaling},sid:{enumerable:!0,value:sid}}),_this.on("connectionStateChanged",(function(){"failed"!==_this.connectionState||["disconnected","failed"].includes(_this.iceConnectionState)||_this._disconnect(new MediaDTLSTransportFailedError)})),_this.on("iceConnectionStateChanged",(function(){return maybeUpdateState(_this)})),_this.on("signalingConnectionStateChanged",(function(){return maybeUpdateState(_this)})),setTimeout((function(){return maybeUpdateState(_this)})),_this}return __extends(RoomSignaling,_super),RoomSignaling.prototype._disconnect=function(error){return"disconnected"!==this.state&&(this.preempt("disconnected",null,[error]),!0)},RoomSignaling.prototype.toString=function(){return"[RoomSignaling #"+this._instanceId+": "+(this.localParticipant?this.localParticipant.sid:"null")+"]"},RoomSignaling.prototype.connectParticipant=function(participant){var self=this;return"disconnected"!==participant.state&&!this.participants.has(participant.sid)&&(this.participants.set(participant.sid,participant),participant.on("stateChanged",(function stateChanged(state){"disconnected"===state&&(participant.removeListener("stateChanged",stateChanged),self.participants.delete(participant.sid),self.emit("participantDisconnected",participant))})),this.emit("participantConnected",participant),!0)},RoomSignaling.prototype.disconnect=function(){return this._disconnect()},RoomSignaling.prototype.setDominantSpeaker=function(dominantSpeakerSid){this.dominantSpeakerSid=dominantSpeakerSid,this.emit("dominantSpeakerChanged")},RoomSignaling}(StateMachine);function maybeUpdateState(roomSignaling){var newState;"disconnected"!==roomSignaling.state&&"disconnected"!==roomSignaling.signalingConnectionState?("reconnecting"===roomSignaling.signalingConnectionState?newState=roomSignaling.signalingConnectionState:"failed"===roomSignaling.iceConnectionState?(roomSignaling._mediaConnectionIsReconnecting=!0,newState="reconnecting"):"new"===roomSignaling.iceConnectionState||"checking"===roomSignaling.iceConnectionState?newState=roomSignaling._mediaConnectionIsReconnecting?"reconnecting":"connected":(roomSignaling._mediaConnectionIsReconnecting=!1,roomSignaling._reconnectingError=null,roomSignaling._sessionTimeout.clear(),newState="connected"),newState!==roomSignaling.state&&("reconnecting"===newState?(roomSignaling._reconnectingError="reconnecting"===roomSignaling.signalingConnectionState?new SignalingConnectionDisconnectedError:new MediaConnectionError,roomSignaling._sessionTimeout.start(),roomSignaling.preempt(newState,null,[roomSignaling._reconnectingError])):roomSignaling.preempt(newState))):roomSignaling._sessionTimeout.clear()}module.exports=RoomSignaling},M1q1:function(module,exports,__webpack_require__){"use strict";var _a=__webpack_require__("xwWy"),DEFAULT_LOG_LEVEL=_a.DEFAULT_LOG_LEVEL,DEFAULT_LOGGER_NAME=_a.DEFAULT_LOGGER_NAME;function createLocalTrack(kind,options){options=Object.assign({loggerName:DEFAULT_LOGGER_NAME,logLevel:DEFAULT_LOG_LEVEL},options);var createOptions={};createOptions.loggerName=options.loggerName,createOptions.logLevel=options.logLevel,delete options.loggerName,delete options.logLevel;var createLocalTracks=options.createLocalTracks;return delete options.createLocalTracks,createOptions[kind]=!(Object.keys(options).length>0)||options,createLocalTracks(createOptions).then((function(localTracks){return localTracks[0]}))}module.exports={audio:function(options){return createLocalTrack("audio",options)},video:function(options){return createLocalTrack("video",options)}}},MCLT:function(module,exports,__webpack_require__){var getOwnPropertyDescriptors=Object.getOwnPropertyDescriptors||function(obj){for(var keys=Object.keys(obj),descriptors={},i=0;i<keys.length;i++)descriptors[keys[i]]=Object.getOwnPropertyDescriptor(obj,keys[i]);return descriptors},formatRegExp=/%[sdj%]/g;exports.format=function(f){if(!isString(f)){for(var objects=[],i=0;i<arguments.length;i++)objects.push(inspect(arguments[i]));return objects.join(" ")}i=1;for(var args=arguments,len=args.length,str=String(f).replace(formatRegExp,(function(x){if("%%"===x)return"%";if(i>=len)return x;switch(x){case"%s":return String(args[i++]);case"%d":return Number(args[i++]);case"%j":try{return JSON.stringify(args[i++])}catch(_){return"[Circular]"}default:return x}})),x=args[i];i<len;x=args[++i])isNull(x)||!isObject(x)?str+=" "+x:str+=" "+inspect(x);return str},exports.deprecate=function(fn,msg){if("undefined"!=typeof process&&!0===process.noDeprecation)return fn;if("undefined"==typeof process)return function(){return exports.deprecate(fn,msg).apply(this,arguments)};var warned=!1;return function(){if(!warned){if(process.throwDeprecation)throw new Error(msg);process.traceDeprecation?console.trace(msg):console.error(msg),warned=!0}return fn.apply(this,arguments)}};var debugEnviron,debugs={};function inspect(obj,opts){var ctx={seen:[],stylize:stylizeNoColor};return arguments.length>=3&&(ctx.depth=arguments[2]),arguments.length>=4&&(ctx.colors=arguments[3]),isBoolean(opts)?ctx.showHidden=opts:opts&&exports._extend(ctx,opts),isUndefined(ctx.showHidden)&&(ctx.showHidden=!1),isUndefined(ctx.depth)&&(ctx.depth=2),isUndefined(ctx.colors)&&(ctx.colors=!1),isUndefined(ctx.customInspect)&&(ctx.customInspect=!0),ctx.colors&&(ctx.stylize=stylizeWithColor),formatValue(ctx,obj,ctx.depth)}function stylizeWithColor(str,styleType){var style=inspect.styles[styleType];return style?"["+inspect.colors[style][0]+"m"+str+"["+inspect.colors[style][1]+"m":str}function stylizeNoColor(str,styleType){return str}function formatValue(ctx,value,recurseTimes){if(ctx.customInspect&&value&&isFunction(value.inspect)&&value.inspect!==exports.inspect&&(!value.constructor||value.constructor.prototype!==value)){var ret=value.inspect(recurseTimes,ctx);return isString(ret)||(ret=formatValue(ctx,ret,recurseTimes)),ret}var primitive=function(ctx,value){if(isUndefined(value))return ctx.stylize("undefined","undefined");if(isString(value)){var simple="'"+JSON.stringify(value).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return ctx.stylize(simple,"string")}return isNumber(value)?ctx.stylize(""+value,"number"):isBoolean(value)?ctx.stylize(""+value,"boolean"):isNull(value)?ctx.stylize("null","null"):void 0}(ctx,value);if(primitive)return primitive;var keys=Object.keys(value),visibleKeys=function(array){var hash={};return array.forEach((function(val,idx){hash[val]=!0})),hash}(keys);if(ctx.showHidden&&(keys=Object.getOwnPropertyNames(value)),isError(value)&&(keys.indexOf("message")>=0||keys.indexOf("description")>=0))return formatError(value);if(0===keys.length){if(isFunction(value))return ctx.stylize("[Function"+(value.name?": "+value.name:"")+"]","special");if(isRegExp(value))return ctx.stylize(RegExp.prototype.toString.call(value),"regexp");if(isDate(value))return ctx.stylize(Date.prototype.toString.call(value),"date");if(isError(value))return formatError(value)}var output,base="",array=!1,braces=["{","}"];return isArray(value)&&(array=!0,braces=["[","]"]),isFunction(value)&&(base=" [Function"+(value.name?": "+value.name:"")+"]"),isRegExp(value)&&(base=" "+RegExp.prototype.toString.call(value)),isDate(value)&&(base=" "+Date.prototype.toUTCString.call(value)),isError(value)&&(base=" "+formatError(value)),0!==keys.length||array&&0!=value.length?recurseTimes<0?isRegExp(value)?ctx.stylize(RegExp.prototype.toString.call(value),"regexp"):ctx.stylize("[Object]","special"):(ctx.seen.push(value),output=array?function(ctx,value,recurseTimes,visibleKeys,keys){for(var output=[],i=0,l=value.length;i<l;++i)hasOwnProperty(value,String(i))?output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,String(i),!0)):output.push("");return keys.forEach((function(key){key.match(/^\d+$/)||output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,key,!0))})),output}(ctx,value,recurseTimes,visibleKeys,keys):keys.map((function(key){return formatProperty(ctx,value,recurseTimes,visibleKeys,key,array)})),ctx.seen.pop(),function(output,base,braces){return output.reduce((function(prev,cur){return cur.indexOf("\n"),prev+cur.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?braces[0]+(""===base?"":base+"\n ")+" "+output.join(",\n  ")+" "+braces[1]:braces[0]+base+" "+output.join(", ")+" "+braces[1]}(output,base,braces)):braces[0]+base+braces[1]}function formatError(value){return"["+Error.prototype.toString.call(value)+"]"}function formatProperty(ctx,value,recurseTimes,visibleKeys,key,array){var name,str,desc;if((desc=Object.getOwnPropertyDescriptor(value,key)||{value:value[key]}).get?str=ctx.stylize(desc.set?"[Getter/Setter]":"[Getter]","special"):desc.set&&(str=ctx.stylize("[Setter]","special")),hasOwnProperty(visibleKeys,key)||(name="["+key+"]"),str||(ctx.seen.indexOf(desc.value)<0?(str=isNull(recurseTimes)?formatValue(ctx,desc.value,null):formatValue(ctx,desc.value,recurseTimes-1)).indexOf("\n")>-1&&(str=array?str.split("\n").map((function(line){return"  "+line})).join("\n").substr(2):"\n"+str.split("\n").map((function(line){return"   "+line})).join("\n")):str=ctx.stylize("[Circular]","special")),isUndefined(name)){if(array&&key.match(/^\d+$/))return str;(name=JSON.stringify(""+key)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(name=name.substr(1,name.length-2),name=ctx.stylize(name,"name")):(name=name.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),name=ctx.stylize(name,"string"))}return name+": "+str}function isArray(ar){return Array.isArray(ar)}function isBoolean(arg){return"boolean"==typeof arg}function isNull(arg){return null===arg}function isNumber(arg){return"number"==typeof arg}function isString(arg){return"string"==typeof arg}function isUndefined(arg){return void 0===arg}function isRegExp(re){return isObject(re)&&"[object RegExp]"===objectToString(re)}function isObject(arg){return"object"==typeof arg&&null!==arg}function isDate(d){return isObject(d)&&"[object Date]"===objectToString(d)}function isError(e){return isObject(e)&&("[object Error]"===objectToString(e)||e instanceof Error)}function isFunction(arg){return"function"==typeof arg}function objectToString(o){return Object.prototype.toString.call(o)}function pad(n){return n<10?"0"+n.toString(10):n.toString(10)}exports.debuglog=function(set){if(isUndefined(debugEnviron)&&(debugEnviron=process.env.NODE_DEBUG||""),set=set.toUpperCase(),!debugs[set])if(new RegExp("\\b"+set+"\\b","i").test(debugEnviron)){var pid=process.pid;debugs[set]=function(){var msg=exports.format.apply(exports,arguments);console.error("%s %d: %s",set,pid,msg)}}else debugs[set]=function(){};return debugs[set]},exports.inspect=inspect,inspect.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},inspect.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},exports.isArray=isArray,exports.isBoolean=isBoolean,exports.isNull=isNull,exports.isNullOrUndefined=function(arg){return null==arg},exports.isNumber=isNumber,exports.isString=isString,exports.isSymbol=function(arg){return"symbol"==typeof arg},exports.isUndefined=isUndefined,exports.isRegExp=isRegExp,exports.isObject=isObject,exports.isDate=isDate,exports.isError=isError,exports.isFunction=isFunction,exports.isPrimitive=function(arg){return null===arg||"boolean"==typeof arg||"number"==typeof arg||"string"==typeof arg||"symbol"==typeof arg||void 0===arg},exports.isBuffer=__webpack_require__("1gqn");var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function timestamp(){var d=new Date,time=[pad(d.getHours()),pad(d.getMinutes()),pad(d.getSeconds())].join(":");return[d.getDate(),months[d.getMonth()],time].join(" ")}function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}exports.log=function(){console.log("%s - %s",timestamp(),exports.format.apply(exports,arguments))},exports.inherits=__webpack_require__("KKCa"),exports._extend=function(origin,add){if(!add||!isObject(add))return origin;for(var keys=Object.keys(add),i=keys.length;i--;)origin[keys[i]]=add[keys[i]];return origin};var kCustomPromisifiedSymbol="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function callbackifyOnRejected(reason,cb){if(!reason){var newReason=new Error("Promise was rejected with a falsy value");newReason.reason=reason,reason=newReason}return cb(reason)}exports.promisify=function(original){if("function"!=typeof original)throw new TypeError('The "original" argument must be of type Function');if(kCustomPromisifiedSymbol&&original[kCustomPromisifiedSymbol]){var fn;if("function"!=typeof(fn=original[kCustomPromisifiedSymbol]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(fn,kCustomPromisifiedSymbol,{value:fn,enumerable:!1,writable:!1,configurable:!0}),fn}function fn(){for(var promiseResolve,promiseReject,promise=new Promise((function(resolve,reject){promiseResolve=resolve,promiseReject=reject})),args=[],i=0;i<arguments.length;i++)args.push(arguments[i]);args.push((function(err,value){err?promiseReject(err):promiseResolve(value)}));try{original.apply(this,args)}catch(err){promiseReject(err)}return promise}return Object.setPrototypeOf(fn,Object.getPrototypeOf(original)),kCustomPromisifiedSymbol&&Object.defineProperty(fn,kCustomPromisifiedSymbol,{value:fn,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(fn,getOwnPropertyDescriptors(original))},exports.promisify.custom=kCustomPromisifiedSymbol,exports.callbackify=function(original){if("function"!=typeof original)throw new TypeError('The "original" argument must be of type Function');function callbackified(){for(var args=[],i=0;i<arguments.length;i++)args.push(arguments[i]);var maybeCb=args.pop();if("function"!=typeof maybeCb)throw new TypeError("The last argument must be of type Function");var self=this,cb=function(){return maybeCb.apply(self,arguments)};original.apply(this,args).then((function(ret){process.nextTick(cb,null,ret)}),(function(rej){process.nextTick(callbackifyOnRejected,rej,cb)}))}return Object.setPrototypeOf(callbackified,Object.getPrototypeOf(original)),Object.defineProperties(callbackified,getOwnPropertyDescriptors(original)),callbackified}},MItk:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),MediaStreamTrack=__webpack_require__("NBph").MediaStreamTrack,_a=__webpack_require__("ghd6"),asLocalTrack=_a.asLocalTrack,asLocalTrackPublication=_a.asLocalTrackPublication,trackClass=_a.trackClass,_b=__webpack_require__("xwWy"),E=_b.typeErrors,trackPriority=_b.trackPriority,validateLocalTrack=__webpack_require__("N7NK").validateLocalTrack,_c=__webpack_require__("VR5W"),LocalAudioTrack=_c.LocalAudioTrack,LocalDataTrack=_c.LocalDataTrack,LocalVideoTrack=_c.LocalVideoTrack,LocalAudioTrackPublication=__webpack_require__("CSzv"),LocalDataTrackPublication=__webpack_require__("deyy"),LocalVideoTrackPublication=__webpack_require__("LFO1"),LocalParticipant=function(_super){function LocalParticipant(signaling,localTracks,options){var _this=this,tracksToStop=(options=Object.assign({LocalAudioTrack:LocalAudioTrack,LocalVideoTrack:LocalVideoTrack,LocalDataTrack:LocalDataTrack,MediaStreamTrack:MediaStreamTrack,LocalAudioTrackPublication:LocalAudioTrackPublication,LocalVideoTrackPublication:LocalVideoTrackPublication,LocalDataTrackPublication:LocalDataTrackPublication,shouldStopLocalTracks:!1,tracks:localTracks},options)).shouldStopLocalTracks?new Set(localTracks.filter((function(localTrack){return"data"!==localTrack.kind}))):new Set;return _this=_super.call(this,signaling,options)||this,Object.defineProperties(_this,{_eventObserver:{value:options.eventObserver},_LocalAudioTrack:{value:options.LocalAudioTrack},_LocalDataTrack:{value:options.LocalDataTrack},_LocalVideoTrack:{value:options.LocalVideoTrack},_MediaStreamTrack:{value:options.MediaStreamTrack},_LocalAudioTrackPublication:{value:options.LocalAudioTrackPublication},_LocalDataTrackPublication:{value:options.LocalDataTrackPublication},_LocalVideoTrackPublication:{value:options.LocalVideoTrackPublication},_tracksToStop:{value:tracksToStop},signalingRegion:{enumerable:!0,get:function(){return signaling.signalingRegion}}}),_this._handleTrackSignalingEvents(),_this}return __extends(LocalParticipant,_super),LocalParticipant.prototype._addTrack=function(track,id,priority){var addedTrack=_super.prototype._addTrack.call(this,track,id);return addedTrack&&"disconnected"!==this.state&&this._addLocalTrack(track,priority),addedTrack},LocalParticipant.prototype._addLocalTrack=function(track,priority){this._signaling.addTrack(track._trackSender,track.name,priority),this._log.info("Added a new "+trackClass(track,!0)+":",track.id),this._log.debug(trackClass(track,!0)+":",track)},LocalParticipant.prototype._removeTrack=function(track,id){var removedTrack=_super.prototype._removeTrack.call(this,track,id);return removedTrack&&"disconnected"!==this.state&&(this._signaling.removeTrack(track._trackSender),this._log.info("Removed a "+trackClass(track,!0)+":",track.id),this._log.debug(trackClass(track,!0)+":",track)),removedTrack},LocalParticipant.prototype._getTrackEvents=function(){return _super.prototype._getTrackEvents.call(this).concat([["disabled","trackDisabled"],["enabled","trackEnabled"],["stopped","trackStopped"]])},LocalParticipant.prototype.toString=function(){return"[LocalParticipant #"+this._instanceId+(this.sid?": "+this.sid:"")+"]"},LocalParticipant.prototype._handleTrackSignalingEvents=function(){var _this=this,log=this._log;if("disconnected"!==this.state){var signaling=this._signaling;this.on("trackDisabled",localTrackDisabled),this.on("trackEnabled",localTrackEnabled),this.on("trackStopped",localTrackStopped),this._tracks.forEach((function(track){_this._addLocalTrack(track,trackPriority.PRIORITY_STANDARD),_this._getOrCreateLocalTrackPublication(track).catch((function(error){log.warn("Failed to get or create LocalTrackPublication for "+track+":",error)}))}));var self=this;signaling.on("stateChanged",(function stateChanged(state){log.debug("Transitioned to state:",state),"disconnected"===state?(log.debug("Removing LocalTrack event listeners"),signaling.removeListener("stateChanged",stateChanged),self.removeListener("trackDisabled",localTrackDisabled),self.removeListener("trackEnabled",localTrackEnabled),self.removeListener("trackStopped",localTrackStopped),self._tracks.forEach((function(track){var trackSignaling=localTrackStopped(track);trackSignaling&&track._trackSender.removeClone(trackSignaling._trackTransceiver)})),log.info("LocalParticipant disconnected. Stopping "+self._tracksToStop.size+" automatically-acquired LocalTracks"),self._tracksToStop.forEach((function(track){track.stop()}))):"connected"===state&&(log.info("reconnected"),setTimeout((function(){return self.emit("reconnected")}),0))}))}function localTrackDisabled(localTrack){var trackSignaling=signaling.getPublication(localTrack._trackSender);trackSignaling&&(trackSignaling.disable(),log.debug("Disabled the "+trackClass(localTrack,!0)+":",localTrack.id))}function localTrackEnabled(localTrack){var trackSignaling=signaling.getPublication(localTrack._trackSender);trackSignaling&&(trackSignaling.enable(),log.debug("Enabled the "+trackClass(localTrack,!0)+":",localTrack.id))}function localTrackStopped(localTrack){var trackSignaling=signaling.getPublication(localTrack._trackSender);return trackSignaling&&trackSignaling.stop(),trackSignaling}},LocalParticipant.prototype._getOrCreateLocalTrackPublication=function(localTrack){var localTrackPublication=getTrackPublication(this.tracks,localTrack);if(localTrackPublication)return Promise.resolve(localTrackPublication);var log=this._log,self=this,trackSignaling=this._signaling.getPublication(localTrack._trackSender);if(!trackSignaling)return Promise.reject(new Error("Unexpected error: The "+localTrack+" cannot be published"));function unpublish(publication){self.unpublishTrack(publication.track)}return new Promise((function(resolve,reject){trackSignaling.on("updated",(function updated(){var error=trackSignaling.error;if(error)return trackSignaling.removeListener("updated",updated),log.warn("Failed to publish the "+trackClass(localTrack,!0)+": "+error.message),self._removeTrack(localTrack,localTrack.id),setTimeout((function(){self.emit("trackPublicationFailed",error,localTrack)})),void reject(error);if(!self._tracks.has(localTrack.id))return trackSignaling.removeListener("updated",updated),void reject(new Error("The "+localTrack+" was unpublished"));if(trackSignaling.sid){trackSignaling.removeListener("updated",updated);var options={log:log,LocalAudioTrackPublication:self._LocalAudioTrackPublication,LocalDataTrackPublication:self._LocalDataTrackPublication,LocalVideoTrackPublication:self._LocalVideoTrackPublication};(localTrackPublication=getTrackPublication(self.tracks,localTrack))||(localTrackPublication=asLocalTrackPublication(localTrack,trackSignaling,unpublish,options),self._addTrackPublication(localTrackPublication));var state=self._signaling.state;"connected"!==state&&"connecting"!==state||(localTrack._processorEventObserver&&localTrack._processorEventObserver.on("event",(function(event){self._eventObserver.emit("event",{name:event.name,payload:event.data,group:"video-processor",level:"info"})})),localTrack.processedTrack&&(localTrack._captureFrames(),localTrack._setSenderMediaStreamTrack(!0))),"connected"===state&&setTimeout((function(){self.emit("trackPublished",localTrackPublication)})),resolve(localTrackPublication)}}))}))},LocalParticipant.prototype.publishTrack=function(localTrackOrMediaStreamTrack,options){var localTrack,trackPublication=getTrackPublication(this.tracks,localTrackOrMediaStreamTrack);if(trackPublication)return Promise.resolve(trackPublication);options=Object.assign({log:this._log,priority:trackPriority.PRIORITY_STANDARD,LocalAudioTrack:this._LocalAudioTrack,LocalDataTrack:this._LocalDataTrack,LocalVideoTrack:this._LocalVideoTrack,MediaStreamTrack:this._MediaStreamTrack},options);try{localTrack=asLocalTrack(localTrackOrMediaStreamTrack,options)}catch(error){return Promise.reject(error)}var priorityValues=Object.values(trackPriority);if(!priorityValues.includes(options.priority))return Promise.reject(E.INVALID_VALUE("LocalTrackPublishOptions.priority",priorityValues));var addedLocalTrack=this._addTrack(localTrack,localTrack.id,options.priority)||this._tracks.get(localTrack.id);return this._getOrCreateLocalTrackPublication(addedLocalTrack)},LocalParticipant.prototype.publishTracks=function(tracks){if(!Array.isArray(tracks))throw E.INVALID_TYPE("tracks","Array of LocalAudioTrack, LocalVideoTrack, LocalDataTrack, or MediaStreamTrack");return Promise.all(tracks.map(this.publishTrack,this))},LocalParticipant.prototype.setBandwidthProfile=function(){this._log.warn("setBandwidthProfile is not implemented yet and may be available in future versions of twilio-video.js")},LocalParticipant.prototype.setNetworkQualityConfiguration=function(networkQualityConfiguration){if("object"!=typeof networkQualityConfiguration||null===networkQualityConfiguration)throw E.INVALID_TYPE("networkQualityConfiguration","NetworkQualityConfiguration");return["local","remote"].forEach((function(prop){if(prop in networkQualityConfiguration&&("number"!=typeof networkQualityConfiguration[prop]||isNaN(networkQualityConfiguration[prop])))throw E.INVALID_TYPE("networkQualityConfiguration."+prop,"number")})),this._signaling.setNetworkQualityConfiguration(networkQualityConfiguration),this},LocalParticipant.prototype.setParameters=function(encodingParameters){if(void 0!==encodingParameters&&"object"!=typeof encodingParameters)throw E.INVALID_TYPE("encodingParameters","EncodingParameters, null or undefined");if(encodingParameters){if(this._signaling.getParameters().adaptiveSimulcast&&encodingParameters.maxVideoBitrate)throw E.INVALID_TYPE("encodingParameters",'encodingParameters.maxVideoBitrate is not compatible with "preferredVideoCodecs=auto"');["maxAudioBitrate","maxVideoBitrate"].forEach((function(prop){if(void 0!==encodingParameters[prop]&&"number"!=typeof encodingParameters[prop]&&null!==encodingParameters[prop])throw E.INVALID_TYPE("encodingParameters."+prop,"number, null or undefined")}))}else null===encodingParameters&&(encodingParameters={maxAudioBitrate:null,maxVideoBitrate:null});return this._signaling.setParameters(encodingParameters),this},LocalParticipant.prototype.unpublishTrack=function(track){validateLocalTrack(track,{LocalAudioTrack:this._LocalAudioTrack,LocalDataTrack:this._LocalDataTrack,LocalVideoTrack:this._LocalVideoTrack,MediaStreamTrack:this._MediaStreamTrack});var localTrack=this._tracks.get(track.id);if(!localTrack)return null;if(this._signaling.getPublication(localTrack._trackSender).publishFailed(new Error("The "+localTrack+" was unpublished")),!(localTrack=this._removeTrack(localTrack,localTrack.id)))return null;var localTrackPublication=getTrackPublication(this.tracks,localTrack);return localTrackPublication&&this._removeTrackPublication(localTrackPublication),localTrackPublication},LocalParticipant.prototype.unpublishTracks=function(tracks){var _this=this;if(!Array.isArray(tracks))throw E.INVALID_TYPE("tracks","Array of LocalAudioTrack, LocalVideoTrack, LocalDataTrack, or MediaStreamTrack");return tracks.reduce((function(unpublishedTracks,track){var unpublishedTrack=_this.unpublishTrack(track);return unpublishedTrack?unpublishedTracks.concat(unpublishedTrack):unpublishedTracks}),[])},LocalParticipant}(__webpack_require__("TTpt"));function getTrackPublication(trackPublications,track){return Array.from(trackPublications.values()).find((function(trackPublication){return trackPublication.track===track||trackPublication.track.mediaStreamTrack===track}))||null}module.exports=LocalParticipant},N7NK:function(module,exports,__webpack_require__){"use strict";var isNonArrayObject=__webpack_require__("ghd6").isNonArrayObject,_a=__webpack_require__("xwWy"),E=_a.typeErrors,clientTrackSwitchOffControl=_a.clientTrackSwitchOffControl,videoContentPreferencesMode=_a.videoContentPreferencesMode,subscriptionMode=_a.subscriptionMode,trackPriority=_a.trackPriority,trackSwitchOffMode=_a.trackSwitchOffMode;function validateObject(object,name,propChecks){return void 0===propChecks&&(propChecks=[]),void 0===object?null:null!==object&&isNonArrayObject(object)?propChecks.reduce((function(error,_a){var prop=_a.prop,type=_a.type,values=_a.values;if(error||!(prop in object))return error;var value=object[prop];return type&&typeof value!==type||"number"===type&&isNaN(value)?E.INVALID_TYPE(name+"."+prop,type):Array.isArray(values)&&!values.includes(value)?E.INVALID_VALUE(name+"."+prop,values):error}),null):E.INVALID_TYPE(name,"object")}exports.validateBandwidthProfile=function(bandwidthProfile){var error=validateObject(bandwidthProfile,"options.bandwidthProfile");return!bandwidthProfile||error?error:(error=validateObject(bandwidthProfile.video,"options.bandwidthProfile.video",[{prop:"contentPreferencesMode",values:Object.values(videoContentPreferencesMode)},{prop:"dominantSpeakerPriority",values:Object.values(trackPriority)},{prop:"maxSubscriptionBitrate",type:"number"},{prop:"maxTracks",type:"number"},{prop:"mode",values:Object.values(subscriptionMode)},{prop:"clientTrackSwitchOffControl",values:Object.values(clientTrackSwitchOffControl)},{prop:"trackSwitchOffMode",values:Object.values(trackSwitchOffMode)}]))||(bandwidthProfile.video?"maxTracks"in bandwidthProfile.video&&"clientTrackSwitchOffControl"in bandwidthProfile.video?new TypeError("options.bandwidthProfile.video.maxTracks is deprecated. Use options.bandwidthProfile.video.clientTrackSwitchOffControl instead."):"renderDimensions"in bandwidthProfile.video&&"contentPreferencesMode"in bandwidthProfile.video?new TypeError("options.bandwidthProfile.video.renderDimensions is deprecated. Use options.bandwidthProfile.video.contentPreferencesMode instead."):function(renderDimensions){var name="options.bandwidthProfile.video.renderDimensions",error=validateObject(renderDimensions,name);return renderDimensions?error||Object.values(trackPriority).reduce((function(error,prop){return error||validateObject(renderDimensions[prop],name+"."+prop,[{prop:"height",type:"number"},{prop:"width",type:"number"}])}),null):error}(bandwidthProfile.video.renderDimensions):null)},exports.validateLocalTrack=function(track,options){if(!(track instanceof options.LocalAudioTrack||track instanceof options.LocalDataTrack||track instanceof options.LocalVideoTrack||track instanceof options.MediaStreamTrack))throw E.INVALID_TYPE("track","LocalAudioTrack, LocalVideoTrack, LocalDataTrack, or MediaStreamTrack")},exports.validateObject=validateObject},NBph:function(module,exports,__webpack_require__){"use strict";var WebRTC={};Object.defineProperties(WebRTC,{getStats:{enumerable:!0,value:__webpack_require__("/4oH")},getUserMedia:{enumerable:!0,value:__webpack_require__("R6uM")},MediaStream:{enumerable:!0,value:__webpack_require__("1go7")},MediaStreamTrack:{enumerable:!0,value:__webpack_require__("0Tt/")},RTCIceCandidate:{enumerable:!0,value:__webpack_require__("52Yu")},RTCPeerConnection:{enumerable:!0,value:__webpack_require__("x3fV")},RTCSessionDescription:{enumerable:!0,value:__webpack_require__("4N67")}}),module.exports=WebRTC},NCuz:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),EventEmitter=__webpack_require__("mAYT"),_a=__webpack_require__("ghd6"),buildLogLevels=_a.buildLogLevels,valueToJSON=_a.valueToJSON,DEFAULT_LOG_LEVEL=__webpack_require__("xwWy").DEFAULT_LOG_LEVEL,Log=__webpack_require__("S3Hu"),nInstances=0,Track=function(_super){function Track(id,kind,options){var _this;options=Object.assign({name:id,log:null,logLevel:DEFAULT_LOG_LEVEL},options),_this=_super.call(this)||this;var name=String(options.name),logLevels=buildLogLevels(options.logLevel),log=options.log?options.log.createLog("media",_this):new Log("media",_this,logLevels,options.loggerName);return Object.defineProperties(_this,{_instanceId:{value:++nInstances},_log:{value:log},kind:{enumerable:!0,value:kind},name:{enumerable:!0,value:name}}),_this}return __extends(Track,_super),Track.prototype.toJSON=function(){return valueToJSON(this)},Track}(EventEmitter);module.exports=Track},NSCw:function(module,exports,__webpack_require__){"use strict";module.exports=function(_a){var _b=_a.actual,_c=_a.available,_d=_a.level;Object.defineProperties(this,{actual:{value:void 0===_b?null:_b,enumerable:!0},available:{value:void 0===_c?null:_c,enumerable:!0},level:{value:void 0===_d?null:_d,enumerable:!0}})}},NXBa:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),SenderOrReceiverReportFactory=__webpack_require__("akGs"),SenderReport=__webpack_require__("HNKe"),SenderReportFactory=function(_super){function SenderReportFactory(trackId,initialStats){var _this=_super.call(this,initialStats.id,trackId,initialStats)||this;return Object.defineProperties(_this,{lastReport:{enumerable:!0,value:null,writable:!0}}),_this}return __extends(SenderReportFactory,_super),SenderReportFactory.prototype.next=function(trackId,newerStats,newerRemoteStats){var olderStats=this.lastStats;this.lastStats=newerStats,this.trackId=trackId;var report=SenderReport.of(trackId,olderStats,newerStats,newerRemoteStats);return this.lastReport=report,report},SenderReportFactory}(SenderOrReceiverReportFactory);module.exports=SenderReportFactory},O22K:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},MediaTrackSender=function(_super){function MediaTrackSender(mediaStreamTrack){var _this=_super.call(this,mediaStreamTrack.id,mediaStreamTrack)||this;return Object.defineProperties(_this,{_clones:{value:new Set},_senders:{value:new Set},_senderToPublisherHintCallbacks:{value:new Map},isPublishing:{get:function(){return!!this._clones.size}}}),_this}return __extends(MediaTrackSender,_super),MediaTrackSender.prototype.clone=function(){var clone=new MediaTrackSender(this.track.clone());return this._clones.add(clone),clone},MediaTrackSender.prototype.removeClone=function(clone){this._clones.delete(clone)},MediaTrackSender.prototype.setMediaStreamTrack=function(mediaStreamTrack){var _this=this,clones=Array.from(this._clones),senders=Array.from(this._senders);return Promise.all(clones.map((function(clone){return clone.setMediaStreamTrack(mediaStreamTrack.clone())})).concat(senders.map((function(sender){return _this._replaceTrack(sender,mediaStreamTrack)})))).finally((function(){_this._track=mediaStreamTrack}))},MediaTrackSender.prototype.addSender=function(sender,publisherHintCallback){return this._senders.add(sender),publisherHintCallback&&this._senderToPublisherHintCallbacks.set(sender,publisherHintCallback),this},MediaTrackSender.prototype.removeSender=function(sender){return this._senders.delete(sender),this._senderToPublisherHintCallbacks.delete(sender),this},MediaTrackSender.prototype.setPublisherHint=function(encodings){var publisherHintCallback=__read(Array.from(this._senderToPublisherHintCallbacks.values()),1)[0];return publisherHintCallback?publisherHintCallback(encodings):Promise.resolve("COULD_NOT_APPLY_HINT")},MediaTrackSender.prototype._replaceTrack=function(sender,mediaStreamTrack){var _this=this;return sender.replaceTrack(mediaStreamTrack).then((function(replaceTrackResult){return _this.setPublisherHint(null).catch((function(){})),_this.emit("replaced"),replaceTrackResult}))},MediaTrackSender}(__webpack_require__("uBG5"));module.exports=MediaTrackSender},OD4n:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),MediaSignaling=__webpack_require__("zbom"),Timeout=__webpack_require__("Y1/N"),isDeepEqual=__webpack_require__("ghd6").isDeepEqual,messageId=1,RenderHintsSignaling=function(_super){function RenderHintsSignaling(getReceiver,options){var _this=_super.call(this,getReceiver,"render_hints",options)||this;return Object.defineProperties(_this,{_trackSidsToRenderHints:{value:new Map},_responseTimer:{value:new Timeout((function(){_this._sendAllHints(),_this._responseTimer.setDelay(2*_this._responseTimer.delay)}),2e3,!1)}}),_this.on("ready",(function(transport){transport.on("message",(function(message){switch(_this._log.debug("Incoming: ",message),message.type){case"render_hints":_this._processHintResults(message&&message.subscriber&&message.subscriber.hints||[]);break;default:_this._log.warn("Unknown message type: ",message.type)}})),_this._sendAllHints()})),_this}return __extends(RenderHintsSignaling,_super),RenderHintsSignaling.prototype._sendAllHints=function(){var _this=this;Array.from(this._trackSidsToRenderHints.keys()).forEach((function(trackSid){var trackState=_this._trackSidsToRenderHints.get(trackSid);trackState.renderDimensions&&(trackState.isDimensionDirty=!0),"enabled"in trackState&&(trackState.isEnabledDirty=!0)})),this._sendHints()},RenderHintsSignaling.prototype._processHintResults=function(hintResults){var _this=this;this._responseTimer.clear(),this._responseTimer.setDelay(2e3),hintResults.forEach((function(hintResult){"OK"!==hintResult.result&&_this._log.debug("Server error processing hint:",hintResult)})),this._sendHints()},RenderHintsSignaling.prototype._sendHints=function(){var _this=this;if(this._transport&&!this._responseTimer.isSet){var hints=[];if(Array.from(this._trackSidsToRenderHints.keys()).forEach((function(trackSid){var trackState=_this._trackSidsToRenderHints.get(trackSid);if(trackState.isEnabledDirty||trackState.isDimensionDirty){var mspHint={track:trackSid};trackState.isEnabledDirty&&(mspHint.enabled=trackState.enabled,trackState.isEnabledDirty=!1),trackState.isDimensionDirty&&(mspHint.render_dimensions=trackState.renderDimensions,trackState.isDimensionDirty=!1),hints.push(mspHint)}})),hints.length>0){var payLoad={type:"render_hints",subscriber:{id:messageId++,hints:hints}};this._log.debug("Outgoing: ",payLoad),this._transport.publish(payLoad),this._responseTimer.start()}}},RenderHintsSignaling.prototype.setTrackHint=function(trackSid,renderHint){var trackState=this._trackSidsToRenderHints.get(trackSid)||{isEnabledDirty:!1,isDimensionDirty:!1};"enabled"in renderHint&&trackState.enabled!==renderHint.enabled&&(trackState.enabled=!!renderHint.enabled,trackState.isEnabledDirty=!0),renderHint.renderDimensions&&!isDeepEqual(renderHint.renderDimensions,trackState.renderDimensions)&&(trackState.renderDimensions=renderHint.renderDimensions,trackState.isDimensionDirty=!0),this._trackSidsToRenderHints.set(trackSid,trackState),this._sendHints()},RenderHintsSignaling.prototype.clearTrackHint=function(trackSid){this._trackSidsToRenderHints.delete(trackSid)},RenderHintsSignaling}(MediaSignaling);module.exports=RenderHintsSignaling},P7XM:function(module,exports){module.exports="function"==typeof Object.create?function(ctor,superCtor){superCtor&&(ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}}))}:function(ctor,superCtor){if(superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype,ctor.prototype=new TempCtor,ctor.prototype.constructor=ctor}}},PrET:function(module,exports,__webpack_require__){"use strict";var bind=__webpack_require__("D3zA"),GetIntrinsic=__webpack_require__("AM7I"),$apply=GetIntrinsic("%Function.prototype.apply%"),$call=GetIntrinsic("%Function.prototype.call%"),$reflectApply=GetIntrinsic("%Reflect.apply%",!0)||bind.call($call,$apply),$gOPD=GetIntrinsic("%Object.getOwnPropertyDescriptor%",!0),$defineProperty=GetIntrinsic("%Object.defineProperty%",!0),$max=GetIntrinsic("%Math.max%");if($defineProperty)try{$defineProperty({},"a",{value:1})}catch(e){$defineProperty=null}module.exports=function(originalFunction){var func=$reflectApply(bind,$call,arguments);if($gOPD&&$defineProperty){var desc=$gOPD(func,"length");desc.configurable&&$defineProperty(func,"length",{value:1+$max(0,originalFunction.length-(arguments.length-1))})}return func};var applyBind=function(){return $reflectApply(bind,$apply,arguments)};$defineProperty?$defineProperty(module.exports,"apply",{value:applyBind}):module.exports.apply=applyBind},QB7E:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),LocalParticipantSignaling=__webpack_require__("3oWx"),LocalTrackPublicationV2=__webpack_require__("Ye3u"),DEFAULT_LOG_LEVEL=__webpack_require__("xwWy").DEFAULT_LOG_LEVEL,Log=__webpack_require__("S3Hu"),_a=__webpack_require__("ghd6"),buildLogLevels=_a.buildLogLevels,isDeepEqual=_a.isDeepEqual,LocalParticipantV2=function(_super){function LocalParticipantV2(encodingParameters,networkQualityConfiguration,options){var _this;options=Object.assign({logLevel:DEFAULT_LOG_LEVEL,LocalTrackPublicationV2:LocalTrackPublicationV2},options),_this=_super.call(this)||this;var logLevels=buildLogLevels(options.logLevel);return Object.defineProperties(_this,{_bandwidthProfile:{value:null,writable:!0},_bandwidthProfileRevision:{value:0,writable:!0},_encodingParameters:{value:encodingParameters},_removeListeners:{value:new Map},_LocalTrackPublicationV2:{value:options.LocalTrackPublicationV2},_log:{value:options.log?options.log.createLog("default",_this):new Log("default",_this,logLevels,options.loggerName)},_publishedRevision:{writable:!0,value:0},_revision:{writable:!0,value:1},_signalingRegion:{value:null,writable:!0},bandwidthProfile:{enumerable:!0,get:function(){return this._bandwidthProfile}},bandwidthProfileRevision:{enumerable:!0,get:function(){return this._bandwidthProfileRevision}},networkQualityConfiguration:{enumerable:!0,value:networkQualityConfiguration},revision:{enumerable:!0,get:function(){return this._revision}},signalingRegion:{enumerable:!0,get:function(){return this._signalingRegion}}}),_this}return __extends(LocalParticipantV2,_super),LocalParticipantV2.prototype.toString=function(){return"[LocalParticipantSignaling: "+this.sid+"]"},LocalParticipantV2.prototype.setSignalingRegion=function(signalingRegion){this._signalingRegion||(this._signalingRegion=signalingRegion)},LocalParticipantV2.prototype.setBandwidthProfile=function(bandwidthProfile){isDeepEqual(this._bandwidthProfile,bandwidthProfile)||(this._bandwidthProfile=JSON.parse(JSON.stringify(bandwidthProfile)),this._bandwidthProfileRevision++,this.didUpdate())},LocalParticipantV2.prototype.getParameters=function(){return this._encodingParameters},LocalParticipantV2.prototype.setParameters=function(encodingParameters){return this._encodingParameters.update(encodingParameters),this},LocalParticipantV2.prototype.update=function(published){return this._publishedRevision>=published.revision||(this._publishedRevision=published.revision,published.tracks.forEach((function(publicationState){var localTrackPublicationV2=this.tracks.get(publicationState.id);localTrackPublicationV2&&localTrackPublicationV2.update(publicationState)}),this)),this},LocalParticipantV2.prototype._createLocalTrackPublicationSignaling=function(trackSender,name,priority){return new this._LocalTrackPublicationV2(trackSender,name,priority)},LocalParticipantV2.prototype.addTrack=function(trackSender,name,priority){var _this=this;_super.prototype.addTrack.call(this,trackSender,name,priority);var publication=this.getPublication(trackSender),isEnabled=publication.isEnabled,updatedPriority=publication.updatedPriority,updated=function(){isEnabled===publication.isEnabled&&updatedPriority===publication.updatedPriority||(_this.didUpdate(),isEnabled=publication.isEnabled,updatedPriority=publication.updatedPriority)};return publication.on("updated",updated),this._removeListener(publication),this._removeListeners.set(publication,(function(){return publication.removeListener("updated",updated)})),this.didUpdate(),this},LocalParticipantV2.prototype._removeListener=function(publication){var removeListener=this._removeListeners.get(publication);removeListener&&removeListener()},LocalParticipantV2.prototype.getState=function(){return{revision:this.revision,tracks:Array.from(this.tracks.values()).map((function(track){return track.getState()}))}},LocalParticipantV2.prototype.didUpdate=function(){this._revision++,this.emit("updated")},LocalParticipantV2.prototype.removeTrack=function(trackSender){var publication=_super.prototype.removeTrack.call(this,trackSender);return publication&&(trackSender.removeClone(publication.trackTransceiver),this._removeListener(publication),this.didUpdate()),publication},LocalParticipantV2.prototype.setNetworkQualityConfiguration=function(networkQualityConfiguration){this.networkQualityConfiguration.update(networkQualityConfiguration)},LocalParticipantV2.prototype.setPublisherHint=function(trackSid,encodings){var trackSignaling=Array.from(this.tracks.values()).find((function(trackPub){return trackPub.sid===trackSid}));return trackSignaling?trackSignaling.trackTransceiver.setPublisherHint(encodings):(this._log.warn("track:"+trackSid+" not found"),Promise.resolve("UNKNOWN_TRACK"))},LocalParticipantV2}(LocalParticipantSignaling);module.exports=LocalParticipantV2},QH9v:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),DataTrackTransceiver=__webpack_require__("UpXp"),makeUUID=__webpack_require__("ghd6").makeUUID,DataTrackSender=function(_super){function DataTrackSender(maxPacketLifeTime,maxRetransmtis,ordered){var _this=_super.call(this,makeUUID(),maxPacketLifeTime,maxRetransmtis,ordered)||this;return Object.defineProperties(_this,{_clones:{value:new Set},_dataChannels:{value:new Set}}),_this}return __extends(DataTrackSender,_super),DataTrackSender.prototype._addClone=function(clone){this._clones.add(clone)},DataTrackSender.prototype.removeClone=function(clone){this._clones.delete(clone)},DataTrackSender.prototype.addDataChannel=function(dataChannel){return this._dataChannels.add(dataChannel),this},DataTrackSender.prototype.clone=function(){var _this=this,clone=new DataTrackSender(this.maxPacketLifeTime,this.maxRetransmits,this.ordered);return this._addClone(clone),clone.once("stopped",(function(){return _this.removeClone(clone)})),clone},DataTrackSender.prototype.removeDataChannel=function(dataChannel){return this._dataChannels.delete(dataChannel),this},DataTrackSender.prototype.send=function(data){return this._dataChannels.forEach((function(dataChannel){try{dataChannel.send(data)}catch(error){}})),this._clones.forEach((function(clone){try{clone.send(data)}catch(error){}})),this},DataTrackSender.prototype.stop=function(){this._dataChannels.forEach((function(dataChannel){return dataChannel.close()})),this._clones.forEach((function(clone){return clone.stop()})),_super.prototype.stop.call(this)},DataTrackSender}(DataTrackTransceiver);module.exports=DataTrackSender},QsSX:function(module,exports,__webpack_require__){var events=__webpack_require__("+qE3"),precond=__webpack_require__("zMHY"),util=__webpack_require__("MCLT"),Backoff=__webpack_require__("KGUp"),FibonacciBackoffStrategy=__webpack_require__("HOot");function FunctionCall(fn,args,callback){events.EventEmitter.call(this),precond.checkIsFunction(fn,"Expected fn to be a function."),precond.checkIsArray(args,"Expected args to be an array."),precond.checkIsFunction(callback,"Expected callback to be a function."),this.function_=fn,this.arguments_=args,this.callback_=callback,this.lastResult_=[],this.numRetries_=0,this.backoff_=null,this.strategy_=null,this.failAfter_=-1,this.retryPredicate_=FunctionCall.DEFAULT_RETRY_PREDICATE_,this.state_=FunctionCall.State_.PENDING}util.inherits(FunctionCall,events.EventEmitter),FunctionCall.State_={PENDING:0,RUNNING:1,COMPLETED:2,ABORTED:3},FunctionCall.DEFAULT_RETRY_PREDICATE_=function(err){return!0},FunctionCall.prototype.isPending=function(){return this.state_==FunctionCall.State_.PENDING},FunctionCall.prototype.isRunning=function(){return this.state_==FunctionCall.State_.RUNNING},FunctionCall.prototype.isCompleted=function(){return this.state_==FunctionCall.State_.COMPLETED},FunctionCall.prototype.isAborted=function(){return this.state_==FunctionCall.State_.ABORTED},FunctionCall.prototype.setStrategy=function(strategy){return precond.checkState(this.isPending(),"FunctionCall in progress."),this.strategy_=strategy,this},FunctionCall.prototype.retryIf=function(retryPredicate){return precond.checkState(this.isPending(),"FunctionCall in progress."),this.retryPredicate_=retryPredicate,this},FunctionCall.prototype.getLastResult=function(){return this.lastResult_.concat()},FunctionCall.prototype.getNumRetries=function(){return this.numRetries_},FunctionCall.prototype.failAfter=function(maxNumberOfRetry){return precond.checkState(this.isPending(),"FunctionCall in progress."),this.failAfter_=maxNumberOfRetry,this},FunctionCall.prototype.abort=function(){this.isCompleted()||this.isAborted()||(this.isRunning()&&this.backoff_.reset(),this.state_=FunctionCall.State_.ABORTED,this.lastResult_=[new Error("Backoff aborted.")],this.emit("abort"),this.doCallback_())},FunctionCall.prototype.start=function(backoffFactory){precond.checkState(!this.isAborted(),"FunctionCall is aborted."),precond.checkState(this.isPending(),"FunctionCall already started.");var strategy=this.strategy_||new FibonacciBackoffStrategy;this.backoff_=backoffFactory?backoffFactory(strategy):new Backoff(strategy),this.backoff_.on("ready",this.doCall_.bind(this,!0)),this.backoff_.on("fail",this.doCallback_.bind(this)),this.backoff_.on("backoff",this.handleBackoff_.bind(this)),this.failAfter_>0&&this.backoff_.failAfter(this.failAfter_),this.state_=FunctionCall.State_.RUNNING,this.doCall_(!1)},FunctionCall.prototype.doCall_=function(isRetry){isRetry&&this.numRetries_++;var eventArgs=["call"].concat(this.arguments_);events.EventEmitter.prototype.emit.apply(this,eventArgs);var callback=this.handleFunctionCallback_.bind(this);this.function_.apply(null,this.arguments_.concat(callback))},FunctionCall.prototype.doCallback_=function(){this.callback_.apply(null,this.lastResult_)},FunctionCall.prototype.handleFunctionCallback_=function(){if(!this.isAborted()){var args=Array.prototype.slice.call(arguments);this.lastResult_=args,events.EventEmitter.prototype.emit.apply(this,["callback"].concat(args));var err=args[0];err&&this.retryPredicate_(err)?this.backoff_.backoff(err):(this.state_=FunctionCall.State_.COMPLETED,this.doCallback_())}},FunctionCall.prototype.handleBackoff_=function(number,delay,err){this.emit("backoff",number,delay,err)},module.exports=FunctionCall},Qvpb:function(module,exports,__webpack_require__){"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},__awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):(value=result.value,value instanceof P?value:new P((function(resolve){resolve(value)}))).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!((t=(t=_.trys).length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}},__read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__spreadArray=this&&this.__spreadArray||function(to,from){for(var i=0,il=from.length,j=to.length;i<il;i++,j++)to[j]=from[i];return to};Object.defineProperty(exports,"__esModule",{value:!0}),exports.createLocalTracks=void 0;var _a=__webpack_require__("ghd6"),asLocalTrack=_a.asLocalTrack,buildLogLevels=_a.buildLogLevels,_b=__webpack_require__("NBph"),getUserMedia=_b.getUserMedia,MediaStreamTrack=_b.MediaStreamTrack,_c=__webpack_require__("VR5W"),LocalAudioTrack=_c.LocalAudioTrack,LocalDataTrack=_c.LocalDataTrack,LocalVideoTrack=_c.LocalVideoTrack,Log=__webpack_require__("S3Hu"),_d=__webpack_require__("xwWy"),DEFAULT_LOG_LEVEL=_d.DEFAULT_LOG_LEVEL,DEFAULT_LOGGER_NAME=_d.DEFAULT_LOGGER_NAME,workaround180748=__webpack_require__("cV4H"),createLocalTrackCalls=0;exports.createLocalTracks=function(options){return __awaiter(this,void 0,void 0,(function(){var isAudioVideoAbsent,fullOptions,logComponentName,logLevels,log,localTrackOptions,extraLocalTrackOptions,mediaStreamConstraints,workaroundWebKitBug180748,mediaStream,mediaStreamTracks,error_1;return __generator(this,(function(_a){switch(_a.label){case 0:if(fullOptions=__assign({audio:isAudioVideoAbsent=!(options&&("audio"in options||"video"in options)),getUserMedia:getUserMedia,loggerName:DEFAULT_LOGGER_NAME,logLevel:DEFAULT_LOG_LEVEL,LocalAudioTrack:LocalAudioTrack,LocalDataTrack:LocalDataTrack,LocalVideoTrack:LocalVideoTrack,MediaStreamTrack:MediaStreamTrack,Log:Log,video:isAudioVideoAbsent},options),logComponentName="[createLocalTracks #"+ ++createLocalTrackCalls+"]",logLevels=buildLogLevels(fullOptions.logLevel),log=new fullOptions.Log("default",logComponentName,logLevels,fullOptions.loggerName),delete(localTrackOptions=Object.assign({log:log},fullOptions)).name,!1===fullOptions.audio&&!1===fullOptions.video)return log.info("Neither audio nor video requested, so returning empty LocalTracks"),[2,[]];if(fullOptions.tracks)return log.info("Adding user-provided LocalTracks"),log.debug("LocalTracks:",fullOptions.tracks),[2,fullOptions.tracks];(extraLocalTrackOptions={audio:"object"==typeof fullOptions.audio&&fullOptions.audio.name?{name:fullOptions.audio.name}:{},video:"object"==typeof fullOptions.video&&fullOptions.video.name?{name:fullOptions.video.name}:{}}).audio.isCreatedByCreateLocalTracks=!0,extraLocalTrackOptions.video.isCreatedByCreateLocalTracks=!0,"object"==typeof fullOptions.audio&&"boolean"==typeof fullOptions.audio.workaroundWebKitBug1208516&&(extraLocalTrackOptions.audio.workaroundWebKitBug1208516=fullOptions.audio.workaroundWebKitBug1208516),"object"==typeof fullOptions.video&&"boolean"==typeof fullOptions.video.workaroundWebKitBug1208516&&(extraLocalTrackOptions.video.workaroundWebKitBug1208516=fullOptions.video.workaroundWebKitBug1208516),"object"==typeof fullOptions.audio&&delete fullOptions.audio.name,"object"==typeof fullOptions.video&&delete fullOptions.video.name,mediaStreamConstraints={audio:fullOptions.audio,video:fullOptions.video},workaroundWebKitBug180748="object"==typeof fullOptions.audio&&fullOptions.audio.workaroundWebKitBug180748,_a.label=1;case 1:return _a.trys.push([1,3,,4]),[4,workaroundWebKitBug180748?workaround180748(log,fullOptions.getUserMedia,mediaStreamConstraints):fullOptions.getUserMedia(mediaStreamConstraints)];case 2:return mediaStream=_a.sent(),mediaStreamTracks=__spreadArray(__spreadArray([],__read(mediaStream.getAudioTracks())),__read(mediaStream.getVideoTracks())),log.info("Call to getUserMedia successful; got MediaStreamTracks:",mediaStreamTracks),[2,mediaStreamTracks.map((function(mediaStreamTrack){return asLocalTrack(mediaStreamTrack,__assign(__assign({},extraLocalTrackOptions[mediaStreamTrack.kind]),localTrackOptions))}))];case 3:throw error_1=_a.sent(),log.warn("Call to getUserMedia failed:",error_1),error_1;case 4:return[2]}}))}))}},"R2/C":function(module,exports,__webpack_require__){"use strict";var EventTarget=__webpack_require__("bQMn"),inherits=__webpack_require__("/E53").inherits,Latch=__webpack_require__("14BE"),sdpUtils=__webpack_require__("L1nb"),util=__webpack_require__("mIkg"),isUnifiedPlan="unified"===sdpUtils.getSdpFormat(),updateTrackIdsToSSRCs=isUnifiedPlan?sdpUtils.updateUnifiedPlanTrackIdsToSSRCs:sdpUtils.updatePlanBTrackIdsToSSRCs;function SafariRTCPeerConnection(configuration){if(!(this instanceof SafariRTCPeerConnection))return new SafariRTCPeerConnection(configuration);EventTarget.call(this),util.interceptEvent(this,"datachannel"),util.interceptEvent(this,"iceconnectionstatechange"),util.interceptEvent(this,"signalingstatechange"),util.interceptEvent(this,"track");var peerConnection=new RTCPeerConnection(configuration);Object.defineProperties(this,{_appliedTracksToSSRCs:{value:new Map,writable:!0},_audioTransceiver:{value:null,writable:!0},_isClosed:{value:!1,writable:!0},_peerConnection:{value:peerConnection},_pendingLocalOffer:{value:null,writable:!0},_pendingRemoteOffer:{value:null,writable:!0},_rolledBackTracksToSSRCs:{value:new Map,writable:!0},_signalingStateLatch:{value:new Latch},_tracksToSSRCs:{value:new Map,writable:!0},_videoTransceiver:{value:null,writable:!0},localDescription:{enumerable:!0,get:function(){return this._pendingLocalOffer||this._peerConnection.localDescription}},iceConnectionState:{enumerable:!0,get:function(){return this._isClosed?"closed":this._peerConnection.iceConnectionState}},iceGatheringState:{enumerable:!0,get:function(){return this._isClosed?"complete":this._peerConnection.iceGatheringState}},remoteDescription:{enumerable:!0,get:function(){return this._pendingRemoteOffer||this._peerConnection.remoteDescription}},signalingState:{enumerable:!0,get:function(){return this._isClosed?"closed":this._pendingLocalOffer?"have-local-offer":this._pendingRemoteOffer?"have-remote-offer":this._peerConnection.signalingState}}});var self=this;peerConnection.addEventListener("datachannel",(function(event){shimDataChannel(event.channel),self.dispatchEvent(event)})),peerConnection.addEventListener("iceconnectionstatechange",(function(){self._isClosed||self.dispatchEvent.apply(self,arguments)})),peerConnection.addEventListener("signalingstatechange",(function(){self._isClosed||("stable"===peerConnection.signalingState&&(self._appliedTracksToSSRCs=new Map(self._tracksToSSRCs)),self._pendingLocalOffer||self._pendingRemoteOffer||self.dispatchEvent.apply(self,arguments))})),peerConnection.addEventListener("track",(function(event){self._pendingRemoteOffer=null,self.dispatchEvent(event)})),util.proxyProperties(RTCPeerConnection.prototype,this,peerConnection)}function setDescription(peerConnection,local,description){var offer,pendingLocalOffer=local?peerConnection._pendingLocalOffer:peerConnection._pendingRemoteOffer,intermediateState=local?"have-local-offer":"have-remote-offer",setLocalDescription=local?"setLocalDescription":"setRemoteDescription";if(!local&&(local?peerConnection._pendingRemoteOffer:peerConnection._pendingLocalOffer)&&"answer"===description.type)return function(peerConnection,answer){return peerConnection._peerConnection.setLocalDescription(peerConnection._pendingLocalOffer).then((function(){return peerConnection._pendingLocalOffer=null,peerConnection.setRemoteDescription(answer)})).then((function(){peerConnection._signalingStateLatch.lower()}))}(peerConnection,description);if("offer"===description.type){if(peerConnection.signalingState!==intermediateState&&"stable"!==peerConnection.signalingState)return Promise.reject(new Error("Cannot set "+(local?"local":"remote")+" offer in state "+peerConnection.signalingState));pendingLocalOffer||"low"!==peerConnection._signalingStateLatch.state||peerConnection._signalingStateLatch.raise();var previousSignalingState=peerConnection.signalingState;return offer=description,local?peerConnection._pendingLocalOffer=offer:peerConnection._pendingRemoteOffer=offer,peerConnection.signalingState!==previousSignalingState?Promise.resolve().then((function(){peerConnection.dispatchEvent(new Event("signalingstatechange"))})):Promise.resolve()}return"rollback"===description.type?peerConnection.signalingState!==intermediateState?Promise.reject(new Error("Cannot rollback "+(local?"local":"remote")+" description in "+peerConnection.signalingState)):(local?peerConnection._pendingLocalOffer=null:peerConnection._pendingRemoteOffer=null,peerConnection._rolledBackTracksToSSRCs=new Map(peerConnection._tracksToSSRCs),peerConnection._tracksToSSRCs=new Map(peerConnection._appliedTracksToSSRCs),Promise.resolve().then((function(){peerConnection.dispatchEvent(new Event("signalingstatechange"))}))):peerConnection._peerConnection[setLocalDescription](description)}function hasReceiversForTracksOfKind(peerConnection,kind){return!!peerConnection.getTransceivers().find((function(transceiver){return transceiver.receiver&&transceiver.receiver.track&&transceiver.receiver.track.kind===kind}))}function shimDataChannel(dataChannel){return Object.defineProperties(dataChannel,{maxPacketLifeTime:{value:65535===dataChannel.maxPacketLifeTime?null:dataChannel.maxPacketLifeTime},maxRetransmits:{value:65535===dataChannel.maxRetransmits?null:dataChannel.maxRetransmits}})}inherits(SafariRTCPeerConnection,EventTarget),SafariRTCPeerConnection.prototype.addIceCandidate=function(candidate){var self=this;return"have-remote-offer"===this.signalingState?this._signalingStateLatch.when("low").then((function(){return self._peerConnection.addIceCandidate(candidate)})):this._peerConnection.addIceCandidate(candidate)},SafariRTCPeerConnection.prototype.createOffer=function(options){options=Object.assign({},options);var self=this;if(options.offerToReceiveVideo&&!this._audioTransceiver&&(!isUnifiedPlan||!hasReceiversForTracksOfKind(this,"audio"))){delete options.offerToReceiveAudio;try{this._audioTransceiver=isUnifiedPlan?this.addTransceiver("audio",{direction:"recvonly"}):this.addTransceiver("audio")}catch(e){return Promise.reject(e)}}if(options.offerToReceiveVideo&&!this._videoTransceiver&&(!isUnifiedPlan||!hasReceiversForTracksOfKind(this,"video"))){delete options.offerToReceiveVideo;try{this._videoTransceiver=isUnifiedPlan?this.addTransceiver("video",{direction:"recvonly"}):this.addTransceiver("video")}catch(e){return Promise.reject(e)}}return this._peerConnection.createOffer(options).then((function(offer){return self._rolledBackTracksToSSRCs.clear(),new RTCSessionDescription({type:offer.type,sdp:updateTrackIdsToSSRCs(self._tracksToSSRCs,offer.sdp)})}))},SafariRTCPeerConnection.prototype.createAnswer=function(options){var self=this;return this._pendingRemoteOffer?this._peerConnection.setRemoteDescription(this._pendingRemoteOffer).then((function(){return self._signalingStateLatch.lower(),self._peerConnection.createAnswer()})).then((function(answer){return self._pendingRemoteOffer=null,self._rolledBackTracksToSSRCs.clear(),isUnifiedPlan?new RTCSessionDescription({type:answer.type,sdp:updateTrackIdsToSSRCs(self._tracksToSSRCs,answer.sdp)}):answer}),(function(error){throw self._pendingRemoteOffer=null,error})):this._peerConnection.createAnswer(options).then((function(answer){return self._rolledBackTracksToSSRCs.clear(),isUnifiedPlan?new RTCSessionDescription({type:answer.type,sdp:updateTrackIdsToSSRCs(self._tracksToSSRCs,answer.sdp)}):answer}))},SafariRTCPeerConnection.prototype.createDataChannel=function(label,dataChannelDict){var dataChannel=this._peerConnection.createDataChannel(label,dataChannelDict);return shimDataChannel(dataChannel),dataChannel},SafariRTCPeerConnection.prototype.removeTrack=function(sender){sender.replaceTrack(null),this._peerConnection.removeTrack(sender)},SafariRTCPeerConnection.prototype.setLocalDescription=function(description){return this._rolledBackTracksToSSRCs.size>0&&(this._tracksToSSRCs=new Map(this._rolledBackTracksToSSRCs),this._rolledBackTracksToSSRCs.clear()),setDescription(this,!0,description)},SafariRTCPeerConnection.prototype.setRemoteDescription=function(description){return this._rolledBackTracksToSSRCs.clear(),setDescription(this,!1,description)},SafariRTCPeerConnection.prototype.close=function(){if(!this._isClosed){this._isClosed=!0,this._peerConnection.close();var self=this;setTimeout((function(){self.dispatchEvent(new Event("iceconnectionstatechange")),self.dispatchEvent(new Event("signalingstatechange"))}))}},util.delegateMethods(RTCPeerConnection.prototype,SafariRTCPeerConnection.prototype,"_peerConnection"),module.exports=SafariRTCPeerConnection},R6uM:function(module,exports,__webpack_require__){"use strict";module.exports=function(constraints){return"object"==typeof navigator&&"object"==typeof navigator.mediaDevices&&"function"==typeof navigator.mediaDevices.getUserMedia?(constraints=constraints||{audio:!0,video:!0},navigator.mediaDevices.getUserMedia(constraints)):Promise.reject(new Error("getUserMedia is not supported"))}},ROvb:function(module,exports,__webpack_require__){"use strict";var RTCSessionDescription=__webpack_require__("NBph").RTCSessionDescription,_a=__webpack_require__("9dY8"),createPtToCodecName=_a.createPtToCodecName,getMediaSections=_a.getMediaSections;function mediaSectionWorkaround(mediaSection){var ptToCodecName=createPtToCodecName(mediaSection);mediaSection=function(mediaSection,ptToCodecName){return Array.from(ptToCodecName.keys()).reduce((function(section,pt){var rtpmapRegex=new RegExp("^a=rtpmap:"+pt+" rtx.+$","gm");return(section.match(rtpmapRegex)||[]).slice("rtx"===ptToCodecName.get(pt)?1:0).reduce((function(section,rtpmap){var rtpmapRegex=new RegExp("\r\n"+rtpmap),fmtpmapRegex=new RegExp("\r\na=fmtp:"+pt+" apt=[0-9]+");return section.replace(rtpmapRegex,"").replace(fmtpmapRegex,"")}),section)}),mediaSection)}(mediaSection,ptToCodecName);var codecNameToPts=function(ptToCodecName){var codecNameToPts=new Map;return ptToCodecName.forEach((function(codecName,pt){var pts=codecNameToPts.get(codecName)||new Set;return codecNameToPts.set(codecName,pts.add(pt))})),codecNameToPts}(ptToCodecName),rtxPts=codecNameToPts.get("rtx")||new Set,invalidRtxPts=new Set,associatedPtToRtxPt=function(rtxPtToAssociatedPt,invalidRtxPts){var associatedPtToRtxPts=Array.from(rtxPtToAssociatedPt).reduce((function(associatedPtToRtxPts,pair){var rtxPt=pair[0],pt=pair[1],rtxPts=associatedPtToRtxPts.get(pt)||new Set;return associatedPtToRtxPts.set(pt,rtxPts.add(rtxPt))}),new Map);return Array.from(associatedPtToRtxPts).reduce((function(associatedPtToRtxPt,pair){var pt=pair[0],rtxPts=Array.from(pair[1]);return rtxPts.length>1?(rtxPts.forEach((function(rtxPt){invalidRtxPts.add(rtxPt)})),associatedPtToRtxPt):associatedPtToRtxPt.set(pt,rtxPts[0])}),new Map)}(function(mediaSection,ptToCodecName,rtxPts,invalidRtxPts){return Array.from(rtxPts).reduce((function(rtxPtToAssociatedPt,rtxPt){var fmtpPattern=new RegExp("a=fmtp:"+rtxPt+" apt=(\\d+)"),matches=mediaSection.match(fmtpPattern);if(!matches)return invalidRtxPts.add(rtxPt),rtxPtToAssociatedPt;var pt=Number.parseInt(matches[1]);return ptToCodecName.has(pt)?"rtx"===ptToCodecName.get(pt)?(invalidRtxPts.add(rtxPt),rtxPtToAssociatedPt):rtxPtToAssociatedPt.set(rtxPt,pt):(invalidRtxPts.add(rtxPt),rtxPtToAssociatedPt)}),new Map)}(mediaSection,ptToCodecName,rtxPts,invalidRtxPts),invalidRtxPts),unassociatedRtxPts=Array.from(invalidRtxPts);return["h264","vp8","vp9"].reduce((function(unassociatedPts,codecName){var pts=codecNameToPts.get(codecName)||new Set;return Array.from(pts).reduce((function(unassociatedPts,pt){return associatedPtToRtxPt.has(pt)?unassociatedPts:unassociatedPts.add(pt)}),unassociatedPts)}),new Set).forEach((function(pt){if(unassociatedRtxPts.length){var rtxPt=unassociatedRtxPts.shift();mediaSection=function(mediaSection,rtxPt,pt){return mediaSection.endsWith("\r\n")?mediaSection+"a=fmtp:"+rtxPt+" apt="+pt+"\r\n":mediaSection+"\r\na=fmtp:"+rtxPt+" apt="+pt}(mediaSection=deleteFmtpAttributesForRtxPt(mediaSection,rtxPt),rtxPt,pt)}})),unassociatedRtxPts.forEach((function(rtxPt){mediaSection=function(mediaSection,rtxPt){var pattern=new RegExp("a=rtpmap:"+rtxPt+".*\r\n","gm");return mediaSection.replace(pattern,"")}(mediaSection=deleteFmtpAttributesForRtxPt(mediaSection,rtxPt),rtxPt)})),mediaSection}function deleteFmtpAttributesForRtxPt(mediaSection,rtxPt){var pattern=new RegExp("a=fmtp:"+rtxPt+".*\r\n","gm");return mediaSection.replace(pattern,"")}module.exports=function(description){var sdp,mediaSections,descriptionInit={type:description.type};return"rollback"!==description.type&&(descriptionInit.sdp=(mediaSections=getMediaSections(sdp=description.sdp),[sdp.split("\r\nm=")[0]].concat(mediaSections.map(mediaSectionWorkaround)).join("\r\n"))),new RTCSessionDescription(descriptionInit)}},"Rj+V":function(module,exports,__webpack_require__){"use strict";var inherits=__webpack_require__("/E53").inherits,LocalDataTrackClass=__webpack_require__("z1nD");function LocalDataTrack(options){var track=new LocalDataTrackClass(options);return Object.setPrototypeOf(track,LocalDataTrack.prototype),track}inherits(LocalDataTrack,LocalDataTrackClass),module.exports=LocalDataTrack},S3Hu:function(module,exports,__webpack_require__){"use strict";var deprecationWarningsByComponentConstructor,__read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__spreadArray=this&&this.__spreadArray||function(to,from){for(var i=0,il=from.length,j=to.length;i<il;i++,j++)to[j]=from[i];return to},defaultGetLogger=__webpack_require__("cmf6").getLogger,constants=__webpack_require__("xwWy"),DEFAULT_LOG_LEVEL=constants.DEFAULT_LOG_LEVEL,DEFAULT_LOGGER_NAME=constants.DEFAULT_LOGGER_NAME,E=__webpack_require__("xwWy").typeErrors,Log=function(){function Log(moduleName,component,logLevels,loggerName,getLogger){if("string"!=typeof moduleName)throw E.INVALID_TYPE("moduleName","string");if(!component)throw E.REQUIRED_ARGUMENT("component");"object"!=typeof logLevels&&(logLevels={}),getLogger=getLogger||defaultGetLogger,validateLogLevels(logLevels),Object.defineProperties(this,{_component:{value:component},_logLevels:{value:logLevels},_warnings:{value:new Set},_loggerName:{get:function(){var name=loggerName&&"string"==typeof loggerName?loggerName:DEFAULT_LOGGER_NAME;return this._logLevelsEqual||(name=name+"-"+moduleName),name}},_logger:{get:function(){var logger=getLogger(this._loggerName),level=this._logLevels[moduleName]||DEFAULT_LOG_LEVEL;return logger.setDefaultLevel(level="off"===level?"silent":level),logger}},_logLevelsEqual:{get:function(){return 1===new Set(Object.values(this._logLevels)).size}},logLevel:{get:function(){return Log.getLevelByName(logLevels[moduleName]||DEFAULT_LOG_LEVEL)}},name:{get:component.toString.bind(component)}})}return Log.getLevelByName=function(name){return isNaN(name)?(validateLogLevel(name=name.toUpperCase()),Log[name]):parseInt(name,10)},Log.prototype.createLog=function(moduleName,component){var name=this._loggerName;return this._logLevelsEqual||(name=name.substring(0,name.lastIndexOf("-"))),new Log(moduleName,component,this._logLevels,name)},Log.prototype.setLevels=function(levels){return validateLogLevels(levels),Object.assign(this._logLevels,levels),this},Log.prototype.log=function(logLevel,messages){var name=Log._levels[logLevel];if(!name)throw E.INVALID_VALUE("logLevel",LOG_LEVEL_VALUES);name=name.toLowerCase();var prefix=[(new Date).toISOString(),name,this.name];return(this._logger[name]||function(){}).apply(void 0,__spreadArray([],__read(prefix.concat(messages)))),this},Log.prototype.debug=function(){return this.log(Log.DEBUG,[].slice.call(arguments))},Log.prototype.deprecated=function(deprecationWarning){var deprecationWarnings=function(componentConstructor){if((deprecationWarningsByComponentConstructor=deprecationWarningsByComponentConstructor||new Map).has(componentConstructor))return deprecationWarningsByComponentConstructor.get(componentConstructor);var deprecationWarnings=new Set;return deprecationWarningsByComponentConstructor.set(componentConstructor,deprecationWarnings),deprecationWarnings}(this._component.constructor);return deprecationWarnings.has(deprecationWarning)?this:(deprecationWarnings.add(deprecationWarning),this.warn(deprecationWarning))},Log.prototype.info=function(){return this.log(Log.INFO,[].slice.call(arguments))},Log.prototype.warn=function(){return this.log(Log.WARN,[].slice.call(arguments))},Log.prototype.warnOnce=function(warning){return this._warnings.has(warning)?this:(this._warnings.add(warning),this.warn(warning))},Log.prototype.error=function(){return this.log(Log.ERROR,[].slice.call(arguments))},Log.prototype.throw=function(error,customMessage){throw error.clone&&(error=error.clone(customMessage)),this.log(Log.ERROR,error),error},Log}();Object.defineProperties(Log,{DEBUG:{value:0},INFO:{value:1},WARN:{value:2},ERROR:{value:3},OFF:{value:4},_levels:{value:["DEBUG","INFO","WARN","ERROR","OFF"]}});var LOG_LEVELS_SET={},LOG_LEVEL_VALUES=[],LOG_LEVEL_NAMES=Log._levels.map((function(level,i){return LOG_LEVELS_SET[level]=!0,LOG_LEVEL_VALUES.push(i),level}));function validateLogLevel(level){if(!(level in LOG_LEVELS_SET))throw E.INVALID_VALUE("level",LOG_LEVEL_NAMES)}function validateLogLevels(levels){Object.keys(levels).forEach((function(moduleName){validateLogLevel(levels[moduleName].toUpperCase())}))}module.exports=Log},"SAu+":function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__spreadArray=this&&this.__spreadArray||function(to,from){for(var i=0,il=from.length,j=to.length;i<il;i++,j++)to[j]=from[i];return to},TwilioError=function(_super){function TwilioError(code){var _this=this,args=[].slice.call(arguments,1);_this=_super.apply(this,__spreadArray([],__read(args)))||this,Object.setPrototypeOf(_this,TwilioError.prototype);var error=Error.apply(_this,args);return error.name="TwilioError",Object.defineProperty(_this,"code",{value:code,enumerable:!0}),Object.getOwnPropertyNames(error).forEach((function(prop){Object.defineProperty(this,prop,{value:error[prop],enumerable:!0})}),_this),_this}return __extends(TwilioError,_super),TwilioError.prototype.toString=function(){return this.name+" "+this.code+(this.message?": "+this.message:"")},TwilioError}(Error);module.exports=TwilioError},STyX:function(module,exports,__webpack_require__){"use strict";var IceReport=function(){function IceReport(send,recv,availableSend,rtt){Object.defineProperties(this,{availableSend:{enumerable:!0,value:availableSend},recv:{enumerable:!0,value:recv},rtt:{enumerable:!0,value:rtt},send:{enumerable:!0,value:send}})}return IceReport.of=function(olderStats,newerStats){var secondsElapsed=(newerStats.timestamp-olderStats.timestamp)/1e3;return new IceReport(secondsElapsed>0?(newerStats.bytesSent-olderStats.bytesSent)/secondsElapsed*8:0,secondsElapsed>0?(newerStats.bytesReceived-olderStats.bytesReceived)/secondsElapsed*8:0,newerStats.availableOutgoingBitrate,newerStats.currentRoundTripTime)},IceReport}();module.exports=IceReport},"T/xC":function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),StateMachine=__webpack_require__("gEVb"),TwilioConnection=__webpack_require__("FjKE"),DefaultBackoff=__webpack_require__("Czg6"),reconnectBackoffConfig=__webpack_require__("xwWy").reconnectBackoffConfig,Timeout=__webpack_require__("Y1/N"),_a=__webpack_require__("xwWy"),SDK_NAME=_a.SDK_NAME,SDK_VERSION=_a.SDK_VERSION,SDP_FORMAT=_a.SDP_FORMAT,_b=__webpack_require__("ghd6"),createBandwidthProfilePayload=_b.createBandwidthProfilePayload,createMediaSignalingPayload=_b.createMediaSignalingPayload,createSubscribePayload=_b.createSubscribePayload,getUserAgent=_b.getUserAgent,isNonArrayObject=_b.isNonArrayObject,_c=__webpack_require__("5wwa"),createTwilioError=_c.createTwilioError,RoomCompletedError=_c.RoomCompletedError,SignalingConnectionError=_c.SignalingConnectionError,SignalingServerBusyError=_c.SignalingServerBusyError,states={connecting:["connected","disconnected"],connected:["disconnected","syncing"],syncing:["connected","disconnected"],disconnected:[]},TwilioConnectionTransport=function(_super){function TwilioConnectionTransport(name,accessToken,localParticipant,peerConnectionManager,wsServer,options){var _this;return options=Object.assign({Backoff:DefaultBackoff,TwilioConnection:TwilioConnection,iceServers:null,trackPriority:!0,trackSwitchOff:!0,renderHints:!0,userAgent:getUserAgent()},options),_this=_super.call(this,"connecting",states)||this,Object.defineProperties(_this,{_accessToken:{value:accessToken},_automaticSubscription:{value:options.automaticSubscription},_bandwidthProfile:{value:options.bandwidthProfile},_dominantSpeaker:{value:options.dominantSpeaker},_adaptiveSimulcast:{value:options.adaptiveSimulcast},_eventObserver:{value:options.eventObserver,writable:!1},_renderHints:{value:options.renderHints},_iceServersStatus:{value:Array.isArray(options.iceServers)?"overrode":"acquire"},_localParticipant:{value:localParticipant},_name:{value:name},_networkQuality:{value:isNonArrayObject(options.networkQuality)||options.networkQuality},_options:{value:options},_peerConnectionManager:{value:peerConnectionManager},_sessionTimer:{value:null,writable:!0},_sessionTimeoutMS:{value:0,writable:!0},_reconnectBackoff:{value:options.Backoff.exponential(reconnectBackoffConfig)},_session:{value:null,writable:!0},_trackPriority:{value:options.trackPriority},_trackSwitchOff:{value:options.trackSwitchOff},_twilioConnection:{value:null,writable:!0},_updatesReceived:{value:[]},_updatesToSend:{value:[]},_userAgent:{value:options.userAgent},_wsServer:{value:wsServer}}),function(transport){function createOrResetTwilioConnection(){if("disconnected"!==transport.state){transport._twilioConnection&&transport._twilioConnection.removeListener("message",handleMessage);var _options=transport._options,TwilioConnection=_options.TwilioConnection,twilioConnection=new TwilioConnection(transport._wsServer,Object.assign({helloBody:"connecting"===transport.state&&"acquire"===transport._iceServersStatus?transport._createIceMessage():transport._createConnectOrSyncOrDisconnectMessage()},_options));twilioConnection.once("close",(function(reason){reason===TwilioConnection.CloseReason.LOCAL?disconnect():disconnect(new Error(reason))})),twilioConnection.on("message",handleMessage),transport._twilioConnection=twilioConnection}}function disconnect(error){if("disconnected"!==transport.state)if(error){var reconnectTimer=transport._getReconnectTimer();if(reconnectTimer)"connected"===transport.state&&transport.preempt("syncing"),reconnectTimer.then(createOrResetTwilioConnection);else{var twilioError=error.message===TwilioConnection.CloseReason.BUSY?new SignalingServerBusyError:new SignalingConnectionError;transport.disconnect(twilioError)}}else transport.disconnect()}function handleMessage(message){if("disconnected"!==transport.state)if("error"!==message.type)switch(transport.state){case"connected":switch(message.type){case"connected":case"synced":case"update":return void transport.emit("message",message);case"disconnected":return void transport.disconnect("completed"===message.status?new RoomCompletedError:null);default:return}case"connecting":switch(message.type){case"iced":return void transport._options.onIced(message.ice_servers).then((function(){transport._sendConnectOrSyncOrDisconnectMessage()}));case"connected":return transport._setSession(message.session,message.options.session_timeout),transport.emit("connected",message),void transport.preempt("connected");case"synced":case"update":return void transport._updatesReceived.push(message);case"disconnected":return void transport.disconnect("completed"===message.status?new RoomCompletedError:null);default:return}case"syncing":switch(message.type){case"connected":case"update":return void transport._updatesReceived.push(message);case"synced":return transport._clearReconnectTimer(),transport.emit("message",message),void transport.preempt("connected");case"disconnected":return void transport.disconnect("completed"===message.status?new RoomCompletedError:null);default:return}default:return}else transport.disconnect(createTwilioError(message.code,message.message))}transport.on("stateChanged",(function stateChanged(state){switch(state){case"connected":var updates=transport._updatesToSend.splice(0);return updates.length&&transport.publish(function(updates){return updates.reduce((function(reduced,update){return(!reduced.participant&&update.participant||reduced.participant&&update.participant&&update.participant.revision>reduced.participant.revision)&&(reduced.participant=update.participant),!reduced.peer_connections&&update.peer_connections?reduced.peer_connections=reducePeerConnections(update.peer_connections):reduced.peer_connections&&update.peer_connections&&(reduced.peer_connections=reducePeerConnections(reduced.peer_connections.concat(update.peer_connections))),reduced}),{})}(updates)),void transport._updatesReceived.splice(0).forEach((function(update){return transport.emit("message",update)}));case"disconnected":return transport._twilioConnection.removeListener("message",handleMessage),void transport.removeListener("stateChanged",stateChanged);case"syncing":default:return}}));var _options=transport._options;"overrode"===transport._iceServersStatus?(0,_options.onIced)(_options.iceServers).then(createOrResetTwilioConnection):createOrResetTwilioConnection()}(_this),_this}return __extends(TwilioConnectionTransport,_super),TwilioConnectionTransport.prototype._createConnectOrSyncOrDisconnectMessage=function(){if("connected"===this.state)return null;if("disconnected"===this.state)return{session:this._session,type:"disconnect",version:2};var type={connecting:"connect",syncing:"sync"}[this.state],message={name:this._name,participant:this._localParticipant.getState(),peer_connections:this._peerConnectionManager.getStates(),type:type,version:2};return"connect"===message.type?(message.ice_servers=this._iceServersStatus,message.publisher={name:SDK_NAME,sdk_version:SDK_VERSION,user_agent:this._userAgent},this._bandwidthProfile&&(message.bandwidth_profile=createBandwidthProfilePayload(this._bandwidthProfile)),message.media_signaling=createMediaSignalingPayload(this._dominantSpeaker,this._networkQuality,this._trackPriority,this._trackSwitchOff,this._adaptiveSimulcast,this._renderHints),message.subscribe=createSubscribePayload(this._automaticSubscription),message.format=SDP_FORMAT,message.token=this._accessToken):"sync"===message.type?(message.session=this._session,message.token=this._accessToken):"update"===message.type&&(message.session=this._session),message},TwilioConnectionTransport.prototype._createIceMessage=function(){return{edge:"roaming",token:this._accessToken,type:"ice",version:1}},TwilioConnectionTransport.prototype._sendConnectOrSyncOrDisconnectMessage=function(){var message=this._createConnectOrSyncOrDisconnectMessage();message&&this._twilioConnection.sendMessage(message)},TwilioConnectionTransport.prototype.disconnect=function(error){return"disconnected"!==this.state&&(this.preempt("disconnected",null,[error]),this._sendConnectOrSyncOrDisconnectMessage(),this._twilioConnection.close(),!0)},TwilioConnectionTransport.prototype.publish=function(update){switch(this.state){case"connected":return this._twilioConnection.sendMessage(Object.assign({session:this._session,type:"update",version:2},update)),!0;case"connecting":case"syncing":return this._updatesToSend.push(update),!0;case"disconnected":default:return!1}},TwilioConnectionTransport.prototype.publishEvent=function(group,name,level,payload){this._eventObserver.emit("event",{group:group,name:name,level:level,payload:payload})},TwilioConnectionTransport.prototype.sync=function(){return"connected"===this.state&&(this.preempt("syncing"),this._sendConnectOrSyncOrDisconnectMessage(),!0)},TwilioConnectionTransport.prototype._setSession=function(session,sessionTimeout){this._session=session,this._sessionTimeoutMS=1e3*sessionTimeout},TwilioConnectionTransport.prototype._getReconnectTimer=function(){var _this=this;return 0===this._sessionTimeoutMS?null:(this._sessionTimer||(this._sessionTimer=new Timeout((function(){_this._sessionTimer&&(_this._sessionTimeoutMS=0)}),this._sessionTimeoutMS)),new Promise((function(resolve){_this._reconnectBackoff.once("ready",resolve),_this._reconnectBackoff.backoff()})))},TwilioConnectionTransport.prototype._clearReconnectTimer=function(){this._reconnectBackoff.reset(),this._sessionTimer&&(this._sessionTimer.clear(),this._sessionTimer=null)},TwilioConnectionTransport}(StateMachine);function reducePeerConnections(peerConnections){return Array.from(peerConnections.reduce((function(peerConnectionsById,update){var reduced=peerConnectionsById.get(update.id)||update;return(!reduced.description&&update.description||reduced.description&&update.description&&update.description.revision>reduced.description.revision)&&(reduced.description=update.description),(!reduced.ice&&update.ice||reduced.ice&&update.ice&&update.ice.revision>reduced.ice.revision)&&(reduced.ice=update.ice),peerConnectionsById.set(reduced.id,reduced),peerConnectionsById}),new Map).values())}module.exports=TwilioConnectionTransport},T5BQ:function(module,exports,__webpack_require__){"use strict";var _a=__webpack_require__("xwWy"),ICE_ACTIVITY_CHECK_PERIOD_MS=_a.ICE_ACTIVITY_CHECK_PERIOD_MS,ICE_INACTIVITY_THRESHOLD_MS=_a.ICE_INACTIVITY_THRESHOLD_MS,IceConnectionMonitor=function(){function IceConnectionMonitor(peerConnection,options){options=Object.assign({activityCheckPeriodMs:ICE_ACTIVITY_CHECK_PERIOD_MS,inactivityThresholdMs:ICE_INACTIVITY_THRESHOLD_MS},options),Object.defineProperties(this,{_activityCheckPeriodMs:{value:options.activityCheckPeriodMs},_inactivityThresholdMs:{value:options.inactivityThresholdMs},_lastActivity:{value:null,writable:!0},_peerConnection:{value:peerConnection},_timer:{value:null,writable:!0},_onIceConnectionStateChanged:{value:null,writable:!0}})}return IceConnectionMonitor.prototype._getActivePairStat=function(stats){return Array.from(stats.values()).find((function(stat){return"candidate-pair"===stat.type&&stat.nominated}))||{bytesReceived:0,timestamp:Math.round((new Date).getTime())}},IceConnectionMonitor.prototype._getIceConnectionStats=function(){var _this=this;return this._peerConnection.getStats().then((function(stats){return _this._getActivePairStat(stats)})).catch((function(){return null}))},IceConnectionMonitor.prototype._scheduleInactivityCallback=function(callback){var _this=this;callback&&null===this._onIceConnectionStateChanged?(this._onIceConnectionStateChanged=function(){"disconnected"===_this._peerConnection.iceConnectionState&&callback()},this._peerConnection.addEventListener("iceconnectionstatechange",this._onIceConnectionStateChanged)):!callback&&this._onIceConnectionStateChanged&&(this._peerConnection.removeEventListener("iceconnectionstatechange",this._onIceConnectionStateChanged),this._onIceConnectionStateChanged=null)},IceConnectionMonitor.prototype.start=function(onIceConnectionInactive){var _this=this;this.stop(),this._timer=setInterval((function(){_this._getIceConnectionStats().then((function(iceStats){iceStats&&(_this._lastActivity&&_this._lastActivity.bytesReceived===iceStats.bytesReceived||(_this._lastActivity=iceStats,_this._scheduleInactivityCallback(null)),iceStats.timestamp-_this._lastActivity.timestamp>=_this._inactivityThresholdMs&&("disconnected"===_this._peerConnection.iceConnectionState?onIceConnectionInactive():null===_this._onIceConnectionStateChanged&&_this._scheduleInactivityCallback(onIceConnectionInactive)))}))}),this._activityCheckPeriodMs)},IceConnectionMonitor.prototype.stop=function(){this._scheduleInactivityCallback(null),null!==this._timer&&(clearInterval(this._timer),this._timer=null,this._lastActivity=null)},IceConnectionMonitor}();module.exports=IceConnectionMonitor},TM7a:function(module,exports,__webpack_require__){"use strict";module.exports=function(audioContext,stream,timeout){timeout="number"==typeof timeout?timeout:250;var source=audioContext.createMediaStreamSource(stream),analyser=audioContext.createAnalyser();analyser.fftSize=2048,source.connect(analyser);var samples=new Uint8Array(analyser.fftSize),timeoutDidFire=!1;return setTimeout((function(){timeoutDidFire=!0}),timeout),function doDetectSilence(){return timeoutDidFire?Promise.resolve(!0):(analyser.getByteTimeDomainData(samples),samples.some((function(sample){return 128!==sample&&0!==sample}))?Promise.resolve(!1):function(timeout){return timeout="number"==typeof timeout?timeout:0,new Promise((function(resolve){return setTimeout(resolve,timeout)}))}().then(doDetectSilence))}().then((function(isSilent){return source.disconnect(),isSilent}),(function(error){throw source.disconnect(),error}))}},TTpt:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__spreadArray=this&&this.__spreadArray||function(to,from){for(var i=0,il=from.length,j=to.length;i<il;i++,j++)to[j]=from[i];return to},EventEmitter=__webpack_require__("mAYT"),RemoteAudioTrack=__webpack_require__("6frX"),RemoteAudioTrackPublication=__webpack_require__("8vSI"),RemoteDataTrack=__webpack_require__("Vh62"),RemoteDataTrackPublication=__webpack_require__("m8+h"),RemoteVideoTrack=__webpack_require__("Ds+w"),RemoteVideoTrackPublication=__webpack_require__("6vXP"),util=__webpack_require__("ghd6"),nInstances=0,Participant=function(_super){function Participant(signaling,options){var _this=_super.call(this)||this,indexed=function(tracks){var indexedTracks=tracks.map((function(track){return[track.id,track]})),indexedAudioTracks=indexedTracks.filter((function(keyValue){return"audio"===keyValue[1].kind})),indexedVideoTracks=indexedTracks.filter((function(keyValue){return"video"===keyValue[1].kind}));return{audioTracks:indexedAudioTracks,dataTracks:indexedTracks.filter((function(keyValue){return"data"===keyValue[1].kind})),tracks:indexedTracks,videoTracks:indexedVideoTracks}}((options=Object.assign({RemoteAudioTrack:RemoteAudioTrack,RemoteAudioTrackPublication:RemoteAudioTrackPublication,RemoteDataTrack:RemoteDataTrack,RemoteDataTrackPublication:RemoteDataTrackPublication,RemoteVideoTrack:RemoteVideoTrack,RemoteVideoTrackPublication:RemoteVideoTrackPublication,tracks:[]},options)).tracks),log=options.log.createLog("default",_this),audioTracks=new Map(indexed.audioTracks),dataTracks=new Map(indexed.dataTracks),tracks=new Map(indexed.tracks),videoTracks=new Map(indexed.videoTracks);return Object.defineProperties(_this,{_RemoteAudioTrack:{value:options.RemoteAudioTrack},_RemoteAudioTrackPublication:{value:options.RemoteAudioTrackPublication},_RemoteDataTrack:{value:options.RemoteDataTrack},_RemoteDataTrackPublication:{value:options.RemoteDataTrackPublication},_RemoteVideoTrack:{value:options.RemoteVideoTrack},_RemoteVideoTrackPublication:{value:options.RemoteVideoTrackPublication},_audioTracks:{value:audioTracks},_dataTracks:{value:dataTracks},_instanceId:{value:++nInstances},_clientTrackSwitchOffControl:{value:options.clientTrackSwitchOffControl},_contentPreferencesMode:{value:options.contentPreferencesMode},_log:{value:log},_signaling:{value:signaling},_tracks:{value:tracks},_trackEventReemitters:{value:new Map},_trackPublicationEventReemitters:{value:new Map},_trackSignalingUpdatedEventCallbacks:{value:new Map},_videoTracks:{value:videoTracks},audioTracks:{enumerable:!0,value:new Map},dataTracks:{enumerable:!0,value:new Map},identity:{enumerable:!0,get:function(){return signaling.identity}},networkQualityLevel:{enumerable:!0,get:function(){return signaling.networkQualityLevel}},networkQualityStats:{enumerable:!0,get:function(){return signaling.networkQualityStats}},sid:{enumerable:!0,get:function(){return signaling.sid}},state:{enumerable:!0,get:function(){return signaling.state}},tracks:{enumerable:!0,value:new Map},videoTracks:{enumerable:!0,value:new Map}}),_this._tracks.forEach(reemitTrackEvents.bind(null,_this)),signaling.on("networkQualityLevelChanged",(function(){return _this.emit("networkQualityLevelChanged",_this.networkQualityLevel,_this.networkQualityStats&&(_this.networkQualityStats.audio||_this.networkQualityStats.video)?_this.networkQualityStats:null)})),function(participant,signaling){var log=participant._log;"disconnected"!==participant.state&&signaling.on("stateChanged",(function stateChanged(state){log.debug("Transitioned to state:",state),participant.emit(state,participant),"disconnected"===state&&(log.debug("Removing Track event reemitters"),signaling.removeListener("stateChanged",stateChanged),participant._tracks.forEach((function(track){var reemitters=participant._trackEventReemitters.get(track.id);track&&reemitters&&reemitters.forEach((function(reemitter,event){track.removeListener(event,reemitter)}))})),signaling.tracks.forEach((function(trackSignaling){var track=participant._tracks.get(trackSignaling.id),reemitters=participant._trackEventReemitters.get(trackSignaling.id);track&&reemitters&&reemitters.forEach((function(reemitter,event){track.removeListener(event,reemitter)}))})),participant._trackEventReemitters.clear(),participant.tracks.forEach((function(publication){participant._trackPublicationEventReemitters.get(publication.trackSid).forEach((function(reemitter,event){publication.removeListener(event,reemitter)}))})),participant._trackPublicationEventReemitters.clear())}))}(_this,signaling),log.info("Created a new Participant"+(_this.identity?": "+_this.identity:"")),_this}return __extends(Participant,_super),Participant.prototype._getTrackEvents=function(){return[["dimensionsChanged","trackDimensionsChanged"],["message","trackMessage"],["started","trackStarted"]]},Participant.prototype._getTrackPublicationEvents=function(){return[]},Participant.prototype.toString=function(){return"[Participant #"+this._instanceId+": "+this.sid+"]"},Participant.prototype._addTrack=function(track,id){var log=this._log;return this._tracks.has(id)?null:(this._tracks.set(id,track),{audio:this._audioTracks,video:this._videoTracks,data:this._dataTracks}[track.kind].set(id,track),reemitTrackEvents(this,track,id),log.info("Added a new "+util.trackClass(track)+":",id),log.debug(util.trackClass(track)+":",track),track)},Participant.prototype._addTrackPublication=function(publication){var log=this._log;return this.tracks.has(publication.trackSid)?null:(this.tracks.set(publication.trackSid,publication),{audio:this.audioTracks,data:this.dataTracks,video:this.videoTracks}[publication.kind].set(publication.trackSid,publication),function(participant,publication){var publicationEventReemitters=new Map;"disconnected"!==participant.state&&(participant._getTrackPublicationEvents().forEach((function(_a){var _b=__read(_a,2),publicationEvent=_b[0],participantEvent=_b[1];publicationEventReemitters.set(publicationEvent,(function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];participant.emit.apply(participant,__spreadArray(__spreadArray([participantEvent],__read(args)),[publication]))})),publication.on(publicationEvent,publicationEventReemitters.get(publicationEvent))})),participant._trackPublicationEventReemitters.set(publication.trackSid,publicationEventReemitters))}(this,publication),log.info("Added a new "+util.trackPublicationClass(publication)+":",publication.trackSid),log.debug(util.trackPublicationClass(publication)+":",publication),publication)},Participant.prototype._handleTrackSignalingEvents=function(){var log=this._log,clientTrackSwitchOffControl=this._clientTrackSwitchOffControl,contentPreferencesMode=this._contentPreferencesMode,self=this;if("disconnected"!==this.state){var RemoteAudioTrack=this._RemoteAudioTrack,RemoteAudioTrackPublication=this._RemoteAudioTrackPublication,RemoteVideoTrack=this._RemoteVideoTrack,RemoteVideoTrackPublication=this._RemoteVideoTrackPublication,RemoteDataTrack=this._RemoteDataTrack,RemoteDataTrackPublication=this._RemoteDataTrackPublication,participantSignaling=this._signaling;participantSignaling.on("trackAdded",trackSignalingAdded),participantSignaling.on("trackRemoved",trackSignalingRemoved),participantSignaling.tracks.forEach(trackSignalingAdded),participantSignaling.on("stateChanged",(function stateChanged(state){"disconnected"===state?(log.debug("Removing event listeners"),participantSignaling.removeListener("stateChanged",stateChanged),participantSignaling.removeListener("trackAdded",trackSignalingAdded),participantSignaling.removeListener("trackRemoved",trackSignalingRemoved)):"connected"===state&&(log.info("reconnected"),setTimeout((function(){return self.emit("reconnected")}),0))}))}function trackSignalingAdded(signaling){var publication=new(0,{audio:RemoteAudioTrackPublication,data:RemoteDataTrackPublication,video:RemoteVideoTrackPublication}[signaling.kind])(signaling,{log:log});self._addTrackPublication(publication);var isSubscribed=signaling.isSubscribed;isSubscribed&&trackSignalingSubscribed(signaling),self._trackSignalingUpdatedEventCallbacks.set(signaling.sid,(function(){if(isSubscribed!==signaling.isSubscribed){if(isSubscribed=signaling.isSubscribed)return void trackSignalingSubscribed(signaling);!function(signaling){var _a=__read(Array.from(self._tracks.entries()).find((function(_a){return __read(_a,2)[1].sid===signaling.sid})),2),id=_a[0],track=_a[1],publication=self.tracks.get(signaling.sid);track&&self._removeTrack(track,publication,id)}(signaling)}})),signaling.on("updated",self._trackSignalingUpdatedEventCallbacks.get(signaling.sid))}function trackSignalingRemoved(signaling){signaling.isSubscribed&&signaling.setTrackTransceiver(null);var updated=self._trackSignalingUpdatedEventCallbacks.get(signaling.sid);updated&&(signaling.removeListener("updated",updated),self._trackSignalingUpdatedEventCallbacks.delete(signaling.sid));var publication=self.tracks.get(signaling.sid);publication&&self._removeTrackPublication(publication)}function trackSignalingSubscribed(signaling){var isEnabled=signaling.isEnabled,name=signaling.name,kind=signaling.kind,sid=signaling.sid,trackTransceiver=signaling.trackTransceiver,isSwitchedOff=signaling.isSwitchedOff,RemoteTrack={audio:RemoteAudioTrack,video:RemoteVideoTrack,data:RemoteDataTrack}[kind],publication=self.tracks.get(sid);if(RemoteTrack&&kind===trackTransceiver.kind){var options={log:log,name:name,clientTrackSwitchOffControl:clientTrackSwitchOffControl,contentPreferencesMode:contentPreferencesMode},track="data"===kind?new RemoteTrack(sid,trackTransceiver,options):new RemoteTrack(sid,trackTransceiver,isEnabled,isSwitchedOff,(function(newPriority){return participantSignaling.updateSubscriberTrackPriority(sid,newPriority)}),(function(renderHint){signaling.isSubscribed&&participantSignaling.updateTrackRenderHint(sid,renderHint)}),options);self._addTrack(track,publication,trackTransceiver.id)}}},Participant.prototype._removeTrack=function(track,id){if(!this._tracks.has(id))return null;this._tracks.delete(id),{audio:this._audioTracks,video:this._videoTracks,data:this._dataTracks}[track.kind].delete(id),(this._trackEventReemitters.get(id)||new Map).forEach((function(reemitter,event){track.removeListener(event,reemitter)}));var log=this._log;return log.info("Removed a "+util.trackClass(track)+":",id),log.debug(util.trackClass(track)+":",track),track},Participant.prototype._removeTrackPublication=function(publication){if(!(publication=this.tracks.get(publication.trackSid)))return null;this.tracks.delete(publication.trackSid),{audio:this.audioTracks,data:this.dataTracks,video:this.videoTracks}[publication.kind].delete(publication.trackSid),(this._trackPublicationEventReemitters.get(publication.trackSid)||new Map).forEach((function(reemitter,event){publication.removeListener(event,reemitter)}));var log=this._log;return log.info("Removed a "+util.trackPublicationClass(publication)+":",publication.trackSid),log.debug(util.trackPublicationClass(publication)+":",publication),publication},Participant.prototype.toJSON=function(){return util.valueToJSON(this)},Participant}(EventEmitter);function reemitTrackEvents(participant,track,id){var trackEventReemitters=new Map;"disconnected"!==participant.state&&(participant._getTrackEvents().forEach((function(eventPair){var trackEvent=eventPair[0],participantEvent=eventPair[1];trackEventReemitters.set(trackEvent,(function(){var args=[participantEvent].concat([].slice.call(arguments));return participant.emit.apply(participant,__spreadArray([],__read(args)))})),track.on(trackEvent,trackEventReemitters.get(trackEvent))})),participant._trackEventReemitters.set(id,trackEventReemitters))}module.exports=Participant},UBwA:function(module,exports,__webpack_require__){"use strict";var DocumentVisibilityMonitor=function(){function DocumentVisibilityMonitor(nPhases){var _this=this;void 0===nPhases&&(nPhases=1),Object.defineProperties(this,{_listeners:{value:[]},_onVisibilityChange:{value:function(){_this._emitVisible("visible"===document.visibilityState)}}});for(var i=0;i<nPhases;i++)this._listeners.push([])}return DocumentVisibilityMonitor.prototype.clear=function(){for(var nPhases=this._listeners.length,i=0;i<nPhases;i++)this._listeners[i]=[]},DocumentVisibilityMonitor.prototype._listenerCount=function(){return this._listeners.reduce((function(count,phaseListeners){return count+phaseListeners.length}),0)},DocumentVisibilityMonitor.prototype._emitVisible=function(isVisible){for(var _this=this,promise=Promise.resolve(),_loop_1=function(phase){promise=promise.then((function(){return _this._emitVisiblePhase(phase,isVisible)}))},phase=1;phase<=this._listeners.length;phase++)_loop_1(phase);return promise},DocumentVisibilityMonitor.prototype._emitVisiblePhase=function(phase,isVisible){return Promise.all(this._listeners[phase-1].map((function(listener){var ret=listener(isVisible);return ret instanceof Promise?ret:Promise.resolve(ret)})))},DocumentVisibilityMonitor.prototype._start=function(){document.addEventListener("visibilitychange",this._onVisibilityChange)},DocumentVisibilityMonitor.prototype._stop=function(){document.removeEventListener("visibilitychange",this._onVisibilityChange)},DocumentVisibilityMonitor.prototype.onVisibilityChange=function(phase,listener){if("number"!=typeof phase||phase<=0||phase>this._listeners.length)throw new Error("invalid phase: ",phase);return this._listeners[phase-1].push(listener),1===this._listenerCount()&&this._start(),this},DocumentVisibilityMonitor.prototype.offVisibilityChange=function(phase,listener){if("number"!=typeof phase||phase<=0||phase>this._listeners.length)throw new Error("invalid phase: ",phase);var phaseListeners=this._listeners[phase-1],index=phaseListeners.indexOf(listener);return-1!==index&&(phaseListeners.splice(index,1),0===this._listenerCount()&&this._stop()),this},DocumentVisibilityMonitor}();module.exports=new DocumentVisibilityMonitor(2)},UVaH:function(module,exports,__webpack_require__){"use strict";var origSymbol="undefined"!=typeof Symbol&&Symbol,hasSymbolSham=__webpack_require__("FpZJ");module.exports=function(){return"function"==typeof origSymbol&&"function"==typeof Symbol&&"symbol"==typeof origSymbol("foo")&&"symbol"==typeof Symbol("bar")&&hasSymbolSham()}},"UZ/N":function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),ReceiverReport=__webpack_require__("2xLa"),ReceiverReportFactory=function(_super){function ReceiverReportFactory(trackId,initialStats){var _this=_super.call(this,initialStats.id,trackId,initialStats)||this;return Object.defineProperties(_this,{lastReport:{enumerable:!0,value:null,writable:!0}}),_this}return __extends(ReceiverReportFactory,_super),ReceiverReportFactory.prototype.next=function(trackId,newerStats){var olderStats=this.lastStats;this.lastStats=newerStats,this.trackId=trackId;var report=ReceiverReport.of(trackId,olderStats,newerStats);return this.lastReport=report,report},ReceiverReportFactory}(__webpack_require__("akGs"));module.exports=ReceiverReportFactory},Um2Z:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),TrackPrioritySignaling=function(_super){function TrackPrioritySignaling(getReceiver,options){var _this=_super.call(this,getReceiver,"track_priority",options)||this;return Object.defineProperties(_this,{_enqueuedPriorityUpdates:{value:new Map}}),_this.on("ready",(function(transport){Array.from(_this._enqueuedPriorityUpdates.keys()).forEach((function(trackSid){transport.publish({type:"track_priority",track:trackSid,subscribe:_this._enqueuedPriorityUpdates.get(trackSid)})}))})),_this}return __extends(TrackPrioritySignaling,_super),TrackPrioritySignaling.prototype.sendTrackPriorityUpdate=function(trackSid,publishOrSubscribe,priority){if("subscribe"!==publishOrSubscribe)throw new Error("only subscribe priorities are supported, found: "+publishOrSubscribe);this._enqueuedPriorityUpdates.set(trackSid,priority),this._transport&&this._transport.publish({type:"track_priority",track:trackSid,subscribe:priority})},TrackPrioritySignaling}(__webpack_require__("zbom"));module.exports=TrackPrioritySignaling},UpXp:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),DataTrackTransceiver=function(_super){function DataTrackTransceiver(id,maxPacketLifeTime,maxRetransmits,ordered){var _this=_super.call(this,id,"data")||this;return Object.defineProperties(_this,{maxPacketLifeTime:{enumerable:!0,value:maxPacketLifeTime},maxRetransmits:{enumerable:!0,value:maxRetransmits},ordered:{enumerable:!0,value:ordered}}),_this}return __extends(DataTrackTransceiver,_super),DataTrackTransceiver}(__webpack_require__("Jhn5"));module.exports=DataTrackTransceiver},VF6F:function(module,exports,__webpack_require__){"use strict";var GetIntrinsic=__webpack_require__("AM7I"),callBind=__webpack_require__("PrET"),$indexOf=callBind(GetIntrinsic("String.prototype.indexOf"));module.exports=function(name,allowMissing){var intrinsic=GetIntrinsic(name,!!allowMissing);return"function"==typeof intrinsic&&$indexOf(name,".prototype.")>-1?callBind(intrinsic):intrinsic}},VR5W:function(module,exports,__webpack_require__){"use strict";module.exports={LocalAudioTrack:__webpack_require__("gJbR"),LocalVideoTrack:__webpack_require__("2NPH"),LocalDataTrack:__webpack_require__("Rj+V")}},VUT2:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),DataTransport=function(_super){function DataTransport(dataChannel){var _this=_super.call(this)||this;return Object.defineProperties(_this,{_dataChannel:{value:dataChannel},_messageQueue:{value:[]}}),dataChannel.addEventListener("open",(function(){_this._messageQueue.splice(0).forEach((function(message){return _this._publish(message)}))})),dataChannel.addEventListener("message",(function(_a){var data=_a.data;try{var message=JSON.parse(data);_this.emit("message",message)}catch(error){}})),_this.publish({type:"ready"}),_this}return __extends(DataTransport,_super),DataTransport.prototype._publish=function(message){var data=JSON.stringify(message);try{this._dataChannel.send(data)}catch(error){}},DataTransport.prototype.publish=function(message){var dataChannel=this._dataChannel;return"closing"!==dataChannel.readyState&&"closed"!==dataChannel.readyState&&("connecting"===dataChannel.readyState?(this._messageQueue.push(message),!0):(this._publish(message),!0))},DataTransport}(__webpack_require__("+qE3").EventEmitter);module.exports=DataTransport},VgEY:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),EventEmitter=__webpack_require__("+qE3").EventEmitter,VALID_GROUPS=["signaling","room","media","quality","video-processor","preflight"],VALID_LEVELS=["debug","error","info","warning"],EventObserver=function(_super){function EventObserver(publisher,connectTimestamp,log,eventListener){void 0===eventListener&&(eventListener=null);var _this=_super.call(this)||this;return _this.on("event",(function(_a){var name=_a.name,group=_a.group,level=_a.level,payload=_a.payload;if("string"!=typeof name)throw log.error("Unexpected name: ",name),new Error("Unexpected name: ",name);if(!VALID_GROUPS.includes(group))throw log.error("Unexpected group: ",group),new Error("Unexpected group: ",group);if(!VALID_LEVELS.includes(level))throw log.error("Unexpected level: ",level),new Error("Unexpected level: ",level);var timestamp=Date.now(),elapsedTime=timestamp-connectTimestamp,publisherPayload=Object.assign({elapsedTime:elapsedTime,level:level},payload||{});publisher.publish(group,name,publisherPayload);var event=Object.assign({elapsedTime:elapsedTime,group:group,level:level,name:name,timestamp:timestamp},payload?{payload:payload}:{});log[{debug:"debug",error:"error",info:"info",warning:"warn"}[level]]("event",event),eventListener&&"signaling"===group&&eventListener.emit("event",event)})),_this}return __extends(EventObserver,_super),EventObserver}(EventEmitter);module.exports=EventObserver},Vh62:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__spreadArray=this&&this.__spreadArray||function(to,from){for(var i=0,il=from.length,j=to.length;i<il;i++,j++)to[j]=from[i];return to},Track=__webpack_require__("NCuz"),_a=__webpack_require__("xwWy"),E=_a.typeErrors,trackPriority=_a.trackPriority,RemoteDataTrack=function(_super){function RemoteDataTrack(sid,dataTrackReceiver,options){var _this=_super.call(this,dataTrackReceiver.id,"data",options)||this;return Object.defineProperties(_this,{_isSwitchedOff:{value:!1,writable:!0},_priority:{value:null,writable:!0},isEnabled:{enumerable:!0,value:!0},isSwitchedOff:{enumerable:!0,get:function(){return this._isSwitchedOff}},maxPacketLifeTime:{enumerable:!0,value:dataTrackReceiver.maxPacketLifeTime},maxRetransmits:{enumerable:!0,value:dataTrackReceiver.maxRetransmits},ordered:{enumerable:!0,value:dataTrackReceiver.ordered},priority:{enumerable:!0,get:function(){return this._priority}},reliable:{enumerable:!0,value:null===dataTrackReceiver.maxPacketLifeTime&&null===dataTrackReceiver.maxRetransmits},sid:{enumerable:!0,value:sid}}),dataTrackReceiver.on("message",(function(data){_this.emit("message",data,_this)})),_this}return __extends(RemoteDataTrack,_super),RemoteDataTrack.prototype.setPriority=function(priority){var priorityValues=__spreadArray([null],__read(Object.values(trackPriority)));if(!priorityValues.includes(priority))throw E.INVALID_VALUE("priority",priorityValues);return this._priority=priority,this},RemoteDataTrack.prototype._setEnabled=function(){},RemoteDataTrack.prototype._setSwitchedOff=function(isSwitchedOff){this._isSwitchedOff!==isSwitchedOff&&(this._isSwitchedOff=isSwitchedOff,this.emit(isSwitchedOff?"switchedOff":"switchedOn",this))},RemoteDataTrack}(Track);module.exports=RemoteDataTrack},VueP:function(module,exports,__webpack_require__){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):(value=result.value,value instanceof P?value:new P((function(resolve){resolve(value)}))).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!((t=(t=_.trys).length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}},__read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar};function getStatValues(report,statName,kind,reportTypes){var results=[];return report.forEach((function(stat){0!==reportTypes.length&&!reportTypes.includes(stat.type)||0!==kind.length&&!kind.includes(stat.kind)||"number"!=typeof stat[statName]||results.push(stat[statName])})),results}function makeStandardCandidateStats(input){return[{key:"transportId",type:"string"},{key:"candidateType",type:"string"},{key:"port",altKeys:["portNumber"],type:"number"},{key:"address",altKeys:["ip","ipAddress"],type:"string"},{key:"priority",type:"number"},{key:"protocol",altKeys:["transport"],type:"string"},{key:"url",type:"string"},{key:"relayProtocol",type:"string"}].reduce((function(report,keyInfo){var keysToLookFor=[keyInfo.key];keyInfo.altKeys&&(keysToLookFor=keysToLookFor.concat(keyInfo.altKeys));var key=keysToLookFor.find((function(key){return key in input}));return key&&typeof input[key]===keyInfo.type&&(report[keyInfo.key]=input[key]),report}),{})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getCombinedConnectionStats=void 0,exports.getCombinedConnectionStats=function(_a){var publisher=_a.publisher,subscriber=_a.subscriber;return __awaiter(this,void 0,void 0,(function(){var _b,publisherStats,subscriberStats,timestamps,timestamp,jitter,packets,packetsLost,trackRoundTripTime,currentRoundTripTime,roundTripTime,bytesSent,bytesReceived,selectedIceCandidatePairStats,iceCandidateStats;return __generator(this,(function(_c){switch(_c.label){case 0:return[4,Promise.all([publisher,subscriber].map((function(pc){return pc.getStats()})))];case 1:return _b=__read.apply(void 0,[_c.sent(),2]),publisherStats=_b[0],timestamps=getStatValues(subscriberStats=_b[1],"timestamp",["audio"],["inbound-rtp"]),timestamp=timestamps.length>0?timestamps[0]:0,jitter=getStatValues(subscriberStats,"jitter",["audio"],["inbound-rtp"]).reduce((function(a,b){return Math.max(a,b)}),0),packets=getStatValues(subscriberStats,"packetsReceived",["audio","video"],["inbound-rtp"]).reduce((function(a,b){return a+b}),0),packetsLost=getStatValues(subscriberStats,"packetsLost",["audio","video"],["inbound-rtp"]).reduce((function(a,b){return a+b}),0),trackRoundTripTime=getStatValues(publisherStats,"roundTripTime",["audio","video"],["remote-inbound-rtp"]).reduce((function(a,b){return Math.max(a,b)}),0),currentRoundTripTime=getStatValues(subscriberStats,"currentRoundTripTime",[],["candidate-pair"]).reduce((function(a,b){return Math.max(a,b)}),0),roundTripTime=1e3*(currentRoundTripTime||trackRoundTripTime),bytesSent=getStatValues(publisherStats,"bytesSent",[],["candidate-pair"]).reduce((function(a,b){return a+b}),0),bytesReceived=getStatValues(subscriberStats,"bytesReceived",[],["candidate-pair"]).reduce((function(a,b){return a+b}),0),selectedIceCandidatePairStats=function(stats){var selectedCandidatePairId=null,candidatePairs=[];stats.forEach((function(stat){"transport"===stat.type&&stat.selectedCandidatePairId?selectedCandidatePairId=stat.selectedCandidatePairId:"candidate-pair"===stat.type&&candidatePairs.push(stat)}));var activeCandidatePairStatsFound=candidatePairs.find((function(pair){return pair.selected||selectedCandidatePairId&&pair.id===selectedCandidatePairId}));if(!activeCandidatePairStatsFound)return null;var activeCandidatePairStats=activeCandidatePairStatsFound,activeLocalCandidateStats=stats.get(activeCandidatePairStats.localCandidateId),activeRemoteCandidateStats=stats.get(activeCandidatePairStats.remoteCandidateId);return activeLocalCandidateStats&&activeRemoteCandidateStats?{localCandidate:makeStandardCandidateStats(activeLocalCandidateStats),remoteCandidate:makeStandardCandidateStats(activeRemoteCandidateStats)}:null}(subscriberStats),iceCandidateStats=[],subscriberStats.forEach((function(stat){"local-candidate"!==stat.type&&"remote-candidate"!==stat.type||iceCandidateStats.push(makeStandardCandidateStats(stat))})),[2,{timestamp:timestamp,jitter:jitter,packets:packets,packetsLost:packetsLost,roundTripTime:roundTripTime,bytesSent:bytesSent,bytesReceived:bytesReceived,selectedIceCandidatePairStats:selectedIceCandidatePairStats,iceCandidateStats:iceCandidateStats}]}}))}))}},"W/pi":function(module,exports,__webpack_require__){"use strict";var __read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__spreadArray=this&&this.__spreadArray||function(to,from){for(var i=0,il=from.length,j=to.length;i<il;i++,j++)to[j]=from[i];return to};Object.defineProperty(exports,"__esModule",{value:!0}),exports.makeStat=void 0,exports.makeStat=function(values){return values&&values.length?{min:Math.min.apply(Math,__spreadArray([],__read(values))),max:Math.max.apply(Math,__spreadArray([],__read(values))),average:values.reduce((function(total,value){return total+value}),0)/values.length}:null}},WHMX:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),RemoteTrackPublicationSignaling=function(_super){function RemoteTrackPublicationSignaling(sid,name,kind,isEnabled,priority,isSwitchedOff){var _this=_super.call(this,name,kind,isEnabled,priority)||this;return Object.defineProperties(_this,{_isSwitchedOff:{value:isSwitchedOff,writable:!0}}),_this.setSid(sid),_this}return __extends(RemoteTrackPublicationSignaling,_super),Object.defineProperty(RemoteTrackPublicationSignaling.prototype,"isSubscribed",{get:function(){return!!this.trackTransceiver},enumerable:!1,configurable:!0}),Object.defineProperty(RemoteTrackPublicationSignaling.prototype,"isSwitchedOff",{get:function(){return this._isSwitchedOff},enumerable:!1,configurable:!0}),RemoteTrackPublicationSignaling.prototype.subscribeFailed=function(error){return this.error||(this._error=error,this.emit("updated")),this},RemoteTrackPublicationSignaling.prototype.setPriority=function(priority){return this._priority!==priority&&(this._priority=priority,this.emit("updated")),this},RemoteTrackPublicationSignaling.prototype.setSwitchedOff=function(isSwitchedOff){return this._isSwitchedOff!==isSwitchedOff&&(this._isSwitchedOff=isSwitchedOff,this.emit("updated")),this},RemoteTrackPublicationSignaling}(__webpack_require__("Ivmz"));module.exports=RemoteTrackPublicationSignaling},XI6i:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),NetworkQualityVideoStats=function(_super){function NetworkQualityVideoStats(mediaLevels){return _super.call(this,mediaLevels)||this}return __extends(NetworkQualityVideoStats,_super),NetworkQualityVideoStats}(__webpack_require__("hkYD"));module.exports=NetworkQualityVideoStats},"Y1/N":function(module,exports,__webpack_require__){"use strict";var Timeout=function(){function Timeout(fn,delay,autoStart){void 0===autoStart&&(autoStart=!0),Object.defineProperties(this,{_delay:{value:delay,writable:!0},_fn:{value:fn},_timeout:{value:null,writable:!0}}),autoStart&&this.start()}return Object.defineProperty(Timeout.prototype,"delay",{get:function(){return this._delay},enumerable:!1,configurable:!0}),Object.defineProperty(Timeout.prototype,"isSet",{get:function(){return!!this._timeout},enumerable:!1,configurable:!0}),Timeout.prototype.setDelay=function(delay){this._delay=delay},Timeout.prototype.start=function(){var _this=this;this.isSet||(this._timeout=setTimeout((function(){var fn=_this._fn;_this.clear(),fn()}),this._delay))},Timeout.prototype.clear=function(){clearTimeout(this._timeout),this._timeout=null},Timeout.prototype.reset=function(){this.clear(),this.start()},Timeout}();module.exports=Timeout},Ye3u:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),LocalTrackPublicationSignaling=__webpack_require__("shdM"),createTwilioError=__webpack_require__("5wwa").createTwilioError,LocalTrackPublicationV2=function(_super){function LocalTrackPublicationV2(trackSender,name,priority){return _super.call(this,trackSender,name,priority)||this}return __extends(LocalTrackPublicationV2,_super),LocalTrackPublicationV2.prototype.getState=function(){return{enabled:this.isEnabled,id:this.id,kind:this.kind,name:this.name,priority:this.updatedPriority}},LocalTrackPublicationV2.prototype.update=function(track){switch(track.state){case"ready":this.setSid(track.sid);break;case"failed":var error=track.error;this.publishFailed(createTwilioError(error.code,error.message))}return this},LocalTrackPublicationV2}(LocalTrackPublicationSignaling);module.exports=LocalTrackPublicationV2},ZfiD:function(module,exports,__webpack_require__){"use strict";var IceReport=__webpack_require__("STyX"),IceReportFactory=function(){function IceReportFactory(){Object.defineProperties(this,{lastReport:{enumerable:!0,value:new IceReport(0,0),writable:!0},lastStats:{enumerable:!0,value:null,writable:!0}})}return IceReportFactory.prototype.next=function(newerStats){var olderStats=this.lastStats;if(this.lastStats=newerStats,olderStats){var report=olderStats.id===newerStats.id?IceReport.of(olderStats,newerStats):new IceReport(0,0);this.lastReport=report}return this.lastReport},IceReportFactory}();module.exports=IceReportFactory},aI7X:function(module,exports,__webpack_require__){"use strict";var ERROR_MESSAGE="Function.prototype.bind called on incompatible ",slice=Array.prototype.slice,toStr=Object.prototype.toString;module.exports=function(that){var target=this;if("function"!=typeof target||"[object Function]"!==toStr.call(target))throw new TypeError(ERROR_MESSAGE+target);for(var bound,args=slice.call(arguments,1),binder=function(){if(this instanceof bound){var result=target.apply(this,args.concat(slice.call(arguments)));return Object(result)===result?result:this}return target.apply(that,args.concat(slice.call(arguments)))},boundLength=Math.max(0,target.length-args.length),boundArgs=[],i=0;i<boundLength;i++)boundArgs.push("$"+i);if(bound=Function("binder","return function ("+boundArgs.join(",")+"){ return binder.apply(this,arguments); }")(binder),target.prototype){var Empty=function(){};Empty.prototype=target.prototype,bound.prototype=new Empty,Empty.prototype=null}return bound}},aQcx:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),getUserMedia=__webpack_require__("NBph").getUserMedia,_a=__webpack_require__("mIkg"),guessBrowser=_a.guessBrowser,isIOSChrome=_a.isIOSChrome,_b=__webpack_require__("ghd6"),capitalize=_b.capitalize,defer=_b.defer,isUserMediaTrack=_b.isUserMediaTrack,waitForSometime=_b.waitForSometime,waitForEvent=_b.waitForEvent,ILLEGAL_INVOKE=__webpack_require__("xwWy").typeErrors.ILLEGAL_INVOKE,detectSilentAudio=__webpack_require__("m0JW"),detectSilentVideo=__webpack_require__("+OFx"),documentVisibilityMonitor=__webpack_require__("UBwA"),localMediaRestartDeferreds=__webpack_require__("jxCJ"),gUMSilentTrackWorkaround=__webpack_require__("cV4H"),MediaTrackSender=__webpack_require__("O22K");function restartWhenInadvertentlyStopped(localMediaTrack){var log=localMediaTrack._log,kind=localMediaTrack.kind,detectSilence={audio:detectSilentAudio,video:detectSilentVideo}[kind],el=localMediaTrack._dummyEl,mediaStreamTrack=localMediaTrack.mediaStreamTrack,trackChangeInProgress=null;function maybeRestart(){return Promise.race([waitForEvent(mediaStreamTrack,"unmute"),waitForSometime(50)]).then((function(){return muted=localMediaTrack.mediaStreamTrack.muted,isInadvertentlyStopped=localMediaTrack.isStopped&&!!localMediaTrack._workaroundWebKitBug1208516Cleanup,Promise.resolve().then((function(){return"visible"===document.visibilityState&&!trackChangeInProgress&&(muted||isInadvertentlyStopped||el.play().then((function(){return detectSilence(el)})).then((function(isSilent){return isSilent?log.warn("Silence detected"):log.info("Non-silence detected"),isSilent})).catch((function(error){log.warn("Failed to detect silence:",error)})).finally((function(){el.pause()})))}));var muted,isInadvertentlyStopped})).then((function(shouldReacquire){return shouldReacquire&&!trackChangeInProgress&&(trackChangeInProgress=defer(),localMediaTrack._restart().finally((function(){el=localMediaTrack._dummyEl,removeMediaStreamTrackListeners(),mediaStreamTrack=localMediaTrack.mediaStreamTrack,addMediaStreamTrackListeners(),trackChangeInProgress.resolve(),trackChangeInProgress=null})).catch((function(error){log.error("failed to restart track: ",error)}))),(trackChangeInProgress&&trackChangeInProgress.promise||Promise.resolve()).finally((function(){return localMediaRestartDeferreds.resolveDeferred(kind)}))})).catch((function(ex){log.error("error in maybeRestart: "+ex.message)}))}function onMute(){var log=localMediaTrack._log,kind=localMediaTrack.kind;log.info("Muted"),log.debug("LocalMediaTrack:",localMediaTrack),localMediaRestartDeferreds.startDeferred(kind)}function addMediaStreamTrackListeners(){mediaStreamTrack.addEventListener("ended",maybeRestart),mediaStreamTrack.addEventListener("mute",onMute),mediaStreamTrack.addEventListener("unmute",maybeRestart)}function removeMediaStreamTrackListeners(){mediaStreamTrack.removeEventListener("ended",maybeRestart),mediaStreamTrack.removeEventListener("mute",onMute),mediaStreamTrack.removeEventListener("unmute",maybeRestart)}var onVisibilityChange=function(isVisible){return!!isVisible&&maybeRestart()};return documentVisibilityMonitor.onVisibilityChange(1,onVisibilityChange),addMediaStreamTrackListeners(),function(){documentVisibilityMonitor.offVisibilityChange(1,onVisibilityChange),removeMediaStreamTrackListeners()}}module.exports=function(AudioOrVideoTrack){return function(_super){function LocalMediaTrack(mediaStreamTrack,options){var _this=this,workaroundWebKitBug1208516=("safari"===guessBrowser()||isIOSChrome())&&isUserMediaTrack(mediaStreamTrack)&&"object"==typeof document&&"function"==typeof document.addEventListener&&"string"==typeof document.visibilityState;options=Object.assign({getUserMedia:getUserMedia,isCreatedByCreateLocalTracks:!1,workaroundWebKitBug1208516:workaroundWebKitBug1208516,gUMSilentTrackWorkaround:gUMSilentTrackWorkaround},options);var mediaTrackSender=new MediaTrackSender(mediaStreamTrack),kind=mediaTrackSender.kind;return _this=_super.call(this,mediaTrackSender,options)||this,Object.defineProperties(_this,{_constraints:{value:"object"==typeof options[kind]?options[kind]:{},writable:!0},_getUserMedia:{value:options.getUserMedia},_gUMSilentTrackWorkaround:{value:options.gUMSilentTrackWorkaround},_workaroundWebKitBug1208516:{value:options.workaroundWebKitBug1208516},_workaroundWebKitBug1208516Cleanup:{value:null,writable:!0},_didCallEnd:{value:!1,writable:!0},_isCreatedByCreateLocalTracks:{value:options.isCreatedByCreateLocalTracks},_trackSender:{value:mediaTrackSender},id:{enumerable:!0,value:mediaTrackSender.id},isEnabled:{enumerable:!0,get:function(){return mediaTrackSender.enabled}},isStopped:{enumerable:!0,get:function(){return"ended"===mediaTrackSender.readyState}}}),_this._workaroundWebKitBug1208516&&(_this._workaroundWebKitBug1208516Cleanup=restartWhenInadvertentlyStopped(_this)),_this}return __extends(LocalMediaTrack,_super),LocalMediaTrack.prototype._end=function(){this._didCallEnd||(_super.prototype._end.call(this),this._didCallEnd=!0,this.emit("stopped",this))},LocalMediaTrack.prototype._initialize=function(){this._didCallEnd&&(this._didCallEnd=!1),_super.prototype._initialize.call(this)},LocalMediaTrack.prototype._reacquireTrack=function(constraints){var _a,getUserMedia=this._getUserMedia,gUMSilentTrackWorkaround=this._gUMSilentTrackWorkaround,log=this._log,kind=this.mediaStreamTrack.kind;log.info("Re-acquiring the MediaStreamTrack"),log.debug("Constraints:",constraints);var gUMConstraints=Object.assign({audio:!1,video:!1},((_a={})[kind]=constraints,_a));return(this._workaroundWebKitBug1208516Cleanup?gUMSilentTrackWorkaround(log,getUserMedia,gUMConstraints):getUserMedia(gUMConstraints)).then((function(mediaStream){return mediaStream.getTracks()[0]}))},LocalMediaTrack.prototype._restart=function(constraints){var _this=this,log=this._log;return constraints=constraints||this._constraints,this._stop(),this._reacquireTrack(constraints).catch((function(error){throw log.error("Failed to re-acquire the MediaStreamTrack:",{error:error,constraints:constraints}),error})).then((function(newMediaStreamTrack){return log.info("Re-acquired the MediaStreamTrack"),log.debug("MediaStreamTrack:",newMediaStreamTrack),_this._constraints=Object.assign({},constraints),_this._setMediaStreamTrack(newMediaStreamTrack)}))},LocalMediaTrack.prototype._setMediaStreamTrack=function(mediaStreamTrack){var _this=this;return mediaStreamTrack.enabled=this.mediaStreamTrack.enabled,this._stop(),(this._unprocessedTrack?Promise.resolve().then((function(){_this._unprocessedTrack=mediaStreamTrack})):this._trackSender.setMediaStreamTrack(mediaStreamTrack).catch((function(error){_this._log.warn("setMediaStreamTrack failed:",{error:error,mediaStreamTrack:mediaStreamTrack})}))).then((function(){_this._initialize(),_this._getAllAttachedElements().forEach((function(el){return _this._attach(el)}))}))},LocalMediaTrack.prototype._stop=function(){return this.mediaStreamTrack.stop(),this._end(),this},LocalMediaTrack.prototype.enable=function(enabled){return(enabled="boolean"!=typeof enabled||enabled)!==this.mediaStreamTrack.enabled&&(this._log.info((enabled?"En":"Dis")+"abling"),this.mediaStreamTrack.enabled=enabled,this.emit(enabled?"enabled":"disabled",this)),this},LocalMediaTrack.prototype.disable=function(){return this.enable(!1)},LocalMediaTrack.prototype.restart=function(constraints){var _this=this,kind=this.kind;if(!this._isCreatedByCreateLocalTracks)return Promise.reject(ILLEGAL_INVOKE("restart","can only be called on a Local"+capitalize(kind)+"Track that is created using createLocalTracks or createLocal"+capitalize(kind)+"Track."));this._workaroundWebKitBug1208516Cleanup&&(this._workaroundWebKitBug1208516Cleanup(),this._workaroundWebKitBug1208516Cleanup=null);var promise=this._restart(constraints);return this._workaroundWebKitBug1208516&&(promise=promise.finally((function(){_this._workaroundWebKitBug1208516Cleanup=restartWhenInadvertentlyStopped(_this)}))),promise},LocalMediaTrack.prototype.stop=function(){return this._log.info("Stopping"),this._workaroundWebKitBug1208516Cleanup&&(this._workaroundWebKitBug1208516Cleanup(),this._workaroundWebKitBug1208516Cleanup=null),this._stop()},LocalMediaTrack}(AudioOrVideoTrack)}},akGs:function(module,exports,__webpack_require__){"use strict";module.exports=function(id,trackId,initialStats){Object.defineProperties(this,{id:{enumerable:!0,value:id,writable:!0},trackId:{enumerable:!0,value:trackId,writable:!0},lastStats:{enumerable:!0,value:initialStats,writable:!0}})}},b9Z9:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),RemoteVideoTrackStats=function(_super){function RemoteVideoTrackStats(trackId,statsReport){var _this=_super.call(this,trackId,statsReport)||this,dimensions=null;return"number"==typeof statsReport.frameWidthReceived&&"number"==typeof statsReport.frameHeightReceived&&(dimensions={},Object.defineProperties(dimensions,{width:{value:statsReport.frameWidthReceived,enumerable:!0},height:{value:statsReport.frameHeightReceived,enumerable:!0}})),Object.defineProperties(_this,{dimensions:{value:dimensions,enumerable:!0},frameRate:{value:"number"==typeof statsReport.frameRateReceived?statsReport.frameRateReceived:null,enumerable:!0}}),_this}return __extends(RemoteVideoTrackStats,_super),RemoteVideoTrackStats}(__webpack_require__("i99/"));module.exports=RemoteVideoTrackStats},bQMn:function(module,exports,__webpack_require__){"use strict";var EventEmitter=__webpack_require__("+qE3").EventEmitter;function EventTarget(){Object.defineProperties(this,{_eventEmitter:{value:new EventEmitter}})}EventTarget.prototype.dispatchEvent=function(event){return this._eventEmitter.emit(event.type,event)},EventTarget.prototype.addEventListener=function(){return this._eventEmitter.addListener.apply(this._eventEmitter,arguments)},EventTarget.prototype.removeEventListener=function(){return this._eventEmitter.removeListener.apply(this._eventEmitter,arguments)},module.exports=EventTarget},cV4H:function(module,exports,__webpack_require__){"use strict";var detectSilence=__webpack_require__("TM7a");module.exports=function(log,getUserMedia,constraints,n,timeout){n="number"==typeof n?n:3;var retry=0,AudioContextFactory=__webpack_require__("/+gY"),holder={},audioContext=AudioContextFactory.getOrCreate(holder);return function doWorkaround(){return getUserMedia(constraints).then((function(stream){return(constraints.audio?detectSilence(audioContext,stream,timeout).catch((function(err){return log.warn("Encountered an error while detecting silence",err),!0})):Promise.resolve(!1)).then((function(isSilent){return isSilent?n<=0?(log.warn("Got a silent audio MediaStreamTrack. Normally we would try to get a new one, but we've run out of retries; returning it anyway."),stream):(log.warn("Got a silent audio MediaStreamTrack. Stopping all MediaStreamTracks and calling getUserMedia again. This is retry #"+ ++retry+"."),stream.getTracks().forEach((function(track){return track.stop()})),n--,doWorkaround()):(log.info("Got a non-silent audio MediaStreamTrack; returning it."),stream)}))}))}().then((function(stream){return AudioContextFactory.release(holder),stream}),(function(error){throw AudioContextFactory.release(holder),error}))}},cibw:function(module,exports,__webpack_require__){"use strict";var possibleNames=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],g="undefined"==typeof globalThis?global:globalThis;module.exports=function(){for(var out=[],i=0;i<possibleNames.length;i++)"function"==typeof g[possibleNames[i]]&&(out[out.length]=possibleNames[i]);return out}},cmf6:function(module,exports){var noop=function(){},isIE="undefined"!=typeof window&&void 0!==window.navigator&&/Trident\/|MSIE /.test(window.navigator.userAgent),logMethods=["trace","debug","info","warn","error"];function bindMethod(obj,methodName){var method=obj[methodName];if("function"==typeof method.bind)return method.bind(obj);try{return Function.prototype.bind.call(method,obj)}catch(e){return function(){return Function.prototype.apply.apply(method,[obj,arguments])}}}function traceForIE(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function realMethod(methodName){return"debug"===methodName&&(methodName="log"),"undefined"!=typeof console&&("trace"===methodName&&isIE?traceForIE:void 0!==console[methodName]?bindMethod(console,methodName):void 0!==console.log?bindMethod(console,"log"):noop)}function replaceLoggingMethods(level,loggerName){for(var i=0;i<logMethods.length;i++){var methodName=logMethods[i];this[methodName]=i<level?noop:this.methodFactory(methodName,level,loggerName)}this.log=this.debug}function enableLoggingWhenConsoleArrives(methodName,level,loggerName){return function(){"undefined"!=typeof console&&(replaceLoggingMethods.call(this,level,loggerName),this[methodName].apply(this,arguments))}}function defaultMethodFactory(methodName,level,loggerName){return realMethod(methodName)||enableLoggingWhenConsoleArrives.apply(this,arguments)}function Logger(name,defaultLevel,factory){var currentLevel,self=this,storageKey="loglevel";function getPersistedLevel(){var storedLevel;if("undefined"!=typeof window&&storageKey){try{storedLevel=window.localStorage[storageKey]}catch(ignore){}if(void 0===storedLevel)try{var cookie=window.document.cookie,location=cookie.indexOf(encodeURIComponent(storageKey)+"=");-1!==location&&(storedLevel=/^([^;]+)/.exec(cookie.slice(location))[1])}catch(ignore){}return void 0===self.levels[storedLevel]&&(storedLevel=void 0),storedLevel}}"string"==typeof name?storageKey+=":"+name:"symbol"==typeof name&&(storageKey=void 0),self.name=name,self.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},self.methodFactory=factory||defaultMethodFactory,self.getLevel=function(){return currentLevel},self.setLevel=function(level,persist){if("string"==typeof level&&void 0!==self.levels[level.toUpperCase()]&&(level=self.levels[level.toUpperCase()]),!("number"==typeof level&&level>=0&&level<=self.levels.SILENT))throw"log.setLevel() called with invalid level: "+level;if(currentLevel=level,!1!==persist&&function(levelNum){var levelName=(logMethods[levelNum]||"silent").toUpperCase();if("undefined"!=typeof window&&storageKey){try{return void(window.localStorage[storageKey]=levelName)}catch(ignore){}try{window.document.cookie=encodeURIComponent(storageKey)+"="+levelName+";"}catch(ignore){}}}(level),replaceLoggingMethods.call(self,level,name),"undefined"==typeof console&&level<self.levels.SILENT)return"No console available for logging"},self.setDefaultLevel=function(level){getPersistedLevel()||self.setLevel(level,!1)},self.enableAll=function(persist){self.setLevel(self.levels.TRACE,persist)},self.disableAll=function(persist){self.setLevel(self.levels.SILENT,persist)};var initialLevel=getPersistedLevel();null==initialLevel&&(initialLevel=null==defaultLevel?"WARN":defaultLevel),self.setLevel(initialLevel,!1)}var defaultLogger=new Logger,_loggersByName={};defaultLogger.getLogger=function(name){if("symbol"!=typeof name&&"string"!=typeof name||""===name)throw new TypeError("You must supply a name when creating a logger.");var logger=_loggersByName[name];return logger||(logger=_loggersByName[name]=new Logger(name,defaultLogger.getLevel(),defaultLogger.methodFactory)),logger};var _log="undefined"!=typeof window?window.log:void 0;defaultLogger.noConflict=function(){return"undefined"!=typeof window&&window.log===defaultLogger&&(window.log=_log),defaultLogger},defaultLogger.getLoggers=function(){return _loggersByName},defaultLogger.default=defaultLogger,module.exports=defaultLogger},crnd:function(module,exports){function webpackEmptyAsyncContext(req){return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}))}webpackEmptyAsyncContext.keys=function(){return[]},webpackEmptyAsyncContext.resolve=webpackEmptyAsyncContext,module.exports=webpackEmptyAsyncContext,webpackEmptyAsyncContext.id="crnd"},"d+6x":function(module,exports,__webpack_require__){"use strict";var NetworkMonitor=function(){function NetworkMonitor(onNetworkChanged,options){var _this=this,nav=(options=Object.assign({navigator:navigator,window:window},options)).navigator,connection=nav.connection||{type:null},type=connection.type,_a=connection.type?{_events:{value:["change","typechange"]},_listener:{value:function(){var networkChanged=type!==_this.type&&_this.isOnline;type=_this.type,networkChanged&&onNetworkChanged()}},_target:{value:connection}}:{_events:{value:["online"]},_listener:{value:onNetworkChanged},_target:{value:options.window}};Object.defineProperties(this,{isOnline:{enumerable:!0,get:function(){return"boolean"!=typeof nav.onLine||nav.onLine}},type:{enumerable:!0,get:function(){return connection.type||null}},_listener:_a._listener,_events:_a._events,_target:_a._target})}return NetworkMonitor.prototype.start=function(){var _this=this;this._events.forEach((function(event){_this._target.addEventListener(event,_this._listener)}))},NetworkMonitor.prototype.stop=function(){var _this=this;this._events.forEach((function(event){_this._target.removeEventListener(event,_this._listener)}))},NetworkMonitor}();module.exports=NetworkMonitor},d6fC:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__spreadArray=this&&this.__spreadArray||function(to,from){for(var i=0,il=from.length,j=to.length;i<il;i++,j++)to[j]=from[i];return to},DefaultBackoff=__webpack_require__("Czg6"),_a=__webpack_require__("NBph"),DefaultRTCIceCandidate=_a.RTCIceCandidate,DefaultRTCPeerConnection=_a.RTCPeerConnection,DefaultRTCSessionDescription=_a.RTCSessionDescription,getStatistics=_a.getStats,util=__webpack_require__("mIkg"),_b=__webpack_require__("xwWy"),DEFAULT_ICE_GATHERING_TIMEOUT_MS=_b.DEFAULT_ICE_GATHERING_TIMEOUT_MS,DEFAULT_LOG_LEVEL=_b.DEFAULT_LOG_LEVEL,DEFAULT_SESSION_TIMEOUT_SEC=_b.DEFAULT_SESSION_TIMEOUT_SEC,iceRestartBackoffConfig=_b.iceRestartBackoffConfig,_c=__webpack_require__("9dY8"),addOrRewriteNewTrackIds=_c.addOrRewriteNewTrackIds,addOrRewriteTrackIds=_c.addOrRewriteTrackIds,createCodecMapForMediaSection=_c.createCodecMapForMediaSection,disableRtx=_c.disableRtx,enableDtxForOpus=_c.enableDtxForOpus,filterLocalCodecs=_c.filterLocalCodecs,getMediaSections=_c.getMediaSections,removeSSRCAttributes=_c.removeSSRCAttributes,revertSimulcast=_c.revertSimulcast,setCodecPreferences=_c.setCodecPreferences,setSimulcast=_c.setSimulcast,DefaultTimeout=__webpack_require__("Y1/N"),_d=__webpack_require__("5wwa"),MediaClientLocalDescFailedError=_d.MediaClientLocalDescFailedError,MediaClientRemoteDescFailedError=_d.MediaClientRemoteDescFailedError,_e=__webpack_require__("ghd6"),buildLogLevels=_e.buildLogLevels,getPlatform=_e.getPlatform,isChromeScreenShareTrack=_e.isChromeScreenShareTrack,oncePerTick=_e.oncePerTick,defer=_e.defer,IceBox=__webpack_require__("uqca"),DefaultIceConnectionMonitor=__webpack_require__("T5BQ"),DataTrackReceiver=__webpack_require__("lBno"),MediaTrackReceiver=__webpack_require__("7bK7"),StateMachine=__webpack_require__("gEVb"),Log=__webpack_require__("S3Hu"),TrackMatcher=__webpack_require__("tC0a"),workaroundIssue8329=__webpack_require__("ROvb"),guess=util.guessBrowser(),platform=getPlatform(),isAndroid=/android/.test(platform),isChrome="chrome"===guess,isFirefox="firefox"===guess,isSafari="safari"===guess,nInstances=0,states={open:["closed","updating"],updating:["closed","open"],closed:[]},PeerConnectionV2=function(_super){function PeerConnectionV2(id,encodingParameters,preferredCodecs,options){var _this=_super.call(this,"open",states)||this,configuration=getConfiguration(options=Object.assign({enableDscp:!1,dummyAudioMediaStreamTrack:null,isChromeScreenShareTrack:isChromeScreenShareTrack,iceServers:[],logLevel:DEFAULT_LOG_LEVEL,offerOptions:{},revertSimulcast:revertSimulcast,sessionTimeout:1e3*DEFAULT_SESSION_TIMEOUT_SEC,setCodecPreferences:setCodecPreferences,setSimulcast:setSimulcast,Backoff:DefaultBackoff,IceConnectionMonitor:DefaultIceConnectionMonitor,RTCIceCandidate:DefaultRTCIceCandidate,RTCPeerConnection:DefaultRTCPeerConnection,RTCSessionDescription:DefaultRTCSessionDescription,Timeout:DefaultTimeout},options)),logLevels=buildLogLevels(options.logLevel),RTCPeerConnection=options.RTCPeerConnection;!0===options.enableDscp&&(options.chromeSpecificConstraints=options.chromeSpecificConstraints||{},options.chromeSpecificConstraints.optional=options.chromeSpecificConstraints.optional||[],options.chromeSpecificConstraints.optional.push({googDscp:!0}));var log=options.log?options.log.createLog("webrtc",_this):new Log("webrtc",_this,logLevels,options.loggerName),peerConnection=new RTCPeerConnection(configuration,options.chromeSpecificConstraints);options.dummyAudioMediaStreamTrack&&peerConnection.addTrack(options.dummyAudioMediaStreamTrack),Object.defineProperties(_this,{_appliedTrackIdsToAttributes:{value:new Map,writable:!0},_dataChannels:{value:new Map},_dataTrackReceivers:{value:new Set},_descriptionRevision:{writable:!0,value:0},_didGenerateLocalCandidates:{writable:!0,value:!1},_enableDscp:{value:options.enableDscp},_encodingParameters:{value:encodingParameters},_isChromeScreenShareTrack:{value:options.isChromeScreenShareTrack},_iceGatheringFailed:{value:!1,writable:!0},_iceGatheringTimeout:{value:new options.Timeout((function(){return _this._handleIceGatheringTimeout()}),DEFAULT_ICE_GATHERING_TIMEOUT_MS,!1)},_iceRestartBackoff:{value:options.Backoff.exponential(iceRestartBackoffConfig)},_instanceId:{value:++nInstances},_isIceConnectionInactive:{writable:!0,value:!1},_isIceLite:{writable:!0,value:!1},_isIceRestartBackoffInProgress:{writable:!0,value:!1},_isRestartingIce:{writable:!0,value:!1},_lastIceConnectionState:{writable:!0,value:null},_lastStableDescriptionRevision:{writable:!0,value:0},_localCandidates:{writable:!0,value:[]},_localCodecs:{value:new Set},_localCandidatesRevision:{writable:!0,value:1},_localDescriptionWithoutSimulcast:{writable:!0,value:null},_localDescription:{writable:!0,value:null},_localUfrag:{writable:!0,value:null},_log:{value:log},_eventObserver:{value:options.eventObserver},_remoteCodecMaps:{value:new Map},_rtpSenders:{value:new Map},_rtpNewSenders:{value:new Set},_iceConnectionMonitor:{value:new options.IceConnectionMonitor(peerConnection)},_mediaTrackReceivers:{value:new Set},_needsAnswer:{writable:!0,value:!1},_negotiationRole:{writable:!0,value:null},_offerOptions:{writable:!0,value:options.offerOptions},_onEncodingParametersChanged:{value:oncePerTick((function(){_this._needsAnswer||updateEncodingParameters(_this)}))},_peerConnection:{value:peerConnection},_preferredAudioCodecs:{value:preferredCodecs.audio},_preferredVideoCodecs:{value:preferredCodecs.video},_shouldApplyDtx:{value:preferredCodecs.audio.every((function(_a){return"opus"!==_a.codec}))||preferredCodecs.audio.some((function(_a){return"opus"===_a.codec&&_a.dtx}))},_queuedDescription:{writable:!0,value:null},_iceReconnectTimeout:{value:new options.Timeout((function(){log.debug("ICE reconnect timed out"),_this.close()}),options.sessionTimeout,!1)},_recycledTransceivers:{value:{audio:[],video:[]}},_replaceTrackPromises:{value:new Map},_remoteCandidates:{writable:!0,value:new IceBox},_setCodecPreferences:{value:isFirefox&&isAndroid&&preferredCodecs.video[0]&&"h264"!==preferredCodecs.video[0].codec.toLowerCase()?function(sdp){return sdp}:options.setCodecPreferences},_setSimulcast:{value:options.setSimulcast},_revertSimulcast:{value:options.revertSimulcast},_RTCIceCandidate:{value:options.RTCIceCandidate},_RTCPeerConnection:{value:options.RTCPeerConnection},_RTCSessionDescription:{value:options.RTCSessionDescription},_shouldOffer:{writable:!0,value:!1},_shouldRestartIce:{writable:!0,value:!1},_trackIdsToAttributes:{value:new Map,writable:!0},_trackMatcher:{writable:!0,value:null},_mediaTrackSenderToPublisherHints:{value:new Map},id:{enumerable:!0,value:id}}),encodingParameters.on("changed",_this._onEncodingParametersChanged),peerConnection.addEventListener("connectionstatechange",_this._handleConnectionStateChange.bind(_this)),peerConnection.addEventListener("datachannel",_this._handleDataChannelEvent.bind(_this)),peerConnection.addEventListener("icecandidate",_this._handleIceCandidateEvent.bind(_this)),peerConnection.addEventListener("iceconnectionstatechange",_this._handleIceConnectionStateChange.bind(_this)),peerConnection.addEventListener("icegatheringstatechange",_this._handleIceGatheringStateChange.bind(_this)),peerConnection.addEventListener("signalingstatechange",_this._handleSignalingStateChange.bind(_this)),peerConnection.addEventListener("track",_this._handleTrackEvent.bind(_this)),_this._iceRestartBackoff.on("ready",(function(){return _this._initiateIceRestart()}));var self=_this;return _this.on("stateChanged",(function stateChanged(state){"closed"===state&&(self.removeListener("stateChanged",stateChanged),self._dataChannels.forEach((function(dataChannel,dataTrackSender){self.removeDataTrackSender(dataTrackSender)})))})),_this}return __extends(PeerConnectionV2,_super),PeerConnectionV2.prototype.toString=function(){return"[PeerConnectionV2 #"+this._instanceId+": "+this.id+"]"},PeerConnectionV2.prototype.setEffectiveAdaptiveSimulcast=function(effectiveAdaptiveSimulcast){this._log.debug("Setting setEffectiveAdaptiveSimulcast: ",effectiveAdaptiveSimulcast),this._preferredVideoCodecs.forEach((function(cs){"adaptiveSimulcast"in cs&&(cs.adaptiveSimulcast=effectiveAdaptiveSimulcast)}))},Object.defineProperty(PeerConnectionV2.prototype,"_shouldApplySimulcast",{get:function(){return!(!isChrome&&!isSafari)&&this._preferredVideoCodecs.some((function(cs){return"vp8"===cs.codec.toLowerCase()&&cs.simulcast&&!1!==cs.adaptiveSimulcast}))},enumerable:!1,configurable:!0}),Object.defineProperty(PeerConnectionV2.prototype,"connectionState",{get:function(){return"failed"===this.iceConnectionState?"failed":this._peerConnection.connectionState||this.iceConnectionState},enumerable:!1,configurable:!0}),Object.defineProperty(PeerConnectionV2.prototype,"iceConnectionState",{get:function(){return this._isIceConnectionInactive&&"disconnected"===this._peerConnection.iceConnectionState||this._iceGatheringFailed?"failed":this._peerConnection.iceConnectionState},enumerable:!1,configurable:!0}),Object.defineProperty(PeerConnectionV2.prototype,"isApplicationSectionNegotiated",{get:function(){return"closed"===this._peerConnection.signalingState||!!this._peerConnection.localDescription&&getMediaSections(this._peerConnection.localDescription.sdp,"application").length>0},enumerable:!1,configurable:!0}),Object.defineProperty(PeerConnectionV2.prototype,"_isAdaptiveSimulcastEnabled",{get:function(){var adaptiveSimulcastEntry=this._preferredVideoCodecs.find((function(cs){return"adaptiveSimulcast"in cs}));return adaptiveSimulcastEntry&&!0===adaptiveSimulcastEntry.adaptiveSimulcast},enumerable:!1,configurable:!0}),PeerConnectionV2.prototype._maybeUpdateEncodings=function(track,encodings,trackReplaced){if(void 0===trackReplaced&&(trackReplaced=!1),"video"!==track.kind)return!1;var browser=util.guessBrowser();return!!("safari"===browser||"chrome"===browser&&this._isAdaptiveSimulcastEnabled)&&(this._updateEncodings(track,encodings,trackReplaced),!0)},PeerConnectionV2.prototype._updateEncodings=function(track,encodings,trackReplaced){if(this._isChromeScreenShareTrack(track)){var screenShareActiveLayerConfig_1=[{scaleResolutionDownBy:1},{scaleResolutionDownBy:1}];encodings.forEach((function(encoding,i){var activeLayerConfig=screenShareActiveLayerConfig_1[i];activeLayerConfig?(encoding.scaleResolutionDownBy=activeLayerConfig.scaleResolutionDownBy,trackReplaced&&delete encoding.active):(encoding.active=!1,delete encoding.scaleResolutionDownBy)}))}else{var _a=track.getSettings(),trackPixels_1=_a.width*_a.height,activeLayersInfo=[{pixels:518400,maxActiveLayers:3},{pixels:129600,maxActiveLayers:2},{pixels:0,maxActiveLayers:1}].find((function(layer){return trackPixels_1>=layer.pixels})),activeLayers_1=Math.min(encodings.length,activeLayersInfo.maxActiveLayers);encodings.forEach((function(encoding,i){i<activeLayers_1?(encoding.scaleResolutionDownBy=1<<activeLayers_1-i-1,trackReplaced&&(encoding.active=!0)):(encoding.active=!1,delete encoding.scaleResolutionDownBy)}))}this._log.debug("_updateEncodings:",encodings.map((function(_a,i){return"["+i+": "+_a.active+", "+(_a.scaleResolutionDownBy||0)+"]"})).join(", "))},PeerConnectionV2.prototype._addIceCandidate=function(candidate){var _this=this;return Promise.resolve().then((function(){return candidate=new _this._RTCIceCandidate(candidate),_this._peerConnection.addIceCandidate(candidate)})).catch((function(error){_this._log.warn("Failed to add RTCIceCandidate "+(candidate?'"'+candidate.candidate+'"':"null")+": "+error.message)}))},PeerConnectionV2.prototype._addIceCandidates=function(candidates){return Promise.all(candidates.map(this._addIceCandidate,this)).then((function(){}))},PeerConnectionV2.prototype._addOrUpdateTransceiver=function(track){var _this=this,transceiver=function(pcv2,kind){var preferredCodecs={audio:pcv2._preferredAudioCodecs.map((function(_a){return _a.codec.toLowerCase()})),video:pcv2._preferredVideoCodecs.map((function(_a){return _a.codec.toLowerCase()}))}[kind],recycledTransceivers=pcv2._recycledTransceivers[kind],localCodec=preferredCodecs.find((function(codec){return pcv2._localCodecs.has(codec)}));if(!localCodec)return recycledTransceivers.shift();var transceiver=recycledTransceivers.find((function(transceiver){var remoteCodecMap=pcv2._remoteCodecMaps.get(transceiver.mid);return remoteCodecMap&&remoteCodecMap.has(localCodec)}));return transceiver&&recycledTransceivers.splice(recycledTransceivers.indexOf(transceiver),1),transceiver}(this,track.kind);if(transceiver&&transceiver.sender){var oldTrackId=transceiver.sender.track?transceiver.sender.track.id:null;return oldTrackId&&this._log.warn("Reusing transceiver: "+transceiver.mid+"] "+oldTrackId+" => "+track.id),this._replaceTrackPromises.set(transceiver,transceiver.sender.replaceTrack(track).then((function(){transceiver.direction="sendrecv"}),(function(){})).finally((function(){_this._replaceTrackPromises.delete(transceiver)}))),transceiver}return this._peerConnection.addTransceiver(track)},PeerConnectionV2.prototype._checkIceBox=function(description){var ufrag=getUfrag(description);if(!ufrag)return Promise.resolve();var candidates=this._remoteCandidates.setUfrag(ufrag);return this._addIceCandidates(candidates)},PeerConnectionV2.prototype._answer=function(offer){var _this=this;return Promise.resolve().then((function(){return _this._negotiationRole||(_this._negotiationRole="answerer"),_this._setRemoteDescription(offer)})).catch((function(){throw new MediaClientRemoteDescFailedError})).then((function(){return _this._peerConnection.createAnswer()})).then((function(answer){answer=isFirefox?new _this._RTCSessionDescription({sdp:disableRtx(answer.sdp),type:answer.type}):workaroundIssue8329(answer);var updatedSdp=removeSSRCAttributes(answer.sdp,["mslabel","label"]);if(_this._shouldApplySimulcast){var sdpWithoutSimulcast=updatedSdp;updatedSdp=_this._setSimulcast(sdpWithoutSimulcast,_this._trackIdsToAttributes),updatedSdp=_this._revertSimulcast(updatedSdp,sdpWithoutSimulcast,offer.sdp)}return updatedSdp=updatedSdp.replace(/42e015/g,"42e01f"),_this._setLocalDescription({type:answer.type,sdp:updatedSdp})})).then((function(){return _this._checkIceBox(offer)})).then((function(){return _this._queuedDescription&&_this._updateDescription(_this._queuedDescription)})).then((function(){return _this._queuedDescription=null,_this._maybeReoffer(_this._peerConnection.localDescription)})).catch((function(error){var errorToThrow=error instanceof MediaClientRemoteDescFailedError?error:new MediaClientLocalDescFailedError;throw _this._publishMediaWarning({message:"Failed to _answer",code:errorToThrow.code,error:error}),errorToThrow}))},PeerConnectionV2.prototype._close=function(){return this._iceConnectionMonitor.stop(),"closed"!==this._peerConnection.signalingState&&(this._peerConnection.close(),this.preempt("closed"),this._encodingParameters.removeListener("changed",this._onEncodingParametersChanged),!0)},PeerConnectionV2.prototype._handleConnectionStateChange=function(){this.emit("connectionStateChanged")},PeerConnectionV2.prototype._handleDataChannelEvent=function(event){var _this=this,dataChannel=event.channel,dataTrackReceiver=new DataTrackReceiver(dataChannel);this._dataTrackReceivers.add(dataTrackReceiver),dataChannel.addEventListener("close",(function(){_this._dataTrackReceivers.delete(dataTrackReceiver)})),this.emit("trackAdded",dataTrackReceiver)},PeerConnectionV2.prototype._handleGlare=function(offer){var _this=this;return this._log.debug("Glare detected; rolling back"),this._isRestartingIce&&(this._log.debug("An ICE restart was in progress; we'll need to restart ICE again after rolling back"),this._isRestartingIce=!1,this._shouldRestartIce=!0),Promise.resolve().then((function(){return _this._trackIdsToAttributes=new Map(_this._appliedTrackIdsToAttributes),_this._setLocalDescription({type:"rollback"})})).then((function(){return _this._needsAnswer=!1,_this._answer(offer)})).then((function(didReoffer){return didReoffer?Promise.resolve():_this._offer()}))},PeerConnectionV2.prototype._publishMediaWarning=function(_a){this._eventObserver.emit("event",{level:"warning",name:"error",group:"media",payload:{message:_a.message,code:_a.code,context:JSON.stringify({error:_a.error.message,sdp:_a.sdp})}})},PeerConnectionV2.prototype._handleIceCandidateEvent=function(event){event.candidate&&(this._log.debug("Clearing ICE gathering timeout"),this._didGenerateLocalCandidates=!0,this._iceGatheringTimeout.clear(),this._localCandidates.push(event.candidate));var peerConnectionState={ice:{candidates:this._isIceLite?[]:this._localCandidates.slice(),ufrag:this._localUfrag},id:this.id};event.candidate||(peerConnectionState.ice.complete=!0),this._isIceLite&&event.candidate||(peerConnectionState.ice.revision=this._localCandidatesRevision++,this.emit("candidates",peerConnectionState))},PeerConnectionV2.prototype._handleIceConnectionStateChange=function(){var _this=this,iceConnectionState=this._peerConnection.iceConnectionState,isIceConnectedOrComplete=["connected","completed"].includes(iceConnectionState),log=this._log;log.debug('ICE connection state is "'+iceConnectionState+'"'),isIceConnectedOrComplete&&(this._iceReconnectTimeout.clear(),this._iceRestartBackoff.reset()),"failed"===this._lastIceConnectionState||"failed"!==iceConnectionState||this._shouldRestartIce||this._isRestartingIce?["disconnected","failed"].includes(this._lastIceConnectionState)&&isIceConnectedOrComplete&&log.debug("ICE reconnected"):(log.warn("ICE failed"),this._initiateIceRestartBackoff()),"connected"===iceConnectionState?(this._isIceConnectionInactive=!1,this._iceConnectionMonitor.start((function(){_this._iceConnectionMonitor.stop(),_this._shouldRestartIce||_this._isRestartingIce||(log.warn("ICE Connection Monitor detected inactivity"),_this._isIceConnectionInactive=!0,_this._initiateIceRestartBackoff(),_this.emit("iceConnectionStateChanged"),_this.emit("connectionStateChanged"))}))):["disconnected","completed"].includes(iceConnectionState)||(this._iceConnectionMonitor.stop(),this._isIceConnectionInactive=!1),this._lastIceConnectionState=iceConnectionState,this.emit("iceConnectionStateChanged")},PeerConnectionV2.prototype._handleIceGatheringTimeout=function(){this._log.warn("ICE failed to gather any local candidates"),this._iceGatheringFailed=!0,this._initiateIceRestartBackoff(),this.emit("iceConnectionStateChanged"),this.emit("connectionStateChanged")},PeerConnectionV2.prototype._handleIceGatheringStateChange=function(){var iceGatheringState=this._peerConnection.iceGatheringState,log=this._log;log.debug('ICE gathering state is "'+iceGatheringState+'"');var _a=this._iceGatheringTimeout;"gathering"!==iceGatheringState||this._didGenerateLocalCandidates||_a.isSet||(log.debug("Starting ICE gathering timeout: "+_a.delay),this._iceGatheringFailed=!1,this._iceGatheringTimeout.start())},PeerConnectionV2.prototype._handleSignalingStateChange=function(){"stable"===this._peerConnection.signalingState&&(this._appliedTrackIdsToAttributes=new Map(this._trackIdsToAttributes))},PeerConnectionV2.prototype._handleTrackEvent=function(event){var _this=this,sdp=this._peerConnection.remoteDescription?this._peerConnection.remoteDescription.sdp:null;this._trackMatcher=this._trackMatcher||new TrackMatcher,this._trackMatcher.update(sdp);var mediaStreamTrack=event.track,signaledTrackId=this._trackMatcher.match(event)||mediaStreamTrack.id,mediaTrackReceiver=new MediaTrackReceiver(signaledTrackId,mediaStreamTrack);this._mediaTrackReceivers.forEach((function(trackReceiver){trackReceiver.track.id===mediaTrackReceiver.track.id&&_this._mediaTrackReceivers.delete(trackReceiver)})),this._mediaTrackReceivers.add(mediaTrackReceiver),mediaStreamTrack.addEventListener("ended",(function(){return _this._mediaTrackReceivers.delete(mediaTrackReceiver)})),this.emit("trackAdded",mediaTrackReceiver)},PeerConnectionV2.prototype._initiateIceRestart=function(){if("closed"!==this._peerConnection.signalingState){var log=this._log;log.warn("Attempting to restart ICE"),this._didGenerateLocalCandidates=!1,this._isIceRestartBackoffInProgress=!1,this._shouldRestartIce=!0;var _a=this._iceReconnectTimeout;_a.isSet||(log.debug("Starting ICE reconnect timeout: "+_a.delay),this._iceReconnectTimeout.start()),this.offer().catch((function(ex){log.error("offer failed in _initiateIceRestart with: "+ex.message)}))}},PeerConnectionV2.prototype._initiateIceRestartBackoff=function(){"closed"===this._peerConnection.signalingState||this._isIceRestartBackoffInProgress||(this._log.warn("An ICE restart has been scheduled"),this._isIceRestartBackoffInProgress=!0,this._iceRestartBackoff.backoff())},PeerConnectionV2.prototype._maybeReoffer=function(localDescription){var shouldReoffer=this._shouldOffer;if(localDescription&&localDescription.sdp){var senders_1=this._peerConnection.getSenders().filter((function(sender){return sender.track}));shouldReoffer=["audio","video"].reduce((function(shouldOffer,kind){var mediaSections=getMediaSections(localDescription.sdp,kind,"(sendrecv|sendonly)"),sendersOfKind=senders_1.filter(isSenderOfKind.bind(null,kind));return shouldOffer||mediaSections.length<sendersOfKind.length}),shouldReoffer);var hasDataTrack=this._dataChannels.size>0,hasApplicationMediaSection=getMediaSections(localDescription.sdp,"application").length>0;shouldReoffer=shouldReoffer||hasDataTrack&&!hasApplicationMediaSection}return(shouldReoffer?this._offer():Promise.resolve()).then((function(){return shouldReoffer}))},PeerConnectionV2.prototype._offer=function(){var _this=this,offerOptions=Object.assign({},this._offerOptions);return this._needsAnswer=!0,this._shouldRestartIce&&(this._shouldRestartIce=!1,this._isRestartingIce=!0,offerOptions.iceRestart=!0),Promise.all(this._replaceTrackPromises.values()).then((function(){return _this._peerConnection.createOffer(offerOptions)})).catch((function(error){var errorToThrow=new MediaClientLocalDescFailedError;throw _this._publishMediaWarning({message:"Failed to create offer",code:errorToThrow.code,error:error}),errorToThrow})).then((function(offer){offer=isFirefox?new _this._RTCSessionDescription({sdp:disableRtx(offer.sdp),type:offer.type}):workaroundIssue8329(offer);var sdp=removeSSRCAttributes(offer.sdp,["mslabel","label"]);sdp=_this._peerConnection.remoteDescription?filterLocalCodecs(sdp,_this._peerConnection.remoteDescription.sdp):sdp;var updatedSdp=_this._setCodecPreferences(sdp,_this._preferredAudioCodecs,_this._preferredVideoCodecs);return _this._shouldOffer=!1,_this._negotiationRole||(_this._negotiationRole="offerer"),_this._shouldApplySimulcast&&(_this._localDescriptionWithoutSimulcast={type:"offer",sdp:updatedSdp},updatedSdp=_this._setSimulcast(updatedSdp,_this._trackIdsToAttributes)),_this._setLocalDescription({type:"offer",sdp:updatedSdp})}))},PeerConnectionV2.prototype._getMediaTrackSenderId=function(trackId){var mediaTrackSender=Array.from(this._rtpSenders.keys()).find((function(_a){return _a.track.id===trackId}));return mediaTrackSender?mediaTrackSender.id:trackId},PeerConnectionV2.prototype._addOrRewriteLocalTrackIds=function(description){var _this=this,activeTransceivers=this._peerConnection.getTransceivers().filter((function(_a){var sender=_a.sender;return!_a.stopped&&sender&&sender.track})),assignedTransceivers=activeTransceivers.filter((function(_a){return _a.mid})),midsToTrackIds=new Map(assignedTransceivers.map((function(_a){return[_a.mid,_this._getMediaTrackSenderId(_a.sender.track.id)]}))),sdp1=addOrRewriteTrackIds(description.sdp,midsToTrackIds),unassignedTransceivers=activeTransceivers.filter((function(_a){return!_a.mid})),newTrackIdsByKind=new Map(["audio","video"].map((function(kind){return[kind,unassignedTransceivers.filter((function(_a){return _a.sender.track.kind===kind})).map((function(_a){return _this._getMediaTrackSenderId(_a.sender.track.id)}))]}))),sdp2=addOrRewriteNewTrackIds(sdp1,midsToTrackIds,newTrackIdsByKind);return new this._RTCSessionDescription({sdp:sdp2,type:description.type})},PeerConnectionV2.prototype._rollbackAndApplyOffer=function(offer){var _this=this;return this._setLocalDescription({type:"rollback"}).then((function(){return _this._setLocalDescription(offer)}))},PeerConnectionV2.prototype._setLocalDescription=function(description){var _this=this;return"rollback"!==description.type&&this._shouldApplyDtx&&(description=new this._RTCSessionDescription({sdp:enableDtxForOpus(description.sdp),type:description.type})),this._peerConnection.setLocalDescription(description).catch((function(error){_this._log.warn('Calling setLocalDescription with an RTCSessionDescription of type "'+description.type+'" failed with the error "'+error.message+'".',error);var errorToThrow=new MediaClientLocalDescFailedError,publishWarning={message:'Calling setLocalDescription with an RTCSessionDescription of type "'+description.type+'" failed',code:errorToThrow.code,error:error};throw description.sdp&&(_this._log.warn("The SDP was "+description.sdp),publishWarning.sdp=description.sdp),_this._publishMediaWarning(publishWarning),errorToThrow})).then((function(){"rollback"!==description.type&&(_this._localDescription=_this._addOrRewriteLocalTrackIds(description),_this._shouldApplyDtx&&(_this._localDescription=new _this._RTCSessionDescription({sdp:enableDtxForOpus(_this._localDescription.sdp,[]),type:_this._localDescription.type})),_this._localCandidates=[],"offer"===description.type?_this._descriptionRevision++:"answer"===description.type&&(_this._lastStableDescriptionRevision=_this._descriptionRevision,negotiationCompleted(_this)),_this._localUfrag=getUfrag(description),_this.emit("description",_this.getState()))}))},PeerConnectionV2.prototype._setRemoteDescription=function(description){var _this=this;return description.sdp&&(description.sdp=this._setCodecPreferences(description.sdp,this._preferredAudioCodecs,this._preferredVideoCodecs),description.sdp=this._shouldApplyDtx?enableDtxForOpus(description.sdp):enableDtxForOpus(description.sdp,[]),isFirefox&&(description.sdp=description.sdp.replace(/a=msid:[^ ]+ /g,"a=msid:- ")),this._peerConnection.remoteDescription||(this._isIceLite=/a=ice-lite/.test(description.sdp))),description=new this._RTCSessionDescription(description),Promise.resolve().then((function(){if("answer"===description.type&&_this._localDescriptionWithoutSimulcast){var adaptiveSimulcastEntry=_this._preferredVideoCodecs.find((function(cs){return"adaptiveSimulcast"in cs})),sdpWithoutSimulcastForNonVP8MediaSections=_this._revertSimulcast(_this._localDescription.sdp,_this._localDescriptionWithoutSimulcast.sdp,description.sdp,!!adaptiveSimulcastEntry&&!1===adaptiveSimulcastEntry.adaptiveSimulcast);if(_this._localDescriptionWithoutSimulcast=null,sdpWithoutSimulcastForNonVP8MediaSections!==_this._localDescription.sdp)return _this._rollbackAndApplyOffer({type:_this._localDescription.type,sdp:sdpWithoutSimulcastForNonVP8MediaSections})}})).then((function(){return _this._peerConnection.setRemoteDescription(description)})).then((function(){"answer"===description.type&&(_this._isRestartingIce&&(_this._log.debug("An ICE restart was in-progress and is now completed"),_this._isRestartingIce=!1),negotiationCompleted(_this))}),(function(error){throw _this._log.warn('Calling setRemoteDescription with an RTCSessionDescription of type "'+description.type+'" failed with the error "'+error.message+'".',error),description.sdp&&_this._log.warn("The SDP was "+description.sdp),error}))},PeerConnectionV2.prototype._updateDescription=function(description){var _this=this;switch(description.type){case"answer":case"pranswer":if(description.revision!==this._descriptionRevision||"have-local-offer"!==this._peerConnection.signalingState)return Promise.resolve();this._descriptionRevision=description.revision;break;case"close":return this._close();case"create-offer":return description.revision<=this._lastStableDescriptionRevision?Promise.resolve():this._needsAnswer?(this._queuedDescription=description,Promise.resolve()):(this._descriptionRevision=description.revision,this._offer());case"offer":return description.revision<=this._lastStableDescriptionRevision||"closed"===this._peerConnection.signalingState?Promise.resolve():"have-local-offer"===this._peerConnection.signalingState?this._needsAnswer&&0===this._lastStableDescriptionRevision?(this._queuedDescription=description,Promise.resolve()):(this._descriptionRevision=description.revision,this._handleGlare(description)):(this._descriptionRevision=description.revision,this._answer(description).then((function(){})))}var revision=description.revision;return Promise.resolve().then((function(){return _this._setRemoteDescription(description)})).catch((function(error){var errorToThrow=new MediaClientRemoteDescFailedError;throw _this._publishMediaWarning({message:'Calling setRemoteDescription with an RTCSessionDescription of type "'+description.type+'" failed',code:errorToThrow.code,error:error,sdp:description.sdp}),errorToThrow})).then((function(){return _this._lastStableDescriptionRevision=revision,_this._needsAnswer=!1,_this._checkIceBox(description)})).then((function(){return _this._queuedDescription&&_this._updateDescription(_this._queuedDescription)})).then((function(){return _this._queuedDescription=null,_this._maybeReoffer(_this._peerConnection.localDescription).then((function(){}))}))},PeerConnectionV2.prototype._updateIce=function(iceState){var candidates=this._remoteCandidates.update(iceState);return this._addIceCandidates(candidates)},PeerConnectionV2.prototype.addDataTrackSender=function(dataTrackSender){if(!this._dataChannels.has(dataTrackSender))try{var dataChannelDict={ordered:dataTrackSender.ordered};null!==dataTrackSender.maxPacketLifeTime&&(dataChannelDict.maxPacketLifeTime=dataTrackSender.maxPacketLifeTime),null!==dataTrackSender.maxRetransmits&&(dataChannelDict.maxRetransmits=dataTrackSender.maxRetransmits);var dataChannel=this._peerConnection.createDataChannel(dataTrackSender.id,dataChannelDict);dataTrackSender.addDataChannel(dataChannel),this._dataChannels.set(dataTrackSender,dataChannel)}catch(error){this._log.warn('Error creating an RTCDataChannel for DataTrack "'+dataTrackSender.id+'": '+error.message)}},PeerConnectionV2.prototype._handleQueuedPublisherHints=function(){var _this=this;"stable"===this._peerConnection.signalingState&&this._mediaTrackSenderToPublisherHints.forEach((function(_a,mediaTrackSender){var deferred=_a.deferred,encodings=_a.encodings;_this._mediaTrackSenderToPublisherHints.delete(mediaTrackSender),_this._setPublisherHint(mediaTrackSender,encodings).then((function(result){return deferred.resolve(result)})).catch((function(error){return deferred.reject(error)}))}))},PeerConnectionV2.prototype._setPublisherHint=function(mediaTrackSender,encodings){var _this=this;if(isFirefox)return Promise.resolve("COULD_NOT_APPLY_HINT");this._mediaTrackSenderToPublisherHints.has(mediaTrackSender)&&(this._mediaTrackSenderToPublisherHints.get(mediaTrackSender).deferred.resolve("REQUEST_SKIPPED"),this._mediaTrackSenderToPublisherHints.delete(mediaTrackSender));var sender=this._rtpSenders.get(mediaTrackSender);if(!sender)return this._log.warn("Could not apply publisher hint because RTCRtpSender was not found"),Promise.resolve("UNKNOWN_TRACK");if("closed"===this._peerConnection.signalingState)return this._log.warn('Could not apply publisher hint because signalingState was "closed"'),Promise.resolve("COULD_NOT_APPLY_HINT");if("stable"!==this._peerConnection.signalingState){this._log.debug("Queuing up publisher hint because signalingState:",this._peerConnection.signalingState);var deferred=defer();return this._mediaTrackSenderToPublisherHints.set(mediaTrackSender,{deferred:deferred,encodings:encodings}),deferred.promise}var parameters=sender.getParameters();return null!==encodings&&encodings.forEach((function(_a){var enabled=_a.enabled,layerIndex=_a.layer_index;parameters.encodings.length>layerIndex?(_this._log.debug("layer:"+layerIndex+", active:"+parameters.encodings[layerIndex].active+" => "+enabled),parameters.encodings[layerIndex].active=enabled):_this._log.warn("invalid layer:"+layerIndex+", active:"+enabled)})),this._maybeUpdateEncodings(sender.track,parameters.encodings,null===encodings),sender.setParameters(parameters).then((function(){return"OK"})).catch((function(error){return _this._log.error("Failed to apply publisher hints:",error),"COULD_NOT_APPLY_HINT"}))},PeerConnectionV2.prototype.addMediaTrackSender=function(mediaTrackSender){var _this=this;if("closed"!==this._peerConnection.signalingState&&!this._rtpSenders.has(mediaTrackSender)){var sender=this._addOrUpdateTransceiver(mediaTrackSender.track).sender;mediaTrackSender.addSender(sender,(function(encodings){return _this._setPublisherHint(mediaTrackSender,encodings)})),this._rtpNewSenders.add(sender),this._rtpSenders.set(mediaTrackSender,sender)}},PeerConnectionV2.prototype.close=function(){this._close()&&(this._descriptionRevision++,this._localDescription={type:"close"},this.emit("description",this.getState()))},PeerConnectionV2.prototype.getTrackReceivers=function(){return Array.from(this._dataTrackReceivers).concat(Array.from(this._mediaTrackReceivers))},PeerConnectionV2.prototype.getState=function(){if(!this._localDescription)return null;var localDescription={type:this._localDescription.type,revision:"answer"===this._localDescription.type?this._lastStableDescriptionRevision:this._descriptionRevision};return this._localDescription.sdp&&(localDescription.sdp=this._localDescription.sdp),{description:localDescription,id:this.id}},PeerConnectionV2.prototype.offer=function(){var _this=this;return this._needsAnswer||this._isRestartingIce?(this._shouldOffer=!0,Promise.resolve()):this.bracket("offering",(function(key){return _this.transition("updating",key),(_this._needsAnswer||_this._isRestartingIce?Promise.resolve():_this._offer()).then((function(){_this.tryTransition("open",key)}),(function(error){throw _this.tryTransition("open",key),error}))}))},PeerConnectionV2.prototype.removeDataTrackSender=function(dataTrackSender){var dataChannel=this._dataChannels.get(dataTrackSender);dataChannel&&(dataTrackSender.removeDataChannel(dataChannel),this._dataChannels.delete(dataTrackSender),dataChannel.close())},PeerConnectionV2.prototype.removeMediaTrackSender=function(mediaTrackSender){var sender=this._rtpSenders.get(mediaTrackSender);sender&&("closed"!==this._peerConnection.signalingState&&this._peerConnection.removeTrack(sender),mediaTrackSender.removeSender(sender),this._mediaTrackSenderToPublisherHints.has(mediaTrackSender)&&(this._mediaTrackSenderToPublisherHints.get(mediaTrackSender).deferred.resolve("UNKNOWN_TRACK"),this._mediaTrackSenderToPublisherHints.delete(mediaTrackSender)),this._rtpNewSenders.delete(sender),this._rtpSenders.delete(mediaTrackSender))},PeerConnectionV2.prototype.setConfiguration=function(configuration){"function"==typeof this._peerConnection.setConfiguration&&this._peerConnection.setConfiguration(getConfiguration(configuration))},PeerConnectionV2.prototype.setIceReconnectTimeout=function(period){return this._iceReconnectTimeout.setDelay(period),this._log.debug("Updated ICE reconnection timeout period:",this._iceReconnectTimeout.delay),this},PeerConnectionV2.prototype.update=function(peerConnectionState){var _this=this;return this.bracket("updating",(function(key){if("closed"===_this.state)return Promise.resolve();_this.transition("updating",key);var updates=[];return peerConnectionState.ice&&updates.push(_this._updateIce(peerConnectionState.ice)),peerConnectionState.description&&updates.push(_this._updateDescription(peerConnectionState.description)),Promise.all(updates).then((function(){_this.tryTransition("open",key)}),(function(error){throw _this.tryTransition("open",key),error}))}))},PeerConnectionV2.prototype.getStats=function(){var _this=this;return getStatistics(this._peerConnection).then((function(response){return function(pcv2,response){return Object.assign(response,{remoteAudioTrackStats:response.remoteAudioTrackStats.map((function(stats){return rewriteTrackId(pcv2,stats)})),remoteVideoTrackStats:response.remoteVideoTrackStats.map((function(stats){return rewriteTrackId(pcv2,stats)})),localAudioTrackStats:response.localAudioTrackStats.map((function(stats){return rewriteLocalTrackId(pcv2,stats)})),localVideoTrackStats:response.localVideoTrackStats.map((function(stats){return rewriteLocalTrackId(pcv2,stats)}))})}(_this,response)}))},PeerConnectionV2}(StateMachine);function rewriteLocalTrackId(pcv2,stats){var trackId=pcv2._getMediaTrackSenderId(stats.trackId);return Object.assign(stats,{trackId:trackId})}function rewriteTrackId(pcv2,stats){var receiver=__spreadArray([],__read(pcv2._mediaTrackReceivers)).find((function(receiver){return receiver.track.id===stats.trackId}));return Object.assign(stats,{trackId:receiver?receiver.id:null})}function getUfrag(description){if(description.sdp){var match=description.sdp.match(/^a=ice-ufrag:([a-zA-Z0-9+/]+)/m);if(match)return match[1]}return null}function getConfiguration(configuration){return Object.assign({bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},configuration)}function isSenderOfKind(kind,sender){var track=sender.track;return track&&track.kind===kind&&"ended"!==track.readyState}function negotiationCompleted(pcv2){!function(pcv2){pcv2._recycledTransceivers.audio=[],pcv2._recycledTransceivers.video=[],pcv2._peerConnection.getTransceivers().forEach((function(transceiver){(function(transceiver,pcv2){return!transceiver.stopped&&!pcv2._replaceTrackPromises.has(transceiver)&&["inactive","recvonly"].includes(transceiver.direction)})(transceiver,pcv2)&&pcv2._recycledTransceivers[transceiver.receiver.track.kind].push(transceiver)}))}(pcv2),function(pcv2){var description=pcv2._peerConnection.localDescription;description&&description.sdp&&getMediaSections(description.sdp).forEach((function(section){createCodecMapForMediaSection(section).forEach((function(pts,codec){return pcv2._localCodecs.add(codec)}))}))}(pcv2),function(pcv2){var description=pcv2._peerConnection.remoteDescription;description&&description.sdp&&getMediaSections(description.sdp).forEach((function(section){var matched=section.match(/^a=mid:(.+)$/m);if(matched&&matched[1]){var mid=matched[1],codecMap=createCodecMapForMediaSection(section);pcv2._remoteCodecMaps.set(mid,codecMap)}}))}(pcv2),updateEncodingParameters(pcv2).then((function(){pcv2._handleQueuedPublisherHints()}))}function updateEncodingParameters(pcv2){var _a=pcv2._encodingParameters,maxBitrates=new Map([["audio",_a.maxAudioBitrate],["video",_a.maxVideoBitrate]]),promises=[];return pcv2._peerConnection.getSenders().filter((function(sender){return sender.track})).forEach((function(sender){var maxBitrate=maxBitrates.get(sender.track.kind),params=sender.getParameters();null===maxBitrate||0===maxBitrate?function(params){Array.isArray(params.encodings)&&params.encodings.forEach((function(encoding){return delete encoding.maxBitrate}))}(params):pcv2._isChromeScreenShareTrack(sender.track)?pcv2._log.warn("Not setting maxBitrate for "+sender.track.kind+" Track "+sender.track.id+" because it appears to be screen share track: "+sender.track.label):function(params,maxBitrate){isFirefox?params.encodings=[{maxBitrate:maxBitrate}]:params.encodings.forEach((function(encoding){encoding.maxBitrate=maxBitrate}))}(params,maxBitrate),!isFirefox&&pcv2._enableDscp&&params.encodings.length>0&&(params.encodings[0].networkPriority="high");var trackReplaced=pcv2._rtpNewSenders.has(sender);pcv2._maybeUpdateEncodings(sender.track,params.encodings,trackReplaced),pcv2._rtpNewSenders.delete(sender);var promise=sender.setParameters(params).catch((function(error){pcv2._log.warn("Error while setting encodings parameters for "+sender.track.kind+" Track "+sender.track.id+": "+(error.message||error.name))}));promises.push(promise)})),Promise.all(promises)}module.exports=PeerConnectionV2},d75R:function(module,exports,__webpack_require__){var util=__webpack_require__("MCLT");function IllegalArgumentError(message){Error.call(this,message),this.message=message}function IllegalStateError(message){Error.call(this,message),this.message=message}util.inherits(IllegalArgumentError,Error),IllegalArgumentError.prototype.name="IllegalArgumentError",util.inherits(IllegalStateError,Error),IllegalStateError.prototype.name="IllegalStateError",module.exports.IllegalStateError=IllegalStateError,module.exports.IllegalArgumentError=IllegalArgumentError},"dI/0":function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),NullObserver=function(){function NullObserver(callback){Object.defineProperties(this,{_callback:{value:callback}})}return NullObserver.prototype.observe=function(){},NullObserver.prototype.unobserve=function(){},NullObserver.prototype.makeVisible=function(videoEl){var visibleEntry=this._makeFakeEntry(videoEl,!0);this._callback([visibleEntry])},NullObserver.prototype.makeInvisible=function(videoEl){var invisibleEntry=this._makeFakeEntry(videoEl,!1);this._callback([invisibleEntry])},NullObserver.prototype._makeFakeEntry=function(videoElement,isIntersecting){return{target:videoElement,isIntersecting:isIntersecting}},NullObserver}(),NullIntersectionObserver=function(_super){function NullIntersectionObserver(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(NullIntersectionObserver,_super),NullIntersectionObserver}(NullObserver),NullResizeObserver=function(_super){function NullResizeObserver(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(NullResizeObserver,_super),NullResizeObserver.prototype.resize=function(videoEl){var entry=this._makeFakeEntry(videoEl,!0);this._callback([entry])},NullResizeObserver}(NullObserver);module.exports={NullIntersectionObserver:NullIntersectionObserver,NullResizeObserver:NullResizeObserver,NullObserver:NullObserver}},deyy:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),LocalDataTrackPublication=function(_super){function LocalDataTrackPublication(signaling,track,unpublish,options){return _super.call(this,signaling,track,unpublish,options)||this}return __extends(LocalDataTrackPublication,_super),LocalDataTrackPublication.prototype.toString=function(){return"[LocalDataTrackPublication #"+this._instanceId+": "+this.trackSid+"]"},LocalDataTrackPublication}(__webpack_require__("mb7l"));module.exports=LocalDataTrackPublication},eqpY:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getTurnCredentials=void 0;var TwilioConnection=__webpack_require__("FjKE"),ICE_VERSION=__webpack_require__("xwWy").ICE_VERSION,_a=__webpack_require__("5wwa"),createTwilioError=_a.createTwilioError,SignalingConnectionError=_a.SignalingConnectionError,events_1=__webpack_require__("+qE3");exports.getTurnCredentials=function(token,wsServer){return new Promise((function(resolve,reject){var eventObserver=new events_1.EventEmitter,twilioConnection=new TwilioConnection(wsServer,{networkMonitor:null,eventObserver:eventObserver,helloBody:{edge:"roaming",preflight:!0,token:token,type:"ice",version:ICE_VERSION}}),done=!1;twilioConnection.once("close",(function(){done||(done=!0,reject(new SignalingConnectionError))})),twilioConnection.on("message",(function(messageData){var code=messageData.code,message=messageData.message,type=messageData.type;"iced"!==type&&"error"!==type||done||(done=!0,"iced"===type?resolve(messageData.ice_servers):reject(createTwilioError(code,message)),twilioConnection.close())}))}))}},gBrb:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),RecordingV2=function(_super){function RecordingV2(){var _this=_super.call(this)||this;return Object.defineProperties(_this,{_revision:{value:1,writable:!0}}),_this}return __extends(RecordingV2,_super),RecordingV2.prototype.update=function(recording){return recording.revision<this._revision?this:(this._revision=recording.revision,this.enable(recording.is_recording))},RecordingV2}(__webpack_require__("wl3V"));module.exports=RecordingV2},gEVb:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__spreadArray=this&&this.__spreadArray||function(to,from){for(var i=0,il=from.length,j=to.length;i<il;i++,j++)to[j]=from[i];return to},EventEmitter=__webpack_require__("+qE3").EventEmitter,util=__webpack_require__("ghd6"),StateMachine=function(_super){function StateMachine(initialState,states){var graph,_this=_super.call(this)||this,lock=null,state=initialState;return states=function(states){var newStates=new Map;for(var key in states)newStates.set(key,new Set(states[key]));return newStates}(states),Object.defineProperties(_this,{_lock:{get:function(){return lock},set:function(_lock){lock=_lock}},_reachableStates:{value:(graph=states,Array.from(graph.keys()).reduce((function(newGraph,from){return newGraph.set(from,function reachableFrom(graph,from,to){return to=to||new Set,graph.get(from).forEach((function(node){to.has(node)||(to.add(node),reachableFrom(graph,node,to).forEach(to.add,to))})),to}(graph,from))}),new Map))},_state:{get:function(){return state},set:function(_state){state=_state}},_states:{value:states},_whenDeferreds:{value:new Set},isLocked:{enumerable:!0,get:function(){return null!==lock}},state:{enumerable:!0,get:function(){return state}}}),_this.on("stateChanged",(function(state){_this._whenDeferreds.forEach((function(deferred){deferred.when(state,deferred.resolve,deferred.reject)}))})),_this}return __extends(StateMachine,_super),StateMachine.prototype._whenPromise=function(when){var _this=this;if("function"!=typeof when)return Promise.reject(new Error("when() executor must be a function"));var deferred=util.defer();return deferred.when=when,this._whenDeferreds.add(deferred),deferred.promise.then((function(payload){return _this._whenDeferreds.delete(deferred),payload}),(function(error){throw _this._whenDeferreds.delete(deferred),error}))},StateMachine.prototype.bracket=function(name,transitionFunction){var key,self=this;function releaseLock(error){if(self.hasLock(key)&&self.releaseLockCompletely(key),error)throw error}return this.takeLock(name).then((function(_key){return transitionFunction(key=_key)})).then((function(result){return releaseLock(),result}),releaseLock)},StateMachine.prototype.hasLock=function(key){return this._lock===key},StateMachine.prototype.preempt=function(newState,name,payload){if(!isValidTransition(this._states,this.state,newState))throw new Error('Cannot transition from "'+this.state+'" to "'+newState+'"');var oldLock;this.isLocked&&(oldLock=this._lock,this._lock=null);var key=null;name&&(key=this.takeLockSync(name));var preemptionKey=key?null:this.takeLockSync("preemption");return this.transition(newState,key||preemptionKey,payload),oldLock&&oldLock.resolve(),preemptionKey&&this.releaseLock(preemptionKey),key},StateMachine.prototype.releaseLock=function(key){if(!this.isLocked)throw new Error("Could not release the lock for "+key.name+" because the StateMachine is not locked");if(!this.hasLock(key))throw new Error("Could not release the lock for "+key.name+" because "+this._lock.name+" has the lock");0===key.depth?(this._lock=null,key.resolve()):key.depth--},StateMachine.prototype.releaseLockCompletely=function(key){if(!this.isLocked)throw new Error("Could not release the lock for "+key.name+" because the StateMachine is not locked");if(!this.hasLock(key))throw new Error("Could not release the lock for "+key.name+" because "+this._lock.name+" has the lock");key.depth=0,this._lock=null,key.resolve()},StateMachine.prototype.takeLock=function(nameOrKey){var _this=this;if("object"==typeof nameOrKey){var key_1=nameOrKey;return new Promise((function(resolve){resolve(_this.takeLockSync(key_1))}))}var name=nameOrKey;if(this.isLocked){var takeLock=this.takeLock.bind(this,name);return this._lock.promise.then(takeLock)}return Promise.resolve(this.takeLockSync(name))},StateMachine.prototype.takeLockSync=function(nameOrKey){var key="string"==typeof nameOrKey?null:nameOrKey,name=key?key.name:nameOrKey;if(key&&!this.hasLock(key)||!key&&this.isLocked)throw new Error("Could not take the lock for "+name+" because the lock for "+this._lock.name+" was not released");if(key)return key.depth++,key;var lock=function(name){var lock=util.defer();return lock.name=name,lock.depth=0,lock}(name);return this._lock=lock,lock},StateMachine.prototype.transition=function(newState,key,payload){if(payload=payload||[],this.isLocked){if(!key)throw new Error("You must provide the key in order to transition");if(!this.hasLock(key))throw new Error("Could not transition using the key for "+key.name+" because "+this._lock.name+" has the lock")}else if(key)throw new Error("Key provided for "+key.name+", but the StateMachine was not locked (possibly due to preemption)");if(!isValidTransition(this._states,this.state,newState))throw new Error('Cannot transition from "'+this.state+'" to "'+newState+'"');this._state=newState,this.emit.apply(this,__spreadArray([],__read(["stateChanged",newState].concat(payload))))},StateMachine.prototype.tryTransition=function(newState,key,payload){try{this.transition(newState,key,payload)}catch(error){return!1}return!0},StateMachine.prototype.when=function(state){var _this=this;return this.state===state?Promise.resolve(this):isValidTransition(this._reachableStates,this.state,state)?this._whenPromise((function(newState,resolve,reject){newState===state?resolve(_this):isValidTransition(_this._reachableStates,newState,state)||reject(createUnreachableError(newState,state))})):Promise.reject(createUnreachableError(this.state,state))},StateMachine}(EventEmitter);function isValidTransition(graph,from,to){return graph.get(from).has(to)}function createUnreachableError(here,there){return new Error('"'+there+'" cannot be reached from "'+here+'"')}module.exports=StateMachine},gJbR:function(module,exports,__webpack_require__){"use strict";var inherits=__webpack_require__("/E53").inherits,LocalAudioTrackClass=__webpack_require__("jU82");function LocalAudioTrack(mediaStreamTrack,options){var track=new LocalAudioTrackClass(mediaStreamTrack,options);return Object.setPrototypeOf(track,LocalAudioTrack.prototype),track}inherits(LocalAudioTrack,LocalAudioTrackClass),module.exports=LocalAudioTrack},ghd6:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__spreadArray=this&&this.__spreadArray||function(to,from){for(var i=0,il=from.length,j=to.length;i<il;i++,j++)to[j]=from[i];return to},constants=__webpack_require__("xwWy"),E=constants.typeErrors,trackPriority=constants.trackPriority,util=__webpack_require__("mIkg"),sessionSID=__webpack_require__("6kkQ").sessionSID;function getUserAgent(){return"undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent:"Unknown"}function delegateMethod(source,wrapper,target,methodName){if(!(methodName in wrapper)&&!methodName.match(/^on[a-z]+$/)){var type;try{type=typeof source[methodName]}catch(error){}"function"===type&&(wrapper[methodName]=function(){for(var _a,args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];return(_a=this[target])[methodName].apply(_a,__spreadArray([],__read(args)))})}}function isNonArrayObject(object){return"object"==typeof object&&!Array.isArray(object)}function hidePrivateProperties(object){Object.getOwnPropertyNames(object).forEach((function(name){name.startsWith("_")&&hideProperty(object,name)}))}function hideProperty(object,name){var descriptor=Object.getOwnPropertyDescriptor(object,name);descriptor.enumerable=!1,Object.defineProperty(object,name,descriptor)}function hidePublicProperties(object,props){void 0===props&&(props=[]),props.forEach((function(name){object.hasOwnProperty(name)&&hideProperty(object,name)}))}function arrayToJSON(array){return array.map(valueToJSON)}function valueToJSON(value){return Array.isArray(value)?arrayToJSON(value):value instanceof Set?arrayToJSON(__spreadArray([],__read(value))):value instanceof Map?__spreadArray([],__read(value.entries())).reduce((function(json,_a){var _b,_c=__read(_a,2);return Object.assign(((_b={})[_c[0]]=valueToJSON(_c[1]),_b),json)}),{}):value&&"object"==typeof value?Object.entries(value).reduce((function(json,_a){var _b,_c=__read(_a,2);return Object.assign(((_b={})[_c[0]]=valueToJSON(_c[1]),_b),json)}),{}):value}function createBandwidthProfileVideoPayload(bandwidthProfileVideo){return createRSPPayload(bandwidthProfileVideo,[{prop:"dominantSpeakerPriority",type:"string",payloadProp:"active_speaker_priority"},{prop:"maxSubscriptionBitrate",type:"number",payloadProp:"max_subscription_bandwidth"},{prop:"maxTracks",type:"number",payloadProp:"max_tracks"},{prop:"mode",type:"string"},{prop:"renderDimensions",type:"object",payloadProp:"render_dimensions",transform:createRenderDimensionsPayload},{prop:"trackSwitchOffMode",type:"string",payloadProp:"track_switch_off"}])}function createDimensionsPayload(dimensions){return createRSPPayload(dimensions,[{prop:"height",type:"number"},{prop:"width",type:"number"}])}function createRenderDimensionsPayload(renderDimensions){return createRSPPayload(renderDimensions,[{prop:trackPriority.PRIORITY_HIGH,type:"object",transform:createDimensionsPayload},{prop:trackPriority.PRIORITY_LOW,type:"object",transform:createDimensionsPayload},{prop:trackPriority.PRIORITY_STANDARD,type:"object",transform:createDimensionsPayload}])}function createRSPPayload(object,propConversions){return propConversions.reduce((function(payload,_a){var _b,prop=_a.prop,_c=_a.payloadProp,_d=_a.transform;return typeof object[prop]===_a.type?Object.assign(((_b={})[void 0===_c?prop:_c]=(void 0===_d?function(x){return x}:_d)(object[prop]),_b),payload):payload}),{})}exports.constants=constants,exports.createBandwidthProfilePayload=function(bandwidthProfile){return createRSPPayload(bandwidthProfile,[{prop:"video",type:"object",transform:createBandwidthProfileVideoPayload}])},exports.createMediaSignalingPayload=function(dominantSpeaker,networkQuality,trackPriority,trackSwitchOff,adaptiveSimulcast,renderHints){var transports={transports:[{type:"data-channel"}]};return Object.assign(dominantSpeaker?{active_speaker:transports}:{},networkQuality?{network_quality:transports}:{},renderHints?{render_hints:transports}:{},adaptiveSimulcast?{publisher_hints:transports}:{},trackPriority?{track_priority:transports}:{},trackSwitchOff?{track_switch_off:transports}:{})},exports.createRoomConnectEventPayload=function(connectOptions){function boolToString(val){return val?"true":"false"}var payload={sessionSID:sessionSID,iceServers:(connectOptions.iceServers||[]).length,audioTracks:(connectOptions.tracks||[]).filter((function(track){return"audio"===track.kind})).length,videoTracks:(connectOptions.tracks||[]).filter((function(track){return"video"===track.kind})).length,dataTracks:(connectOptions.tracks||[]).filter((function(track){return"data"===track.kind})).length};if([["audio"],["automaticSubscription"],["enableDscp"],["eventListener"],["preflight"],["video"],["dominantSpeaker","enableDominantSpeaker"]].forEach((function(_a){var _b=__read(_a,2),prop=_b[0],eventProp=_b[1];payload[eventProp=eventProp||prop]=boolToString(!!connectOptions[prop])})),[["maxVideoBitrate"],["maxAudioBitrate"]].forEach((function(_a){var _b=__read(_a,2),prop=_b[0],eventProp=_b[1];eventProp=eventProp||prop,"number"==typeof connectOptions[prop]?payload[eventProp]=connectOptions[prop]:isNaN(Number(connectOptions[prop]))||(payload[eventProp]=Number(connectOptions[prop]))})),[["iceTransportPolicy"],["region"],["name","roomName"]].forEach((function(_a){var _b=__read(_a,2),prop=_b[0],eventProp=_b[1];eventProp=eventProp||prop,"string"==typeof connectOptions[prop]?payload[eventProp]=connectOptions[prop]:"number"==typeof connectOptions[prop]&&"name"===prop&&(payload[eventProp]=connectOptions[prop].toString())})),["preferredAudioCodecs","preferredVideoCodecs"].forEach((function(prop){prop in connectOptions&&(payload[prop]=JSON.stringify(connectOptions[prop]))})),"networkQuality"in connectOptions&&(payload.networkQualityConfiguration={},isNonArrayObject(connectOptions.networkQuality)?["local","remote"].forEach((function(prop){"number"==typeof connectOptions.networkQuality[prop]&&(payload.networkQualityConfiguration[prop]=connectOptions.networkQuality[prop])})):(payload.networkQualityConfiguration.remote=0,payload.networkQualityConfiguration.local=connectOptions.networkQuality?1:0)),connectOptions.bandwidthProfile&&connectOptions.bandwidthProfile.video){var videoBPOptions_1=connectOptions.bandwidthProfile.video||{};payload.bandwidthProfileOptions={},["mode","maxTracks","trackSwitchOffMode","dominantSpeakerPriority","maxSubscriptionBitrate","renderDimensions","contentPreferencesMode","clientTrackSwitchOffControl"].forEach((function(prop){"number"==typeof videoBPOptions_1[prop]||"string"==typeof videoBPOptions_1[prop]?payload.bandwidthProfileOptions[prop]=videoBPOptions_1[prop]:"boolean"==typeof videoBPOptions_1[prop]?payload.bandwidthProfileOptions[prop]=boolToString(videoBPOptions_1[prop]):"object"==typeof videoBPOptions_1[prop]&&(payload.bandwidthProfileOptions[prop]=JSON.stringify(videoBPOptions_1[prop]))}))}return{group:"room",name:"connect",level:"info",payload:payload}},exports.createSubscribePayload=function(automaticSubscription){return{rules:[{type:automaticSubscription?"include":"exclude",all:!0}],revision:1}},exports.asLocalTrack=function(track,options){if(track instanceof options.LocalAudioTrack||track instanceof options.LocalVideoTrack||track instanceof options.LocalDataTrack)return track;if(track instanceof options.MediaStreamTrack)return"audio"===track.kind?new options.LocalAudioTrack(track,options):new options.LocalVideoTrack(track,options);throw E.INVALID_TYPE("track","LocalAudioTrack, LocalVideoTrack, LocalDataTrack, or MediaStreamTrack")},exports.asLocalTrackPublication=function(track,signaling,unpublish,options){return new(0,{audio:options.LocalAudioTrackPublication,video:options.LocalVideoTrackPublication,data:options.LocalDataTrackPublication}[track.kind])(signaling,track,unpublish,options)},exports.capitalize=function(word){return word[0].toUpperCase()+word.slice(1)},exports.deprecateEvents=function(name,emitter,events,log){var warningsShown=new Set;emitter.on("newListener",(function newListener(event){events.has(event)&&!warningsShown.has(event)&&(log.deprecated(name+"#"+event+" has been deprecated and scheduled for removal in twilio-video.js@2.0.0."+(events.get(event)?" Use "+name+"#"+events.get(event)+" instead.":"")),warningsShown.add(event)),warningsShown.size>=events.size&&emitter.removeListener("newListener",newListener)}))},exports.difference=function(list1,list2){list1=Array.isArray(list1)?new Set(list1):new Set(list1.values()),list2=Array.isArray(list2)?new Set(list2):new Set(list2.values());var difference=new Set;return list1.forEach((function(item){list2.has(item)||difference.add(item)})),difference},exports.filterObject=function(object,filterValue){return Object.keys(object).reduce((function(filtered,key){return object[key]!==filterValue&&(filtered[key]=object[key]),filtered}),{})},exports.flatMap=function(list,mapFn){var listArray=list instanceof Map||list instanceof Set?Array.from(list.values()):list;return mapFn=mapFn||function(item){return item},listArray.reduce((function(flattened,item){var mapped=mapFn(item);return flattened.concat(mapped)}),[])},exports.getPlatform=function(){var userAgent=getUserAgent(),_b=__read(userAgent.match(/\(([^)]+)\)/)||[],2)[1];return __read((void 0===_b?"unknown":_b).split(";").map((function(entry){return entry.trim()})),1)[0].toLowerCase()},exports.getUserAgent=getUserAgent,exports.hidePrivateProperties=hidePrivateProperties,exports.hidePrivateAndCertainPublicPropertiesInClass=function(klass,props){return function(_super){function class_1(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];var _this=_super.apply(this,__spreadArray([],__read(args)))||this;return hidePrivateProperties(_this),hidePublicProperties(_this,props),_this}return __extends(class_1,_super),class_1}(klass)},exports.isDeepEqual=function isDeepEqual(val1,val2){if(val1===val2)return!0;if(typeof val1!=typeof val2)return!1;if(null===val1)return null===val2;if(null===val2)return!1;if(Array.isArray(val1))return Array.isArray(val2)&&val1.length===val2.length&&val1.every((function(val,i){return isDeepEqual(val,val2[i])}));if("object"==typeof val1){var val1Keys=Object.keys(val1).sort(),val2Keys=Object.keys(val2).sort();return!Array.isArray(val2)&&isDeepEqual(val1Keys,val2Keys)&&val1Keys.every((function(key){return isDeepEqual(val1[key],val2[key])}))}return!1},exports.isNonArrayObject=isNonArrayObject,exports.inRange=function(num,min,max){return min<=num&&num<=max},exports.makeUUID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(c){var r=16*Math.random()|0;return("x"===c?r:3&r|8).toString(16)}))},exports.oncePerTick=function(fn){var timeout=null;function nextTick(){timeout=null,fn()}return function(){timeout&&clearTimeout(timeout),timeout=setTimeout(nextTick)}},exports.promiseFromEvents=function(operation,eventEmitter,successEvent,failureEvent){return new Promise((function(resolve,reject){function onSuccess(){var args=[].slice.call(arguments);failureEvent&&eventEmitter.removeListener(failureEvent,onFailure),resolve.apply(void 0,__spreadArray([],__read(args)))}function onFailure(){var args=[].slice.call(arguments);eventEmitter.removeListener(successEvent,onSuccess),reject.apply(void 0,__spreadArray([],__read(args)))}eventEmitter.once(successEvent,onSuccess),failureEvent&&eventEmitter.once(failureEvent,onFailure),operation()}))},exports.getOrNull=function(obj,path){return path.split(".").reduce((function(output,step){return output?output[step]:null}),obj)},exports.defer=function(){var deferred={};return deferred.promise=new Promise((function(resolve,reject){deferred.resolve=resolve,deferred.reject=reject})),deferred},exports.delegateMethods=function(source,wrapper,target){for(var methodName in source)delegateMethod(source,wrapper,target,methodName)},exports.proxyProperties=function(source,wrapper,target){Object.getOwnPropertyNames(source).forEach((function(propertyName){!function(source,wrapper,target,propertyName){propertyName in wrapper||(propertyName.match(/^on[a-z]+$/)?(Object.defineProperty(wrapper,propertyName,{value:null,writable:!0}),target.addEventListener(propertyName.slice(2),(function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];wrapper.dispatchEvent.apply(wrapper,__spreadArray([],__read(args)))}))):Object.defineProperty(wrapper,propertyName,{enumerable:!0,get:function(){return target[propertyName]}}))}(0,wrapper,target,propertyName)}))},exports.legacyPromise=function(promise,onSuccess,onFailure){return onSuccess?promise.then((function(result){onSuccess(result)}),(function(error){onFailure(error)})):promise},exports.buildLogLevels=function(logLevel){return"string"==typeof logLevel?{default:logLevel,media:logLevel,signaling:logLevel,webrtc:logLevel}:logLevel},exports.trackClass=function(track,local){return(local=local?"Local":"")+(track.kind||"").replace(/\w{1}/,(function(m){return m.toUpperCase()}))+"Track"},exports.trackPublicationClass=function(publication,local){return(local=local?"Local":"")+(publication.kind||"").replace(/\w{1}/,(function(m){return m.toUpperCase()}))+"TrackPublication"},exports.valueToJSON=valueToJSON,exports.withJitter=function(value,jitter){var rand=Math.random();return value-jitter+Math.floor(2*jitter*rand+.5)},exports.isChromeScreenShareTrack=function(track){return"chrome"===util.guessBrowser()&&"video"===track.kind&&"displaySurface"in track.getSettings()},exports.isUserMediaTrack=function(track){return"string"==typeof track.getSettings().deviceId},exports.waitForSometime=function(timeoutMS){return void 0===timeoutMS&&(timeoutMS=10),new Promise((function(resolve){return setTimeout(resolve,timeoutMS)}))},exports.waitForEvent=function(eventTarget,event){return new Promise((function(resolve){eventTarget.addEventListener(event,(function onevent(e){eventTarget.removeEventListener(event,onevent),resolve(e)}))}))}},hkYD:function(module,exports,__webpack_require__){"use strict";var NetworkQualitySendStats=__webpack_require__("7C7v"),NetworkQualityRecvStats=__webpack_require__("kltW");module.exports=function(_a){var _b=_a.sendStats,sendStats=void 0===_b?null:_b,_c=_a.recvStats,recvStats=void 0===_c?null:_c;Object.defineProperties(this,{send:{value:_a.send,enumerable:!0},recv:{value:_a.recv,enumerable:!0},sendStats:{value:sendStats?new NetworkQualitySendStats(sendStats):null,enumerable:!0},recvStats:{value:recvStats?new NetworkQualityRecvStats(recvStats):null,enumerable:!0}})}},"i99/":function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),RemoteTrackStats=function(_super){function RemoteTrackStats(trackId,statsReport){var _this=_super.call(this,trackId,statsReport)||this;return Object.defineProperties(_this,{bytesReceived:{value:"number"==typeof statsReport.bytesReceived?statsReport.bytesReceived:null,enumerable:!0},packetsReceived:{value:"number"==typeof statsReport.packetsReceived?statsReport.packetsReceived:null,enumerable:!0}}),_this}return __extends(RemoteTrackStats,_super),RemoteTrackStats}(__webpack_require__("0iCT"));module.exports=RemoteTrackStats},iqXr:function(module){module.exports=JSON.parse('{"name":"twilio-video","title":"Twilio Video","description":"Twilio Video JavaScript Library","version":"2.21.1","homepage":"https://twilio.com","author":"Mark Andrus Roberts <mroberts@twilio.com>","contributors":["Ryan Rowland <rrowland@twilio.com>","Manjesh Malavalli <mmalavalli@twilio.com>","Makarand Patwardhan <mpatwardhan@twilio.com>"],"keywords":["twilio","webrtc","library","javascript","video","rooms"],"repository":{"type":"git","url":"https://github.com/twilio/twilio-video.js.git"},"devDependencies":{"@babel/core":"^7.14.2","@babel/preset-env":"^7.14.2","@babel/preset-typescript":"^7.13.0","@types/express":"^4.11.0","@types/node":"^8.5.1","@types/selenium-webdriver":"^3.0.8","@types/ws":"^3.2.1","@typescript-eslint/eslint-plugin":"^4.13.0","@typescript-eslint/parser":"^4.0.0","babel-cli":"^6.26.0","babel-preset-es2015":"^6.24.1","browserify":"^17.0.0","cheerio":"^0.22.0","cors":"^2.8.5","electron":"^9.1.0","envify":"^4.0.0","eslint":"^6.2.1","eslint-config-standard":"^14.0.0","eslint-plugin-import":"^2.18.2","eslint-plugin-node":"^9.1.0","eslint-plugin-promise":"^4.2.1","eslint-plugin-standard":"^4.0.1","express":"^4.16.2","glob":"^7.1.7","ink-docstrap":"^1.3.2","inquirer":"^7.0.0","is-docker":"^2.0.0","jsdoc":"^3.5.5","jsdoc-babel":"^0.5.0","json-loader":"^0.5.7","karma":"^5.0.2","karma-browserify":"^8.0.0","karma-chrome-launcher":"^2.0.0","karma-edgium-launcher":"^4.0.0-0","karma-electron":"^6.1.0","karma-firefox-launcher":"^1.3.0","karma-htmlfile-reporter":"^0.3.8","karma-junit-reporter":"^1.2.0","karma-mocha":"^1.3.0","karma-safari-launcher":"^1.0.0","karma-spec-reporter":"0.0.32","karma-typescript":"^5.5.1","karma-typescript-es6-transform":"^5.5.1","mocha":"^3.2.0","mock-require":"^3.0.3","ncp":"^2.0.0","node-http-server":"^8.1.2","npm-run-all":"^4.0.2","nyc":"^15.1.0","requirejs":"^2.3.3","rimraf":"^2.6.1","simple-git":"^1.126.0","sinon":"^4.0.1","ts-node":"4.0.1","tslint":"5.8.0","twilio":"^3.49.0","twilio-release-tool":"^1.0.2","typescript":"4.2.2","uglify-js":"^2.8.22","vinyl-fs":"^2.4.4","vinyl-source-stream":"^1.1.0","watchify":"^3.11.1","webrtc-adapter":"^7.7.1"},"engines":{"node":">=0.12"},"license":"BSD-3-Clause","main":"./es5/index.js","types":"./tsdef/index.d.ts","scripts":{"lint:js":"eslint ./lib ./test/*.js ./docker/**/*.js ./test/framework/*.js ./test/lib/*.js ./test/integration/** ./test/unit/** ","lint:ts":"eslint ./tsdef/*.ts ./lib/**/*.ts","lint":"npm-run-all lint:js lint:ts","printVersion":"node --version && npm --version","test:unit":"npm-run-all printVersion build:es5 && nyc --report-dir=./coverage --include=lib/**/* --reporter=html --reporter=lcov --reporter=text mocha -r ts-node/register ./test/unit/*","test:serversiderender":"mocha ./test/serversiderender/index.js","test:integration:adapter":"node ./scripts/karma.js karma/integration.adapter.conf.js","test:integration":"npm run build:es5 && node ./scripts/karma.js karma/integration.conf.js","test:umd:install":"npm install puppeteer@5.5.0","test:umd":"mocha ./test/umd/index.js","test:crossbrowser:build:clean":"rimraf ./test/crossbrowser/lib ./test/crossbrowser/src/browser/index.js","test:crossbrowser:build:lint":"cd ./test/crossbrowser && tslint --project tsconfig.json","test:crossbrowser:build:tsc":"cd ./test/crossbrowser && tsc","test:crossbrowser:build:browser":"cd ./test/crossbrowser && browserify lib/crossbrowser/src/browser/index.js > src/browser/index.js","test:crossbrowser:build":"npm-run-all test:crossbrowser:build:*","test:crossbrowser:test":"cd ./test/crossbrowser && mocha --compilers ts:ts-node/register test/integration/spec/**/*.ts","test:crossbrowser":"npm-run-all test:crossbrowser:*","test:sdkdriver:build:clean":"rimraf ./test/lib/sdkdriver/lib ./test/lib/sdkdriver/test/integration/browser/index.js","test:sdkdriver:build:lint":"cd ./test/lib/sdkdriver && tslint --project tsconfig.json","test:sdkdriver:build:tsc":"cd ./test/lib/sdkdriver && tsc --rootDir src","test:sdkdriver:build":"npm-run-all test:sdkdriver:build:*","test:sdkdriver:test:unit":"cd ./test/lib/sdkdriver && mocha --compilers ts:ts-node/register test/unit/spec/**/*.ts","test:sdkdriver:test:integration:browser":"cd ./test/lib/sdkdriver/test/integration && browserify browser/browser.js > browser/index.js","test:sdkdriver:test:integration:run":"cd ./test/lib/sdkdriver && mocha --compilers ts:ts-node/register test/integration/spec/**/*.ts","test:sdkdriver:test:integration":"npm-run-all test:sdkdriver:test:integration:*","test:sdkdriver:test":"npm-run-all test:sdkdriver:test:*","test:sdkdriver":"npm-run-all test:sdkdriver:*","test:framework:angular:install":"cd ./test/framework/twilio-video-angular && rimraf ./node_modules package-lock.json && npm install","test:framework:angular:run":"mocha ./test/framework/twilio-video-angular.js","test:framework:angular":"npm-run-all test:framework:angular:*","test:framework:no-framework:run":"mocha ./test/framework/twilio-video-no-framework.js","test:framework:no-framework":"npm-run-all test:framework:no-framework:*","test:framework:react:install":"cd ./test/framework/twilio-video-react && rimraf ./node_modules package-lock.json && npm install","test:framework:react:test":"node ./scripts/framework.js twilio-video-react","test:framework:react:build":"cd ./test/framework/twilio-video-react && npm run build","test:framework:react:run":"mocha ./test/framework/twilio-video-react.js","test:framework:react":"npm-run-all test:framework:react:*","test:framework:install":"npm install chromedriver && npm install selenium-webdriver && npm install geckodriver && npm install puppeteer","test:framework":"npm-run-all test:framework:install test:framework:no-framework test:framework:react","test":"npm-run-all test:unit test:integration","build:es5":"rimraf ./es5 && tsc tsdef/twilio-video-tests.ts --noEmit --lib es2018,dom && tsc ","build:js":"node ./scripts/build.js ./src/twilio-video.js ./LICENSE.md ./dist/twilio-video.js","build:min.js":"uglifyjs ./dist/twilio-video.js -o ./dist/twilio-video.min.js --comments \\"/^! twilio-video.js/\\" -b beautify=false,ascii_only=true","build":"npm-run-all clean lint docs test:unit test:integration build:es5 build:js build:min.js test:umd","build:quick":"npm-run-all clean lint docs build:es5 build:js build:min.js","docs":"node ./scripts/docs.js ./dist/docs","watch":"tsc -w","clean":"rimraf ./coverage ./es5 ./dist"},"dependencies":{"backoff":"^2.5.0","events":"^3.3.0","util":"^0.12.4","ws":"^7.4.6","xmlhttprequest":"^1.8.0"},"browser":{"ws":"./src/ws.js","xmlhttprequest":"./src/xmlhttprequest.js"}}')},j4sL:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),NetworkQualityAudioStats=function(_super){function NetworkQualityAudioStats(mediaLevels){return _super.call(this,mediaLevels)||this}return __extends(NetworkQualityAudioStats,_super),NetworkQualityAudioStats}(__webpack_require__("hkYD"));module.exports=NetworkQualityAudioStats},jU82:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),AudioTrack=__webpack_require__("wxsB"),LocalAudioTrack=function(_super){function LocalAudioTrack(mediaStreamTrack,options){return _super.call(this,mediaStreamTrack,options)||this}return __extends(LocalAudioTrack,_super),LocalAudioTrack.prototype.toString=function(){return"[LocalAudioTrack #"+this._instanceId+": "+this.id+"]"},LocalAudioTrack.prototype.attach=function(el){return(el=_super.prototype.attach.call(this,el)).muted=!0,el},LocalAudioTrack.prototype._end=function(){return _super.prototype._end.apply(this,arguments)},LocalAudioTrack.prototype.disable=function(){return _super.prototype.disable.apply(this,arguments)},LocalAudioTrack.prototype.enable=function(){return _super.prototype.enable.apply(this,arguments)},LocalAudioTrack.prototype.restart=function(){return _super.prototype.restart.apply(this,arguments)},LocalAudioTrack.prototype.stop=function(){return _super.prototype.stop.apply(this,arguments)},LocalAudioTrack}(__webpack_require__("aQcx")(AudioTrack));module.exports=LocalAudioTrack},jxCJ:function(module,exports,__webpack_require__){"use strict";var defer=__webpack_require__("ghd6").defer,LocalMediaRestartDeferreds=function(){function LocalMediaRestartDeferreds(){Object.defineProperties(this,{_audio:{value:defer(),writable:!0},_video:{value:defer(),writable:!0}}),this._audio.resolve(),this._video.resolve()}return LocalMediaRestartDeferreds.prototype.resolveDeferred=function(kind){"audio"===kind?this._audio.resolve():this._video.resolve()},LocalMediaRestartDeferreds.prototype.startDeferred=function(kind){"audio"===kind?this._audio=defer():this._video=defer()},LocalMediaRestartDeferreds.prototype.whenResolved=function(kind){return"audio"===kind?this._audio.promise:this._video.promise},LocalMediaRestartDeferreds}();module.exports=new LocalMediaRestartDeferreds},kThA:function(module,exports,__webpack_require__){function isDef(value){return null!=value}function BackoffStrategy(options){if(isDef((options=options||{}).initialDelay)&&options.initialDelay<1)throw new Error("The initial timeout must be greater than 0.");if(isDef(options.maxDelay)&&options.maxDelay<1)throw new Error("The maximal timeout must be greater than 0.");if(this.initialDelay_=options.initialDelay||100,this.maxDelay_=options.maxDelay||1e4,this.maxDelay_<=this.initialDelay_)throw new Error("The maximal backoff delay must be greater than the initial backoff delay.");if(isDef(options.randomisationFactor)&&(options.randomisationFactor<0||options.randomisationFactor>1))throw new Error("The randomisation factor must be between 0 and 1.");this.randomisationFactor_=options.randomisationFactor||0}__webpack_require__("+qE3"),__webpack_require__("MCLT"),BackoffStrategy.prototype.getMaxDelay=function(){return this.maxDelay_},BackoffStrategy.prototype.getInitialDelay=function(){return this.initialDelay_},BackoffStrategy.prototype.next=function(){var backoffDelay=this.next_(),randomisationMultiple=1+Math.random()*this.randomisationFactor_;return Math.round(backoffDelay*randomisationMultiple)},BackoffStrategy.prototype.next_=function(){throw new Error("BackoffStrategy.next_() unimplemented.")},BackoffStrategy.prototype.reset=function(){this.reset_()},BackoffStrategy.prototype.reset_=function(){throw new Error("BackoffStrategy.reset_() unimplemented.")},module.exports=BackoffStrategy},kltW:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),NetworkQualityRecvStats=function(_super){function NetworkQualityRecvStats(sendOrRecvStats){return _super.call(this,sendOrRecvStats)||this}return __extends(NetworkQualityRecvStats,_super),NetworkQualityRecvStats}(__webpack_require__("5UJR"));module.exports=NetworkQualityRecvStats},lBno:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),DataTrackTransceiver=__webpack_require__("UpXp"),DataTransport=__webpack_require__("VUT2"),DataTrackReceiver=function(_super){function DataTrackReceiver(dataChannel){var _this=_super.call(this,dataChannel.label,dataChannel.maxPacketLifeTime,dataChannel.maxRetransmits,dataChannel.ordered)||this;return Object.defineProperties(_this,{_dataChannel:{value:dataChannel}}),dataChannel.binaryType="arraybuffer",dataChannel.addEventListener("message",(function(event){_this.emit("message",event.data)})),dataChannel.addEventListener("close",(function(){_this.emit("close")})),_this}return __extends(DataTrackReceiver,_super),DataTrackReceiver.prototype.stop=function(){this._dataChannel.close(),_super.prototype.stop.call(this)},DataTrackReceiver.prototype.toDataTransport=function(){return new DataTransport(this._dataChannel)},DataTrackReceiver}(DataTrackTransceiver);module.exports=DataTrackReceiver},lrhj:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),DominantSpeakerSignaling=function(_super){function DominantSpeakerSignaling(getReceiver,options){var _this=_super.call(this,getReceiver,"active_speaker",options)||this;return Object.defineProperties(_this,{_loudestParticipantSid:{value:null,writable:!0}}),_this.on("ready",(function(transport){transport.on("message",(function(message){switch(message.type){case"active_speaker":_this._setLoudestParticipantSid(message.participant)}}))})),_this}return __extends(DominantSpeakerSignaling,_super),Object.defineProperty(DominantSpeakerSignaling.prototype,"loudestParticipantSid",{get:function(){return this._loudestParticipantSid},enumerable:!1,configurable:!0}),DominantSpeakerSignaling.prototype._setLoudestParticipantSid=function(loudestParticipantSid){this.loudestParticipantSid!==loudestParticipantSid&&(this._loudestParticipantSid=loudestParticipantSid,this.emit("updated"))},DominantSpeakerSignaling}(__webpack_require__("zbom"));module.exports=DominantSpeakerSignaling},m0JW:function(module,exports,__webpack_require__){"use strict";var detectSilence=__webpack_require__("TM7a");module.exports=function(el){var AudioContextFactory=__webpack_require__("/+gY"),holder={},audioContext=AudioContextFactory.getOrCreate(holder),attemptsLeft=3;return function doCheckSilence(){return attemptsLeft--,detectSilence(audioContext,el.srcObject,250).then((function(isSilent){return!!isSilent&&(!(attemptsLeft>0)||doCheckSilence())})).catch((function(){return!0}))}().finally((function(){AudioContextFactory.release(holder)}))}},"m8+h":function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),RemoteDataTrackPublication=function(_super){function RemoteDataTrackPublication(signaling,options){return _super.call(this,signaling,options)||this}return __extends(RemoteDataTrackPublication,_super),RemoteDataTrackPublication.prototype.toString=function(){return"[RemoteDataTrackPublication #"+this._instanceId+": "+this.trackSid+"]"},RemoteDataTrackPublication}(__webpack_require__("+EQa"));module.exports=RemoteDataTrackPublication},mAYT:function(module,exports,__webpack_require__){"use strict";var EventEmitter=__webpack_require__("+qE3").EventEmitter,hidePrivateAndCertainPublicPropertiesInClass=__webpack_require__("ghd6").hidePrivateAndCertainPublicPropertiesInClass;module.exports=hidePrivateAndCertainPublicPropertiesInClass(EventEmitter,["domain"])},mIkg:function(module,exports,__webpack_require__){"use strict";function delegateMethod(source,wrapper,target,methodName){if(!(methodName in wrapper)&&!methodName.match(/^on[a-z]+$/)){var isProperty=!1;try{var propDesc=Object.getOwnPropertyDescriptor(source,methodName);isProperty=propDesc&&!!propDesc.get}catch(error){}if(!isProperty){var type;try{type=typeof source[methodName]}catch(error){}"function"===type&&(wrapper[methodName]=function(){return this[target][methodName].apply(this[target],arguments)})}}}function getUserAgent(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:null}function guessBrowser(userAgent){return void 0===userAgent&&(userAgent=getUserAgent()),/Chrome|CriOS/.test(userAgent)?"chrome":/Firefox|FxiOS/.test(userAgent)?"firefox":/Safari|iPhone|iPad|iPod/.test(userAgent)?"safari":null}exports.defer=function(){var deferred={};return deferred.promise=new Promise((function(resolve,reject){deferred.resolve=resolve,deferred.reject=reject})),deferred},exports.delegateMethods=function(source,wrapper,target){for(var methodName in source)delegateMethod(source,wrapper,target,methodName)},exports.difference=function(list1,list2){list1=Array.isArray(list1)?new Set(list1):new Set(list1.values()),list2=Array.isArray(list2)?new Set(list2):new Set(list2.values());var difference=new Set;return list1.forEach((function(item){list2.has(item)||difference.add(item)})),difference},exports.flatMap=function(list,mapFn){return(list instanceof Map||list instanceof Set?Array.from(list.values()):list).reduce((function(flattened,item){var mapped=mapFn(item);return flattened.concat(mapped)}),[])},exports.guessBrowser=guessBrowser,exports.guessBrowserVersion=function(userAgent){void 0===userAgent&&(userAgent=getUserAgent());var prefix={chrome:"Chrome|CriOS",firefox:"Firefox|FxiOS",safari:"Version"}[guessBrowser(userAgent)];if(!prefix)return null;var regex=new RegExp("("+prefix+")/([^\\s]+)"),match=(userAgent.match(regex)||[])[2];if(!match)return null;var versions=match.split(".").map(Number);return{major:isNaN(versions[0])?null:versions[0],minor:isNaN(versions[1])?null:versions[1]}},exports.isIOSChrome=function(userAgent){return void 0===userAgent&&(userAgent=getUserAgent()),/Mobi/.test(userAgent)&&"chrome"===guessBrowser()&&/iPad|iPhone|iPod/.test(userAgent)},exports.interceptEvent=function(target,type){var currentListener=null;Object.defineProperty(target,"on"+type,{get:function(){return currentListener},set:function(newListener){currentListener&&this.removeEventListener(type,currentListener),"function"==typeof newListener?this.addEventListener(type,currentListener=newListener):currentListener=null}})},exports.legacyPromise=function(promise,onSuccess,onFailure){return onSuccess?promise.then((function(result){onSuccess(result)}),(function(error){onFailure(error)})):promise},exports.makeUUID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(c){var r=16*Math.random()|0;return("x"===c?r:3&r|8).toString(16)}))},exports.proxyProperties=function(source,wrapper,target){Object.getOwnPropertyNames(source).forEach((function(propertyName){!function(source,wrapper,target,propertyName){propertyName in wrapper||(propertyName.match(/^on[a-z]+$/)?(Object.defineProperty(wrapper,propertyName,{value:null,writable:!0}),target.addEventListener(propertyName.slice(2),(function(){wrapper.dispatchEvent.apply(wrapper,arguments)}))):Object.defineProperty(wrapper,propertyName,{enumerable:!0,get:function(){return target[propertyName]}}))}(0,wrapper,target,propertyName)}))},exports.support=function(){return"object"==typeof navigator&&"object"==typeof navigator.mediaDevices&&"function"==typeof navigator.mediaDevices.getUserMedia&&"function"==typeof RTCPeerConnection}},mb7l:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),TrackPublication=__webpack_require__("tjbx"),_a=__webpack_require__("xwWy"),E=_a.typeErrors,trackPriority=_a.trackPriority,LocalTrackPublication=function(_super){function LocalTrackPublication(signaling,track,unpublish,options){var _this=_super.call(this,track.name,signaling.sid,options)||this;return Object.defineProperties(_this,{_reemitTrackEvent:{value:function(){return _this.emit(_this.isTrackEnabled?"trackEnabled":"trackDisabled")}},_signaling:{value:signaling},_unpublish:{value:unpublish},isTrackEnabled:{enumerable:!0,get:function(){return"data"===this.track.kind||this.track.isEnabled}},kind:{enumerable:!0,value:track.kind},priority:{enumerable:!0,get:function(){return signaling.updatedPriority}},track:{enumerable:!0,value:track}}),track.on("disabled",_this._reemitTrackEvent),track.on("enabled",_this._reemitTrackEvent),_this}return __extends(LocalTrackPublication,_super),LocalTrackPublication.prototype.toString=function(){return"[LocalTrackPublication #"+this._instanceId+": "+this.trackSid+"]"},LocalTrackPublication.prototype.setPriority=function(priority){var priorityValues=Object.values(trackPriority);if(!priorityValues.includes(priority))throw E.INVALID_VALUE("priority",priorityValues);return this._signaling.setPriority(priority),this},LocalTrackPublication.prototype.unpublish=function(){return this.track.removeListener("disabled",this._reemitTrackEvent),this.track.removeListener("enabled",this._reemitTrackEvent),this._unpublish(this),this},LocalTrackPublication}(TrackPublication);module.exports=LocalTrackPublication},mbHc:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Timer=void 0;var Timer=function(){function Timer(){this._end=void 0,this.start()}return Timer.prototype.start=function(){return this._start=Date.now(),this},Timer.prototype.stop=function(){return this._end=Date.now(),this},Timer.prototype.getTimeMeasurement=function(){return{start:this._start,end:this._end,duration:void 0===this._end?void 0:this._end-this._start}},Timer}();exports.Timer=Timer},muOY:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),TrackSwitchOffSignaling=function(_super){function TrackSwitchOffSignaling(getReceiver,options){var _this=_super.call(this,getReceiver,"track_switch_off",options)||this;return _this.on("ready",(function(transport){transport.on("message",(function(message){switch(message.type){case"track_switch_off":_this._setTrackSwitchOffUpdates(message.off||[],message.on||[])}}))})),_this}return __extends(TrackSwitchOffSignaling,_super),TrackSwitchOffSignaling.prototype._setTrackSwitchOffUpdates=function(tracksSwitchedOff,tracksSwitchedOn){this.emit("updated",tracksSwitchedOff,tracksSwitchedOn)},TrackSwitchOffSignaling}(__webpack_require__("zbom"));module.exports=TrackSwitchOffSignaling},mv6w:function(module,exports,__webpack_require__){"use strict";var Filter=function(){function Filter(options){options=Object.assign({getKey:function(a){return a},getValue:function(a){return a},isLessThanOrEqualTo:function(a,b){return a<=b}},options),Object.defineProperties(this,{_getKey:{value:options.getKey},_getValue:{value:options.getValue},_isLessThanOrEqualTo:{value:options.isLessThanOrEqualTo},_map:{value:new Map}})}return Filter.prototype.toMap=function(){return new Map(this._map)},Filter.prototype.updateAndFilter=function(entries){return entries.filter(this.update,this)},Filter.prototype.update=function(entry){var key=this._getKey(entry),value=this._getValue(entry);return!(this._map.has(key)&&this._isLessThanOrEqualTo(value,this._map.get(key))||(this._map.set(key,value),0))},Filter}();module.exports=Filter},nj3X:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},EventEmitter=__webpack_require__("+qE3").EventEmitter,_a=__webpack_require__("xwWy"),DEFAULT_NQ_LEVEL_LOCAL=_a.DEFAULT_NQ_LEVEL_LOCAL,DEFAULT_NQ_LEVEL_REMOTE=_a.DEFAULT_NQ_LEVEL_REMOTE,MAX_NQ_LEVEL=_a.MAX_NQ_LEVEL,inRange=__webpack_require__("ghd6").inRange,NetworkQualityConfigurationImpl=function(_super){function NetworkQualityConfigurationImpl(networkQualityConfiguration){var _this=_super.call(this)||this;return networkQualityConfiguration=Object.assign({local:DEFAULT_NQ_LEVEL_LOCAL,remote:DEFAULT_NQ_LEVEL_REMOTE},networkQualityConfiguration),Object.defineProperties(_this,{local:{value:inRange(networkQualityConfiguration.local,DEFAULT_NQ_LEVEL_LOCAL,MAX_NQ_LEVEL)?networkQualityConfiguration.local:DEFAULT_NQ_LEVEL_LOCAL,writable:!0},remote:{value:inRange(networkQualityConfiguration.remote,DEFAULT_NQ_LEVEL_REMOTE,MAX_NQ_LEVEL)?networkQualityConfiguration.remote:DEFAULT_NQ_LEVEL_REMOTE,writable:!0}}),_this}return __extends(NetworkQualityConfigurationImpl,_super),NetworkQualityConfigurationImpl.prototype.update=function(networkQualityConfiguration){var _this=this;networkQualityConfiguration=Object.assign({local:this.local,remote:this.remote},networkQualityConfiguration),[["local",DEFAULT_NQ_LEVEL_LOCAL,3],["remote",DEFAULT_NQ_LEVEL_REMOTE,3]].forEach((function(_a){var _b=__read(_a,3),localOrRemote=_b[0],min=_b[1];_this[localOrRemote]="number"==typeof networkQualityConfiguration[localOrRemote]&&inRange(networkQualityConfiguration[localOrRemote],min,_b[2])?networkQualityConfiguration[localOrRemote]:min}))},NetworkQualityConfigurationImpl}(EventEmitter);module.exports=NetworkQualityConfigurationImpl},o2QH:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),EncodingParametersImpl=function(_super){function EncodingParametersImpl(encodingParameters,adaptiveSimulcast){var _this=_super.call(this)||this;return encodingParameters=Object.assign({maxAudioBitrate:null,maxVideoBitrate:null},encodingParameters),Object.defineProperties(_this,{maxAudioBitrate:{value:encodingParameters.maxAudioBitrate,writable:!0},maxVideoBitrate:{value:encodingParameters.maxVideoBitrate,writable:!0},adaptiveSimulcast:{value:adaptiveSimulcast}}),_this}return __extends(EncodingParametersImpl,_super),EncodingParametersImpl.prototype.toJSON=function(){return{maxAudioBitrate:this.maxAudioBitrate,maxVideoBitrate:this.maxVideoBitrate}},EncodingParametersImpl.prototype.update=function(encodingParameters){var _this=this;encodingParameters=Object.assign({maxAudioBitrate:this.maxAudioBitrate,maxVideoBitrate:this.maxVideoBitrate},encodingParameters),["maxAudioBitrate","maxVideoBitrate"].reduce((function(shouldEmitChanged,maxKindBitrate){return _this[maxKindBitrate]!==encodingParameters[maxKindBitrate]&&(_this[maxKindBitrate]=encodingParameters[maxKindBitrate],shouldEmitChanged=!0),shouldEmitChanged}),!1)&&this.emit("changed")},EncodingParametersImpl}(__webpack_require__("+qE3").EventEmitter);module.exports=EncodingParametersImpl},oNNP:function(module,exports,__webpack_require__){"use strict";var bind=__webpack_require__("D3zA");module.exports=bind.call(Function.call,Object.prototype.hasOwnProperty)},oOgq:function(module,exports,__webpack_require__){"use strict";var __read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar};module.exports={isAndroid:function(){return/Android/.test(navigator.userAgent)},isIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)},isMobile:function(){return/Mobi/.test(navigator.userAgent)},isNonChromiumEdge:function(browser){return"chrome"===browser&&/Edge/.test(navigator.userAgent)&&("undefined"==typeof chrome||void 0===chrome.runtime)},mobileWebKitBrowser:function(browser){return"safari"!==browser?null:"brave"in navigator?"brave":["edge","edg"].find((function(name){return navigator.userAgent.toLowerCase().includes(name)}))||null},rebrandedChromeBrowser:function(browser){if("chrome"!==browser)return null;if("brave"in navigator)return"brave";var matches=function(string){for(var openParenthesisPositions=[],substrings=[],i=0;i<string.length;i++)if("("===string[i])openParenthesisPositions.push(i);else if(")"===string[i]&&openParenthesisPositions.length>0){var openParenthesisPosition=openParenthesisPositions.pop();0===openParenthesisPositions.length&&substrings.push(string.substring(openParenthesisPosition,i+1))}return substrings}(navigator.userAgent).reduce((function(userAgent,substring){return userAgent.replace(substring,"")}),navigator.userAgent).match(/[^\s]+/g)||[];return __read(matches.map((function(nameAndVersion){return nameAndVersion.split("/")[0].toLowerCase()}))).slice(2).find((function(name){return!["chrome","mobile","safari"].includes(name)}))||null}}},ok1L:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.mosToScore=exports.calculateMOS=void 0,exports.calculateMOS=function(rtt,jitter,fractionLost){var effectiveLatency=rtt+2*jitter+10,rFactor=0;switch(!0){case effectiveLatency<160:rFactor=94.768-effectiveLatency/40;break;case effectiveLatency<1e3:rFactor=94.768-(effectiveLatency-120)/10}switch(!0){case fractionLost<=rFactor/2.5:rFactor=Math.max(rFactor-2.5*fractionLost,6.52);break;default:rFactor=0}return 1+.035*rFactor+7e-6*rFactor*(rFactor-60)*(100-rFactor)},exports.mosToScore=function(mosValue){return mosValue?mosValue>4.2?5:mosValue>4?4:mosValue>3.6?3:mosValue>3?2:1:0}},oy54:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),EventEmitter=__webpack_require__("+qE3").EventEmitter,DEFAULT_VIDEO_PROCESSOR_STATS_INTERVAL_MS=__webpack_require__("xwWy").DEFAULT_VIDEO_PROCESSOR_STATS_INTERVAL_MS,VideoProcessorEventObserver=function(_super){function VideoProcessorEventObserver(log){var _this=_super.call(this)||this;return Object.defineProperties(_this,{_lastStatsSaveTime:{value:null,writable:!0},_lastStatsPublishTime:{value:null,writable:!0},_log:{value:log},_processorInfo:{value:null,writable:!0},_stats:{value:null,writable:!0}}),_this.on("add",(function(info){_this._lastStatsSaveTime=Date.now(),_this._lastStatsPublishTime=Date.now(),_this._processorInfo=info,_this._stats=[],_this._reemitEvent("add",_this._getEventData())})),_this.on("remove",(function(){var data=_this._getEventData();_this._lastStatsSaveTime=null,_this._lastStatsPublishTime=null,_this._processorInfo=null,_this._stats=null,_this._reemitEvent("remove",data)})),_this.on("start",(function(){_this._reemitEvent("start",_this._getEventData())})),_this.on("stop",(function(message){_this._reemitEvent("stop",Object.assign({message:message},_this._getEventData()))})),_this.on("stats",(function(){return _this._maybeEmitStats()})),_this}return __extends(VideoProcessorEventObserver,_super),VideoProcessorEventObserver.prototype._getEventData=function(){if(!this._processorInfo)return{};var _a=this._processorInfo,processor=_a.processor,data={captureHeight:_a.captureHeight,captureWidth:_a.captureWidth,inputFrameRate:_a.inputFrameRate,isRemoteVideoTrack:_a.isRemoteVideoTrack};return data.name=processor._name||"VideoProcessor",["assetsPath","blurFilterRadius","fitType","isSimdEnabled","maskBlurRadius","version"].forEach((function(prop){var val=processor["_"+prop];void 0!==val&&(data[prop]=val)})),Object.keys(data).forEach((function(prop){var val=data[prop];"boolean"==typeof val&&(data[prop]=val?"true":"false")})),data},VideoProcessorEventObserver.prototype._maybeEmitStats=function(){if(this._stats&&this._processorInfo){var benchmark=this._processorInfo.processor._benchmark;if(benchmark){var now=Date.now();if(!(now-this._lastStatsSaveTime<1e3)){var entry={outputFrameRate:benchmark.getRate("totalProcessingDelay")};if(["captureFrameDelay","imageCompositionDelay","inputImageResizeDelay","processFrameDelay","segmentationDelay"].forEach((function(name){entry[name]=benchmark.getAverageDelay(name)})),this._lastStatsSaveTime=now,this._stats.push(entry),!(now-this._lastStatsPublishTime<DEFAULT_VIDEO_PROCESSOR_STATS_INTERVAL_MS)){this._lastStatsPublishTime=now;var averages=this._stats.splice(0).reduce((function(averages,current,n){return Object.keys(entry).forEach((function(name){averages[name]||(averages[name]=0),averages[name]=(averages[name]*n+current[name])/(n+1)})),averages}),{});Object.keys(averages).forEach((function(name){averages[name]=parseFloat(averages[name].toFixed(2))})),this._reemitEvent("stats",Object.assign({},averages,this._getEventData()))}}}}},VideoProcessorEventObserver.prototype._reemitEvent=function(name,data){this._log.debug("VideoProcessor:"+name,data),this.emit("event",{name:name,data:data})},VideoProcessorEventObserver}(EventEmitter);module.exports=VideoProcessorEventObserver},pWYA:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},EventEmitter=__webpack_require__("+qE3"),PeerConnectionReportFactory=__webpack_require__("I/VV"),NetworkQualityMonitor=function(_super){function NetworkQualityMonitor(manager,signaling){var _this=_super.call(this)||this;return Object.defineProperties(_this,{_factories:{value:new WeakMap},_manager:{value:manager},_signaling:{value:signaling}}),signaling.on("updated",(function(){return _this.emit("updated")})),_this}return __extends(NetworkQualityMonitor,_super),Object.defineProperty(NetworkQualityMonitor.prototype,"level",{get:function(){return this._signaling.level},enumerable:!1,configurable:!0}),Object.defineProperty(NetworkQualityMonitor.prototype,"levels",{get:function(){return this._signaling.levels},enumerable:!1,configurable:!0}),Object.defineProperty(NetworkQualityMonitor.prototype,"remoteLevels",{get:function(){return this._signaling.remoteLevels},enumerable:!1,configurable:!0}),NetworkQualityMonitor.prototype.start=function(){var _this=this;this.stop();var timeout=setTimeout((function(){var monitor,reportsOrNullPromises;_this._timeout===timeout&&(monitor=_this,reportsOrNullPromises=(monitor._manager._peerConnections?Array.from(monitor._manager._peerConnections.values()):[]).map((function(pcv2){return pcv2._peerConnection})).filter((function(pc){return"closed"!==pc.signalingState})).map((function(pc){if(monitor._factories.has(pc))return monitor._factories.get(pc);var factory=new PeerConnectionReportFactory(pc);return monitor._factories.set(pc,factory),factory})).map((function(factory){return factory.next().catch((function(){return null}))})),Promise.all(reportsOrNullPromises).then((function(reportsOrNull){return reportsOrNull.filter((function(reportOrNull){return reportOrNull})).map((function(report){return report.summarize()}))}))).then((function(reports){if(_this._timeout===timeout){if(reports.length){var _a=__read(reports,1);_this._signaling.put(_a[0])}_this.start()}}))}),200);this._timeout=timeout},NetworkQualityMonitor.prototype.stop=function(){clearTimeout(this._timeout),this._timeout=null},NetworkQualityMonitor}(EventEmitter);module.exports=NetworkQualityMonitor},q6IO:function(module,exports,__webpack_require__){"use strict";module.exports=function(_a){var _b=_a.jitter,_c=_a.rtt,_d=_a.level;Object.defineProperties(this,{jitter:{value:void 0===_b?null:_b,enumerable:!0},rtt:{value:void 0===_c?null:_c,enumerable:!0},level:{value:void 0===_d?null:_d,enumerable:!0}})}},qOIT:function(module,exports,__webpack_require__){"use strict";var MovingAverageDelta=function(){function MovingAverageDelta(){Object.defineProperties(this,{_samples:{value:[{denominator:0,numerator:0},{denominator:0,numerator:0}]}})}return MovingAverageDelta.prototype.get=function(){var samples=this._samples;return(samples[1].numerator-samples[0].numerator)/(samples[1].denominator-samples[0].denominator||1/0)},MovingAverageDelta.prototype.putSample=function(numerator,denominator){var samples=this._samples;samples.shift(),samples.push({denominator:denominator,numerator:numerator})},MovingAverageDelta}();module.exports=MovingAverageDelta},qRNy:function(module,exports,__webpack_require__){"use strict";var __read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},_a=__webpack_require__("ghd6"),difference=_a.difference,flatMap=_a.flatMap;function createSSRC(){return String(Math.floor(4294967295*Math.random()))}var TrackAttributes=function(){function TrackAttributes(trackId,streamId,cName){Object.defineProperties(this,{cName:{enumerable:!0,value:cName},isSimulcastEnabled:{enumerable:!0,value:!1,writable:!0},primarySSRCs:{enumerable:!0,value:new Set},rtxPairs:{enumerable:!0,value:new Map},streamId:{enumerable:!0,value:streamId},trackId:{enumerable:!0,value:trackId}})}return TrackAttributes.prototype.addSimulcastSSRCs=function(){if(!this.isSimulcastEnabled){var simulcastSSRCs=[createSSRC(),createSSRC()];simulcastSSRCs.forEach((function(ssrc){this.primarySSRCs.add(ssrc)}),this),this.rtxPairs.size&&simulcastSSRCs.forEach((function(ssrc){this.rtxPairs.set(createSSRC(),ssrc)}),this)}},TrackAttributes.prototype.addSSRC=function(ssrc,primarySSRC,isSimSSRC){primarySSRC?this.rtxPairs.set(ssrc,primarySSRC):this.primarySSRCs.add(ssrc),this.isSimulcastEnabled=this.isSimulcastEnabled||isSimSSRC},TrackAttributes.prototype.toSdpLines=function(excludeRtx){var _this=this,rtxPairs=excludeRtx?[]:Array.from(this.rtxPairs.entries()).map((function(rtxPair){return rtxPair.reverse()})),simSSRCs=Array.from(this.primarySSRCs.values()),ssrcs=rtxPairs.length?flatMap(rtxPairs):simSSRCs,attrLines=flatMap(ssrcs,(function(ssrc){return["a=ssrc:"+ssrc+" cname:"+_this.cName,"a=ssrc:"+ssrc+" msid:"+_this.streamId+" "+_this.trackId]})),rtxPairLines=rtxPairs.map((function(rtxPair){return"a=ssrc-group:FID "+rtxPair.join(" ")})),simGroupLines=["a=ssrc-group:SIM "+simSSRCs.join(" ")];return rtxPairLines.concat(attrLines).concat(simGroupLines)},TrackAttributes}();function getMatches(section,pattern){return(section.match(new RegExp(pattern,"gm"))||[]).map((function(match){return(match.match(new RegExp(pattern))||[]).slice(1)}))}module.exports=function(section,trackIdsToAttributes){var newTrackIdsToAttributes=function(section){var simSSRCs=function(section){return new Set(flatMap(getMatches(section,"^a=ssrc-group:SIM ([0-9]+) ([0-9]+) ([0-9]+)$")))}(section),rtxPairs=function(section){return new Map(getMatches(section,"^a=ssrc-group:FID ([0-9]+) ([0-9]+)$").map((function(pair){return pair.reverse()})))}(section);return function(section){var _a=__read(flatMap(getMatches(section,"^a=msid:(.+) (.+)$")),2),streamId=_a[0],trackId=_a[1];return flatMap(getMatches(section,"^a=ssrc:(.+) cname:.+$")).map((function(ssrc){return[ssrc,streamId,trackId]}))}(section).reduce((function(trackIdsToSSRCs,tuple){var ssrc=tuple[0],streamId=tuple[1],trackId=tuple[2],trackAttributes=trackIdsToSSRCs.get(trackId)||new TrackAttributes(trackId,streamId,function(section,ssrc,attribute){return section.match(new RegExp("a=ssrc:"+ssrc+" cname:(.+)"))[1]}(section,ssrc)),primarySSRC=rtxPairs.get(ssrc)||null;return trackAttributes.addSSRC(ssrc,primarySSRC,simSSRCs.has(ssrc)),trackIdsToSSRCs.set(trackId,trackAttributes)}),new Map)}(section),newTrackIds=Array.from(newTrackIdsToAttributes.keys()),trackIds=Array.from(trackIdsToAttributes.keys()),trackIdsToAdd=difference(newTrackIds,trackIds),trackIdsToIgnore=difference(trackIds,newTrackIds);flatMap(trackIdsToAdd,(function(trackId){return newTrackIdsToAttributes.get(trackId)})).forEach((function(trackAttributes){trackAttributes.addSimulcastSSRCs(),trackIdsToAttributes.set(trackAttributes.trackId,trackAttributes)})),trackIds=Array.from(trackIdsToAttributes.keys());var relevantTrackIds=difference(trackIds,trackIdsToIgnore),relevantTrackAttributes=flatMap(relevantTrackIds,(function(trackId){return trackIdsToAttributes.get(trackId)})),excludeRtx=!section.match(/a=rtpmap:[0-9]+ rtx/),relevantSdpLines=flatMap(relevantTrackAttributes,(function(trackAttributes){return trackAttributes.toSdpLines(excludeRtx)})),sectionLines=flatMap(new Set(section.split("\r\n").concat(relevantSdpLines)));return section.match("a=x-google-flag:conference")||sectionLines.push("a=x-google-flag:conference"),sectionLines.join("\r\n")}},qnQj:function(module,exports,__webpack_require__){"use strict";var EventTarget=__webpack_require__("bQMn"),FirefoxRTCSessionDescription=__webpack_require__("ro1H"),inherits=__webpack_require__("/E53").inherits,updateTracksToSSRCs=__webpack_require__("L1nb").updateUnifiedPlanTrackIdsToSSRCs,util=__webpack_require__("mIkg"),needsWorkaroundForBug1480277="object"==typeof navigator&&navigator.userAgent&&(navigator.userAgent.match(/Firefox\/61/)||navigator.userAgent.match(/Firefox\/62/));function FirefoxRTCPeerConnection(configuration){if(!(this instanceof FirefoxRTCPeerConnection))return new FirefoxRTCPeerConnection(configuration);EventTarget.call(this),util.interceptEvent(this,"signalingstatechange");var peerConnection=new RTCPeerConnection(configuration);Object.defineProperties(this,{_initiallyNegotiatedDtlsRole:{value:null,writable:!0},_isClosed:{value:!1,writable:!0},_peerConnection:{value:peerConnection},_rollingBack:{value:!1,writable:!0},_tracksToSSRCs:{value:new Map},iceGatheringState:{enumerable:!0,get:function(){return this._isClosed?"complete":this._peerConnection.iceGatheringState}},localDescription:{enumerable:!0,get:function(){return overwriteWithInitiallyNegotiatedDtlsRole(this._peerConnection.localDescription,this._initiallyNegotiatedDtlsRole)}},signalingState:{enumerable:!0,get:function(){return this._isClosed?"closed":this._peerConnection.signalingState}}});var previousSignalingState,self=this;peerConnection.addEventListener("signalingstatechange",(function(){if(!self._rollingBack&&self.signalingState!==previousSignalingState){previousSignalingState=self.signalingState;var dispatchEventToSelf=self.dispatchEvent.apply.bind(self.dispatchEvent,self,arguments);self._isClosed?setTimeout(dispatchEventToSelf):dispatchEventToSelf()}})),util.proxyProperties(RTCPeerConnection.prototype,this,peerConnection)}function rollback(peerConnection,local,onceRolledBack){var setLocalDescription=local?"setLocalDescription":"setRemoteDescription";return peerConnection._rollingBack=!0,peerConnection._peerConnection[setLocalDescription](new FirefoxRTCSessionDescription({type:"rollback"})).then(onceRolledBack).then((function(result){return peerConnection._rollingBack=!1,result}),(function(error){throw peerConnection._rollingBack=!1,error}))}function saveInitiallyNegotiatedDtlsRole(peerConnection,description,remote){if(!peerConnection._initiallyNegotiatedDtlsRole&&"offer"!==description.type){var match=description.sdp.match(/a=setup:([a-z]+)/);if(match){var dtlsRole=match[1];peerConnection._initiallyNegotiatedDtlsRole=remote?{active:"passive",passive:"active"}[dtlsRole]:dtlsRole}}}function overwriteWithInitiallyNegotiatedDtlsRole(description,dtlsRole){return description&&"answer"===description.type&&dtlsRole?new FirefoxRTCSessionDescription({type:description.type,sdp:description.sdp.replace(/a=setup:[a-z]+/g,"a=setup:"+dtlsRole)}):description}inherits(FirefoxRTCPeerConnection,EventTarget),Object.defineProperty(FirefoxRTCPeerConnection.prototype,"peerIdentity",{enumerable:!0,value:Promise.resolve({idp:"",name:""})}),needsWorkaroundForBug1480277&&(FirefoxRTCPeerConnection.prototype.addTrack=function(){var track=arguments[0],sender=this._peerConnection.addTrack.apply(this._peerConnection,arguments);return sender.replaceTrack(track),sender}),FirefoxRTCPeerConnection.prototype.createAnswer=function(){var promise,args=[].slice.call(arguments),self=this;return promise=this._peerConnection.createAnswer().then((function(answer){return saveInitiallyNegotiatedDtlsRole(self,answer),overwriteWithInitiallyNegotiatedDtlsRole(answer,self._initiallyNegotiatedDtlsRole)})),"function"==typeof args[0]?util.legacyPromise(promise,args[0],args[1]):promise},FirefoxRTCPeerConnection.prototype.createOffer=function(){var promise,args=[].slice.call(arguments),options=(args.length>1?args[2]:args[0])||{},self=this;if("have-local-offer"===this.signalingState||"have-remote-offer"===this.signalingState){var local="have-local-offer"===this.signalingState;promise=rollback(this,local,(function(){return self.createOffer(options)}))}else promise=self._peerConnection.createOffer(options);return promise=promise.then((function(offer){return new FirefoxRTCSessionDescription({type:offer.type,sdp:updateTracksToSSRCs(self._tracksToSSRCs,offer.sdp)})})),args.length>1?util.legacyPromise(promise,args[0],args[1]):promise},FirefoxRTCPeerConnection.prototype.setLocalDescription=function(){var promise,args=[].slice.call(arguments),description=args[0];return description&&"answer"===description.type&&"have-local-offer"===this.signalingState&&(promise=Promise.reject(new Error("Cannot set local answer in state have-local-offer"))),promise?args.length>1?util.legacyPromise(promise,args[1],args[2]):promise:this._peerConnection.setLocalDescription.apply(this._peerConnection,args)},FirefoxRTCPeerConnection.prototype.setRemoteDescription=function(){var promise,args=[].slice.call(arguments),description=args[0],self=this;return description&&"have-remote-offer"===this.signalingState&&("answer"===description.type?promise=Promise.reject(new Error("Cannot set remote answer in state have-remote-offer")):"offer"===description.type&&(promise=rollback(this,!1,(function(){return self._peerConnection.setRemoteDescription(description)})))),promise||(promise=this._peerConnection.setRemoteDescription(description)),promise=promise.then((function(){saveInitiallyNegotiatedDtlsRole(self,description,!0)})),args.length>1?util.legacyPromise(promise,args[1],args[2]):promise},FirefoxRTCPeerConnection.prototype.close=function(){"closed"!==this.signalingState&&(this._isClosed=!0,this._peerConnection.close())},util.delegateMethods(RTCPeerConnection.prototype,FirefoxRTCPeerConnection.prototype,"_peerConnection"),module.exports=FirefoxRTCPeerConnection},r2dn:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),LocalAudioTrackStats=function(_super){function LocalAudioTrackStats(trackId,statsReport,prepareForInsights){var _this=_super.call(this,trackId,statsReport,prepareForInsights)||this;return Object.defineProperties(_this,{audioLevel:{value:"number"==typeof statsReport.audioInputLevel?statsReport.audioInputLevel:null,enumerable:!0},jitter:{value:"number"==typeof statsReport.jitter?statsReport.jitter:null,enumerable:!0}}),_this}return __extends(LocalAudioTrackStats,_super),LocalAudioTrackStats}(__webpack_require__("zYCr"));module.exports=LocalAudioTrackStats},ro1H:function(module,exports,__webpack_require__){"use strict";module.exports=RTCSessionDescription},sJKT:function(module,exports,__webpack_require__){"use strict";var InsightsPublisher=function(){function InsightsPublisher(){Object.defineProperties(this,{_connected:{writable:!0,value:!0}})}return InsightsPublisher.prototype.connect=function(){},InsightsPublisher.prototype.disconnect=function(){return!!this._connected&&(this._connected=!1,!0)},InsightsPublisher.prototype.publish=function(){return this._connected},InsightsPublisher}();module.exports=InsightsPublisher},sOna:function(module,exports,__webpack_require__){"use strict";var isArgumentsObject=__webpack_require__("45zb"),isGeneratorFunction=__webpack_require__("Cj46"),whichTypedArray=__webpack_require__("7cSL"),isTypedArray=__webpack_require__("9OO9");function uncurryThis(f){return f.call.bind(f)}var BigIntSupported="undefined"!=typeof BigInt,SymbolSupported="undefined"!=typeof Symbol,ObjectToString=uncurryThis(Object.prototype.toString),numberValue=uncurryThis(Number.prototype.valueOf),stringValue=uncurryThis(String.prototype.valueOf),booleanValue=uncurryThis(Boolean.prototype.valueOf);if(BigIntSupported)var bigIntValue=uncurryThis(BigInt.prototype.valueOf);if(SymbolSupported)var symbolValue=uncurryThis(Symbol.prototype.valueOf);function checkBoxedPrimitive(value,prototypeValueOf){if("object"!=typeof value)return!1;try{return prototypeValueOf(value),!0}catch(e){return!1}}function isMapToString(value){return"[object Map]"===ObjectToString(value)}function isSetToString(value){return"[object Set]"===ObjectToString(value)}function isWeakMapToString(value){return"[object WeakMap]"===ObjectToString(value)}function isWeakSetToString(value){return"[object WeakSet]"===ObjectToString(value)}function isArrayBufferToString(value){return"[object ArrayBuffer]"===ObjectToString(value)}function isArrayBuffer(value){return"undefined"!=typeof ArrayBuffer&&(isArrayBufferToString.working?isArrayBufferToString(value):value instanceof ArrayBuffer)}function isDataViewToString(value){return"[object DataView]"===ObjectToString(value)}function isDataView(value){return"undefined"!=typeof DataView&&(isDataViewToString.working?isDataViewToString(value):value instanceof DataView)}exports.isArgumentsObject=isArgumentsObject,exports.isGeneratorFunction=isGeneratorFunction,exports.isTypedArray=isTypedArray,exports.isPromise=function(input){return"undefined"!=typeof Promise&&input instanceof Promise||null!==input&&"object"==typeof input&&"function"==typeof input.then&&"function"==typeof input.catch},exports.isArrayBufferView=function(value){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(value):isTypedArray(value)||isDataView(value)},exports.isUint8Array=function(value){return"Uint8Array"===whichTypedArray(value)},exports.isUint8ClampedArray=function(value){return"Uint8ClampedArray"===whichTypedArray(value)},exports.isUint16Array=function(value){return"Uint16Array"===whichTypedArray(value)},exports.isUint32Array=function(value){return"Uint32Array"===whichTypedArray(value)},exports.isInt8Array=function(value){return"Int8Array"===whichTypedArray(value)},exports.isInt16Array=function(value){return"Int16Array"===whichTypedArray(value)},exports.isInt32Array=function(value){return"Int32Array"===whichTypedArray(value)},exports.isFloat32Array=function(value){return"Float32Array"===whichTypedArray(value)},exports.isFloat64Array=function(value){return"Float64Array"===whichTypedArray(value)},exports.isBigInt64Array=function(value){return"BigInt64Array"===whichTypedArray(value)},exports.isBigUint64Array=function(value){return"BigUint64Array"===whichTypedArray(value)},isMapToString.working="undefined"!=typeof Map&&isMapToString(new Map),exports.isMap=function(value){return"undefined"!=typeof Map&&(isMapToString.working?isMapToString(value):value instanceof Map)},isSetToString.working="undefined"!=typeof Set&&isSetToString(new Set),exports.isSet=function(value){return"undefined"!=typeof Set&&(isSetToString.working?isSetToString(value):value instanceof Set)},isWeakMapToString.working="undefined"!=typeof WeakMap&&isWeakMapToString(new WeakMap),exports.isWeakMap=function(value){return"undefined"!=typeof WeakMap&&(isWeakMapToString.working?isWeakMapToString(value):value instanceof WeakMap)},isWeakSetToString.working="undefined"!=typeof WeakSet&&isWeakSetToString(new WeakSet),exports.isWeakSet=function(value){return isWeakSetToString(value)},isArrayBufferToString.working="undefined"!=typeof ArrayBuffer&&isArrayBufferToString(new ArrayBuffer),exports.isArrayBuffer=isArrayBuffer,isDataViewToString.working="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView&&isDataViewToString(new DataView(new ArrayBuffer(1),0,1)),exports.isDataView=isDataView;var SharedArrayBufferCopy="undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:void 0;function isSharedArrayBufferToString(value){return"[object SharedArrayBuffer]"===ObjectToString(value)}function isSharedArrayBuffer(value){return void 0!==SharedArrayBufferCopy&&(void 0===isSharedArrayBufferToString.working&&(isSharedArrayBufferToString.working=isSharedArrayBufferToString(new SharedArrayBufferCopy)),isSharedArrayBufferToString.working?isSharedArrayBufferToString(value):value instanceof SharedArrayBufferCopy)}function isNumberObject(value){return checkBoxedPrimitive(value,numberValue)}function isStringObject(value){return checkBoxedPrimitive(value,stringValue)}function isBooleanObject(value){return checkBoxedPrimitive(value,booleanValue)}function isBigIntObject(value){return BigIntSupported&&checkBoxedPrimitive(value,bigIntValue)}function isSymbolObject(value){return SymbolSupported&&checkBoxedPrimitive(value,symbolValue)}exports.isSharedArrayBuffer=isSharedArrayBuffer,exports.isAsyncFunction=function(value){return"[object AsyncFunction]"===ObjectToString(value)},exports.isMapIterator=function(value){return"[object Map Iterator]"===ObjectToString(value)},exports.isSetIterator=function(value){return"[object Set Iterator]"===ObjectToString(value)},exports.isGeneratorObject=function(value){return"[object Generator]"===ObjectToString(value)},exports.isWebAssemblyCompiledModule=function(value){return"[object WebAssembly.Module]"===ObjectToString(value)},exports.isNumberObject=isNumberObject,exports.isStringObject=isStringObject,exports.isBooleanObject=isBooleanObject,exports.isBigIntObject=isBigIntObject,exports.isSymbolObject=isSymbolObject,exports.isBoxedPrimitive=function(value){return isNumberObject(value)||isStringObject(value)||isBooleanObject(value)||isBigIntObject(value)||isSymbolObject(value)},exports.isAnyArrayBuffer=function(value){return"undefined"!=typeof Uint8Array&&(isArrayBuffer(value)||isSharedArrayBuffer(value))},["isProxy","isExternal","isModuleNamespaceObject"].forEach((function(method){Object.defineProperty(exports,method,{enumerable:!1,value:function(){throw new Error(method+" is not supported in userland")}})}))},sYJf:function(module,exports,__webpack_require__){"use strict";var __read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__spreadArray=this&&this.__spreadArray||function(to,from){for(var i=0,il=from.length,j=to.length;i<il;i++,j++)to[j]=from[i];return to},CancelablePromise=function(){function CancelablePromise(onCreate,onCancel){var _this=this;Object.defineProperties(this,{_isCancelable:{writable:!0,value:!0},_isCanceled:{writable:!0,value:!1},_onCancel:{value:onCancel}}),Object.defineProperty(this,"_promise",{value:new Promise((function(resolve,reject){onCreate((function(value){_this._isCancelable=!1,resolve(value)}),(function(reason){_this._isCancelable=!1,reject(reason)}),(function(){return _this._isCanceled}))}))})}return CancelablePromise.reject=function(reason){return new CancelablePromise((function(resolve,reject){reject(reason)}),(function(){}))},CancelablePromise.resolve=function(result){return new CancelablePromise((function(resolve){resolve(result)}),(function(){}))},CancelablePromise.prototype.cancel=function(){return this._isCancelable&&(this._isCanceled=!0,this._onCancel()),this},CancelablePromise.prototype.catch=function(){var args=[].slice.call(arguments),promise=this._promise;return new CancelablePromise((function(resolve,reject){promise.catch.apply(promise,__spreadArray([],__read(args))).then(resolve,reject)}),this._onCancel)},CancelablePromise.prototype.then=function(){var args=[].slice.call(arguments),promise=this._promise;return new CancelablePromise((function(resolve,reject){promise.then.apply(promise,__spreadArray([],__read(args))).then(resolve,reject)}),this._onCancel)},CancelablePromise.prototype.finally=function(){var args=[].slice.call(arguments),promise=this._promise;return new CancelablePromise((function(resolve,reject){promise.finally.apply(promise,__spreadArray([],__read(args))).then(resolve,reject)}),this._onCancel)},CancelablePromise}();module.exports=CancelablePromise},shdM:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),LocalTrackPublicationSignaling=function(_super){function LocalTrackPublicationSignaling(trackSender,name,priority){var _this=this;return trackSender=trackSender.clone(),(_this=_super.call(this,name,trackSender.kind,"data"===trackSender.kind||trackSender.track.enabled,priority)||this).setTrackTransceiver(trackSender),Object.defineProperties(_this,{_updatedPriority:{value:priority,writable:!0},id:{enumerable:!0,value:trackSender.id}}),_this}return __extends(LocalTrackPublicationSignaling,_super),Object.defineProperty(LocalTrackPublicationSignaling.prototype,"updatedPriority",{get:function(){return this._updatedPriority},enumerable:!1,configurable:!0}),LocalTrackPublicationSignaling.prototype.enable=function(enabled){return this.trackTransceiver.track.enabled=enabled="boolean"!=typeof enabled||enabled,_super.prototype.enable.call(this,enabled)},LocalTrackPublicationSignaling.prototype.publishFailed=function(error){return function(publication,error){return null===publication._sid&&!publication._error&&(publication._error=error,!0)}(this,error)&&this.emit("updated"),this},LocalTrackPublicationSignaling.prototype.setPriority=function(priority){return this._updatedPriority!==priority&&(this._updatedPriority=priority,this.emit("updated")),this},LocalTrackPublicationSignaling.prototype.setSid=function(sid){return this._error?this:_super.prototype.setSid.call(this,sid)},LocalTrackPublicationSignaling.prototype.stop=function(){this.trackTransceiver.stop()},LocalTrackPublicationSignaling}(__webpack_require__("Ivmz"));module.exports=LocalTrackPublicationSignaling},t472:function(module,exports,__webpack_require__){"use strict";var _a=__webpack_require__("mIkg"),guessBrowser=_a.guessBrowser,isWebRTCSupported=_a.support,_b=__webpack_require__("oOgq"),isAndroid=_b.isAndroid,isMobile=_b.isMobile,isNonChromiumEdge=_b.isNonChromiumEdge,rebrandedChromeBrowser=_b.rebrandedChromeBrowser,mobileWebKitBrowser=_b.mobileWebKitBrowser,SUPPORTED_CHROME_BASED_BROWSERS=["crios","edg","edge","electron","headlesschrome"],SUPPORTED_ANDROID_BROWSERS=["chrome","firefox"],SUPPORTED_IOS_BROWSERS=["chrome","safari"],SUPPORTED_MOBILE_WEBKIT_BASED_BROWSERS=[];module.exports=function(){var browser=guessBrowser();if(!browser)return!1;var rebrandedChrome=rebrandedChromeBrowser(browser),mobileWebKit=mobileWebKitBrowser(browser),supportedMobileBrowsers=isAndroid()?SUPPORTED_ANDROID_BROWSERS:SUPPORTED_IOS_BROWSERS;return!!browser&&isWebRTCSupported()&&(!rebrandedChrome||SUPPORTED_CHROME_BASED_BROWSERS.includes(rebrandedChrome))&&!isNonChromiumEdge(browser)&&(!mobileWebKit||SUPPORTED_MOBILE_WEBKIT_BASED_BROWSERS.includes(mobileWebKit))&&(!isMobile()||supportedMobileBrowsers.includes(browser))}},tC0a:function(module,exports,__webpack_require__){"use strict";var getMediaSections=__webpack_require__("9dY8").getMediaSections,TrackMatcher=function(){function TrackMatcher(){Object.defineProperties(this,{_midsToTrackIds:{value:new Map,writable:!0}})}return TrackMatcher.prototype.match=function(event){return this._midsToTrackIds.get(event.transceiver.mid)||null},TrackMatcher.prototype.update=function(sdp){var sections=getMediaSections(sdp,"(audio|video)");this._midsToTrackIds=sections.reduce((function(midsToTrackIds,section){var midMatches=section.match(/^a=mid:(.+)$/m)||[],trackIdMatches=section.match(/^a=msid:.+ (.+)$/m)||[],mid=midMatches[1],trackId=trackIdMatches[1];return mid&&trackId?midsToTrackIds.set(mid,trackId):midsToTrackIds}),this._midsToTrackIds)},TrackMatcher}();module.exports=TrackMatcher},tPbP:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),EventEmitter=__webpack_require__("+qE3").EventEmitter,getUserAgent=__webpack_require__("ghd6").getUserAgent,toplevel=global.window||global,WebSocket=toplevel.WebSocket?toplevel.WebSocket:__webpack_require__("vaDk"),util=__webpack_require__("ghd6"),InsightsPublisher=function(_super){function InsightsPublisher(token,sdkName,sdkVersion,environment,realm,options){var _this=_super.call(this)||this;return options=Object.assign({gateway:createGateway(environment,realm)+"/v1/VideoEvents",maxReconnectAttempts:5,reconnectIntervalMs:50,userAgent:getUserAgent(),WebSocket:WebSocket},options),Object.defineProperties(_this,{_connectTimestamp:{value:0,writable:!0},_eventQueue:{value:[]},_readyToConnect:{value:util.defer()},_reconnectAttemptsLeft:{value:options.maxReconnectAttempts,writable:!0},_ws:{value:null,writable:!0},_WebSocket:{value:options.WebSocket}}),_this._readyToConnect.promise.then((function(_a){var roomSid=_a.roomSid,participantSid=_a.participantSid,self=_this;_this.on("disconnected",(function maybeReconnect(error){if(self._session=null,error&&self._reconnectAttemptsLeft>0)return self.emit("reconnecting"),void function(publisher,token,sdkName,sdkVersion,roomSid,participantSid,options){var connectInterval=Date.now()-publisher._connectTimestamp,timeToWait=options.reconnectIntervalMs-connectInterval;timeToWait>0?setTimeout((function(){connect(publisher,token,sdkName,sdkVersion,roomSid,participantSid,options)}),timeToWait):connect(publisher,token,sdkName,sdkVersion,roomSid,participantSid,options)}(self,token,sdkName,sdkVersion,roomSid,participantSid,options);self.removeListener("disconnected",maybeReconnect)})),connect(_this,token,sdkName,sdkVersion,roomSid,participantSid,options)})).catch((function(){})),_this}return __extends(InsightsPublisher,_super),InsightsPublisher.prototype.connect=function(roomSid,participantSid){this._readyToConnect.resolve({roomSid:roomSid,participantSid:participantSid})},InsightsPublisher.prototype._publish=function(event){event.session=this._session,this._ws.send(JSON.stringify(event))},InsightsPublisher.prototype.disconnect=function(){if(null===this._ws||this._ws.readyState===this._WebSocket.CLOSING||this._ws.readyState===this._WebSocket.CLOSED)return!1;try{this._ws.close()}catch(error){}return this.emit("disconnected"),!0},InsightsPublisher.prototype.publish=function(groupName,eventName,payload){return(null===this._ws||this._ws.readyState!==this._WebSocket.CLOSING&&this._ws.readyState!==this._WebSocket.CLOSED)&&(("string"==typeof this._session?this._publish.bind(this):this._eventQueue.push.bind(this._eventQueue))({group:groupName,name:eventName,payload:payload,timestamp:Date.now(),type:"event",version:1}),!0)},InsightsPublisher}(EventEmitter);function connect(publisher,token,sdkName,sdkVersion,roomSid,participantSid,options){publisher._connectTimestamp=Date.now(),publisher._reconnectAttemptsLeft--,publisher._ws=new options.WebSocket(options.gateway);var ws=publisher._ws;ws.addEventListener("close",(function(event){1e3!==event.code?publisher.emit("disconnected",new Error("WebSocket Error "+event.code+": "+event.reason)):publisher.emit("disconnected")})),ws.addEventListener("message",(function(message){!function(publisher,response,options){switch(response.type){case"connected":publisher._session=response.session,publisher._reconnectAttemptsLeft=options.maxReconnectAttempts,publisher._eventQueue.splice(0).forEach(publisher._publish,publisher),publisher.emit("connected");break;case"error":publisher._ws.close(),publisher.emit("disconnected",new Error(response.message))}}(publisher,JSON.parse(message.data),options)})),ws.addEventListener("open",(function(){var connectRequest={type:"connect",token:token,version:1};connectRequest.publisher={name:sdkName,sdkVersion:sdkVersion,userAgent:options.userAgent,participantSid:participantSid,roomSid:roomSid},ws.send(JSON.stringify(connectRequest))}))}function createGateway(environment,realm){return"prod"===environment?"wss://sdkgw."+realm+".twilio.com":"wss://sdkgw."+environment+"-"+realm+".twilio.com"}module.exports=InsightsPublisher},thyc:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.syntheticVideo=void 0,exports.syntheticVideo=function(_a){var _b=void 0===_a?{}:_a,_c=_b.width,width=void 0===_c?640:_c,_d=_b.height,height=void 0===_d?480:_d,canvas=Object.assign(document.createElement("canvas"),{width:width,height:height}),ctx=canvas.getContext("2d");ctx.fillStyle="green",ctx.fillRect(0,0,canvas.width,canvas.height);var stopped=!1;requestAnimationFrame((function animate(){if(!stopped){var r=Math.round(255*Math.random()),g=Math.round(255*Math.random()),b=Math.round(255*Math.random()),a=Math.round(255*Math.random());ctx.fillStyle="rgba("+r+", "+g+", "+b+", "+a+")",ctx.fillRect(Math.random()*width,Math.random()*height,50,50),requestAnimationFrame(animate)}}));var track=canvas.captureStream(30).getTracks()[0],originalStop=track.stop;return track.stop=function(){stopped=!0,originalStop.call(track)},track}},tjbx:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),EventEmitter=__webpack_require__("mAYT"),_a=__webpack_require__("ghd6"),buildLogLevels=_a.buildLogLevels,valueToJSON=_a.valueToJSON,DEFAULT_LOG_LEVEL=__webpack_require__("xwWy").DEFAULT_LOG_LEVEL,Log=__webpack_require__("S3Hu"),nInstances=0,TrackPublication=function(_super){function TrackPublication(trackName,trackSid,options){var _this=_super.call(this)||this;options=Object.assign({logLevel:DEFAULT_LOG_LEVEL},options);var logLevels=buildLogLevels(options.logLevel);return Object.defineProperties(_this,{_instanceId:{value:nInstances++},_log:{value:options.log?options.log.createLog("default",_this):new Log("default",_this,logLevels,options.loggerName)},trackName:{enumerable:!0,value:trackName},trackSid:{enumerable:!0,value:trackSid}}),_this}return __extends(TrackPublication,_super),TrackPublication.prototype.toJSON=function(){return valueToJSON(this)},TrackPublication.prototype.toString=function(){return"[TrackPublication #"+this._instanceId+": "+this.trackSid+"]"},TrackPublication}(EventEmitter);module.exports=TrackPublication},uBG5:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),MediaTrackTransceiver=function(_super){function MediaTrackTransceiver(id,mediaStreamTrack){var _this=_super.call(this,id,mediaStreamTrack.kind)||this;return Object.defineProperties(_this,{_track:{value:mediaStreamTrack,writable:!0},enabled:{enumerable:!0,get:function(){return this._track.enabled}},readyState:{enumerable:!0,get:function(){return this._track.readyState}},track:{enumerable:!0,get:function(){return this._track}}}),_this}return __extends(MediaTrackTransceiver,_super),MediaTrackTransceiver.prototype.stop=function(){this.track.stop(),_super.prototype.stop.call(this)},MediaTrackTransceiver}(__webpack_require__("Jhn5"));module.exports=MediaTrackTransceiver},uqca:function(module,exports,__webpack_require__){"use strict";var Filter=__webpack_require__("mv6w"),IceBox=function(){function IceBox(){Object.defineProperties(this,{_filter:{value:new Filter({getKey:function(iceState){return iceState.ufrag},isLessThanOrEqualTo:function(a,b){return a.revision<=b.revision}})},_ufrag:{writable:!0,value:null},ufrag:{enumerable:!0,get:function(){return this._ufrag}}})}return IceBox.prototype.setUfrag=function(ufrag){this._ufrag=ufrag;var ice=this._filter.toMap().get(ufrag);return ice?ice.candidates:[]},IceBox.prototype.update=function(iceState){iceState.candidates=iceState.candidates||[];var oldIceState=this._filter.toMap().get(iceState.ufrag),oldCandidates=oldIceState?oldIceState.candidates:[];return this._filter.update(iceState)&&this._ufrag===iceState.ufrag?iceState.candidates.slice(oldCandidates.length):[]},IceBox}();module.exports=IceBox},uxdj:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),_a=__webpack_require__("mIkg"),guessBrowser=_a.guessBrowser,isIOSChrome=_a.isIOSChrome,detectSilentVideo=__webpack_require__("+OFx"),mixinLocalMediaTrack=__webpack_require__("aQcx"),VideoTrack=__webpack_require__("9FmL"),isUserMediaTrack=__webpack_require__("ghd6").isUserMediaTrack,LocalVideoTrack=function(_super){function LocalVideoTrack(mediaStreamTrack,options){var _this=this;return options=Object.assign({workaroundSilentLocalVideo:("safari"===guessBrowser()||isIOSChrome())&&isUserMediaTrack(mediaStreamTrack)&&"undefined"!=typeof document&&"function"==typeof document.createElement},options),_this=_super.call(this,mediaStreamTrack,options)||this,Object.defineProperties(_this,{_workaroundSilentLocalVideo:{value:options.workaroundSilentLocalVideo?workaroundSilentLocalVideo:null},_workaroundSilentLocalVideoCleanup:{value:null,writable:!0}}),_this._workaroundSilentLocalVideo&&(_this._workaroundSilentLocalVideoCleanup=_this._workaroundSilentLocalVideo(_this,document)),_this}return __extends(LocalVideoTrack,_super),LocalVideoTrack.prototype.toString=function(){return"[LocalVideoTrack #"+this._instanceId+": "+this.id+"]"},LocalVideoTrack.prototype._checkIfCanCaptureFrames=function(){return _super.prototype._checkIfCanCaptureFrames.call(this,this._trackSender.isPublishing)},LocalVideoTrack.prototype._end=function(){return _super.prototype._end.apply(this,arguments)},LocalVideoTrack.prototype._setSenderMediaStreamTrack=function(useProcessed){var _this=this,unprocessedTrack=this.mediaStreamTrack,mediaStreamTrack=useProcessed?this.processedTrack:unprocessedTrack;return this._trackSender.setMediaStreamTrack(mediaStreamTrack).catch((function(error){return _this._log.warn("setMediaStreamTrack failed on LocalVideoTrack RTCRtpSender",{error:error,mediaStreamTrack:mediaStreamTrack})})).then((function(){_this._unprocessedTrack=useProcessed?unprocessedTrack:null}))},LocalVideoTrack.prototype.addProcessor=function(){this._log.debug("Adding VideoProcessor to the LocalVideoTrack");var result=_super.prototype.addProcessor.apply(this,arguments);return this.processedTrack?(this._log.debug("Updating LocalVideoTrack's MediaStreamTrack with the processed MediaStreamTrack",this.processedTrack),this._setSenderMediaStreamTrack(!0),result):this._log.warn("Unable to add a VideoProcessor to the LocalVideoTrack")},LocalVideoTrack.prototype.removeProcessor=function(){var _this=this;this._log.debug("Removing VideoProcessor from the LocalVideoTrack");var result=_super.prototype.removeProcessor.apply(this,arguments);return this._log.debug("Updating LocalVideoTrack's MediaStreamTrack with the original MediaStreamTrack"),this._setSenderMediaStreamTrack().then((function(){return _this._updateElementsMediaStreamTrack()})),result},LocalVideoTrack.prototype.disable=function(){var result=_super.prototype.disable.apply(this,arguments);return this.processedTrack&&(this.processedTrack.enabled=!1),result},LocalVideoTrack.prototype.enable=function(enabled){void 0===enabled&&(enabled=!0);var result=_super.prototype.enable.apply(this,arguments);return this.processedTrack&&(this.processedTrack.enabled=enabled,enabled&&(this._captureFrames(),this._log.debug("Updating LocalVideoTrack's MediaStreamTrack with the processed MediaStreamTrack",this.processedTrack),this._setSenderMediaStreamTrack(!0))),result},LocalVideoTrack.prototype.restart=function(){var _this=this;this._workaroundSilentLocalVideoCleanup&&(this._workaroundSilentLocalVideoCleanup(),this._workaroundSilentLocalVideoCleanup=null);var promise=_super.prototype.restart.apply(this,arguments);return this.processor&&promise.then((function(){_this._restartProcessor()})),this._workaroundSilentLocalVideo&&promise.finally((function(){_this._workaroundSilentLocalVideoCleanup=_this._workaroundSilentLocalVideo(_this,document)})),promise},LocalVideoTrack.prototype.stop=function(){return this._workaroundSilentLocalVideoCleanup&&(this._workaroundSilentLocalVideoCleanup(),this._workaroundSilentLocalVideoCleanup=null),_super.prototype.stop.apply(this,arguments)},LocalVideoTrack}(mixinLocalMediaTrack(VideoTrack));function workaroundSilentLocalVideo(localVideoTrack,doc){var log=localVideoTrack._log,el=localVideoTrack._dummyEl,mediaStreamTrack=localVideoTrack.mediaStreamTrack;function onUnmute(){localVideoTrack.isEnabled&&(log.info("Unmuted, checking silence"),el.play().then((function(){return detectSilentVideo(el,doc)})).then((function(isSilent){if(isSilent)return log.warn("Silence detected, restarting"),localVideoTrack._stop(),localVideoTrack._restart();log.info("Non-silent frames detected, so no need to restart")})).catch((function(error){log.warn("Failed to detect silence and restart:",error)})).finally((function(){(el=localVideoTrack._dummyEl).paused||el.pause(),mediaStreamTrack.removeEventListener("unmute",onUnmute),(mediaStreamTrack=localVideoTrack.mediaStreamTrack).addEventListener("unmute",onUnmute)})))}return mediaStreamTrack.addEventListener("unmute",onUnmute),function(){mediaStreamTrack.removeEventListener("unmute",onUnmute)}}module.exports=LocalVideoTrack},v61W:function(module,exports){var hasOwn=Object.prototype.hasOwnProperty,toString=Object.prototype.toString;module.exports=function(obj,fn,ctx){if("[object Function]"!==toString.call(fn))throw new TypeError("iterator must be a function");var l=obj.length;if(l===+l)for(var i=0;i<l;i++)fn.call(ctx,obj[i],i,obj);else for(var k in obj)hasOwn.call(obj,k)&&fn.call(ctx,obj[k],k,obj)}},vaDk:function(module,exports){module.exports=WebSocket},wAda:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),defaultCreateCancelableRoomSignalingPromise=__webpack_require__("Kg6A"),LocalParticipantV2=__webpack_require__("QB7E"),SignalingV2=function(_super){function SignalingV2(wsServer,options){var _this;return options=Object.assign({createCancelableRoomSignalingPromise:defaultCreateCancelableRoomSignalingPromise},options),_this=_super.call(this)||this,Object.defineProperties(_this,{_createCancelableRoomSignalingPromise:{value:options.createCancelableRoomSignalingPromise},_options:{value:options},_wsServer:{value:wsServer}}),_this}return __extends(SignalingV2,_super),SignalingV2.prototype._connect=function(localParticipant,token,encodingParameters,preferredCodecs,options){return options=Object.assign({},this._options,options),this._createCancelableRoomSignalingPromise.bind(null,token,this._wsServer,localParticipant,encodingParameters,preferredCodecs,options)},SignalingV2.prototype.createLocalParticipantSignaling=function(encodingParameters,networkQualityConfiguration){return new LocalParticipantV2(encodingParameters,networkQualityConfiguration)},SignalingV2}(__webpack_require__("HHTs"));module.exports=SignalingV2},wl3V:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),RecordingSignaling=function(_super){function RecordingSignaling(){var _this=_super.call(this)||this;return Object.defineProperties(_this,{_isEnabled:{value:null,writable:!0},isEnabled:{enumerable:!0,get:function(){return this._isEnabled}}}),_this}return __extends(RecordingSignaling,_super),RecordingSignaling.prototype.disable=function(){return this.enable(!1)},RecordingSignaling.prototype.enable=function(enabled){return this.isEnabled!==(enabled="boolean"!=typeof enabled||enabled)&&(this._isEnabled=enabled,this.emit("updated")),this},RecordingSignaling}(__webpack_require__("+qE3").EventEmitter);module.exports=RecordingSignaling},wxsB:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),AudioTrack=function(_super){function AudioTrack(mediaTrackTransceiver,options){return _super.call(this,mediaTrackTransceiver,options)||this}return __extends(AudioTrack,_super),AudioTrack.prototype._start=function(){_super.prototype._start.call(this),this._dummyEl&&(this._dummyEl.srcObject=null,this._dummyEl=null)},AudioTrack.prototype.attach=function(){return _super.prototype.attach.apply(this,arguments)},AudioTrack.prototype.detach=function(){return _super.prototype.detach.apply(this,arguments)},AudioTrack}(__webpack_require__("B32u"));module.exports=AudioTrack},x3fV:function(module,exports,__webpack_require__){"use strict";if("function"==typeof RTCPeerConnection)switch((0,__webpack_require__("mIkg").guessBrowser)()){case"chrome":module.exports=__webpack_require__("BG0f");break;case"firefox":module.exports=__webpack_require__("qnQj");break;case"safari":module.exports=__webpack_require__("R2/C");break;default:module.exports=RTCPeerConnection}else module.exports=function(){throw new Error("RTCPeerConnection is not supported")}},xVU0:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),RemoteTrackPublicationV2=function(_super){function RemoteTrackPublicationV2(track,isSwitchedOff){return _super.call(this,track.sid,track.name,track.kind,track.enabled,track.priority,isSwitchedOff)||this}return __extends(RemoteTrackPublicationV2,_super),RemoteTrackPublicationV2.prototype.update=function(track){return this.enable(track.enabled),this.setPriority(track.priority),this},RemoteTrackPublicationV2}(__webpack_require__("WHMX"));module.exports=RemoteTrackPublicationV2},xwWy:function(module,exports,__webpack_require__){"use strict";var packageInfo=__webpack_require__("iqXr");module.exports.SDK_NAME=packageInfo.name+".js",module.exports.SDK_VERSION=packageInfo.version,module.exports.SDP_FORMAT="unified",module.exports.DEFAULT_ENVIRONMENT="prod",module.exports.DEFAULT_REALM="us1",module.exports.DEFAULT_REGION="gll",module.exports.DEFAULT_LOG_LEVEL="warn",module.exports.DEFAULT_LOGGER_NAME="twilio-video",module.exports.WS_SERVER=function(environment,region){return region="gll"===region?"global":encodeURIComponent(region),"prod"===environment?"wss://"+region+".vss.twilio.com/signaling":"wss://"+region+".vss."+environment+".twilio.com/signaling"},module.exports.PUBLISH_MAX_ATTEMPTS=5,module.exports.PUBLISH_BACKOFF_JITTER=10,module.exports.PUBLISH_BACKOFF_MS=20,module.exports.typeErrors={ILLEGAL_INVOKE:function(name,context){return new TypeError("Illegal call to "+name+": "+context)},INVALID_TYPE:function(name,type){return new TypeError(name+" must be "+(["a","e","i","o","u"].includes(type.toLowerCase()[0])?"an":"a")+" "+type)},INVALID_VALUE:function(name,values){return new RangeError(name+" must be one of "+values.join(", "))},REQUIRED_ARGUMENT:function(name){return new TypeError(name+" must be specified")}},module.exports.DEFAULT_FRAME_RATE=24,module.exports.DEFAULT_VIDEO_PROCESSOR_STATS_INTERVAL_MS=1e4,module.exports.DEFAULT_ICE_GATHERING_TIMEOUT_MS=15e3,module.exports.DEFAULT_SESSION_TIMEOUT_SEC=30,module.exports.DEFAULT_NQ_LEVEL_LOCAL=1,module.exports.DEFAULT_NQ_LEVEL_REMOTE=0,module.exports.MAX_NQ_LEVEL=3,module.exports.ICE_ACTIVITY_CHECK_PERIOD_MS=1e3,module.exports.ICE_INACTIVITY_THRESHOLD_MS=3e3,module.exports.iceRestartBackoffConfig={factor:1.1,initialDelay:1,maxDelay:1e3*module.exports.DEFAULT_SESSION_TIMEOUT_SEC,randomisationFactor:.5},module.exports.reconnectBackoffConfig={factor:1.5,initialDelay:80,randomisationFactor:.5},module.exports.subscriptionMode={MODE_COLLABORATION:"collaboration",MODE_GRID:"grid",MODE_PRESENTATION:"presentation"},module.exports.trackSwitchOffMode={MODE_DISABLED:"disabled",MODE_DETECTED:"detected",MODE_PREDICTED:"predicted"},module.exports.trackPriority={PRIORITY_HIGH:"high",PRIORITY_LOW:"low",PRIORITY_STANDARD:"standard"},module.exports.clientTrackSwitchOffControl={MODE_AUTO:"auto",MODE_MANUAL:"manual"},module.exports.videoContentPreferencesMode={MODE_AUTO:"auto",MODE_MANUAL:"manual"}},yTCf:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),RemoteAudioTrackStats=function(_super){function RemoteAudioTrackStats(trackId,statsReport){var _this=_super.call(this,trackId,statsReport)||this;return Object.defineProperties(_this,{audioLevel:{value:"number"==typeof statsReport.audioOutputLevel?statsReport.audioOutputLevel:null,enumerable:!0},jitter:{value:"number"==typeof statsReport.jitter?statsReport.jitter:null,enumerable:!0}}),_this}return __extends(RemoteAudioTrackStats,_super),RemoteAudioTrackStats}(__webpack_require__("i99/"));module.exports=RemoteAudioTrackStats},z1nD:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),Track=__webpack_require__("NCuz"),DefaultDataTrackSender=__webpack_require__("QH9v"),LocalDataTrack=function(_super){function LocalDataTrack(options){var _this,dataTrackSender=new(0,(options=Object.assign({DataTrackSender:DefaultDataTrackSender,maxPacketLifeTime:null,maxRetransmits:null,ordered:!0},options)).DataTrackSender)(options.maxPacketLifeTime,options.maxRetransmits,options.ordered);return _this=_super.call(this,dataTrackSender.id,"data",options)||this,Object.defineProperties(_this,{_trackSender:{value:dataTrackSender},id:{enumerable:!0,value:dataTrackSender.id},maxPacketLifeTime:{enumerable:!0,value:options.maxPacketLifeTime},maxRetransmits:{enumerable:!0,value:options.maxRetransmits},ordered:{enumerable:!0,value:options.ordered},reliable:{enumerable:!0,value:null===options.maxPacketLifeTime&&null===options.maxRetransmits}}),_this}return __extends(LocalDataTrack,_super),LocalDataTrack.prototype.send=function(data){this._trackSender.send(data)},LocalDataTrack}(Track);module.exports=LocalDataTrack},zMHY:function(module,exports,__webpack_require__){module.exports=__webpack_require__("HNxM")},zUnb:function(module,__webpack_exports__,__webpack_require__){"use strict";function isFunction(x){return"function"==typeof x}__webpack_require__.r(__webpack_exports__);let _enable_super_gross_mode_that_will_cause_bad_things=!1;const config_config={Promise:void 0,set useDeprecatedSynchronousErrorHandling(value){if(value){const error=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+error.stack)}else _enable_super_gross_mode_that_will_cause_bad_things&&console.log("RxJS: Back to a better error behavior. Thank you. <3");_enable_super_gross_mode_that_will_cause_bad_things=value},get useDeprecatedSynchronousErrorHandling(){return _enable_super_gross_mode_that_will_cause_bad_things}};function hostReportError(err){setTimeout(()=>{throw err},0)}const empty={closed:!0,next(value){},error(err){if(config_config.useDeprecatedSynchronousErrorHandling)throw err;hostReportError(err)},complete(){}},isArray=(()=>Array.isArray||(x=>x&&"number"==typeof x.length))();function isObject(x){return null!==x&&"object"==typeof x}const UnsubscriptionError=(()=>{function UnsubscriptionErrorImpl(errors){return Error.call(this),this.message=errors?`${errors.length} errors occurred during unsubscription:\n${errors.map((err,i)=>`${i+1}) ${err.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=errors,this}return UnsubscriptionErrorImpl.prototype=Object.create(Error.prototype),UnsubscriptionErrorImpl})();let Subscription_Subscription=(()=>{class Subscription{constructor(unsubscribe){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,unsubscribe&&(this._ctorUnsubscribe=!0,this._unsubscribe=unsubscribe)}unsubscribe(){let errors;if(this.closed)return;let{_parentOrParents:_parentOrParents,_ctorUnsubscribe:_ctorUnsubscribe,_unsubscribe:_unsubscribe,_subscriptions:_subscriptions}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,_parentOrParents instanceof Subscription)_parentOrParents.remove(this);else if(null!==_parentOrParents)for(let index=0;index<_parentOrParents.length;++index)_parentOrParents[index].remove(this);if(isFunction(_unsubscribe)){_ctorUnsubscribe&&(this._unsubscribe=void 0);try{_unsubscribe.call(this)}catch(e){errors=e instanceof UnsubscriptionError?flattenUnsubscriptionErrors(e.errors):[e]}}if(isArray(_subscriptions)){let index=-1,len=_subscriptions.length;for(;++index<len;){const sub=_subscriptions[index];if(isObject(sub))try{sub.unsubscribe()}catch(e){errors=errors||[],e instanceof UnsubscriptionError?errors=errors.concat(flattenUnsubscriptionErrors(e.errors)):errors.push(e)}}}if(errors)throw new UnsubscriptionError(errors)}add(teardown){let subscription=teardown;if(!teardown)return Subscription.EMPTY;switch(typeof teardown){case"function":subscription=new Subscription(teardown);case"object":if(subscription===this||subscription.closed||"function"!=typeof subscription.unsubscribe)return subscription;if(this.closed)return subscription.unsubscribe(),subscription;if(!(subscription instanceof Subscription)){const tmp=subscription;subscription=new Subscription,subscription._subscriptions=[tmp]}break;default:throw new Error("unrecognized teardown "+teardown+" added to Subscription.")}let{_parentOrParents:_parentOrParents}=subscription;if(null===_parentOrParents)subscription._parentOrParents=this;else if(_parentOrParents instanceof Subscription){if(_parentOrParents===this)return subscription;subscription._parentOrParents=[_parentOrParents,this]}else{if(-1!==_parentOrParents.indexOf(this))return subscription;_parentOrParents.push(this)}const subscriptions=this._subscriptions;return null===subscriptions?this._subscriptions=[subscription]:subscriptions.push(subscription),subscription}remove(subscription){const subscriptions=this._subscriptions;if(subscriptions){const subscriptionIndex=subscriptions.indexOf(subscription);-1!==subscriptionIndex&&subscriptions.splice(subscriptionIndex,1)}}}return Subscription.EMPTY=function(empty){return empty.closed=!0,empty}(new Subscription),Subscription})();function flattenUnsubscriptionErrors(errors){return errors.reduce((errs,err)=>errs.concat(err instanceof UnsubscriptionError?err.errors:err),[])}const rxSubscriber=(()=>"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random())();class Subscriber_Subscriber extends Subscription_Subscription{constructor(destinationOrNext,error,complete){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=empty;break;case 1:if(!destinationOrNext){this.destination=empty;break}if("object"==typeof destinationOrNext){destinationOrNext instanceof Subscriber_Subscriber?(this.syncErrorThrowable=destinationOrNext.syncErrorThrowable,this.destination=destinationOrNext,destinationOrNext.add(this)):(this.syncErrorThrowable=!0,this.destination=new Subscriber_SafeSubscriber(this,destinationOrNext));break}default:this.syncErrorThrowable=!0,this.destination=new Subscriber_SafeSubscriber(this,destinationOrNext,error,complete)}}[rxSubscriber](){return this}static create(next,error,complete){const subscriber=new Subscriber_Subscriber(next,error,complete);return subscriber.syncErrorThrowable=!1,subscriber}next(value){this.isStopped||this._next(value)}error(err){this.isStopped||(this.isStopped=!0,this._error(err))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(value){this.destination.next(value)}_error(err){this.destination.error(err),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:_parentOrParents}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=_parentOrParents,this}}class Subscriber_SafeSubscriber extends Subscriber_Subscriber{constructor(_parentSubscriber,observerOrNext,error,complete){let next;super(),this._parentSubscriber=_parentSubscriber;let context=this;isFunction(observerOrNext)?next=observerOrNext:observerOrNext&&(next=observerOrNext.next,error=observerOrNext.error,complete=observerOrNext.complete,observerOrNext!==empty&&(context=Object.create(observerOrNext),isFunction(context.unsubscribe)&&this.add(context.unsubscribe.bind(context)),context.unsubscribe=this.unsubscribe.bind(this))),this._context=context,this._next=next,this._error=error,this._complete=complete}next(value){if(!this.isStopped&&this._next){const{_parentSubscriber:_parentSubscriber}=this;config_config.useDeprecatedSynchronousErrorHandling&&_parentSubscriber.syncErrorThrowable?this.__tryOrSetError(_parentSubscriber,this._next,value)&&this.unsubscribe():this.__tryOrUnsub(this._next,value)}}error(err){if(!this.isStopped){const{_parentSubscriber:_parentSubscriber}=this,{useDeprecatedSynchronousErrorHandling:useDeprecatedSynchronousErrorHandling}=config_config;if(this._error)useDeprecatedSynchronousErrorHandling&&_parentSubscriber.syncErrorThrowable?(this.__tryOrSetError(_parentSubscriber,this._error,err),this.unsubscribe()):(this.__tryOrUnsub(this._error,err),this.unsubscribe());else if(_parentSubscriber.syncErrorThrowable)useDeprecatedSynchronousErrorHandling?(_parentSubscriber.syncErrorValue=err,_parentSubscriber.syncErrorThrown=!0):hostReportError(err),this.unsubscribe();else{if(this.unsubscribe(),useDeprecatedSynchronousErrorHandling)throw err;hostReportError(err)}}}complete(){if(!this.isStopped){const{_parentSubscriber:_parentSubscriber}=this;if(this._complete){const wrappedComplete=()=>this._complete.call(this._context);config_config.useDeprecatedSynchronousErrorHandling&&_parentSubscriber.syncErrorThrowable?(this.__tryOrSetError(_parentSubscriber,wrappedComplete),this.unsubscribe()):(this.__tryOrUnsub(wrappedComplete),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(fn,value){try{fn.call(this._context,value)}catch(err){if(this.unsubscribe(),config_config.useDeprecatedSynchronousErrorHandling)throw err;hostReportError(err)}}__tryOrSetError(parent,fn,value){if(!config_config.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{fn.call(this._context,value)}catch(err){return config_config.useDeprecatedSynchronousErrorHandling?(parent.syncErrorValue=err,parent.syncErrorThrown=!0,!0):(hostReportError(err),!0)}return!1}_unsubscribe(){const{_parentSubscriber:_parentSubscriber}=this;this._context=null,this._parentSubscriber=null,_parentSubscriber.unsubscribe()}}const observable_observable=(()=>"function"==typeof Symbol&&Symbol.observable||"@@observable")();function identity(x){return x}function pipe(...fns){return pipeFromArray(fns)}function pipeFromArray(fns){return 0===fns.length?identity:1===fns.length?fns[0]:function(input){return fns.reduce((prev,fn)=>fn(prev),input)}}let Observable_Observable=(()=>{class Observable{constructor(subscribe){this._isScalar=!1,subscribe&&(this._subscribe=subscribe)}lift(operator){const observable=new Observable;return observable.source=this,observable.operator=operator,observable}subscribe(observerOrNext,error,complete){const{operator:operator}=this,sink=function(nextOrObserver,error,complete){if(nextOrObserver){if(nextOrObserver instanceof Subscriber_Subscriber)return nextOrObserver;if(nextOrObserver[rxSubscriber])return nextOrObserver[rxSubscriber]()}return nextOrObserver||error||complete?new Subscriber_Subscriber(nextOrObserver,error,complete):new Subscriber_Subscriber(empty)}(observerOrNext,error,complete);if(sink.add(operator?operator.call(sink,this.source):this.source||config_config.useDeprecatedSynchronousErrorHandling&&!sink.syncErrorThrowable?this._subscribe(sink):this._trySubscribe(sink)),config_config.useDeprecatedSynchronousErrorHandling&&sink.syncErrorThrowable&&(sink.syncErrorThrowable=!1,sink.syncErrorThrown))throw sink.syncErrorValue;return sink}_trySubscribe(sink){try{return this._subscribe(sink)}catch(err){config_config.useDeprecatedSynchronousErrorHandling&&(sink.syncErrorThrown=!0,sink.syncErrorValue=err),function(observer){for(;observer;){const{closed:closed,destination:destination,isStopped:isStopped}=observer;if(closed||isStopped)return!1;observer=destination&&destination instanceof Subscriber_Subscriber?destination:null}return!0}(sink)?sink.error(err):console.warn(err)}}forEach(next,promiseCtor){return new(promiseCtor=getPromiseCtor(promiseCtor))((resolve,reject)=>{let subscription;subscription=this.subscribe(value=>{try{next(value)}catch(err){reject(err),subscription&&subscription.unsubscribe()}},reject,resolve)})}_subscribe(subscriber){const{source:source}=this;return source&&source.subscribe(subscriber)}[observable_observable](){return this}pipe(...operations){return 0===operations.length?this:pipeFromArray(operations)(this)}toPromise(promiseCtor){return new(promiseCtor=getPromiseCtor(promiseCtor))((resolve,reject)=>{let value;this.subscribe(x=>value=x,err=>reject(err),()=>resolve(value))})}}return Observable.create=subscribe=>new Observable(subscribe),Observable})();function getPromiseCtor(promiseCtor){if(promiseCtor||(promiseCtor=config_config.Promise||Promise),!promiseCtor)throw new Error("no Promise impl found");return promiseCtor}const ObjectUnsubscribedError=(()=>{function ObjectUnsubscribedErrorImpl(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return ObjectUnsubscribedErrorImpl.prototype=Object.create(Error.prototype),ObjectUnsubscribedErrorImpl})();class SubjectSubscription_SubjectSubscription extends Subscription_Subscription{constructor(subject,subscriber){super(),this.subject=subject,this.subscriber=subscriber,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const subject=this.subject,observers=subject.observers;if(this.subject=null,!observers||0===observers.length||subject.isStopped||subject.closed)return;const subscriberIndex=observers.indexOf(this.subscriber);-1!==subscriberIndex&&observers.splice(subscriberIndex,1)}}class Subject_SubjectSubscriber extends Subscriber_Subscriber{constructor(destination){super(destination),this.destination=destination}}let Subject_Subject=(()=>{class Subject extends Observable_Observable{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[rxSubscriber](){return new Subject_SubjectSubscriber(this)}lift(operator){const subject=new Subject_AnonymousSubject(this,this);return subject.operator=operator,subject}next(value){if(this.closed)throw new ObjectUnsubscribedError;if(!this.isStopped){const{observers:observers}=this,len=observers.length,copy=observers.slice();for(let i=0;i<len;i++)copy[i].next(value)}}error(err){if(this.closed)throw new ObjectUnsubscribedError;this.hasError=!0,this.thrownError=err,this.isStopped=!0;const{observers:observers}=this,len=observers.length,copy=observers.slice();for(let i=0;i<len;i++)copy[i].error(err);this.observers.length=0}complete(){if(this.closed)throw new ObjectUnsubscribedError;this.isStopped=!0;const{observers:observers}=this,len=observers.length,copy=observers.slice();for(let i=0;i<len;i++)copy[i].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(subscriber){if(this.closed)throw new ObjectUnsubscribedError;return super._trySubscribe(subscriber)}_subscribe(subscriber){if(this.closed)throw new ObjectUnsubscribedError;return this.hasError?(subscriber.error(this.thrownError),Subscription_Subscription.EMPTY):this.isStopped?(subscriber.complete(),Subscription_Subscription.EMPTY):(this.observers.push(subscriber),new SubjectSubscription_SubjectSubscription(this,subscriber))}asObservable(){const observable=new Observable_Observable;return observable.source=this,observable}}return Subject.create=(destination,source)=>new Subject_AnonymousSubject(destination,source),Subject})();class Subject_AnonymousSubject extends Subject_Subject{constructor(destination,source){super(),this.destination=destination,this.source=source}next(value){const{destination:destination}=this;destination&&destination.next&&destination.next(value)}error(err){const{destination:destination}=this;destination&&destination.error&&this.destination.error(err)}complete(){const{destination:destination}=this;destination&&destination.complete&&this.destination.complete()}_subscribe(subscriber){const{source:source}=this;return source?this.source.subscribe(subscriber):Subscription_Subscription.EMPTY}}function isScheduler(value){return value&&"function"==typeof value.schedule}function map(project,thisArg){return function(source){if("function"!=typeof project)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return source.lift(new MapOperator(project,thisArg))}}class MapOperator{constructor(project,thisArg){this.project=project,this.thisArg=thisArg}call(subscriber,source){return source.subscribe(new map_MapSubscriber(subscriber,this.project,this.thisArg))}}class map_MapSubscriber extends Subscriber_Subscriber{constructor(destination,project,thisArg){super(destination),this.project=project,this.count=0,this.thisArg=thisArg||this}_next(value){let result;try{result=this.project.call(this.thisArg,value,this.count++)}catch(err){return void this.destination.error(err)}this.destination.next(result)}}const subscribeToArray=array=>subscriber=>{for(let i=0,len=array.length;i<len&&!subscriber.closed;i++)subscriber.next(array[i]);subscriber.complete()};function getSymbolIterator(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}const iterator_iterator=getSymbolIterator(),isArrayLike=x=>x&&"number"==typeof x.length&&"function"!=typeof x;function isPromise(value){return!!value&&"function"!=typeof value.subscribe&&"function"==typeof value.then}const subscribeTo=result=>{if(result&&"function"==typeof result[observable_observable])return obj=result,subscriber=>{const obs=obj[observable_observable]();if("function"!=typeof obs.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return obs.subscribe(subscriber)};if(isArrayLike(result))return subscribeToArray(result);if(isPromise(result))return promise=result,subscriber=>(promise.then(value=>{subscriber.closed||(subscriber.next(value),subscriber.complete())},err=>subscriber.error(err)).then(null,hostReportError),subscriber);if(result&&"function"==typeof result[iterator_iterator])return iterable=result,subscriber=>{const iterator=iterable[iterator_iterator]();for(;;){let item;try{item=iterator.next()}catch(err){return subscriber.error(err),subscriber}if(item.done){subscriber.complete();break}if(subscriber.next(item.value),subscriber.closed)break}return"function"==typeof iterator.return&&subscriber.add(()=>{iterator.return&&iterator.return()}),subscriber};{const value=isObject(result)?"an invalid object":`'${result}'`;throw new TypeError(`You provided ${value} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`)}var iterable,promise,obj};function scheduleArray(input,scheduler){return new Observable_Observable(subscriber=>{const sub=new Subscription_Subscription;let i=0;return sub.add(scheduler.schedule((function(){i!==input.length?(subscriber.next(input[i++]),subscriber.closed||sub.add(this.schedule())):subscriber.complete()}))),sub})}function from(input,scheduler){return scheduler?function(input,scheduler){if(null!=input){if(function(input){return input&&"function"==typeof input[observable_observable]}(input))return function(input,scheduler){return new Observable_Observable(subscriber=>{const sub=new Subscription_Subscription;return sub.add(scheduler.schedule(()=>{const observable=input[observable_observable]();sub.add(observable.subscribe({next(value){sub.add(scheduler.schedule(()=>subscriber.next(value)))},error(err){sub.add(scheduler.schedule(()=>subscriber.error(err)))},complete(){sub.add(scheduler.schedule(()=>subscriber.complete()))}}))})),sub})}(input,scheduler);if(isPromise(input))return function(input,scheduler){return new Observable_Observable(subscriber=>{const sub=new Subscription_Subscription;return sub.add(scheduler.schedule(()=>input.then(value=>{sub.add(scheduler.schedule(()=>{subscriber.next(value),sub.add(scheduler.schedule(()=>subscriber.complete()))}))},err=>{sub.add(scheduler.schedule(()=>subscriber.error(err)))}))),sub})}(input,scheduler);if(isArrayLike(input))return scheduleArray(input,scheduler);if(function(input){return input&&"function"==typeof input[iterator_iterator]}(input)||"string"==typeof input)return function(input,scheduler){if(!input)throw new Error("Iterable cannot be null");return new Observable_Observable(subscriber=>{const sub=new Subscription_Subscription;let iterator;return sub.add(()=>{iterator&&"function"==typeof iterator.return&&iterator.return()}),sub.add(scheduler.schedule(()=>{iterator=input[iterator_iterator](),sub.add(scheduler.schedule((function(){if(subscriber.closed)return;let value,done;try{const result=iterator.next();value=result.value,done=result.done}catch(err){return void subscriber.error(err)}done?subscriber.complete():(subscriber.next(value),this.schedule())})))})),sub})}(input,scheduler)}throw new TypeError((null!==input&&typeof input||input)+" is not observable")}(input,scheduler):input instanceof Observable_Observable?input:new Observable_Observable(subscribeTo(input))}class innerSubscribe_SimpleInnerSubscriber extends Subscriber_Subscriber{constructor(parent){super(),this.parent=parent}_next(value){this.parent.notifyNext(value)}_error(error){this.parent.notifyError(error),this.unsubscribe()}_complete(){this.parent.notifyComplete(),this.unsubscribe()}}class innerSubscribe_SimpleOuterSubscriber extends Subscriber_Subscriber{notifyNext(innerValue){this.destination.next(innerValue)}notifyError(err){this.destination.error(err)}notifyComplete(){this.destination.complete()}}function innerSubscribe(result,innerSubscriber){if(innerSubscriber.closed)return;if(result instanceof Observable_Observable)return result.subscribe(innerSubscriber);let subscription;try{subscription=subscribeTo(result)(innerSubscriber)}catch(error){innerSubscriber.error(error)}return subscription}function mergeMap(project,resultSelector,concurrent=Number.POSITIVE_INFINITY){return"function"==typeof resultSelector?source=>source.pipe(mergeMap((a,i)=>from(project(a,i)).pipe(map((b,ii)=>resultSelector(a,b,i,ii))),concurrent)):("number"==typeof resultSelector&&(concurrent=resultSelector),source=>source.lift(new MergeMapOperator(project,concurrent)))}class MergeMapOperator{constructor(project,concurrent=Number.POSITIVE_INFINITY){this.project=project,this.concurrent=concurrent}call(observer,source){return source.subscribe(new mergeMap_MergeMapSubscriber(observer,this.project,this.concurrent))}}class mergeMap_MergeMapSubscriber extends innerSubscribe_SimpleOuterSubscriber{constructor(destination,project,concurrent=Number.POSITIVE_INFINITY){super(destination),this.project=project,this.concurrent=concurrent,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(value){this.active<this.concurrent?this._tryNext(value):this.buffer.push(value)}_tryNext(value){let result;const index=this.index++;try{result=this.project(value,index)}catch(err){return void this.destination.error(err)}this.active++,this._innerSub(result)}_innerSub(ish){const innerSubscriber=new innerSubscribe_SimpleInnerSubscriber(this),destination=this.destination;destination.add(innerSubscriber);const innerSubscription=innerSubscribe(ish,innerSubscriber);innerSubscription!==innerSubscriber&&destination.add(innerSubscription)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(innerValue){this.destination.next(innerValue)}notifyComplete(){const buffer=this.buffer;this.active--,buffer.length>0?this._next(buffer.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function mergeAll(concurrent=Number.POSITIVE_INFINITY){return mergeMap(identity,concurrent)}function fromArray(input,scheduler){return scheduler?scheduleArray(input,scheduler):new Observable_Observable(subscribeToArray(input))}function refCount(){return function(source){return source.lift(new RefCountOperator(source))}}class RefCountOperator{constructor(connectable){this.connectable=connectable}call(subscriber,source){const{connectable:connectable}=this;connectable._refCount++;const refCounter=new refCount_RefCountSubscriber(subscriber,connectable),subscription=source.subscribe(refCounter);return refCounter.closed||(refCounter.connection=connectable.connect()),subscription}}class refCount_RefCountSubscriber extends Subscriber_Subscriber{constructor(destination,connectable){super(destination),this.connectable=connectable}_unsubscribe(){const{connectable:connectable}=this;if(!connectable)return void(this.connection=null);this.connectable=null;const refCount=connectable._refCount;if(refCount<=0)return void(this.connection=null);if(connectable._refCount=refCount-1,refCount>1)return void(this.connection=null);const{connection:connection}=this,sharedConnection=connectable._connection;this.connection=null,!sharedConnection||connection&&sharedConnection!==connection||sharedConnection.unsubscribe()}}class ConnectableObservable_ConnectableObservable extends Observable_Observable{constructor(source,subjectFactory){super(),this.source=source,this.subjectFactory=subjectFactory,this._refCount=0,this._isComplete=!1}_subscribe(subscriber){return this.getSubject().subscribe(subscriber)}getSubject(){const subject=this._subject;return subject&&!subject.isStopped||(this._subject=this.subjectFactory()),this._subject}connect(){let connection=this._connection;return connection||(this._isComplete=!1,connection=this._connection=new Subscription_Subscription,connection.add(this.source.subscribe(new ConnectableObservable_ConnectableSubscriber(this.getSubject(),this))),connection.closed&&(this._connection=null,connection=Subscription_Subscription.EMPTY)),connection}refCount(){return refCount()(this)}}const connectableObservableDescriptor=(()=>{const connectableProto=ConnectableObservable_ConnectableObservable.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:connectableProto._subscribe},_isComplete:{value:connectableProto._isComplete,writable:!0},getSubject:{value:connectableProto.getSubject},connect:{value:connectableProto.connect},refCount:{value:connectableProto.refCount}}})();class ConnectableObservable_ConnectableSubscriber extends Subject_SubjectSubscriber{constructor(destination,connectable){super(destination),this.connectable=connectable}_error(err){this._unsubscribe(),super._error(err)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const connectable=this.connectable;if(connectable){this.connectable=null;const connection=connectable._connection;connectable._refCount=0,connectable._subject=null,connectable._connection=null,connection&&connection.unsubscribe()}}}function shareSubjectFactory(){return new Subject_Subject}function makeParamDecorator(name,props,parentClass){const metaCtor=function(props){return function(...args){if(props){const values=props(...args);for(const propName in values)this[propName]=values[propName]}}}(props);function ParamDecoratorFactory(...args){if(this instanceof ParamDecoratorFactory)return metaCtor.apply(this,args),this;const annotationInstance=new ParamDecoratorFactory(...args);return ParamDecorator.annotation=annotationInstance,ParamDecorator;function ParamDecorator(cls,unusedKey,index){const parameters=cls.hasOwnProperty("__parameters__")?cls.__parameters__:Object.defineProperty(cls,"__parameters__",{value:[]}).__parameters__;for(;parameters.length<=index;)parameters.push(null);return(parameters[index]=parameters[index]||[]).push(annotationInstance),cls}}return parentClass&&(ParamDecoratorFactory.prototype=Object.create(parentClass.prototype)),ParamDecoratorFactory.prototype.ngMetadataName=name,ParamDecoratorFactory.annotationCls=ParamDecoratorFactory,ParamDecoratorFactory}const Inject=makeParamDecorator("Inject",token=>({token:token})),Optional=makeParamDecorator("Optional"),Self=makeParamDecorator("Self"),SkipSelf=makeParamDecorator("SkipSelf");var InjectFlags=function(InjectFlags){return InjectFlags[InjectFlags.Default=0]="Default",InjectFlags[InjectFlags.Host=1]="Host",InjectFlags[InjectFlags.Self=2]="Self",InjectFlags[InjectFlags.SkipSelf=4]="SkipSelf",InjectFlags[InjectFlags.Optional=8]="Optional",InjectFlags}({});function getClosureSafeProperty(objWithPropertyToExtract){for(let key in objWithPropertyToExtract)if(objWithPropertyToExtract[key]===getClosureSafeProperty)return key;throw Error("Could not find renamed property on target object.")}function ɵɵdefineInjectable(opts){return{token:opts.token,providedIn:opts.providedIn||null,factory:opts.factory,value:void 0}}function getInjectableDef(type){const def=type[NG_INJECTABLE_DEF];return def&&def.token===type?def:null}const NG_INJECTABLE_DEF=getClosureSafeProperty({ngInjectableDef:getClosureSafeProperty});function stringify(token){if("string"==typeof token)return token;if(token instanceof Array)return"["+token.map(stringify).join(", ")+"]";if(null==token)return""+token;if(token.overriddenName)return""+token.overriddenName;if(token.name)return""+token.name;const res=token.toString();if(null==res)return""+res;const newLineIndex=res.indexOf("\n");return-1===newLineIndex?res:res.substring(0,newLineIndex)}const __forward_ref__=getClosureSafeProperty({__forward_ref__:getClosureSafeProperty});function forwardRef(forwardRefFn){return forwardRefFn.__forward_ref__=forwardRef,forwardRefFn.toString=function(){return stringify(this())},forwardRefFn}function resolveForwardRef(type){const fn=type;return"function"==typeof fn&&fn.hasOwnProperty(__forward_ref__)&&fn.__forward_ref__===forwardRef?fn():type}const __globalThis="undefined"!=typeof globalThis&&globalThis,__window="undefined"!=typeof window&&window,__self="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,__global="undefined"!=typeof global&&global,_global=__globalThis||__global||__window||__self;class InjectionToken{constructor(_desc,options){this._desc=_desc,this.ngMetadataName="InjectionToken",this.ngInjectableDef=void 0,"number"==typeof options?this.__NG_ELEMENT_ID__=options:void 0!==options&&(this.ngInjectableDef=ɵɵdefineInjectable({token:this,providedIn:options.providedIn||"root",factory:options.factory}))}toString(){return"InjectionToken "+this._desc}}const INJECTOR=new InjectionToken("INJECTOR",-1),THROW_IF_NOT_FOUND=new Object,NEW_LINE=/\n/gm,USE_VALUE=getClosureSafeProperty({provide:String,useValue:getClosureSafeProperty});let _currentInjector=void 0;function setCurrentInjector(injector){const former=_currentInjector;return _currentInjector=injector,former}function ɵɵinject(token,flags=InjectFlags.Default){return function(token,flags=InjectFlags.Default){if(void 0===_currentInjector)throw new Error("inject() must be called from an injection context");return null===_currentInjector?function(token,notFoundValue,flags){const injectableDef=getInjectableDef(token);if(injectableDef&&"root"==injectableDef.providedIn)return void 0===injectableDef.value?injectableDef.value=injectableDef.factory():injectableDef.value;if(flags&InjectFlags.Optional)return null;throw new Error(`Injector: NOT_FOUND [${stringify(token)}]`)}(token,0,flags):_currentInjector.get(token,flags&InjectFlags.Optional?null:void 0,flags)}(token,flags)}class NullInjector{get(token,notFoundValue=THROW_IF_NOT_FOUND){if(notFoundValue===THROW_IF_NOT_FOUND){const error=new Error(`NullInjectorError: No provider for ${stringify(token)}!`);throw error.name="NullInjectorError",error}return notFoundValue}}function formatError(text,obj,injectorErrorName,source=null){text=text&&"\n"===text.charAt(0)&&"ɵ"==text.charAt(1)?text.substr(2):text;let context=stringify(obj);if(obj instanceof Array)context=obj.map(stringify).join(" -> ");else if("object"==typeof obj){let parts=[];for(let key in obj)if(obj.hasOwnProperty(key)){let value=obj[key];parts.push(key+":"+("string"==typeof value?JSON.stringify(value):stringify(value)))}context=`{${parts.join(", ")}}`}return`${injectorErrorName}${source?"("+source+")":""}[${context}]: ${text.replace(NEW_LINE,"\n  ")}`}class NgModuleRef{}class NgModuleFactory{}function addToArray(arr,index,value){index>=arr.length?arr.push(value):arr.splice(index,0,value)}function removeFromArray(arr,index){return index>=arr.length-1?arr.pop():arr.splice(index,1)[0]}const ViewEncapsulation=function(){var ViewEncapsulation={Emulated:0,Native:1,None:2,ShadowDom:3};return ViewEncapsulation[ViewEncapsulation.Emulated]="Emulated",ViewEncapsulation[ViewEncapsulation.Native]="Native",ViewEncapsulation[ViewEncapsulation.None]="None",ViewEncapsulation[ViewEncapsulation.ShadowDom]="ShadowDom",ViewEncapsulation}(),defaultScheduler=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(_global))();function getDebugContext(error){return error.ngDebugContext}function getOriginalError(error){return error.ngOriginalError}function defaultErrorLogger(console,...values){console.error(...values)}class ErrorHandler{constructor(){this._console=console}handleError(error){const originalError=this._findOriginalError(error),context=this._findContext(error),errorLogger=function(error){return error.ngErrorLogger||defaultErrorLogger}(error);errorLogger(this._console,"ERROR",error),originalError&&errorLogger(this._console,"ORIGINAL ERROR",originalError),context&&errorLogger(this._console,"ERROR CONTEXT",context)}_findContext(error){return error?getDebugContext(error)?getDebugContext(error):this._findContext(getOriginalError(error)):null}_findOriginalError(error){let e=getOriginalError(error);for(;e&&getOriginalError(e);)e=getOriginalError(e);return e}}let _devMode=!0,_runModeLocked=!1;function isDevMode(){return _runModeLocked=!0,_devMode}class InertBodyHelper{constructor(defaultDoc){if(this.defaultDoc=defaultDoc,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),this.inertBodyElement=this.inertDocument.body,null==this.inertBodyElement){const inertHtml=this.inertDocument.createElement("html");this.inertDocument.appendChild(inertHtml),this.inertBodyElement=this.inertDocument.createElement("body"),inertHtml.appendChild(this.inertBodyElement)}this.inertBodyElement.innerHTML='<svg><g onload="this.parentNode.remove()"></g></svg>',!this.inertBodyElement.querySelector||this.inertBodyElement.querySelector("svg")?(this.inertBodyElement.innerHTML='<svg><p><style><img src="</style><img src=x onerror=alert(1)//">',this.getInertBodyElement=this.inertBodyElement.querySelector&&this.inertBodyElement.querySelector("svg img")&&function(){try{return!!window.DOMParser}catch(_a){return!1}}()?this.getInertBodyElement_DOMParser:this.getInertBodyElement_InertDocument):this.getInertBodyElement=this.getInertBodyElement_XHR}getInertBodyElement_XHR(html){html="<body><remove></remove>"+html+"</body>";try{html=encodeURI(html)}catch(_a){return null}const xhr=new XMLHttpRequest;xhr.responseType="document",xhr.open("GET","data:text/html;charset=utf-8,"+html,!1),xhr.send(void 0);const body=xhr.response.body;return body.removeChild(body.firstChild),body}getInertBodyElement_DOMParser(html){html="<body><remove></remove>"+html+"</body>";try{const body=(new window.DOMParser).parseFromString(html,"text/html").body;return body.removeChild(body.firstChild),body}catch(_a){return null}}getInertBodyElement_InertDocument(html){const templateEl=this.inertDocument.createElement("template");return"content"in templateEl?(templateEl.innerHTML=html,templateEl):(this.inertBodyElement.innerHTML=html,this.defaultDoc.documentMode&&this.stripCustomNsAttrs(this.inertBodyElement),this.inertBodyElement)}stripCustomNsAttrs(el){const elAttrs=el.attributes;for(let i=elAttrs.length-1;0<i;i--){const attrName=elAttrs.item(i).name;"xmlns:ns1"!==attrName&&0!==attrName.indexOf("ns1:")||el.removeAttribute(attrName)}let childNode=el.firstChild;for(;childNode;)childNode.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(childNode),childNode=childNode.nextSibling}}const SAFE_URL_PATTERN=/^(?:(?:https?|mailto|ftp|tel|file):|[^&:/?#]*(?:[/?#]|$))/gi,DATA_URL_PATTERN=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function _sanitizeUrl(url){return(url=String(url)).match(SAFE_URL_PATTERN)||url.match(DATA_URL_PATTERN)?url:(isDevMode()&&console.warn(`WARNING: sanitizing unsafe URL value ${url} (see http://g.co/ng/security#xss)`),"unsafe:"+url)}function tagSet(tags){const res={};for(const t of tags.split(","))res[t]=!0;return res}function core_merge(...sets){const res={};for(const s of sets)for(const v in s)s.hasOwnProperty(v)&&(res[v]=!0);return res}const VOID_ELEMENTS=tagSet("area,br,col,hr,img,wbr"),OPTIONAL_END_TAG_BLOCK_ELEMENTS=tagSet("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),OPTIONAL_END_TAG_INLINE_ELEMENTS=tagSet("rp,rt"),OPTIONAL_END_TAG_ELEMENTS=core_merge(OPTIONAL_END_TAG_INLINE_ELEMENTS,OPTIONAL_END_TAG_BLOCK_ELEMENTS),VALID_ELEMENTS=core_merge(VOID_ELEMENTS,core_merge(OPTIONAL_END_TAG_BLOCK_ELEMENTS,tagSet("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),core_merge(OPTIONAL_END_TAG_INLINE_ELEMENTS,tagSet("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),OPTIONAL_END_TAG_ELEMENTS),URI_ATTRS=tagSet("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),SRCSET_ATTRS=tagSet("srcset"),VALID_ATTRS=core_merge(URI_ATTRS,SRCSET_ATTRS,tagSet("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),tagSet("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),SKIP_TRAVERSING_CONTENT_IF_INVALID_ELEMENTS=tagSet("script,style,template");class SanitizingHtmlSerializer{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(el){let current=el.firstChild,traverseContent=!0;for(;current;)if(current.nodeType===Node.ELEMENT_NODE?traverseContent=this.startElement(current):current.nodeType===Node.TEXT_NODE?this.chars(current.nodeValue):this.sanitizedSomething=!0,traverseContent&&current.firstChild)current=current.firstChild;else for(;current;){current.nodeType===Node.ELEMENT_NODE&&this.endElement(current);let next=this.checkClobberedElement(current,current.nextSibling);if(next){current=next;break}current=this.checkClobberedElement(current,current.parentNode)}return this.buf.join("")}startElement(element){const tagName=element.nodeName.toLowerCase();if(!VALID_ELEMENTS.hasOwnProperty(tagName))return this.sanitizedSomething=!0,!SKIP_TRAVERSING_CONTENT_IF_INVALID_ELEMENTS.hasOwnProperty(tagName);this.buf.push("<"),this.buf.push(tagName);const elAttrs=element.attributes;for(let i=0;i<elAttrs.length;i++){const elAttr=elAttrs.item(i),attrName=elAttr.name,lower=attrName.toLowerCase();if(!VALID_ATTRS.hasOwnProperty(lower)){this.sanitizedSomething=!0;continue}let value=elAttr.value;URI_ATTRS[lower]&&(value=_sanitizeUrl(value)),SRCSET_ATTRS[lower]&&(srcset=value,value=(srcset=String(srcset)).split(",").map(srcset=>_sanitizeUrl(srcset.trim())).join(", ")),this.buf.push(" ",attrName,'="',encodeEntities(value),'"')}var srcset;return this.buf.push(">"),!0}endElement(current){const tagName=current.nodeName.toLowerCase();VALID_ELEMENTS.hasOwnProperty(tagName)&&!VOID_ELEMENTS.hasOwnProperty(tagName)&&(this.buf.push("</"),this.buf.push(tagName),this.buf.push(">"))}chars(chars){this.buf.push(encodeEntities(chars))}checkClobberedElement(node,nextNode){if(nextNode&&(node.compareDocumentPosition(nextNode)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error("Failed to sanitize html because the element is clobbered: "+node.outerHTML);return nextNode}}const SURROGATE_PAIR_REGEXP=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,NON_ALPHANUMERIC_REGEXP=/([^\#-~ |!])/g;function encodeEntities(value){return value.replace(/&/g,"&amp;").replace(SURROGATE_PAIR_REGEXP,(function(match){return"&#"+(1024*(match.charCodeAt(0)-55296)+(match.charCodeAt(1)-56320)+65536)+";"})).replace(NON_ALPHANUMERIC_REGEXP,(function(match){return"&#"+match.charCodeAt(0)+";"})).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let inertBodyHelper;function getTemplateContent(el){return"content"in el&&function(el){return el.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===el.nodeName}(el)?el.content:null}const SecurityContext=function(){var SecurityContext={NONE:0,HTML:1,STYLE:2,SCRIPT:3,URL:4,RESOURCE_URL:5};return SecurityContext[SecurityContext.NONE]="NONE",SecurityContext[SecurityContext.HTML]="HTML",SecurityContext[SecurityContext.STYLE]="STYLE",SecurityContext[SecurityContext.SCRIPT]="SCRIPT",SecurityContext[SecurityContext.URL]="URL",SecurityContext[SecurityContext.RESOURCE_URL]="RESOURCE_URL",SecurityContext}();class Sanitizer{}const SAFE_STYLE_VALUE=new RegExp("^([-,.\"'%_!# a-zA-Z0-9]+|(?:(?:matrix|translate|scale|rotate|skew|perspective)(?:X|Y|Z|3d)?|(?:rgb|hsl)a?|(?:repeating-)?(?:linear|radial)-gradient|(?:calc|attr))\\([-0-9.%, #a-zA-Z]+\\))$","g"),URL_RE=/^url\(([^)]+)\)$/,CAMEL_CASE_REGEXP=/([A-Z])/g;function normalizeDebugBindingValue(value){try{return null!=value?value.toString().slice(0,30):value}catch(e){return"[ERROR] Exception while trying to serialize the value"}}let ChangeDetectorRef=(()=>{class ChangeDetectorRef{}return ChangeDetectorRef.__NG_ELEMENT_ID__=()=>SWITCH_CHANGE_DETECTOR_REF_FACTORY(),ChangeDetectorRef})();const SWITCH_CHANGE_DETECTOR_REF_FACTORY=(...args)=>{},APP_ROOT=new InjectionToken("The presence of this token marks an injector as being the root injector."),INJECTOR_IMPL=function(providers,parent,name){return new StaticInjector(providers,parent,name)};let Injector=(()=>{class Injector{static create(options,parent){return Array.isArray(options)?INJECTOR_IMPL(options,parent,""):INJECTOR_IMPL(options.providers,options.parent,options.name||"")}}return Injector.THROW_IF_NOT_FOUND=THROW_IF_NOT_FOUND,Injector.NULL=new NullInjector,Injector.ngInjectableDef=ɵɵdefineInjectable({token:Injector,providedIn:"any",factory:()=>ɵɵinject(INJECTOR)}),Injector.__NG_ELEMENT_ID__=-1,Injector})();const IDENT=function(value){return value},EMPTY=[],CIRCULAR$1=IDENT,MULTI_PROVIDER_FN=function(){return Array.prototype.slice.call(arguments)};class StaticInjector{constructor(providers,parent=Injector.NULL,source=null){this.parent=parent,this.source=source;const records=this._records=new Map;records.set(Injector,{token:Injector,fn:IDENT,deps:EMPTY,value:this,useNew:!1}),records.set(INJECTOR,{token:INJECTOR,fn:IDENT,deps:EMPTY,value:this,useNew:!1}),function recursivelyProcessProviders(records,provider){if(provider)if((provider=resolveForwardRef(provider))instanceof Array)for(let i=0;i<provider.length;i++)recursivelyProcessProviders(records,provider[i]);else{if("function"==typeof provider)throw staticError("Function/Class not supported",provider);if(!provider||"object"!=typeof provider||!provider.provide)throw staticError("Unexpected provider",provider);{let token=resolveForwardRef(provider.provide);const resolvedProvider=function(provider){const deps=function(provider){let deps=EMPTY;const providerDeps=provider.deps;if(providerDeps&&providerDeps.length){deps=[];for(let i=0;i<providerDeps.length;i++){let options=6,token=resolveForwardRef(providerDeps[i]);if(token instanceof Array)for(let j=0,annotations=token;j<annotations.length;j++){const annotation=annotations[j];annotation instanceof Optional||annotation==Optional?options|=1:annotation instanceof SkipSelf||annotation==SkipSelf?options&=-3:annotation instanceof Self||annotation==Self?options&=-5:token=annotation instanceof Inject?annotation.token:resolveForwardRef(annotation)}deps.push({token:token,options:options})}}else if(provider.useExisting)deps=[{token:resolveForwardRef(provider.useExisting),options:6}];else if(!providerDeps&&!(USE_VALUE in provider))throw staticError("'deps' required",provider);return deps}(provider);let fn=IDENT,value=EMPTY,useNew=!1,provide=resolveForwardRef(provider.provide);if(USE_VALUE in provider)value=provider.useValue;else if(provider.useFactory)fn=provider.useFactory;else if(provider.useExisting);else if(provider.useClass)useNew=!0,fn=resolveForwardRef(provider.useClass);else{if("function"!=typeof provide)throw staticError("StaticProvider does not have [useValue|useFactory|useExisting|useClass] or [provide] is not newable",provider);useNew=!0,fn=provide}return{deps:deps,fn:fn,useNew:useNew,value:value}}(provider);if(!0===provider.multi){let multiProvider=records.get(token);if(multiProvider){if(multiProvider.fn!==MULTI_PROVIDER_FN)throw multiProviderMixError(token)}else records.set(token,multiProvider={token:provider.provide,deps:[],useNew:!1,fn:MULTI_PROVIDER_FN,value:EMPTY});token=provider,multiProvider.deps.push({token:token,options:6})}const record=records.get(token);if(record&&record.fn==MULTI_PROVIDER_FN)throw multiProviderMixError(token);records.set(token,resolvedProvider)}}}(records,providers)}get(token,notFoundValue,flags=InjectFlags.Default){const record=this._records.get(token);try{return function tryResolveToken(token,record,records,parent,notFoundValue,flags){try{return function(token,record,records,parent,notFoundValue,flags){let value;if(!record||flags&InjectFlags.SkipSelf)flags&InjectFlags.Self||(value=parent.get(token,notFoundValue,InjectFlags.Default));else{if(value=record.value,value==CIRCULAR$1)throw Error("ɵCircular dependency");if(value===EMPTY){record.value=CIRCULAR$1;let obj=void 0,useNew=record.useNew,fn=record.fn,depRecords=record.deps,deps=EMPTY;if(depRecords.length){deps=[];for(let i=0;i<depRecords.length;i++){const depRecord=depRecords[i],options=depRecord.options,childRecord=2&options?records.get(depRecord.token):void 0;deps.push(tryResolveToken(depRecord.token,childRecord,records,childRecord||4&options?parent:Injector.NULL,1&options?null:Injector.THROW_IF_NOT_FOUND,InjectFlags.Default))}}record.value=value=useNew?new fn(...deps):fn.apply(obj,deps)}}return value}(token,record,records,parent,notFoundValue,flags)}catch(e){throw e instanceof Error||(e=new Error(e)),(e.ngTempTokenPath=e.ngTempTokenPath||[]).unshift(token),record&&record.value==CIRCULAR$1&&(record.value=EMPTY),e}}(token,record,this._records,this.parent,notFoundValue,flags)}catch(e){return function(e,token,injectorErrorName,source){const tokenPath=e.ngTempTokenPath;throw token.__source&&tokenPath.unshift(token.__source),e.message=formatError("\n"+e.message,tokenPath,"StaticInjectorError",source),e.ngTokenPath=tokenPath,e.ngTempTokenPath=null,e}(e,token,0,this.source)}}toString(){const tokens=[];return this._records.forEach((v,token)=>tokens.push(stringify(token))),`StaticInjector[${tokens.join(", ")}]`}}function multiProviderMixError(token){return staticError("Cannot mix multi providers and regular providers",token)}function staticError(text,obj){return new Error(formatError(text,obj,"StaticInjectorError"))}const ANALYZE_FOR_ENTRY_COMPONENTS=new InjectionToken("AnalyzeForEntryComponents");let _symbolIterator=null;function core_getSymbolIterator(){if(!_symbolIterator){const Symbol=_global.Symbol;if(Symbol&&Symbol.iterator)_symbolIterator=Symbol.iterator;else{const keys=Object.getOwnPropertyNames(Map.prototype);for(let i=0;i<keys.length;++i){const key=keys[i];"entries"!==key&&"size"!==key&&Map.prototype[key]===Map.prototype.entries&&(_symbolIterator=key)}}}return _symbolIterator}function looseIdentical(a,b){return a===b||"number"==typeof a&&"number"==typeof b&&isNaN(a)&&isNaN(b)}function devModeEqual$1(a,b){const isListLikeIterableA=isListLikeIterable$1(a),isListLikeIterableB=isListLikeIterable$1(b);if(isListLikeIterableA&&isListLikeIterableB)return function(a,b,comparator){const iterator1=a[core_getSymbolIterator()](),iterator2=b[core_getSymbolIterator()]();for(;;){const item1=iterator1.next(),item2=iterator2.next();if(item1.done&&item2.done)return!0;if(item1.done||item2.done)return!1;if(!comparator(item1.value,item2.value))return!1}}(a,b,devModeEqual$1);{const isAObject=a&&("object"==typeof a||"function"==typeof a),isBObject=b&&("object"==typeof b||"function"==typeof b);return!(isListLikeIterableA||!isAObject||isListLikeIterableB||!isBObject)||looseIdentical(a,b)}}class WrappedValue{constructor(value){this.wrapped=value}static wrap(value){return new WrappedValue(value)}static unwrap(value){return WrappedValue.isWrapped(value)?value.wrapped:value}static isWrapped(value){return value instanceof WrappedValue}}function isListLikeIterable$1(obj){return!!isJsObject$1(obj)&&(Array.isArray(obj)||!(obj instanceof Map)&&core_getSymbolIterator()in obj)}function isJsObject$1(o){return null!==o&&("function"==typeof o||"object"==typeof o)}function core_isPromise(obj){return!!obj&&"function"==typeof obj.then}function isObservable(obj){return!!obj&&"function"==typeof obj.subscribe}class SimpleChange{constructor(previousValue,currentValue,firstChange){this.previousValue=previousValue,this.currentValue=currentValue,this.firstChange=firstChange}isFirstChange(){return this.firstChange}}class ComponentFactory{}function noComponentFactoryError(component){const error=Error(`No component factory found for ${stringify(component)}. Did you add it to @NgModule.entryComponents?`);return error[ERROR_COMPONENT]=component,error}const ERROR_COMPONENT="ngComponent";class _NullComponentFactoryResolver{resolveComponentFactory(component){throw noComponentFactoryError(component)}}let ComponentFactoryResolver=(()=>{class ComponentFactoryResolver{}return ComponentFactoryResolver.NULL=new _NullComponentFactoryResolver,ComponentFactoryResolver})();class CodegenComponentFactoryResolver{constructor(factories,_parent,_ngModule){this._parent=_parent,this._ngModule=_ngModule,this._factories=new Map;for(let i=0;i<factories.length;i++){const factory=factories[i];this._factories.set(factory.componentType,factory)}}resolveComponentFactory(component){let factory=this._factories.get(component);if(!factory&&this._parent&&(factory=this._parent.resolveComponentFactory(component)),!factory)throw noComponentFactoryError(component);return new ComponentFactoryBoundToModule(factory,this._ngModule)}}class ComponentFactoryBoundToModule extends ComponentFactory{constructor(factory,ngModule){super(),this.factory=factory,this.ngModule=ngModule,this.selector=factory.selector,this.componentType=factory.componentType,this.ngContentSelectors=factory.ngContentSelectors,this.inputs=factory.inputs,this.outputs=factory.outputs}create(injector,projectableNodes,rootSelectorOrNode,ngModule){return this.factory.create(injector,projectableNodes,rootSelectorOrNode,ngModule||this.ngModule)}}function noop(...args){}let ElementRef=(()=>{class ElementRef{constructor(nativeElement){this.nativeElement=nativeElement}}return ElementRef.__NG_ELEMENT_ID__=()=>SWITCH_ELEMENT_REF_FACTORY(ElementRef),ElementRef})();const SWITCH_ELEMENT_REF_FACTORY=noop;class Renderer{}class RendererFactory2{}const RendererStyleFlags2=function(){var RendererStyleFlags2={Important:1,DashCase:2};return RendererStyleFlags2[RendererStyleFlags2.Important]="Important",RendererStyleFlags2[RendererStyleFlags2.DashCase]="DashCase",RendererStyleFlags2}();let Renderer2=(()=>{class Renderer2{}return Renderer2.__NG_ELEMENT_ID__=()=>SWITCH_RENDERER2_FACTORY(),Renderer2})();const SWITCH_RENDERER2_FACTORY=noop;class Version{constructor(full){this.full=full,this.major=full.split(".")[0],this.minor=full.split(".")[1],this.patch=full.split(".").slice(2).join(".")}}const VERSION=new Version("8.2.14");class DefaultIterableDifferFactory{constructor(){}supports(obj){return isListLikeIterable$1(obj)}create(trackByFn){return new DefaultIterableDiffer(trackByFn)}}const trackByIdentity=(index,item)=>item;class DefaultIterableDiffer{constructor(trackByFn){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=trackByFn||trackByIdentity}forEachItem(fn){let record;for(record=this._itHead;null!==record;record=record._next)fn(record)}forEachOperation(fn){let nextIt=this._itHead,nextRemove=this._removalsHead,addRemoveOffset=0,moveOffsets=null;for(;nextIt||nextRemove;){const record=!nextRemove||nextIt&&nextIt.currentIndex<getPreviousIndex(nextRemove,addRemoveOffset,moveOffsets)?nextIt:nextRemove,adjPreviousIndex=getPreviousIndex(record,addRemoveOffset,moveOffsets),currentIndex=record.currentIndex;if(record===nextRemove)addRemoveOffset--,nextRemove=nextRemove._nextRemoved;else if(nextIt=nextIt._next,null==record.previousIndex)addRemoveOffset++;else{moveOffsets||(moveOffsets=[]);const localMovePreviousIndex=adjPreviousIndex-addRemoveOffset,localCurrentIndex=currentIndex-addRemoveOffset;if(localMovePreviousIndex!=localCurrentIndex){for(let i=0;i<localMovePreviousIndex;i++){const offset=i<moveOffsets.length?moveOffsets[i]:moveOffsets[i]=0,index=offset+i;localCurrentIndex<=index&&index<localMovePreviousIndex&&(moveOffsets[i]=offset+1)}moveOffsets[record.previousIndex]=localCurrentIndex-localMovePreviousIndex}}adjPreviousIndex!==currentIndex&&fn(record,adjPreviousIndex,currentIndex)}}forEachPreviousItem(fn){let record;for(record=this._previousItHead;null!==record;record=record._nextPrevious)fn(record)}forEachAddedItem(fn){let record;for(record=this._additionsHead;null!==record;record=record._nextAdded)fn(record)}forEachMovedItem(fn){let record;for(record=this._movesHead;null!==record;record=record._nextMoved)fn(record)}forEachRemovedItem(fn){let record;for(record=this._removalsHead;null!==record;record=record._nextRemoved)fn(record)}forEachIdentityChange(fn){let record;for(record=this._identityChangesHead;null!==record;record=record._nextIdentityChange)fn(record)}diff(collection){if(null==collection&&(collection=[]),!isListLikeIterable$1(collection))throw new Error(`Error trying to diff '${stringify(collection)}'. Only arrays and iterables are allowed`);return this.check(collection)?this:null}onDestroy(){}check(collection){this._reset();let index,item,itemTrackBy,record=this._itHead,mayBeDirty=!1;if(Array.isArray(collection)){this.length=collection.length;for(let index=0;index<this.length;index++)item=collection[index],itemTrackBy=this._trackByFn(index,item),null!==record&&looseIdentical(record.trackById,itemTrackBy)?(mayBeDirty&&(record=this._verifyReinsertion(record,item,itemTrackBy,index)),looseIdentical(record.item,item)||this._addIdentityChange(record,item)):(record=this._mismatch(record,item,itemTrackBy,index),mayBeDirty=!0),record=record._next}else index=0,function(obj,fn){if(Array.isArray(obj))for(let i=0;i<obj.length;i++)fn(obj[i]);else{const iterator=obj[core_getSymbolIterator()]();let item;for(;!(item=iterator.next()).done;)fn(item.value)}}(collection,item=>{itemTrackBy=this._trackByFn(index,item),null!==record&&looseIdentical(record.trackById,itemTrackBy)?(mayBeDirty&&(record=this._verifyReinsertion(record,item,itemTrackBy,index)),looseIdentical(record.item,item)||this._addIdentityChange(record,item)):(record=this._mismatch(record,item,itemTrackBy,index),mayBeDirty=!0),record=record._next,index++}),this.length=index;return this._truncate(record),this.collection=collection,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let record,nextRecord;for(record=this._previousItHead=this._itHead;null!==record;record=record._next)record._nextPrevious=record._next;for(record=this._additionsHead;null!==record;record=record._nextAdded)record.previousIndex=record.currentIndex;for(this._additionsHead=this._additionsTail=null,record=this._movesHead;null!==record;record=nextRecord)record.previousIndex=record.currentIndex,nextRecord=record._nextMoved;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(record,item,itemTrackBy,index){let previousRecord;return null===record?previousRecord=this._itTail:(previousRecord=record._prev,this._remove(record)),null!==(record=null===this._linkedRecords?null:this._linkedRecords.get(itemTrackBy,index))?(looseIdentical(record.item,item)||this._addIdentityChange(record,item),this._moveAfter(record,previousRecord,index)):null!==(record=null===this._unlinkedRecords?null:this._unlinkedRecords.get(itemTrackBy,null))?(looseIdentical(record.item,item)||this._addIdentityChange(record,item),this._reinsertAfter(record,previousRecord,index)):record=this._addAfter(new IterableChangeRecord_(item,itemTrackBy),previousRecord,index),record}_verifyReinsertion(record,item,itemTrackBy,index){let reinsertRecord=null===this._unlinkedRecords?null:this._unlinkedRecords.get(itemTrackBy,null);return null!==reinsertRecord?record=this._reinsertAfter(reinsertRecord,record._prev,index):record.currentIndex!=index&&(record.currentIndex=index,this._addToMoves(record,index)),record}_truncate(record){for(;null!==record;){const nextRecord=record._next;this._addToRemovals(this._unlink(record)),record=nextRecord}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(record,prevRecord,index){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(record);const prev=record._prevRemoved,next=record._nextRemoved;return null===prev?this._removalsHead=next:prev._nextRemoved=next,null===next?this._removalsTail=prev:next._prevRemoved=prev,this._insertAfter(record,prevRecord,index),this._addToMoves(record,index),record}_moveAfter(record,prevRecord,index){return this._unlink(record),this._insertAfter(record,prevRecord,index),this._addToMoves(record,index),record}_addAfter(record,prevRecord,index){return this._insertAfter(record,prevRecord,index),this._additionsTail=null===this._additionsTail?this._additionsHead=record:this._additionsTail._nextAdded=record,record}_insertAfter(record,prevRecord,index){const next=null===prevRecord?this._itHead:prevRecord._next;return record._next=next,record._prev=prevRecord,null===next?this._itTail=record:next._prev=record,null===prevRecord?this._itHead=record:prevRecord._next=record,null===this._linkedRecords&&(this._linkedRecords=new _DuplicateMap),this._linkedRecords.put(record),record.currentIndex=index,record}_remove(record){return this._addToRemovals(this._unlink(record))}_unlink(record){null!==this._linkedRecords&&this._linkedRecords.remove(record);const prev=record._prev,next=record._next;return null===prev?this._itHead=next:prev._next=next,null===next?this._itTail=prev:next._prev=prev,record}_addToMoves(record,toIndex){return record.previousIndex===toIndex||(this._movesTail=null===this._movesTail?this._movesHead=record:this._movesTail._nextMoved=record),record}_addToRemovals(record){return null===this._unlinkedRecords&&(this._unlinkedRecords=new _DuplicateMap),this._unlinkedRecords.put(record),record.currentIndex=null,record._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=record,record._prevRemoved=null):(record._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=record),record}_addIdentityChange(record,item){return record.item=item,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=record:this._identityChangesTail._nextIdentityChange=record,record}}class IterableChangeRecord_{constructor(item,trackById){this.item=item,this.trackById=trackById,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class _DuplicateItemRecordList{constructor(){this._head=null,this._tail=null}add(record){null===this._head?(this._head=this._tail=record,record._nextDup=null,record._prevDup=null):(this._tail._nextDup=record,record._prevDup=this._tail,record._nextDup=null,this._tail=record)}get(trackById,atOrAfterIndex){let record;for(record=this._head;null!==record;record=record._nextDup)if((null===atOrAfterIndex||atOrAfterIndex<=record.currentIndex)&&looseIdentical(record.trackById,trackById))return record;return null}remove(record){const prev=record._prevDup,next=record._nextDup;return null===prev?this._head=next:prev._nextDup=next,null===next?this._tail=prev:next._prevDup=prev,null===this._head}}class _DuplicateMap{constructor(){this.map=new Map}put(record){const key=record.trackById;let duplicates=this.map.get(key);duplicates||(duplicates=new _DuplicateItemRecordList,this.map.set(key,duplicates)),duplicates.add(record)}get(trackById,atOrAfterIndex){const recordList=this.map.get(trackById);return recordList?recordList.get(trackById,atOrAfterIndex):null}remove(record){const key=record.trackById;return this.map.get(key).remove(record)&&this.map.delete(key),record}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function getPreviousIndex(item,addRemoveOffset,moveOffsets){const previousIndex=item.previousIndex;if(null===previousIndex)return previousIndex;let moveOffset=0;return moveOffsets&&previousIndex<moveOffsets.length&&(moveOffset=moveOffsets[previousIndex]),previousIndex+addRemoveOffset+moveOffset}class DefaultKeyValueDifferFactory{constructor(){}supports(obj){return obj instanceof Map||isJsObject$1(obj)}create(){return new DefaultKeyValueDiffer}}class DefaultKeyValueDiffer{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(fn){let record;for(record=this._mapHead;null!==record;record=record._next)fn(record)}forEachPreviousItem(fn){let record;for(record=this._previousMapHead;null!==record;record=record._nextPrevious)fn(record)}forEachChangedItem(fn){let record;for(record=this._changesHead;null!==record;record=record._nextChanged)fn(record)}forEachAddedItem(fn){let record;for(record=this._additionsHead;null!==record;record=record._nextAdded)fn(record)}forEachRemovedItem(fn){let record;for(record=this._removalsHead;null!==record;record=record._nextRemoved)fn(record)}diff(map){if(map){if(!(map instanceof Map||isJsObject$1(map)))throw new Error(`Error trying to diff '${stringify(map)}'. Only maps and objects are allowed`)}else map=new Map;return this.check(map)?this:null}onDestroy(){}check(map){this._reset();let insertBefore=this._mapHead;if(this._appendAfter=null,this._forEach(map,(value,key)=>{if(insertBefore&&insertBefore.key===key)this._maybeAddToChanges(insertBefore,value),this._appendAfter=insertBefore,insertBefore=insertBefore._next;else{const record=this._getOrCreateRecordForKey(key,value);insertBefore=this._insertBeforeOrAppend(insertBefore,record)}}),insertBefore){insertBefore._prev&&(insertBefore._prev._next=null),this._removalsHead=insertBefore;for(let record=insertBefore;null!==record;record=record._nextRemoved)record===this._mapHead&&(this._mapHead=null),this._records.delete(record.key),record._nextRemoved=record._next,record.previousValue=record.currentValue,record.currentValue=null,record._prev=null,record._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(before,record){if(before){const prev=before._prev;return record._next=before,record._prev=prev,before._prev=record,prev&&(prev._next=record),before===this._mapHead&&(this._mapHead=record),this._appendAfter=before,before}return this._appendAfter?(this._appendAfter._next=record,record._prev=this._appendAfter):this._mapHead=record,this._appendAfter=record,null}_getOrCreateRecordForKey(key,value){if(this._records.has(key)){const record=this._records.get(key);this._maybeAddToChanges(record,value);const prev=record._prev,next=record._next;return prev&&(prev._next=next),next&&(next._prev=prev),record._next=null,record._prev=null,record}const record=new KeyValueChangeRecord_(key);return this._records.set(key,record),record.currentValue=value,this._addToAdditions(record),record}_reset(){if(this.isDirty){let record;for(this._previousMapHead=this._mapHead,record=this._previousMapHead;null!==record;record=record._next)record._nextPrevious=record._next;for(record=this._changesHead;null!==record;record=record._nextChanged)record.previousValue=record.currentValue;for(record=this._additionsHead;null!=record;record=record._nextAdded)record.previousValue=record.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(record,newValue){looseIdentical(newValue,record.currentValue)||(record.previousValue=record.currentValue,record.currentValue=newValue,this._addToChanges(record))}_addToAdditions(record){null===this._additionsHead?this._additionsHead=this._additionsTail=record:(this._additionsTail._nextAdded=record,this._additionsTail=record)}_addToChanges(record){null===this._changesHead?this._changesHead=this._changesTail=record:(this._changesTail._nextChanged=record,this._changesTail=record)}_forEach(obj,fn){obj instanceof Map?obj.forEach(fn):Object.keys(obj).forEach(k=>fn(obj[k],k))}}class KeyValueChangeRecord_{constructor(key){this.key=key,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}let IterableDiffers=(()=>{class IterableDiffers{constructor(factories){this.factories=factories}static create(factories,parent){if(null!=parent){const copied=parent.factories.slice();factories=factories.concat(copied)}return new IterableDiffers(factories)}static extend(factories){return{provide:IterableDiffers,useFactory:parent=>{if(!parent)throw new Error("Cannot extend IterableDiffers without a parent injector");return IterableDiffers.create(factories,parent)},deps:[[IterableDiffers,new SkipSelf,new Optional]]}}find(iterable){const factory=this.factories.find(f=>f.supports(iterable));if(null!=factory)return factory;throw new Error(`Cannot find a differ supporting object '${iterable}' of type '${type=iterable,type.name||typeof type}'`);var type}}return IterableDiffers.ngInjectableDef=ɵɵdefineInjectable({token:IterableDiffers,providedIn:"root",factory:()=>new IterableDiffers([new DefaultIterableDifferFactory])}),IterableDiffers})(),KeyValueDiffers=(()=>{class KeyValueDiffers{constructor(factories){this.factories=factories}static create(factories,parent){if(parent){const copied=parent.factories.slice();factories=factories.concat(copied)}return new KeyValueDiffers(factories)}static extend(factories){return{provide:KeyValueDiffers,useFactory:parent=>{if(!parent)throw new Error("Cannot extend KeyValueDiffers without a parent injector");return KeyValueDiffers.create(factories,parent)},deps:[[KeyValueDiffers,new SkipSelf,new Optional]]}}find(kv){const factory=this.factories.find(f=>f.supports(kv));if(factory)return factory;throw new Error(`Cannot find a differ supporting object '${kv}'`)}}return KeyValueDiffers.ngInjectableDef=ɵɵdefineInjectable({token:KeyValueDiffers,providedIn:"root",factory:()=>new KeyValueDiffers([new DefaultKeyValueDifferFactory])}),KeyValueDiffers})();const keyValDiff=[new DefaultKeyValueDifferFactory],defaultIterableDiffers=new IterableDiffers([new DefaultIterableDifferFactory]),defaultKeyValueDiffers=new KeyValueDiffers(keyValDiff);let TemplateRef=(()=>{class TemplateRef{}return TemplateRef.__NG_ELEMENT_ID__=()=>SWITCH_TEMPLATE_REF_FACTORY(TemplateRef,ElementRef),TemplateRef})();const SWITCH_TEMPLATE_REF_FACTORY=noop;let ViewContainerRef=(()=>{class ViewContainerRef{}return ViewContainerRef.__NG_ELEMENT_ID__=()=>SWITCH_VIEW_CONTAINER_REF_FACTORY(ViewContainerRef,ElementRef),ViewContainerRef})();const SWITCH_VIEW_CONTAINER_REF_FACTORY=noop;function expressionChangedAfterItHasBeenCheckedError(context,oldValue,currValue,isFirstCheck){let msg=`ExpressionChangedAfterItHasBeenCheckedError: Expression has changed after it was checked. Previous value: '${oldValue}'. Current value: '${currValue}'.`;return isFirstCheck&&(msg+=" It seems like the view has been created after its parent and its children have been dirty checked. Has it been created in a change detection hook ?"),function(msg,context){const err=new Error(msg);return _addDebugContext(err,context),err}(msg,context)}function _addDebugContext(err,context){err.ngDebugContext=context,err.ngErrorLogger=context.logError.bind(context)}function viewDestroyedError(action){return new Error("ViewDestroyedError: Attempt to use a destroyed view: "+action)}function shiftInitState(view,priorInitState,newInitState){const state=view.state,initState=1792&state;return initState===priorInitState?(view.state=-1793&state|newInitState,view.initIndex=-1,!0):initState===newInitState}function shouldCallLifecycleInitHook(view,initState,index){return(1792&view.state)===initState&&view.initIndex<=index&&(view.initIndex=index+1,!0)}function asTextData(view,index){return view.nodes[index]}function asElementData(view,index){return view.nodes[index]}function asProviderData(view,index){return view.nodes[index]}function asPureExpressionData(view,index){return view.nodes[index]}function asQueryList(view,index){return view.nodes[index]}const Services={setCurrentNode:void 0,createRootView:void 0,createEmbeddedView:void 0,createComponentView:void 0,createNgModuleRef:void 0,overrideProvider:void 0,overrideComponentView:void 0,clearOverrides:void 0,checkAndUpdateView:void 0,checkNoChangesView:void 0,destroyView:void 0,resolveDep:void 0,createDebugContext:void 0,handleEvent:void 0,updateDirectives:void 0,updateRenderer:void 0,dirtyParentQueries:void 0},NOOP=()=>{},_tokenKeyCache=new Map;function tokenKey(token){let key=_tokenKeyCache.get(token);return key||(key=stringify(token)+"_"+_tokenKeyCache.size,_tokenKeyCache.set(token,key)),key}function createRendererType2(values){return{id:"$$undefined",styles:values.styles,encapsulation:values.encapsulation,data:values.data}}let _renderCompCount$1=0;function checkBinding(view,def,bindingIdx,value){return!(!(2&view.state)&&looseIdentical(view.oldValues[def.bindingIndex+bindingIdx],value))}function checkAndUpdateBinding(view,def,bindingIdx,value){return!!checkBinding(view,def,bindingIdx,value)&&(view.oldValues[def.bindingIndex+bindingIdx]=value,!0)}function checkBindingNoChanges(view,def,bindingIdx,value){const oldValue=view.oldValues[def.bindingIndex+bindingIdx];if(1&view.state||!devModeEqual$1(oldValue,value)){const bindingName=def.bindings[bindingIdx].name;throw expressionChangedAfterItHasBeenCheckedError(Services.createDebugContext(view,def.nodeIndex),`${bindingName}: ${oldValue}`,`${bindingName}: ${value}`,0!=(1&view.state))}}function markParentViewsForCheck(view){let currView=view;for(;currView;)2&currView.def.flags&&(currView.state|=8),currView=currView.viewContainerParent||currView.parent}function markParentViewsForCheckProjectedViews(view,endView){let currView=view;for(;currView&&currView!==endView;)currView.state|=64,currView=currView.viewContainerParent||currView.parent}function dispatchEvent(view,nodeIndex,eventName,event){try{return markParentViewsForCheck(33554432&view.def.nodes[nodeIndex].flags?asElementData(view,nodeIndex).componentView:view),Services.handleEvent(view,nodeIndex,eventName,event)}catch(e){view.root.errorHandler.handleError(e)}}function declaredViewContainer(view){return view.parent?asElementData(view.parent,view.parentNodeDef.nodeIndex):null}function viewParentEl(view){return view.parent?view.parentNodeDef.parent:null}function renderNode(view,def){switch(201347067&def.flags){case 1:return asElementData(view,def.nodeIndex).renderElement;case 2:return asTextData(view,def.nodeIndex).renderText}}function isComponentView(view){return!!view.parent&&!!(32768&view.parentNodeDef.flags)}function isEmbeddedView(view){return!(!view.parent||32768&view.parentNodeDef.flags)}function filterQueryId(queryId){return 1<<queryId%32}function splitMatchedQueriesDsl(matchedQueriesDsl){const matchedQueries={};let matchedQueryIds=0;const references={};return matchedQueriesDsl&&matchedQueriesDsl.forEach(([queryId,valueType])=>{"number"==typeof queryId?(matchedQueries[queryId]=valueType,matchedQueryIds|=filterQueryId(queryId)):references[queryId]=valueType}),{matchedQueries:matchedQueries,references:references,matchedQueryIds:matchedQueryIds}}function splitDepsDsl(deps,sourceName){return deps.map(value=>{let token,flags;return Array.isArray(value)?[flags,token]=value:(flags=0,token=value),token&&("function"==typeof token||"object"==typeof token)&&sourceName&&Object.defineProperty(token,"__source",{value:sourceName,configurable:!0}),{flags:flags,token:token,tokenKey:tokenKey(token)}})}function getParentRenderElement(view,renderHost,def){let renderParent=def.renderParent;return renderParent?0==(1&renderParent.flags)||0==(33554432&renderParent.flags)||renderParent.element.componentRendererType&&renderParent.element.componentRendererType.encapsulation===ViewEncapsulation.Native?asElementData(view,def.renderParent.nodeIndex).renderElement:void 0:renderHost}const DEFINITION_CACHE=new WeakMap;function resolveDefinition(factory){let value=DEFINITION_CACHE.get(factory);return value||(value=factory(()=>NOOP),value.factory=factory,DEFINITION_CACHE.set(factory,value)),value}function visitRootRenderNodes(view,action,parentNode,nextSibling,target){3===action&&(parentNode=view.renderer.parentNode(renderNode(view,view.def.lastRenderRootNode))),visitSiblingRenderNodes(view,action,0,view.def.nodes.length-1,parentNode,nextSibling,target)}function visitSiblingRenderNodes(view,action,startIndex,endIndex,parentNode,nextSibling,target){for(let i=startIndex;i<=endIndex;i++){const nodeDef=view.def.nodes[i];11&nodeDef.flags&&visitRenderNode(view,nodeDef,action,parentNode,nextSibling,target),i+=nodeDef.childCount}}function visitProjectedRenderNodes(view,ngContentIndex,action,parentNode,nextSibling,target){let compView=view;for(;compView&&!isComponentView(compView);)compView=compView.parent;const hostView=compView.parent,hostElDef=viewParentEl(compView),endIndex=hostElDef.nodeIndex+hostElDef.childCount;for(let i=hostElDef.nodeIndex+1;i<=endIndex;i++){const nodeDef=hostView.def.nodes[i];nodeDef.ngContentIndex===ngContentIndex&&visitRenderNode(hostView,nodeDef,action,parentNode,nextSibling,target),i+=nodeDef.childCount}if(!hostView.parent){const projectedNodes=view.root.projectableNodes[ngContentIndex];if(projectedNodes)for(let i=0;i<projectedNodes.length;i++)execRenderNodeAction(view,projectedNodes[i],action,parentNode,nextSibling,target)}}function visitRenderNode(view,nodeDef,action,parentNode,nextSibling,target){if(8&nodeDef.flags)visitProjectedRenderNodes(view,nodeDef.ngContent.index,action,parentNode,nextSibling,target);else{const rn=renderNode(view,nodeDef);if(3===action&&33554432&nodeDef.flags&&48&nodeDef.bindingFlags?(16&nodeDef.bindingFlags&&execRenderNodeAction(view,rn,action,parentNode,nextSibling,target),32&nodeDef.bindingFlags&&execRenderNodeAction(asElementData(view,nodeDef.nodeIndex).componentView,rn,action,parentNode,nextSibling,target)):execRenderNodeAction(view,rn,action,parentNode,nextSibling,target),16777216&nodeDef.flags){const embeddedViews=asElementData(view,nodeDef.nodeIndex).viewContainer._embeddedViews;for(let k=0;k<embeddedViews.length;k++)visitRootRenderNodes(embeddedViews[k],action,parentNode,nextSibling,target)}1&nodeDef.flags&&!nodeDef.element.name&&visitSiblingRenderNodes(view,action,nodeDef.nodeIndex+1,nodeDef.nodeIndex+nodeDef.childCount,parentNode,nextSibling,target)}}function execRenderNodeAction(view,renderNode,action,parentNode,nextSibling,target){const renderer=view.renderer;switch(action){case 1:renderer.appendChild(parentNode,renderNode);break;case 2:renderer.insertBefore(parentNode,renderNode,nextSibling);break;case 3:renderer.removeChild(parentNode,renderNode);break;case 0:target.push(renderNode)}}const NS_PREFIX_RE=/^:([^:]+):(.+)$/;function splitNamespace(name){if(":"===name[0]){const match=name.match(NS_PREFIX_RE);return[match[1],match[2]]}return["",name]}function calcBindingFlags(bindings){let flags=0;for(let i=0;i<bindings.length;i++)flags|=bindings[i].flags;return flags}function inlineInterpolate(valueCount,c0,a1,c1,a2,c2,a3,c3,a4,c4,a5,c5,a6,c6,a7,c7,a8,c8,a9,c9){switch(valueCount){case 1:return c0+_toStringWithNull(a1)+c1;case 2:return c0+_toStringWithNull(a1)+c1+_toStringWithNull(a2)+c2;case 3:return c0+_toStringWithNull(a1)+c1+_toStringWithNull(a2)+c2+_toStringWithNull(a3)+c3;case 4:return c0+_toStringWithNull(a1)+c1+_toStringWithNull(a2)+c2+_toStringWithNull(a3)+c3+_toStringWithNull(a4)+c4;case 5:return c0+_toStringWithNull(a1)+c1+_toStringWithNull(a2)+c2+_toStringWithNull(a3)+c3+_toStringWithNull(a4)+c4+_toStringWithNull(a5)+c5;case 6:return c0+_toStringWithNull(a1)+c1+_toStringWithNull(a2)+c2+_toStringWithNull(a3)+c3+_toStringWithNull(a4)+c4+_toStringWithNull(a5)+c5+_toStringWithNull(a6)+c6;case 7:return c0+_toStringWithNull(a1)+c1+_toStringWithNull(a2)+c2+_toStringWithNull(a3)+c3+_toStringWithNull(a4)+c4+_toStringWithNull(a5)+c5+_toStringWithNull(a6)+c6+_toStringWithNull(a7)+c7;case 8:return c0+_toStringWithNull(a1)+c1+_toStringWithNull(a2)+c2+_toStringWithNull(a3)+c3+_toStringWithNull(a4)+c4+_toStringWithNull(a5)+c5+_toStringWithNull(a6)+c6+_toStringWithNull(a7)+c7+_toStringWithNull(a8)+c8;case 9:return c0+_toStringWithNull(a1)+c1+_toStringWithNull(a2)+c2+_toStringWithNull(a3)+c3+_toStringWithNull(a4)+c4+_toStringWithNull(a5)+c5+_toStringWithNull(a6)+c6+_toStringWithNull(a7)+c7+_toStringWithNull(a8)+c8+_toStringWithNull(a9)+c9;default:throw new Error("Does not support more than 9 expressions")}}function _toStringWithNull(v){return null!=v?v.toString():""}const UNDEFINED_VALUE=new Object,InjectorRefTokenKey=tokenKey(Injector),INJECTORRefTokenKey=tokenKey(INJECTOR),NgModuleRefTokenKey=tokenKey(NgModuleRef);function moduleProvideDef(flags,token,value,deps){return value=resolveForwardRef(value),{index:-1,deps:splitDepsDsl(deps,stringify(token)),flags:flags,token:token,value:value}}function resolveNgModuleDep(data,depDef,notFoundValue=Injector.THROW_IF_NOT_FOUND){const former=setCurrentInjector(data);try{if(8&depDef.flags)return depDef.token;if(2&depDef.flags&&(notFoundValue=null),1&depDef.flags)return data._parent.get(depDef.token,notFoundValue);const tokenKey=depDef.tokenKey;switch(tokenKey){case InjectorRefTokenKey:case INJECTORRefTokenKey:case NgModuleRefTokenKey:return data}const providerDef=data._def.providersByKey[tokenKey];let injectableDef;if(providerDef){let providerInstance=data._providers[providerDef.index];return void 0===providerInstance&&(providerInstance=data._providers[providerDef.index]=_createProviderInstance(data,providerDef)),providerInstance===UNDEFINED_VALUE?void 0:providerInstance}if((injectableDef=getInjectableDef(depDef.token))&&(ngModule=data,null!=(def=injectableDef).providedIn&&(function(ngModule,scope){return ngModule._def.modules.indexOf(scope)>-1}(ngModule,def.providedIn)||"root"===def.providedIn&&ngModule._def.isRoot))){const index=data._providers.length;return data._def.providers[index]=data._def.providersByKey[depDef.tokenKey]={flags:5120,value:injectableDef.factory,deps:[],index:index,token:depDef.token},data._providers[index]=UNDEFINED_VALUE,data._providers[index]=_createProviderInstance(data,data._def.providersByKey[depDef.tokenKey])}return 4&depDef.flags?notFoundValue:data._parent.get(depDef.token,notFoundValue)}finally{setCurrentInjector(former)}var ngModule,def}function _createProviderInstance(ngModule,providerDef){let injectable;switch(201347067&providerDef.flags){case 512:injectable=function(ngModule,ctor,deps){const len=deps.length;switch(len){case 0:return new ctor;case 1:return new ctor(resolveNgModuleDep(ngModule,deps[0]));case 2:return new ctor(resolveNgModuleDep(ngModule,deps[0]),resolveNgModuleDep(ngModule,deps[1]));case 3:return new ctor(resolveNgModuleDep(ngModule,deps[0]),resolveNgModuleDep(ngModule,deps[1]),resolveNgModuleDep(ngModule,deps[2]));default:const depValues=new Array(len);for(let i=0;i<len;i++)depValues[i]=resolveNgModuleDep(ngModule,deps[i]);return new ctor(...depValues)}}(ngModule,providerDef.value,providerDef.deps);break;case 1024:injectable=function(ngModule,factory,deps){const len=deps.length;switch(len){case 0:return factory();case 1:return factory(resolveNgModuleDep(ngModule,deps[0]));case 2:return factory(resolveNgModuleDep(ngModule,deps[0]),resolveNgModuleDep(ngModule,deps[1]));case 3:return factory(resolveNgModuleDep(ngModule,deps[0]),resolveNgModuleDep(ngModule,deps[1]),resolveNgModuleDep(ngModule,deps[2]));default:const depValues=Array(len);for(let i=0;i<len;i++)depValues[i]=resolveNgModuleDep(ngModule,deps[i]);return factory(...depValues)}}(ngModule,providerDef.value,providerDef.deps);break;case 2048:injectable=resolveNgModuleDep(ngModule,providerDef.deps[0]);break;case 256:injectable=providerDef.value}return injectable===UNDEFINED_VALUE||null===injectable||"object"!=typeof injectable||131072&providerDef.flags||"function"!=typeof injectable.ngOnDestroy||(providerDef.flags|=131072),void 0===injectable?UNDEFINED_VALUE:injectable}function detachEmbeddedView(elementData,viewIndex){const embeddedViews=elementData.viewContainer._embeddedViews;if((null==viewIndex||viewIndex>=embeddedViews.length)&&(viewIndex=embeddedViews.length-1),viewIndex<0)return null;const view=embeddedViews[viewIndex];return view.viewContainerParent=null,removeFromArray(embeddedViews,viewIndex),Services.dirtyParentQueries(view),renderDetachView$1(view),view}function renderAttachEmbeddedView(elementData,prevView,view){const prevRenderNode=prevView?renderNode(prevView,prevView.def.lastRenderRootNode):elementData.renderElement,parentNode=view.renderer.parentNode(prevRenderNode),nextSibling=view.renderer.nextSibling(prevRenderNode);visitRootRenderNodes(view,2,parentNode,nextSibling,void 0)}function renderDetachView$1(view){visitRootRenderNodes(view,3,null,null,void 0)}const EMPTY_CONTEXT=new Object;function createComponentFactory(selector,componentType,viewDefFactory,inputs,outputs,ngContentSelectors){return new ComponentFactory_(selector,componentType,viewDefFactory,inputs,outputs,ngContentSelectors)}class ComponentFactory_ extends ComponentFactory{constructor(selector,componentType,viewDefFactory,_inputs,_outputs,ngContentSelectors){super(),this.selector=selector,this.componentType=componentType,this._inputs=_inputs,this._outputs=_outputs,this.ngContentSelectors=ngContentSelectors,this.viewDefFactory=viewDefFactory}get inputs(){const inputsArr=[],inputs=this._inputs;for(let propName in inputs)inputsArr.push({propName:propName,templateName:inputs[propName]});return inputsArr}get outputs(){const outputsArr=[];for(let propName in this._outputs)outputsArr.push({propName:propName,templateName:this._outputs[propName]});return outputsArr}create(injector,projectableNodes,rootSelectorOrNode,ngModule){if(!ngModule)throw new Error("ngModule should be provided");const viewDef=resolveDefinition(this.viewDefFactory),componentNodeIndex=viewDef.nodes[0].element.componentProvider.nodeIndex,view=Services.createRootView(injector,projectableNodes||[],rootSelectorOrNode,viewDef,ngModule,EMPTY_CONTEXT),component=asProviderData(view,componentNodeIndex).instance;return rootSelectorOrNode&&view.renderer.setAttribute(asElementData(view,0).renderElement,"ng-version",VERSION.full),new ComponentRef_(view,new ViewRef_(view),component)}}class ComponentRef_ extends class{}{constructor(_view,_viewRef,_component){super(),this._view=_view,this._viewRef=_viewRef,this._component=_component,this._elDef=this._view.def.nodes[0],this.hostView=_viewRef,this.changeDetectorRef=_viewRef,this.instance=_component}get location(){return new ElementRef(asElementData(this._view,this._elDef.nodeIndex).renderElement)}get injector(){return new Injector_(this._view,this._elDef)}get componentType(){return this._component.constructor}destroy(){this._viewRef.destroy()}onDestroy(callback){this._viewRef.onDestroy(callback)}}function createViewContainerData(view,elDef,elData){return new ViewContainerRef_(view,elDef,elData)}class ViewContainerRef_{constructor(_view,_elDef,_data){this._view=_view,this._elDef=_elDef,this._data=_data,this._embeddedViews=[]}get element(){return new ElementRef(this._data.renderElement)}get injector(){return new Injector_(this._view,this._elDef)}get parentInjector(){let view=this._view,elDef=this._elDef.parent;for(;!elDef&&view;)elDef=viewParentEl(view),view=view.parent;return view?new Injector_(view,elDef):new Injector_(this._view,null)}clear(){for(let i=this._embeddedViews.length-1;i>=0;i--){const view=detachEmbeddedView(this._data,i);Services.destroyView(view)}}get(index){const view=this._embeddedViews[index];if(view){const ref=new ViewRef_(view);return ref.attachToViewContainerRef(this),ref}return null}get length(){return this._embeddedViews.length}createEmbeddedView(templateRef,context,index){const viewRef=templateRef.createEmbeddedView(context||{});return this.insert(viewRef,index),viewRef}createComponent(componentFactory,index,injector,projectableNodes,ngModuleRef){const contextInjector=injector||this.parentInjector;ngModuleRef||componentFactory instanceof ComponentFactoryBoundToModule||(ngModuleRef=contextInjector.get(NgModuleRef));const componentRef=componentFactory.create(contextInjector,projectableNodes,void 0,ngModuleRef);return this.insert(componentRef.hostView,index),componentRef}insert(viewRef,index){if(viewRef.destroyed)throw new Error("Cannot insert a destroyed View in a ViewContainer!");const viewRef_=viewRef;return function(parentView,elementData,viewIndex,view){let embeddedViews=elementData.viewContainer._embeddedViews;null==viewIndex&&(viewIndex=embeddedViews.length),view.viewContainerParent=parentView,addToArray(embeddedViews,viewIndex,view),function(vcElementData,view){const dvcElementData=declaredViewContainer(view);if(!dvcElementData||dvcElementData===vcElementData||16&view.state)return;view.state|=16;let projectedViews=dvcElementData.template._projectedViews;projectedViews||(projectedViews=dvcElementData.template._projectedViews=[]),projectedViews.push(view),function(viewDef,nodeDef){if(4&nodeDef.flags)return;viewDef.nodeFlags|=4,nodeDef.flags|=4;let parentNodeDef=nodeDef.parent;for(;parentNodeDef;)parentNodeDef.childFlags|=4,parentNodeDef=parentNodeDef.parent}(view.parent.def,view.parentNodeDef)}(elementData,view),Services.dirtyParentQueries(view),renderAttachEmbeddedView(elementData,viewIndex>0?embeddedViews[viewIndex-1]:null,view)}(this._view,this._data,index,viewRef_._view),viewRef_.attachToViewContainerRef(this),viewRef}move(viewRef,currentIndex){if(viewRef.destroyed)throw new Error("Cannot move a destroyed View in a ViewContainer!");const previousIndex=this._embeddedViews.indexOf(viewRef._view);return function(elementData,oldViewIndex,newViewIndex){const embeddedViews=elementData.viewContainer._embeddedViews,view=embeddedViews[oldViewIndex];removeFromArray(embeddedViews,oldViewIndex),null==newViewIndex&&(newViewIndex=embeddedViews.length),addToArray(embeddedViews,newViewIndex,view),Services.dirtyParentQueries(view),renderDetachView$1(view),renderAttachEmbeddedView(elementData,newViewIndex>0?embeddedViews[newViewIndex-1]:null,view)}(this._data,previousIndex,currentIndex),viewRef}indexOf(viewRef){return this._embeddedViews.indexOf(viewRef._view)}remove(index){const viewData=detachEmbeddedView(this._data,index);viewData&&Services.destroyView(viewData)}detach(index){const view=detachEmbeddedView(this._data,index);return view?new ViewRef_(view):null}}function createChangeDetectorRef(view){return new ViewRef_(view)}class ViewRef_{constructor(_view){this._view=_view,this._viewContainerRef=null,this._appRef=null}get rootNodes(){return function(view){const renderNodes=[];return visitRootRenderNodes(view,0,void 0,void 0,renderNodes),renderNodes}(this._view)}get context(){return this._view.context}get destroyed(){return 0!=(128&this._view.state)}markForCheck(){markParentViewsForCheck(this._view)}detach(){this._view.state&=-5}detectChanges(){const fs=this._view.root.rendererFactory;fs.begin&&fs.begin();try{Services.checkAndUpdateView(this._view)}finally{fs.end&&fs.end()}}checkNoChanges(){Services.checkNoChangesView(this._view)}reattach(){this._view.state|=4}onDestroy(callback){this._view.disposables||(this._view.disposables=[]),this._view.disposables.push(callback)}destroy(){this._appRef?this._appRef.detachView(this):this._viewContainerRef&&this._viewContainerRef.detach(this._viewContainerRef.indexOf(this)),Services.destroyView(this._view)}detachFromAppRef(){this._appRef=null,renderDetachView$1(this._view),Services.dirtyParentQueries(this._view)}attachToAppRef(appRef){if(this._viewContainerRef)throw new Error("This view is already attached to a ViewContainer!");this._appRef=appRef}attachToViewContainerRef(vcRef){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._viewContainerRef=vcRef}}function createTemplateData(view,def){return new TemplateRef_(view,def)}class TemplateRef_ extends TemplateRef{constructor(_parentView,_def){super(),this._parentView=_parentView,this._def=_def}createEmbeddedView(context){return new ViewRef_(Services.createEmbeddedView(this._parentView,this._def,this._def.element.template,context))}get elementRef(){return new ElementRef(asElementData(this._parentView,this._def.nodeIndex).renderElement)}}function createInjector$1(view,elDef){return new Injector_(view,elDef)}class Injector_{constructor(view,elDef){this.view=view,this.elDef=elDef}get(token,notFoundValue=Injector.THROW_IF_NOT_FOUND){return Services.resolveDep(this.view,this.elDef,!!this.elDef&&0!=(33554432&this.elDef.flags),{flags:0,token:token,tokenKey:tokenKey(token)},notFoundValue)}}function nodeValue(view,index){const def=view.def.nodes[index];if(1&def.flags){const elData=asElementData(view,def.nodeIndex);return def.element.template?elData.template:elData.renderElement}if(2&def.flags)return asTextData(view,def.nodeIndex).renderText;if(20240&def.flags)return asProviderData(view,def.nodeIndex).instance;throw new Error("Illegal state: read nodeValue for node index "+index)}function createRendererV1(view){return new RendererAdapter(view.renderer)}class RendererAdapter{constructor(delegate){this.delegate=delegate}selectRootElement(selectorOrNode){return this.delegate.selectRootElement(selectorOrNode)}createElement(parent,namespaceAndName){const[ns,name]=splitNamespace(namespaceAndName),el=this.delegate.createElement(name,ns);return parent&&this.delegate.appendChild(parent,el),el}createViewRoot(hostElement){return hostElement}createTemplateAnchor(parentElement){const comment=this.delegate.createComment("");return parentElement&&this.delegate.appendChild(parentElement,comment),comment}createText(parentElement,value){const node=this.delegate.createText(value);return parentElement&&this.delegate.appendChild(parentElement,node),node}projectNodes(parentElement,nodes){for(let i=0;i<nodes.length;i++)this.delegate.appendChild(parentElement,nodes[i])}attachViewAfter(node,viewRootNodes){const parentElement=this.delegate.parentNode(node),nextSibling=this.delegate.nextSibling(node);for(let i=0;i<viewRootNodes.length;i++)this.delegate.insertBefore(parentElement,viewRootNodes[i],nextSibling)}detachView(viewRootNodes){for(let i=0;i<viewRootNodes.length;i++){const node=viewRootNodes[i],parentElement=this.delegate.parentNode(node);this.delegate.removeChild(parentElement,node)}}destroyView(hostElement,viewAllNodes){for(let i=0;i<viewAllNodes.length;i++)this.delegate.destroyNode(viewAllNodes[i])}listen(renderElement,name,callback){return this.delegate.listen(renderElement,name,callback)}listenGlobal(target,name,callback){return this.delegate.listen(target,name,callback)}setElementProperty(renderElement,propertyName,propertyValue){this.delegate.setProperty(renderElement,propertyName,propertyValue)}setElementAttribute(renderElement,namespaceAndName,attributeValue){const[ns,name]=splitNamespace(namespaceAndName);null!=attributeValue?this.delegate.setAttribute(renderElement,name,attributeValue,ns):this.delegate.removeAttribute(renderElement,name,ns)}setBindingDebugInfo(renderElement,propertyName,propertyValue){}setElementClass(renderElement,className,isAdd){isAdd?this.delegate.addClass(renderElement,className):this.delegate.removeClass(renderElement,className)}setElementStyle(renderElement,styleName,styleValue){null!=styleValue?this.delegate.setStyle(renderElement,styleName,styleValue):this.delegate.removeStyle(renderElement,styleName)}invokeElementMethod(renderElement,methodName,args){renderElement[methodName].apply(renderElement,args)}setText(renderNode,text){this.delegate.setValue(renderNode,text)}animate(){throw new Error("Renderer.animate is no longer supported!")}}function createNgModuleRef(moduleType,parent,bootstrapComponents,def){return new NgModuleRef_(moduleType,parent,bootstrapComponents,def)}class NgModuleRef_{constructor(_moduleType,_parent,_bootstrapComponents,_def){this._moduleType=_moduleType,this._parent=_parent,this._bootstrapComponents=_bootstrapComponents,this._def=_def,this._destroyListeners=[],this._destroyed=!1,this.injector=this,function(data){const def=data._def,providers=data._providers=new Array(def.providers.length);for(let i=0;i<def.providers.length;i++){const provDef=def.providers[i];4096&provDef.flags||void 0===providers[i]&&(providers[i]=_createProviderInstance(data,provDef))}}(this)}get(token,notFoundValue=Injector.THROW_IF_NOT_FOUND,injectFlags=InjectFlags.Default){let flags=0;return injectFlags&InjectFlags.SkipSelf?flags|=1:injectFlags&InjectFlags.Self&&(flags|=4),resolveNgModuleDep(this,{token:token,tokenKey:tokenKey(token),flags:flags},notFoundValue)}get instance(){return this.get(this._moduleType)}get componentFactoryResolver(){return this.get(ComponentFactoryResolver)}destroy(){if(this._destroyed)throw new Error(`The ng module ${stringify(this.instance.constructor)} has already been destroyed.`);this._destroyed=!0,function(ngModule,lifecycles){const def=ngModule._def,destroyed=new Set;for(let i=0;i<def.providers.length;i++)if(131072&def.providers[i].flags){const instance=ngModule._providers[i];if(instance&&instance!==UNDEFINED_VALUE){const onDestroy=instance.ngOnDestroy;"function"!=typeof onDestroy||destroyed.has(instance)||(onDestroy.apply(instance),destroyed.add(instance))}}}(this),this._destroyListeners.forEach(listener=>listener())}onDestroy(callback){this._destroyListeners.push(callback)}}const RendererV1TokenKey=tokenKey(Renderer),Renderer2TokenKey=tokenKey(Renderer2),ElementRefTokenKey=tokenKey(ElementRef),ViewContainerRefTokenKey=tokenKey(ViewContainerRef),TemplateRefTokenKey=tokenKey(TemplateRef),ChangeDetectorRefTokenKey=tokenKey(ChangeDetectorRef),InjectorRefTokenKey$1=tokenKey(Injector),INJECTORRefTokenKey$1=tokenKey(INJECTOR);function directiveDef(checkIndex,flags,matchedQueries,childCount,ctor,deps,props,outputs){const bindings=[];if(props)for(let prop in props){const[bindingIndex,nonMinifiedName]=props[prop];bindings[bindingIndex]={flags:8,name:prop,nonMinifiedName:nonMinifiedName,ns:null,securityContext:null,suffix:null}}const outputDefs=[];if(outputs)for(let propName in outputs)outputDefs.push({type:1,propName:propName,target:null,eventName:outputs[propName]});return _def(checkIndex,flags|=16384,matchedQueries,childCount,ctor,ctor,deps,bindings,outputDefs)}function providerDef(flags,matchedQueries,token,value,deps){return _def(-1,flags,matchedQueries,0,token,value,deps)}function _def(checkIndex,flags,matchedQueriesDsl,childCount,token,value,deps,bindings,outputs){const{matchedQueries:matchedQueries,references:references,matchedQueryIds:matchedQueryIds}=splitMatchedQueriesDsl(matchedQueriesDsl);outputs||(outputs=[]),bindings||(bindings=[]),value=resolveForwardRef(value);const depDefs=splitDepsDsl(deps,stringify(token));return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:checkIndex,flags:flags,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:matchedQueries,matchedQueryIds:matchedQueryIds,references:references,ngContentIndex:-1,childCount:childCount,bindings:bindings,bindingFlags:calcBindingFlags(bindings),outputs:outputs,element:null,provider:{token:token,value:value,deps:depDefs},text:null,query:null,ngContent:null}}function createProviderInstance(view,def){return _createProviderInstance$1(view,def)}function createPipeInstance(view,def){let compView=view;for(;compView.parent&&!isComponentView(compView);)compView=compView.parent;return createClass(compView.parent,viewParentEl(compView),!0,def.provider.value,def.provider.deps)}function createDirectiveInstance(view,def){const instance=createClass(view,def.parent,(32768&def.flags)>0,def.provider.value,def.provider.deps);if(def.outputs.length)for(let i=0;i<def.outputs.length;i++){const output=def.outputs[i],outputObservable=instance[output.propName];if(!isObservable(outputObservable))throw new Error(`@Output ${output.propName} not initialized in '${instance.constructor.name}'.`);{const subscription=outputObservable.subscribe(eventHandlerClosure(view,def.parent.nodeIndex,output.eventName));view.disposables[def.outputIndex+i]=subscription.unsubscribe.bind(subscription)}}return instance}function eventHandlerClosure(view,index,eventName){return event=>dispatchEvent(view,index,eventName,event)}function _createProviderInstance$1(view,def){const allowPrivateServices=(8192&def.flags)>0,providerDef=def.provider;switch(201347067&def.flags){case 512:return createClass(view,def.parent,allowPrivateServices,providerDef.value,providerDef.deps);case 1024:return function(view,elDef,allowPrivateServices,factory,deps){const len=deps.length;switch(len){case 0:return factory();case 1:return factory(resolveDep(view,elDef,allowPrivateServices,deps[0]));case 2:return factory(resolveDep(view,elDef,allowPrivateServices,deps[0]),resolveDep(view,elDef,allowPrivateServices,deps[1]));case 3:return factory(resolveDep(view,elDef,allowPrivateServices,deps[0]),resolveDep(view,elDef,allowPrivateServices,deps[1]),resolveDep(view,elDef,allowPrivateServices,deps[2]));default:const depValues=Array(len);for(let i=0;i<len;i++)depValues[i]=resolveDep(view,elDef,allowPrivateServices,deps[i]);return factory(...depValues)}}(view,def.parent,allowPrivateServices,providerDef.value,providerDef.deps);case 2048:return resolveDep(view,def.parent,allowPrivateServices,providerDef.deps[0]);case 256:return providerDef.value}}function createClass(view,elDef,allowPrivateServices,ctor,deps){const len=deps.length;switch(len){case 0:return new ctor;case 1:return new ctor(resolveDep(view,elDef,allowPrivateServices,deps[0]));case 2:return new ctor(resolveDep(view,elDef,allowPrivateServices,deps[0]),resolveDep(view,elDef,allowPrivateServices,deps[1]));case 3:return new ctor(resolveDep(view,elDef,allowPrivateServices,deps[0]),resolveDep(view,elDef,allowPrivateServices,deps[1]),resolveDep(view,elDef,allowPrivateServices,deps[2]));default:const depValues=new Array(len);for(let i=0;i<len;i++)depValues[i]=resolveDep(view,elDef,allowPrivateServices,deps[i]);return new ctor(...depValues)}}const NOT_FOUND_CHECK_ONLY_ELEMENT_INJECTOR={};function resolveDep(view,elDef,allowPrivateServices,depDef,notFoundValue=Injector.THROW_IF_NOT_FOUND){if(8&depDef.flags)return depDef.token;const startView=view;2&depDef.flags&&(notFoundValue=null);const tokenKey=depDef.tokenKey;tokenKey===ChangeDetectorRefTokenKey&&(allowPrivateServices=!(!elDef||!elDef.element.componentView)),elDef&&1&depDef.flags&&(allowPrivateServices=!1,elDef=elDef.parent);let searchView=view;for(;searchView;){if(elDef)switch(tokenKey){case RendererV1TokenKey:return createRendererV1(findCompView(searchView,elDef,allowPrivateServices));case Renderer2TokenKey:return findCompView(searchView,elDef,allowPrivateServices).renderer;case ElementRefTokenKey:return new ElementRef(asElementData(searchView,elDef.nodeIndex).renderElement);case ViewContainerRefTokenKey:return asElementData(searchView,elDef.nodeIndex).viewContainer;case TemplateRefTokenKey:if(elDef.element.template)return asElementData(searchView,elDef.nodeIndex).template;break;case ChangeDetectorRefTokenKey:return createChangeDetectorRef(findCompView(searchView,elDef,allowPrivateServices));case InjectorRefTokenKey$1:case INJECTORRefTokenKey$1:return createInjector$1(searchView,elDef);default:const providerDef=(allowPrivateServices?elDef.element.allProviders:elDef.element.publicProviders)[tokenKey];if(providerDef){let providerData=asProviderData(searchView,providerDef.nodeIndex);return providerData||(providerData={instance:_createProviderInstance$1(searchView,providerDef)},searchView.nodes[providerDef.nodeIndex]=providerData),providerData.instance}}allowPrivateServices=isComponentView(searchView),elDef=viewParentEl(searchView),searchView=searchView.parent,4&depDef.flags&&(searchView=null)}const value=startView.root.injector.get(depDef.token,NOT_FOUND_CHECK_ONLY_ELEMENT_INJECTOR);return value!==NOT_FOUND_CHECK_ONLY_ELEMENT_INJECTOR||notFoundValue===NOT_FOUND_CHECK_ONLY_ELEMENT_INJECTOR?value:startView.root.ngModule.injector.get(depDef.token,notFoundValue)}function findCompView(view,elDef,allowPrivateServices){let compView;if(allowPrivateServices)compView=asElementData(view,elDef.nodeIndex).componentView;else for(compView=view;compView.parent&&!isComponentView(compView);)compView=compView.parent;return compView}function updateProp(view,providerData,def,bindingIdx,value,changes){if(32768&def.flags){const compView=asElementData(view,def.parent.nodeIndex).componentView;2&compView.def.flags&&(compView.state|=8)}if(providerData.instance[def.bindings[bindingIdx].name]=value,524288&def.flags){changes=changes||{};const oldValue=WrappedValue.unwrap(view.oldValues[def.bindingIndex+bindingIdx]);changes[def.bindings[bindingIdx].nonMinifiedName]=new SimpleChange(oldValue,value,0!=(2&view.state))}return view.oldValues[def.bindingIndex+bindingIdx]=value,changes}function callLifecycleHooksChildrenFirst(view,lifecycles){if(!(view.def.nodeFlags&lifecycles))return;const nodes=view.def.nodes;let initIndex=0;for(let i=0;i<nodes.length;i++){const nodeDef=nodes[i];let parent=nodeDef.parent;for(!parent&&nodeDef.flags&lifecycles&&callProviderLifecycles(view,i,nodeDef.flags&lifecycles,initIndex++),0==(nodeDef.childFlags&lifecycles)&&(i+=nodeDef.childCount);parent&&1&parent.flags&&i===parent.nodeIndex+parent.childCount;)parent.directChildFlags&lifecycles&&(initIndex=callElementProvidersLifecycles(view,parent,lifecycles,initIndex)),parent=parent.parent}}function callElementProvidersLifecycles(view,elDef,lifecycles,initIndex){for(let i=elDef.nodeIndex+1;i<=elDef.nodeIndex+elDef.childCount;i++){const nodeDef=view.def.nodes[i];nodeDef.flags&lifecycles&&callProviderLifecycles(view,i,nodeDef.flags&lifecycles,initIndex++),i+=nodeDef.childCount}return initIndex}function callProviderLifecycles(view,index,lifecycles,initIndex){const providerData=asProviderData(view,index);if(!providerData)return;const provider=providerData.instance;provider&&(Services.setCurrentNode(view,index),1048576&lifecycles&&shouldCallLifecycleInitHook(view,512,initIndex)&&provider.ngAfterContentInit(),2097152&lifecycles&&provider.ngAfterContentChecked(),4194304&lifecycles&&shouldCallLifecycleInitHook(view,768,initIndex)&&provider.ngAfterViewInit(),8388608&lifecycles&&provider.ngAfterViewChecked(),131072&lifecycles&&provider.ngOnDestroy())}const SCHEDULER=new InjectionToken("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>defaultScheduler}),LOCALE_DATA={},LocaleDataIndex=function(){var LocaleDataIndex={LocaleId:0,DayPeriodsFormat:1,DayPeriodsStandalone:2,DaysFormat:3,DaysStandalone:4,MonthsFormat:5,MonthsStandalone:6,Eras:7,FirstDayOfWeek:8,WeekendRange:9,DateFormat:10,TimeFormat:11,DateTimeFormat:12,NumberSymbols:13,NumberFormats:14,CurrencySymbol:15,CurrencyName:16,Currencies:17,PluralCase:18,ExtraData:19};return LocaleDataIndex[LocaleDataIndex.LocaleId]="LocaleId",LocaleDataIndex[LocaleDataIndex.DayPeriodsFormat]="DayPeriodsFormat",LocaleDataIndex[LocaleDataIndex.DayPeriodsStandalone]="DayPeriodsStandalone",LocaleDataIndex[LocaleDataIndex.DaysFormat]="DaysFormat",LocaleDataIndex[LocaleDataIndex.DaysStandalone]="DaysStandalone",LocaleDataIndex[LocaleDataIndex.MonthsFormat]="MonthsFormat",LocaleDataIndex[LocaleDataIndex.MonthsStandalone]="MonthsStandalone",LocaleDataIndex[LocaleDataIndex.Eras]="Eras",LocaleDataIndex[LocaleDataIndex.FirstDayOfWeek]="FirstDayOfWeek",LocaleDataIndex[LocaleDataIndex.WeekendRange]="WeekendRange",LocaleDataIndex[LocaleDataIndex.DateFormat]="DateFormat",LocaleDataIndex[LocaleDataIndex.TimeFormat]="TimeFormat",LocaleDataIndex[LocaleDataIndex.DateTimeFormat]="DateTimeFormat",LocaleDataIndex[LocaleDataIndex.NumberSymbols]="NumberSymbols",LocaleDataIndex[LocaleDataIndex.NumberFormats]="NumberFormats",LocaleDataIndex[LocaleDataIndex.CurrencySymbol]="CurrencySymbol",LocaleDataIndex[LocaleDataIndex.CurrencyName]="CurrencyName",LocaleDataIndex[LocaleDataIndex.Currencies]="Currencies",LocaleDataIndex[LocaleDataIndex.PluralCase]="PluralCase",LocaleDataIndex[LocaleDataIndex.ExtraData]="ExtraData",LocaleDataIndex}(),u=void 0;var localeEn=["en",[["a","p"],["AM","PM"],u],[["AM","PM"],u,u],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],u,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],u,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",u,"{1} 'at' {0}",u],[".",",",";","%","+","-","E","×","‰","∞","NaN",":"],["#,##0.###","#,##0%","¤#,##0.00","#E0"],"$","US Dollar",{},function(n){let i=Math.floor(Math.abs(n)),v=n.toString().replace(/^[^.]*\.?/,"").length;return 1===i&&0===v?1:5}];class core_EventEmitter extends Subject_Subject{constructor(isAsync=!1){super(),this.__isAsync=isAsync}emit(value){super.next(value)}subscribe(generatorOrNext,error,complete){let schedulerFn,errorFn=err=>null,completeFn=()=>null;generatorOrNext&&"object"==typeof generatorOrNext?(schedulerFn=this.__isAsync?value=>{setTimeout(()=>generatorOrNext.next(value))}:value=>{generatorOrNext.next(value)},generatorOrNext.error&&(errorFn=this.__isAsync?err=>{setTimeout(()=>generatorOrNext.error(err))}:err=>{generatorOrNext.error(err)}),generatorOrNext.complete&&(completeFn=this.__isAsync?()=>{setTimeout(()=>generatorOrNext.complete())}:()=>{generatorOrNext.complete()})):(schedulerFn=this.__isAsync?value=>{setTimeout(()=>generatorOrNext(value))}:value=>{generatorOrNext(value)},error&&(errorFn=this.__isAsync?err=>{setTimeout(()=>error(err))}:err=>{error(err)}),complete&&(completeFn=this.__isAsync?()=>{setTimeout(()=>complete())}:()=>{complete()}));const sink=super.subscribe(schedulerFn,errorFn,completeFn);return generatorOrNext instanceof Subscription_Subscription&&generatorOrNext.add(sink),sink}}function symbolIterator(){return this._results[core_getSymbolIterator()]()}class QueryList{constructor(){this.dirty=!0,this._results=[],this.changes=new core_EventEmitter,this.length=0;const symbol=core_getSymbolIterator(),proto=QueryList.prototype;proto[symbol]||(proto[symbol]=symbolIterator)}map(fn){return this._results.map(fn)}filter(fn){return this._results.filter(fn)}find(fn){return this._results.find(fn)}reduce(fn,init){return this._results.reduce(fn,init)}forEach(fn){this._results.forEach(fn)}some(fn){return this._results.some(fn)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(resultsTree){this._results=function flatten(list,dst){void 0===dst&&(dst=list);for(let i=0;i<list.length;i++){let item=list[i];Array.isArray(item)?(dst===list&&(dst=list.slice(0,i)),flatten(item,dst)):dst!==list&&dst.push(item)}return dst}(resultsTree),this.dirty=!1,this.length=this._results.length,this.last=this._results[this.length-1],this.first=this._results[0]}notifyOnChanges(){this.changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}const APP_INITIALIZER=new InjectionToken("Application Initializer");class ApplicationInitStatus{constructor(appInits){this.appInits=appInits,this.initialized=!1,this.done=!1,this.donePromise=new Promise((res,rej)=>{this.resolve=res,this.reject=rej})}runInitializers(){if(this.initialized)return;const asyncInitPromises=[],complete=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let i=0;i<this.appInits.length;i++){const initResult=this.appInits[i]();core_isPromise(initResult)&&asyncInitPromises.push(initResult)}Promise.all(asyncInitPromises).then(()=>{complete()}).catch(e=>{this.reject(e)}),0===asyncInitPromises.length&&complete(),this.initialized=!0}}const APP_ID=new InjectionToken("AppId"),PLATFORM_INITIALIZER=new InjectionToken("Platform Initializer"),PLATFORM_ID=new InjectionToken("Platform ID"),APP_BOOTSTRAP_LISTENER=new InjectionToken("appBootstrapListener");class Console{log(message){console.log(message)}warn(message){console.warn(message)}}const LOCALE_ID$1=new InjectionToken("LocaleId");function _throwError(){throw new Error("Runtime compiler is not loaded")}const Compiler_compileModuleSync=_throwError,Compiler_compileModuleAsync=_throwError,Compiler_compileModuleAndAllComponentsSync=_throwError,Compiler_compileModuleAndAllComponentsAsync=_throwError;class Compiler{constructor(){this.compileModuleSync=Compiler_compileModuleSync,this.compileModuleAsync=Compiler_compileModuleAsync,this.compileModuleAndAllComponentsSync=Compiler_compileModuleAndAllComponentsSync,this.compileModuleAndAllComponentsAsync=Compiler_compileModuleAndAllComponentsAsync}clearCache(){}clearCacheFor(type){}getModuleId(moduleType){}}class CompilerFactory{}let trace,events;function detectWTF(){const wtf=_global.wtf;return!(!wtf||(trace=wtf.trace,!trace)||(events=trace.events,0))}const wtfEnabled=detectWTF();function noopScope(arg0,arg1){return null}const wtfCreateScope=wtfEnabled?function(signature,flags=null){return events.createScope(signature,flags)}:(signature,flags)=>noopScope,wtfLeave=wtfEnabled?function(scope,returnValue){return trace.leaveScope(scope,returnValue),returnValue}:(s,r)=>r,core_promise=(()=>Promise.resolve(0))();function scheduleMicroTask(fn){"undefined"==typeof Zone?core_promise.then(()=>{fn&&fn.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",fn)}class NgZone{constructor({enableLongStackTrace:enableLongStackTrace=!1}){if(this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new core_EventEmitter(!1),this.onMicrotaskEmpty=new core_EventEmitter(!1),this.onStable=new core_EventEmitter(!1),this.onError=new core_EventEmitter(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");var zone;Zone.assertZonePatched(),this._nesting=0,this._outer=this._inner=Zone.current,Zone.wtfZoneSpec&&(this._inner=this._inner.fork(Zone.wtfZoneSpec)),Zone.TaskTrackingZoneSpec&&(this._inner=this._inner.fork(new Zone.TaskTrackingZoneSpec)),enableLongStackTrace&&Zone.longStackTraceZoneSpec&&(this._inner=this._inner.fork(Zone.longStackTraceZoneSpec)),(zone=this)._inner=zone._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(delegate,current,target,task,applyThis,applyArgs)=>{try{return onEnter(zone),delegate.invokeTask(target,task,applyThis,applyArgs)}finally{onLeave(zone)}},onInvoke:(delegate,current,target,callback,applyThis,applyArgs,source)=>{try{return onEnter(zone),delegate.invoke(target,callback,applyThis,applyArgs,source)}finally{onLeave(zone)}},onHasTask:(delegate,current,target,hasTaskState)=>{delegate.hasTask(target,hasTaskState),current===target&&("microTask"==hasTaskState.change?(zone.hasPendingMicrotasks=hasTaskState.microTask,checkStable(zone)):"macroTask"==hasTaskState.change&&(zone.hasPendingMacrotasks=hasTaskState.macroTask))},onHandleError:(delegate,current,target,error)=>(delegate.handleError(target,error),zone.runOutsideAngular(()=>zone.onError.emit(error)),!1)})}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!NgZone.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(NgZone.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(fn,applyThis,applyArgs){return this._inner.run(fn,applyThis,applyArgs)}runTask(fn,applyThis,applyArgs,name){const zone=this._inner,task=zone.scheduleEventTask("NgZoneEvent: "+name,fn,EMPTY_PAYLOAD,noop$1,noop$1);try{return zone.runTask(task,applyThis,applyArgs)}finally{zone.cancelTask(task)}}runGuarded(fn,applyThis,applyArgs){return this._inner.runGuarded(fn,applyThis,applyArgs)}runOutsideAngular(fn){return this._outer.run(fn)}}function noop$1(){}const EMPTY_PAYLOAD={};function checkStable(zone){if(0==zone._nesting&&!zone.hasPendingMicrotasks&&!zone.isStable)try{zone._nesting++,zone.onMicrotaskEmpty.emit(null)}finally{if(zone._nesting--,!zone.hasPendingMicrotasks)try{zone.runOutsideAngular(()=>zone.onStable.emit(null))}finally{zone.isStable=!0}}}function onEnter(zone){zone._nesting++,zone.isStable&&(zone.isStable=!1,zone.onUnstable.emit(null))}function onLeave(zone){zone._nesting--,checkStable(zone)}class NoopNgZone{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new core_EventEmitter,this.onMicrotaskEmpty=new core_EventEmitter,this.onStable=new core_EventEmitter,this.onError=new core_EventEmitter}run(fn){return fn()}runGuarded(fn){return fn()}runOutsideAngular(fn){return fn()}runTask(fn){return fn()}}class Testability{constructor(_ngZone){this._ngZone=_ngZone,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),_ngZone.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{NgZone.assertNotInAngularZone(),scheduleMicroTask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())scheduleMicroTask(()=>{for(;0!==this._callbacks.length;){let cb=this._callbacks.pop();clearTimeout(cb.timeoutId),cb.doneCb(this._didWork)}this._didWork=!1});else{let pending=this.getPendingTasks();this._callbacks=this._callbacks.filter(cb=>!cb.updateCb||!cb.updateCb(pending)||(clearTimeout(cb.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(cb,timeout,updateCb){let timeoutId=-1;timeout&&timeout>0&&(timeoutId=setTimeout(()=>{this._callbacks=this._callbacks.filter(cb=>cb.timeoutId!==timeoutId),cb(this._didWork,this.getPendingTasks())},timeout)),this._callbacks.push({doneCb:cb,timeoutId:timeoutId,updateCb:updateCb})}whenStable(doneCb,timeout,updateCb){if(updateCb&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/dist/task-tracking.js" loaded?');this.addCallback(doneCb,timeout,updateCb),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(using,provider,exactMatch){return[]}}class TestabilityRegistry{constructor(){this._applications=new Map,_testabilityGetter.addToWindow(this)}registerApplication(token,testability){this._applications.set(token,testability)}unregisterApplication(token){this._applications.delete(token)}unregisterAllApplications(){this._applications.clear()}getTestability(elem){return this._applications.get(elem)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(elem,findInAncestors=!0){return _testabilityGetter.findTestabilityInTree(this,elem,findInAncestors)}}class _NoopGetTestability{addToWindow(registry){}findTestabilityInTree(registry,elem,findInAncestors){return null}}let _platform,_testabilityGetter=new _NoopGetTestability;const ALLOW_MULTIPLE_PLATFORMS=new InjectionToken("AllowMultipleToken");class NgProbeToken{constructor(name,token){this.name=name,this.token=token}}function createPlatformFactory(parentPlatformFactory,name,providers=[]){const desc="Platform: "+name,marker=new InjectionToken(desc);return(extraProviders=[])=>{let platform=getPlatform();if(!platform||platform.injector.get(ALLOW_MULTIPLE_PLATFORMS,!1))if(parentPlatformFactory)parentPlatformFactory(providers.concat(extraProviders).concat({provide:marker,useValue:!0}));else{const injectedProviders=providers.concat(extraProviders).concat({provide:marker,useValue:!0});!function(injector){if(_platform&&!_platform.destroyed&&!_platform.injector.get(ALLOW_MULTIPLE_PLATFORMS,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");_platform=injector.get(PlatformRef);const inits=injector.get(PLATFORM_INITIALIZER,null);inits&&inits.forEach(init=>init())}(Injector.create({providers:injectedProviders,name:desc}))}return function(requiredToken){const platform=getPlatform();if(!platform)throw new Error("No platform exists!");if(!platform.injector.get(requiredToken,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return platform}(marker)}}function getPlatform(){return _platform&&!_platform.destroyed?_platform:null}class PlatformRef{constructor(_injector){this._injector=_injector,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(moduleFactory,options){const ngZone=function(ngZoneOption){let ngZone;return ngZone="noop"===ngZoneOption?new NoopNgZone:("zone.js"===ngZoneOption?void 0:ngZoneOption)||new NgZone({enableLongStackTrace:isDevMode()}),ngZone}(options?options.ngZone:void 0),providers=[{provide:NgZone,useValue:ngZone}];return ngZone.run(()=>{const ngZoneInjector=Injector.create({providers:providers,parent:this.injector,name:moduleFactory.moduleType.name}),moduleRef=moduleFactory.create(ngZoneInjector),exceptionHandler=moduleRef.injector.get(ErrorHandler,null);if(!exceptionHandler)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return moduleRef.onDestroy(()=>remove(this._modules,moduleRef)),ngZone.runOutsideAngular(()=>ngZone.onError.subscribe({next:error=>{exceptionHandler.handleError(error)}})),function(errorHandler,ngZone,callback){try{const result=callback();return core_isPromise(result)?result.catch(e=>{throw ngZone.runOutsideAngular(()=>errorHandler.handleError(e)),e}):result}catch(e){throw ngZone.runOutsideAngular(()=>errorHandler.handleError(e)),e}}(exceptionHandler,ngZone,()=>{const initStatus=moduleRef.injector.get(ApplicationInitStatus);return initStatus.runInitializers(),initStatus.donePromise.then(()=>(this._moduleDoBootstrap(moduleRef),moduleRef))})})}bootstrapModule(moduleType,compilerOptions=[]){const options=optionsReducer({},compilerOptions);return function(injector,options,moduleType){return injector.get(CompilerFactory).createCompiler([options]).compileModuleAsync(moduleType)}(this.injector,options,moduleType).then(moduleFactory=>this.bootstrapModuleFactory(moduleFactory,options))}_moduleDoBootstrap(moduleRef){const appRef=moduleRef.injector.get(core_ApplicationRef);if(moduleRef._bootstrapComponents.length>0)moduleRef._bootstrapComponents.forEach(f=>appRef.bootstrap(f));else{if(!moduleRef.instance.ngDoBootstrap)throw new Error(`The module ${stringify(moduleRef.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);moduleRef.instance.ngDoBootstrap(appRef)}this._modules.push(moduleRef)}onDestroy(callback){this._destroyListeners.push(callback)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(module=>module.destroy()),this._destroyListeners.forEach(listener=>listener()),this._destroyed=!0}get destroyed(){return this._destroyed}}function optionsReducer(dst,objs){return Array.isArray(objs)?objs.reduce(optionsReducer,dst):Object.assign({},dst,objs)}let core_ApplicationRef=(()=>{class ApplicationRef{constructor(_zone,_console,_injector,_exceptionHandler,_componentFactoryResolver,_initStatus){this._zone=_zone,this._console=_console,this._injector=_injector,this._exceptionHandler=_exceptionHandler,this._componentFactoryResolver=_componentFactoryResolver,this._initStatus=_initStatus,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._enforceNoNewChanges=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._enforceNoNewChanges=isDevMode(),this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const isCurrentlyStable=new Observable_Observable(observer=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{observer.next(this._stable),observer.complete()})}),isStable=new Observable_Observable(observer=>{let stableSub;this._zone.runOutsideAngular(()=>{stableSub=this._zone.onStable.subscribe(()=>{NgZone.assertNotInAngularZone(),scheduleMicroTask(()=>{this._stable||this._zone.hasPendingMacrotasks||this._zone.hasPendingMicrotasks||(this._stable=!0,observer.next(!0))})})});const unstableSub=this._zone.onUnstable.subscribe(()=>{NgZone.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{observer.next(!1)}))});return()=>{stableSub.unsubscribe(),unstableSub.unsubscribe()}});this.isStable=function(...observables){let concurrent=Number.POSITIVE_INFINITY,scheduler=null,last=observables[observables.length-1];return isScheduler(last)?(scheduler=observables.pop(),observables.length>1&&"number"==typeof observables[observables.length-1]&&(concurrent=observables.pop())):"number"==typeof last&&(concurrent=observables.pop()),null===scheduler&&1===observables.length&&observables[0]instanceof Observable_Observable?observables[0]:mergeAll(concurrent)(fromArray(observables,scheduler))}(isCurrentlyStable,isStable.pipe(source=>{return refCount()((subjectOrSubjectFactory=shareSubjectFactory,function(source){let subjectFactory;subjectFactory="function"==typeof subjectOrSubjectFactory?subjectOrSubjectFactory:function(){return subjectOrSubjectFactory};const connectable=Object.create(source,connectableObservableDescriptor);return connectable.source=source,connectable.subjectFactory=subjectFactory,connectable})(source));var subjectOrSubjectFactory}))}bootstrap(componentOrFactory,rootSelectorOrNode){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let componentFactory;componentFactory=componentOrFactory instanceof ComponentFactory?componentOrFactory:this._componentFactoryResolver.resolveComponentFactory(componentOrFactory),this.componentTypes.push(componentFactory.componentType);const ngModule=componentFactory instanceof ComponentFactoryBoundToModule?null:this._injector.get(NgModuleRef),compRef=componentFactory.create(Injector.NULL,[],rootSelectorOrNode||componentFactory.selector,ngModule);compRef.onDestroy(()=>{this._unloadComponent(compRef)});const testability=compRef.injector.get(Testability,null);return testability&&compRef.injector.get(TestabilityRegistry).registerApplication(compRef.location.nativeElement,testability),this._loadComponent(compRef),isDevMode()&&this._console.log("Angular is running in the development mode. Call enableProdMode() to enable the production mode."),compRef}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");const scope=ApplicationRef._tickScope();try{this._runningTick=!0;for(let view of this._views)view.detectChanges();if(this._enforceNoNewChanges)for(let view of this._views)view.checkNoChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1,wtfLeave(scope)}}attachView(viewRef){const view=viewRef;this._views.push(view),view.attachToAppRef(this)}detachView(viewRef){const view=viewRef;remove(this._views,view),view.detachFromAppRef()}_loadComponent(componentRef){this.attachView(componentRef.hostView),this.tick(),this.components.push(componentRef),this._injector.get(APP_BOOTSTRAP_LISTENER,[]).concat(this._bootstrapListeners).forEach(listener=>listener(componentRef))}_unloadComponent(componentRef){this.detachView(componentRef.hostView),remove(this.components,componentRef)}ngOnDestroy(){this._views.slice().forEach(view=>view.destroy())}get viewCount(){return this._views.length}}return ApplicationRef._tickScope=wtfCreateScope("ApplicationRef#tick()"),ApplicationRef})();function remove(list,el){const index=list.indexOf(el);index>-1&&list.splice(index,1)}class NgModuleFactoryLoader{}class SystemJsNgModuleLoaderConfig{}const DEFAULT_CONFIG={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"};class SystemJsNgModuleLoader{constructor(_compiler,config){this._compiler=_compiler,this._config=config||DEFAULT_CONFIG}load(path){return this._compiler instanceof Compiler?this.loadFactory(path):this.loadAndCompile(path)}loadAndCompile(path){let[module,exportName]=path.split("#");return void 0===exportName&&(exportName="default"),__webpack_require__("crnd")(module).then(module=>module[exportName]).then(type=>checkNotEmpty(type,module,exportName)).then(type=>this._compiler.compileModuleAsync(type))}loadFactory(path){let[module,exportName]=path.split("#"),factoryClassSuffix="NgFactory";return void 0===exportName&&(exportName="default",factoryClassSuffix=""),__webpack_require__("crnd")(this._config.factoryPathPrefix+module+this._config.factoryPathSuffix).then(module=>module[exportName+factoryClassSuffix]).then(factory=>checkNotEmpty(factory,module,exportName))}}function checkNotEmpty(value,modulePath,exportName){if(!value)throw new Error(`Cannot find '${exportName}' in '${modulePath}'`);return value}class DebugEventListener{constructor(name,callback){this.name=name,this.callback=callback}}class DebugNode__PRE_R3__{constructor(nativeNode,parent,_debugContext){this.listeners=[],this.parent=null,this._debugContext=_debugContext,this.nativeNode=nativeNode,parent&&parent instanceof DebugElement__PRE_R3__&&parent.addChild(this)}get injector(){return this._debugContext.injector}get componentInstance(){return this._debugContext.component}get context(){return this._debugContext.context}get references(){return this._debugContext.references}get providerTokens(){return this._debugContext.providerTokens}}class DebugElement__PRE_R3__ extends DebugNode__PRE_R3__{constructor(nativeNode,parent,_debugContext){super(nativeNode,parent,_debugContext),this.properties={},this.attributes={},this.classes={},this.styles={},this.childNodes=[],this.nativeElement=nativeNode}addChild(child){child&&(this.childNodes.push(child),child.parent=this)}removeChild(child){const childIndex=this.childNodes.indexOf(child);-1!==childIndex&&(child.parent=null,this.childNodes.splice(childIndex,1))}insertChildrenAfter(child,newChildren){const siblingIndex=this.childNodes.indexOf(child);-1!==siblingIndex&&(this.childNodes.splice(siblingIndex+1,0,...newChildren),newChildren.forEach(c=>{c.parent&&c.parent.removeChild(c),child.parent=this}))}insertBefore(refChild,newChild){const refIndex=this.childNodes.indexOf(refChild);-1===refIndex?this.addChild(newChild):(newChild.parent&&newChild.parent.removeChild(newChild),newChild.parent=this,this.childNodes.splice(refIndex,0,newChild))}query(predicate){return this.queryAll(predicate)[0]||null}queryAll(predicate){const matches=[];return function _queryElementChildren(element,predicate,matches){element.childNodes.forEach(node=>{node instanceof DebugElement__PRE_R3__&&(predicate(node)&&matches.push(node),_queryElementChildren(node,predicate,matches))})}(this,predicate,matches),matches}queryAllNodes(predicate){const matches=[];return function _queryNodeChildren(parentNode,predicate,matches){parentNode instanceof DebugElement__PRE_R3__&&parentNode.childNodes.forEach(node=>{predicate(node)&&matches.push(node),node instanceof DebugElement__PRE_R3__&&_queryNodeChildren(node,predicate,matches)})}(this,predicate,matches),matches}get children(){return this.childNodes.filter(node=>node instanceof DebugElement__PRE_R3__)}triggerEventHandler(eventName,eventObj){this.listeners.forEach(listener=>{listener.name==eventName&&listener.callback(eventObj)})}}const _nativeNodeToDebugNode=new Map,getDebugNode=function(nativeNode){return _nativeNodeToDebugNode.get(nativeNode)||null};function indexDebugNode(node){_nativeNodeToDebugNode.set(node.nativeNode,node)}const platformCore=createPlatformFactory(null,"core",[{provide:PLATFORM_ID,useValue:"unknown"},{provide:PlatformRef,deps:[Injector]},{provide:TestabilityRegistry,deps:[]},{provide:Console,deps:[]}]);function _iterableDiffersFactory(){return defaultIterableDiffers}function _keyValueDiffersFactory(){return defaultKeyValueDiffers}function _localeFactory(locale){return locale||"en-US"}function zoneSchedulerFactory(ngZone){let queue=[];return ngZone.onStable.subscribe(()=>{for(;queue.length;)queue.pop()()}),function(fn){queue.push(fn)}}class ApplicationModule{constructor(appRef){}}function anchorDef(flags,matchedQueriesDsl,ngContentIndex,childCount,handleEvent,templateFactory){flags|=1;const{matchedQueries:matchedQueries,references:references,matchedQueryIds:matchedQueryIds}=splitMatchedQueriesDsl(matchedQueriesDsl);return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,flags:flags,checkIndex:-1,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:matchedQueries,matchedQueryIds:matchedQueryIds,references:references,ngContentIndex:ngContentIndex,childCount:childCount,bindings:[],bindingFlags:0,outputs:[],element:{ns:null,name:null,attrs:null,template:templateFactory?resolveDefinition(templateFactory):null,componentProvider:null,componentView:null,componentRendererType:null,publicProviders:null,allProviders:null,handleEvent:handleEvent||NOOP},provider:null,text:null,query:null,ngContent:null}}function elementDef(checkIndex,flags,matchedQueriesDsl,ngContentIndex,childCount,namespaceAndName,fixedAttrs=[],bindings,outputs,handleEvent,componentView,componentRendererType){handleEvent||(handleEvent=NOOP);const{matchedQueries:matchedQueries,references:references,matchedQueryIds:matchedQueryIds}=splitMatchedQueriesDsl(matchedQueriesDsl);let ns=null,name=null;namespaceAndName&&([ns,name]=splitNamespace(namespaceAndName)),bindings=bindings||[];const bindingDefs=new Array(bindings.length);for(let i=0;i<bindings.length;i++){const[bindingFlags,namespaceAndName,suffixOrSecurityContext]=bindings[i],[ns,name]=splitNamespace(namespaceAndName);let securityContext=void 0,suffix=void 0;switch(15&bindingFlags){case 4:suffix=suffixOrSecurityContext;break;case 1:case 8:securityContext=suffixOrSecurityContext}bindingDefs[i]={flags:bindingFlags,ns:ns,name:name,nonMinifiedName:name,securityContext:securityContext,suffix:suffix}}outputs=outputs||[];const outputDefs=new Array(outputs.length);for(let i=0;i<outputs.length;i++){const[target,eventName]=outputs[i];outputDefs[i]={type:0,target:target,eventName:eventName,propName:null}}const attrs=(fixedAttrs=fixedAttrs||[]).map(([namespaceAndName,value])=>{const[ns,name]=splitNamespace(namespaceAndName);return[ns,name,value]});return componentRendererType=function(type){if(type&&"$$undefined"===type.id){const isFilled=null!=type.encapsulation&&type.encapsulation!==ViewEncapsulation.None||type.styles.length||Object.keys(type.data).length;type.id=isFilled?"c"+_renderCompCount$1++:"$$empty"}return type&&"$$empty"===type.id&&(type=null),type||null}(componentRendererType),componentView&&(flags|=33554432),{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:checkIndex,flags:flags|=1,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:matchedQueries,matchedQueryIds:matchedQueryIds,references:references,ngContentIndex:ngContentIndex,childCount:childCount,bindings:bindingDefs,bindingFlags:calcBindingFlags(bindingDefs),outputs:outputDefs,element:{ns:ns,name:name,attrs:attrs,template:null,componentProvider:null,componentView:componentView||null,componentRendererType:componentRendererType,publicProviders:null,allProviders:null,handleEvent:handleEvent||NOOP},provider:null,text:null,query:null,ngContent:null}}function createElement(view,renderHost,def){const elDef=def.element,rootSelectorOrNode=view.root.selectorOrNode,renderer=view.renderer;let el;if(view.parent||!rootSelectorOrNode){el=elDef.name?renderer.createElement(elDef.name,elDef.ns):renderer.createComment("");const parentEl=getParentRenderElement(view,renderHost,def);parentEl&&renderer.appendChild(parentEl,el)}else el=renderer.selectRootElement(rootSelectorOrNode,!!elDef.componentRendererType&&elDef.componentRendererType.encapsulation===ViewEncapsulation.ShadowDom);if(elDef.attrs)for(let i=0;i<elDef.attrs.length;i++){const[ns,name,value]=elDef.attrs[i];renderer.setAttribute(el,name,value,ns)}return el}function listenToElementOutputs(view,compView,def,el){for(let i=0;i<def.outputs.length;i++){const output=def.outputs[i],handleEventClosure=renderEventHandlerClosure(view,def.nodeIndex,(name=output.eventName,(target=output.target)?`${target}:${name}`:name));let listenTarget=output.target,listenerView=view;"component"===output.target&&(listenTarget=null,listenerView=compView);const disposable=listenerView.renderer.listen(listenTarget||el,output.eventName,handleEventClosure);view.disposables[def.outputIndex+i]=disposable}var target,name}function renderEventHandlerClosure(view,index,eventName){return event=>dispatchEvent(view,index,eventName,event)}function checkAndUpdateElementValue(view,def,bindingIdx,value){if(!checkAndUpdateBinding(view,def,bindingIdx,value))return!1;const binding=def.bindings[bindingIdx],elData=asElementData(view,def.nodeIndex),renderNode=elData.renderElement,name=binding.name;switch(15&binding.flags){case 1:!function(view,binding,renderNode,ns,name,value){const securityContext=binding.securityContext;let renderValue=securityContext?view.root.sanitizer.sanitize(securityContext,value):value;renderValue=null!=renderValue?renderValue.toString():null;const renderer=view.renderer;null!=value?renderer.setAttribute(renderNode,name,renderValue,ns):renderer.removeAttribute(renderNode,name,ns)}(view,binding,renderNode,binding.ns,name,value);break;case 2:!function(view,renderNode,name,value){const renderer=view.renderer;value?renderer.addClass(renderNode,name):renderer.removeClass(renderNode,name)}(view,renderNode,name,value);break;case 4:!function(view,binding,renderNode,name,value){let renderValue=view.root.sanitizer.sanitize(SecurityContext.STYLE,value);if(null!=renderValue){renderValue=renderValue.toString();const unit=binding.suffix;null!=unit&&(renderValue+=unit)}else renderValue=null;const renderer=view.renderer;null!=renderValue?renderer.setStyle(renderNode,name,renderValue):renderer.removeStyle(renderNode,name)}(view,binding,renderNode,name,value);break;case 8:!function(view,binding,renderNode,name,value){const securityContext=binding.securityContext;let renderValue=securityContext?view.root.sanitizer.sanitize(securityContext,value):value;view.renderer.setProperty(renderNode,name,renderValue)}(33554432&def.flags&&32&binding.flags?elData.componentView:view,binding,renderNode,name,value)}return!0}function queryDef(flags,id,bindings){let bindingDefs=[];for(let propName in bindings)bindingDefs.push({propName:propName,bindingType:bindings[propName]});return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:-1,flags:flags,childFlags:0,directChildFlags:0,childMatchedQueries:0,ngContentIndex:-1,matchedQueries:{},matchedQueryIds:0,references:{},childCount:0,bindings:[],bindingFlags:0,outputs:[],element:null,provider:null,text:null,query:{id:id,filterId:filterQueryId(id),bindings:bindingDefs},ngContent:null}}function dirtyParentQueries(view){const queryIds=view.def.nodeMatchedQueries;for(;view.parent&&isEmbeddedView(view);){let tplDef=view.parentNodeDef;view=view.parent;const end=tplDef.nodeIndex+tplDef.childCount;for(let i=0;i<=end;i++){const nodeDef=view.def.nodes[i];67108864&nodeDef.flags&&536870912&nodeDef.flags&&(nodeDef.query.filterId&queryIds)===nodeDef.query.filterId&&asQueryList(view,i).setDirty(),!(1&nodeDef.flags&&i+nodeDef.childCount<tplDef.nodeIndex)&&67108864&nodeDef.childFlags&&536870912&nodeDef.childFlags||(i+=nodeDef.childCount)}}if(134217728&view.def.nodeFlags)for(let i=0;i<view.def.nodes.length;i++){const nodeDef=view.def.nodes[i];134217728&nodeDef.flags&&536870912&nodeDef.flags&&asQueryList(view,i).setDirty(),i+=nodeDef.childCount}}function checkAndUpdateQuery(view,nodeDef){const queryList=asQueryList(view,nodeDef.nodeIndex);if(!queryList.dirty)return;let directiveInstance,newValues=void 0;if(67108864&nodeDef.flags){const elementDef=nodeDef.parent.parent;newValues=calcQueryValues(view,elementDef.nodeIndex,elementDef.nodeIndex+elementDef.childCount,nodeDef.query,[]),directiveInstance=asProviderData(view,nodeDef.parent.nodeIndex).instance}else 134217728&nodeDef.flags&&(newValues=calcQueryValues(view,0,view.def.nodes.length-1,nodeDef.query,[]),directiveInstance=view.component);queryList.reset(newValues);const bindings=nodeDef.query.bindings;let notify=!1;for(let i=0;i<bindings.length;i++){const binding=bindings[i];let boundValue;switch(binding.bindingType){case 0:boundValue=queryList.first;break;case 1:boundValue=queryList,notify=!0}directiveInstance[binding.propName]=boundValue}notify&&queryList.notifyOnChanges()}function calcQueryValues(view,startIndex,endIndex,queryDef,values){for(let i=startIndex;i<=endIndex;i++){const nodeDef=view.def.nodes[i],valueType=nodeDef.matchedQueries[queryDef.id];if(null!=valueType&&values.push(getQueryValue(view,nodeDef,valueType)),1&nodeDef.flags&&nodeDef.element.template&&(nodeDef.element.template.nodeMatchedQueries&queryDef.filterId)===queryDef.filterId){const elementData=asElementData(view,i);if((nodeDef.childMatchedQueries&queryDef.filterId)===queryDef.filterId&&(calcQueryValues(view,i+1,i+nodeDef.childCount,queryDef,values),i+=nodeDef.childCount),16777216&nodeDef.flags){const embeddedViews=elementData.viewContainer._embeddedViews;for(let k=0;k<embeddedViews.length;k++){const embeddedView=embeddedViews[k],dvc=declaredViewContainer(embeddedView);dvc&&dvc===elementData&&calcQueryValues(embeddedView,0,embeddedView.def.nodes.length-1,queryDef,values)}}const projectedViews=elementData.template._projectedViews;if(projectedViews)for(let k=0;k<projectedViews.length;k++){const projectedView=projectedViews[k];calcQueryValues(projectedView,0,projectedView.def.nodes.length-1,queryDef,values)}}(nodeDef.childMatchedQueries&queryDef.filterId)!==queryDef.filterId&&(i+=nodeDef.childCount)}return values}function getQueryValue(view,nodeDef,queryValueType){if(null!=queryValueType)switch(queryValueType){case 1:return asElementData(view,nodeDef.nodeIndex).renderElement;case 0:return new ElementRef(asElementData(view,nodeDef.nodeIndex).renderElement);case 2:return asElementData(view,nodeDef.nodeIndex).template;case 3:return asElementData(view,nodeDef.nodeIndex).viewContainer;case 4:return asProviderData(view,nodeDef.nodeIndex).instance}}function appendNgContent(view,renderHost,def){const parentEl=getParentRenderElement(view,renderHost,def);parentEl&&visitProjectedRenderNodes(view,def.ngContent.index,1,parentEl,null,void 0)}function pureObjectDef(checkIndex,propToIndex){const keys=Object.keys(propToIndex),nbKeys=keys.length,propertyNames=new Array(nbKeys);for(let i=0;i<nbKeys;i++){const key=keys[i];propertyNames[propToIndex[key]]=key}return function(flags,checkIndex,propertyNames){const bindings=new Array(propertyNames.length);for(let i=0;i<propertyNames.length;i++){const prop=propertyNames[i];bindings[i]={flags:8,name:prop,ns:null,nonMinifiedName:prop,securityContext:null,suffix:null}}return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:checkIndex,flags:64,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:{},matchedQueryIds:0,references:{},ngContentIndex:-1,childCount:0,bindings:bindings,bindingFlags:calcBindingFlags(bindings),outputs:[],element:null,provider:null,text:null,query:null,ngContent:null}}(0,checkIndex,propertyNames)}function textDef(checkIndex,ngContentIndex,staticText){const bindings=new Array(staticText.length-1);for(let i=1;i<staticText.length;i++)bindings[i-1]={flags:8,name:null,ns:null,nonMinifiedName:null,securityContext:null,suffix:staticText[i]};return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:checkIndex,flags:2,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:{},matchedQueryIds:0,references:{},ngContentIndex:ngContentIndex,childCount:0,bindings:bindings,bindingFlags:8,outputs:[],element:null,provider:null,text:{prefix:staticText[0]},query:null,ngContent:null}}function createText(view,renderHost,def){let renderNode;const renderer=view.renderer;renderNode=renderer.createText(def.text.prefix);const parentEl=getParentRenderElement(view,renderHost,def);return parentEl&&renderer.appendChild(parentEl,renderNode),{renderText:renderNode}}function _addInterpolationPart(value,binding){return(null!=value?value.toString():"")+binding.suffix}function viewDef(flags,nodes,updateDirectives,updateRenderer){let viewBindingCount=0,viewDisposableCount=0,viewNodeFlags=0,viewRootNodeFlags=0,viewMatchedQueries=0,currentParent=null,currentRenderParent=null,currentElementHasPublicProviders=!1,currentElementHasPrivateProviders=!1,lastRenderRootNode=null;for(let i=0;i<nodes.length;i++){const node=nodes[i];if(node.nodeIndex=i,node.parent=currentParent,node.bindingIndex=viewBindingCount,node.outputIndex=viewDisposableCount,node.renderParent=currentRenderParent,viewNodeFlags|=node.flags,viewMatchedQueries|=node.matchedQueryIds,node.element){const elDef=node.element;elDef.publicProviders=currentParent?currentParent.element.publicProviders:Object.create(null),elDef.allProviders=elDef.publicProviders,currentElementHasPublicProviders=!1,currentElementHasPrivateProviders=!1,node.element.template&&(viewMatchedQueries|=node.element.template.nodeMatchedQueries)}if(validateNode(currentParent,node,nodes.length),viewBindingCount+=node.bindings.length,viewDisposableCount+=node.outputs.length,!currentRenderParent&&3&node.flags&&(lastRenderRootNode=node),20224&node.flags){currentElementHasPublicProviders||(currentElementHasPublicProviders=!0,currentParent.element.publicProviders=Object.create(currentParent.element.publicProviders),currentParent.element.allProviders=currentParent.element.publicProviders);const isComponent=0!=(32768&node.flags);0==(8192&node.flags)||isComponent?currentParent.element.publicProviders[tokenKey(node.provider.token)]=node:(currentElementHasPrivateProviders||(currentElementHasPrivateProviders=!0,currentParent.element.allProviders=Object.create(currentParent.element.publicProviders)),currentParent.element.allProviders[tokenKey(node.provider.token)]=node),isComponent&&(currentParent.element.componentProvider=node)}if(currentParent?(currentParent.childFlags|=node.flags,currentParent.directChildFlags|=node.flags,currentParent.childMatchedQueries|=node.matchedQueryIds,node.element&&node.element.template&&(currentParent.childMatchedQueries|=node.element.template.nodeMatchedQueries)):viewRootNodeFlags|=node.flags,node.childCount>0)currentParent=node,isNgContainer(node)||(currentRenderParent=node);else for(;currentParent&&i===currentParent.nodeIndex+currentParent.childCount;){const newParent=currentParent.parent;newParent&&(newParent.childFlags|=currentParent.childFlags,newParent.childMatchedQueries|=currentParent.childMatchedQueries),currentParent=newParent,currentRenderParent=currentParent&&isNgContainer(currentParent)?currentParent.renderParent:currentParent}}return{factory:null,nodeFlags:viewNodeFlags,rootNodeFlags:viewRootNodeFlags,nodeMatchedQueries:viewMatchedQueries,flags:flags,nodes:nodes,updateDirectives:updateDirectives||NOOP,updateRenderer:updateRenderer||NOOP,handleEvent:(view,nodeIndex,eventName,event)=>nodes[nodeIndex].element.handleEvent(view,eventName,event),bindingCount:viewBindingCount,outputCount:viewDisposableCount,lastRenderRootNode:lastRenderRootNode}}function isNgContainer(node){return 0!=(1&node.flags)&&null===node.element.name}function validateNode(parent,node,nodeCount){const template=node.element&&node.element.template;if(template){if(!template.lastRenderRootNode)throw new Error("Illegal State: Embedded templates without nodes are not allowed!");if(template.lastRenderRootNode&&16777216&template.lastRenderRootNode.flags)throw new Error(`Illegal State: Last root node of a template can't have embedded views, at index ${node.nodeIndex}!`)}if(20224&node.flags&&0==(1&(parent?parent.flags:0)))throw new Error(`Illegal State: StaticProvider/Directive nodes need to be children of elements or anchors, at index ${node.nodeIndex}!`);if(node.query){if(67108864&node.flags&&(!parent||0==(16384&parent.flags)))throw new Error(`Illegal State: Content Query nodes need to be children of directives, at index ${node.nodeIndex}!`);if(134217728&node.flags&&parent)throw new Error(`Illegal State: View Query nodes have to be top level nodes, at index ${node.nodeIndex}!`)}if(node.childCount){const parentEnd=parent?parent.nodeIndex+parent.childCount:nodeCount-1;if(node.nodeIndex<=parentEnd&&node.nodeIndex+node.childCount>parentEnd)throw new Error(`Illegal State: childCount of node leads outside of parent, at index ${node.nodeIndex}!`)}}function createEmbeddedView(parent,anchorDef,viewDef,context){const view=createView(parent.root,parent.renderer,parent,anchorDef,viewDef);return initView(view,parent.component,context),createViewNodes(view),view}function createRootView(root,def,context){const view=createView(root,root.renderer,null,null,def);return initView(view,context,context),createViewNodes(view),view}function createComponentView(parentView,nodeDef,viewDef,hostElement){const rendererType=nodeDef.element.componentRendererType;let compRenderer;return compRenderer=rendererType?parentView.root.rendererFactory.createRenderer(hostElement,rendererType):parentView.root.renderer,createView(parentView.root,compRenderer,parentView,nodeDef.element.componentProvider,viewDef)}function createView(root,renderer,parent,parentNodeDef,def){const nodes=new Array(def.nodes.length),disposables=def.outputCount?new Array(def.outputCount):null;return{def:def,parent:parent,viewContainerParent:null,parentNodeDef:parentNodeDef,context:null,component:null,nodes:nodes,state:13,root:root,renderer:renderer,oldValues:new Array(def.bindingCount),disposables:disposables,initIndex:-1}}function initView(view,component,context){view.component=component,view.context=context}function createViewNodes(view){let renderHost;isComponentView(view)&&(renderHost=asElementData(view.parent,view.parentNodeDef.parent.nodeIndex).renderElement);const def=view.def,nodes=view.nodes;for(let i=0;i<def.nodes.length;i++){const nodeDef=def.nodes[i];let nodeData;switch(Services.setCurrentNode(view,i),201347067&nodeDef.flags){case 1:const el=createElement(view,renderHost,nodeDef);let componentView=void 0;if(33554432&nodeDef.flags){const compViewDef=resolveDefinition(nodeDef.element.componentView);componentView=Services.createComponentView(view,nodeDef,compViewDef,el)}listenToElementOutputs(view,componentView,nodeDef,el),nodeData={renderElement:el,componentView:componentView,viewContainer:null,template:nodeDef.element.template?createTemplateData(view,nodeDef):void 0},16777216&nodeDef.flags&&(nodeData.viewContainer=createViewContainerData(view,nodeDef,nodeData));break;case 2:nodeData=createText(view,renderHost,nodeDef);break;case 512:case 1024:case 2048:case 256:nodeData=nodes[i],nodeData||4096&nodeDef.flags||(nodeData={instance:createProviderInstance(view,nodeDef)});break;case 16:nodeData={instance:createPipeInstance(view,nodeDef)};break;case 16384:nodeData=nodes[i],nodeData||(nodeData={instance:createDirectiveInstance(view,nodeDef)}),32768&nodeDef.flags&&initView(asElementData(view,nodeDef.parent.nodeIndex).componentView,nodeData.instance,nodeData.instance);break;case 32:case 64:case 128:nodeData={value:void 0};break;case 67108864:case 134217728:nodeData=new QueryList;break;case 8:appendNgContent(view,renderHost,nodeDef),nodeData=void 0}nodes[i]=nodeData}execComponentViewsAction(view,ViewAction.CreateViewNodes),execQueriesAction(view,201326592,268435456,0)}function checkNoChangesView(view){markProjectedViewsForCheck(view),Services.updateDirectives(view,1),execEmbeddedViewsAction(view,ViewAction.CheckNoChanges),Services.updateRenderer(view,1),execComponentViewsAction(view,ViewAction.CheckNoChanges),view.state&=-97}function checkAndUpdateView(view){1&view.state?(view.state&=-2,view.state|=2):view.state&=-3,shiftInitState(view,0,256),markProjectedViewsForCheck(view),Services.updateDirectives(view,0),execEmbeddedViewsAction(view,ViewAction.CheckAndUpdate),execQueriesAction(view,67108864,536870912,0);let callInit=shiftInitState(view,256,512);callLifecycleHooksChildrenFirst(view,2097152|(callInit?1048576:0)),Services.updateRenderer(view,0),execComponentViewsAction(view,ViewAction.CheckAndUpdate),execQueriesAction(view,134217728,536870912,0),callInit=shiftInitState(view,512,768),callLifecycleHooksChildrenFirst(view,8388608|(callInit?4194304:0)),2&view.def.flags&&(view.state&=-9),view.state&=-97,shiftInitState(view,768,1024)}function checkAndUpdateNode(view,nodeDef,argStyle,v0,v1,v2,v3,v4,v5,v6,v7,v8,v9){return 0===argStyle?function(view,nodeDef,v0,v1,v2,v3,v4,v5,v6,v7,v8,v9){switch(201347067&nodeDef.flags){case 1:return function(view,def,v0,v1,v2,v3,v4,v5,v6,v7,v8,v9){const bindLen=def.bindings.length;let changed=!1;return bindLen>0&&checkAndUpdateElementValue(view,def,0,v0)&&(changed=!0),bindLen>1&&checkAndUpdateElementValue(view,def,1,v1)&&(changed=!0),bindLen>2&&checkAndUpdateElementValue(view,def,2,v2)&&(changed=!0),bindLen>3&&checkAndUpdateElementValue(view,def,3,v3)&&(changed=!0),bindLen>4&&checkAndUpdateElementValue(view,def,4,v4)&&(changed=!0),bindLen>5&&checkAndUpdateElementValue(view,def,5,v5)&&(changed=!0),bindLen>6&&checkAndUpdateElementValue(view,def,6,v6)&&(changed=!0),bindLen>7&&checkAndUpdateElementValue(view,def,7,v7)&&(changed=!0),bindLen>8&&checkAndUpdateElementValue(view,def,8,v8)&&(changed=!0),bindLen>9&&checkAndUpdateElementValue(view,def,9,v9)&&(changed=!0),changed}(view,nodeDef,v0,v1,v2,v3,v4,v5,v6,v7,v8,v9);case 2:return function(view,def,v0,v1,v2,v3,v4,v5,v6,v7,v8,v9){let changed=!1;const bindings=def.bindings,bindLen=bindings.length;if(bindLen>0&&checkAndUpdateBinding(view,def,0,v0)&&(changed=!0),bindLen>1&&checkAndUpdateBinding(view,def,1,v1)&&(changed=!0),bindLen>2&&checkAndUpdateBinding(view,def,2,v2)&&(changed=!0),bindLen>3&&checkAndUpdateBinding(view,def,3,v3)&&(changed=!0),bindLen>4&&checkAndUpdateBinding(view,def,4,v4)&&(changed=!0),bindLen>5&&checkAndUpdateBinding(view,def,5,v5)&&(changed=!0),bindLen>6&&checkAndUpdateBinding(view,def,6,v6)&&(changed=!0),bindLen>7&&checkAndUpdateBinding(view,def,7,v7)&&(changed=!0),bindLen>8&&checkAndUpdateBinding(view,def,8,v8)&&(changed=!0),bindLen>9&&checkAndUpdateBinding(view,def,9,v9)&&(changed=!0),changed){let value=def.text.prefix;bindLen>0&&(value+=_addInterpolationPart(v0,bindings[0])),bindLen>1&&(value+=_addInterpolationPart(v1,bindings[1])),bindLen>2&&(value+=_addInterpolationPart(v2,bindings[2])),bindLen>3&&(value+=_addInterpolationPart(v3,bindings[3])),bindLen>4&&(value+=_addInterpolationPart(v4,bindings[4])),bindLen>5&&(value+=_addInterpolationPart(v5,bindings[5])),bindLen>6&&(value+=_addInterpolationPart(v6,bindings[6])),bindLen>7&&(value+=_addInterpolationPart(v7,bindings[7])),bindLen>8&&(value+=_addInterpolationPart(v8,bindings[8])),bindLen>9&&(value+=_addInterpolationPart(v9,bindings[9]));const renderNode=asTextData(view,def.nodeIndex).renderText;view.renderer.setValue(renderNode,value)}return changed}(view,nodeDef,v0,v1,v2,v3,v4,v5,v6,v7,v8,v9);case 16384:return function(view,def,v0,v1,v2,v3,v4,v5,v6,v7,v8,v9){const providerData=asProviderData(view,def.nodeIndex),directive=providerData.instance;let changed=!1,changes=void 0;const bindLen=def.bindings.length;return bindLen>0&&checkBinding(view,def,0,v0)&&(changed=!0,changes=updateProp(view,providerData,def,0,v0,changes)),bindLen>1&&checkBinding(view,def,1,v1)&&(changed=!0,changes=updateProp(view,providerData,def,1,v1,changes)),bindLen>2&&checkBinding(view,def,2,v2)&&(changed=!0,changes=updateProp(view,providerData,def,2,v2,changes)),bindLen>3&&checkBinding(view,def,3,v3)&&(changed=!0,changes=updateProp(view,providerData,def,3,v3,changes)),bindLen>4&&checkBinding(view,def,4,v4)&&(changed=!0,changes=updateProp(view,providerData,def,4,v4,changes)),bindLen>5&&checkBinding(view,def,5,v5)&&(changed=!0,changes=updateProp(view,providerData,def,5,v5,changes)),bindLen>6&&checkBinding(view,def,6,v6)&&(changed=!0,changes=updateProp(view,providerData,def,6,v6,changes)),bindLen>7&&checkBinding(view,def,7,v7)&&(changed=!0,changes=updateProp(view,providerData,def,7,v7,changes)),bindLen>8&&checkBinding(view,def,8,v8)&&(changed=!0,changes=updateProp(view,providerData,def,8,v8,changes)),bindLen>9&&checkBinding(view,def,9,v9)&&(changed=!0,changes=updateProp(view,providerData,def,9,v9,changes)),changes&&directive.ngOnChanges(changes),65536&def.flags&&shouldCallLifecycleInitHook(view,256,def.nodeIndex)&&directive.ngOnInit(),262144&def.flags&&directive.ngDoCheck(),changed}(view,nodeDef,v0,v1,v2,v3,v4,v5,v6,v7,v8,v9);case 32:case 64:case 128:return function(view,def,v0,v1,v2,v3,v4,v5,v6,v7,v8,v9){const bindings=def.bindings;let changed=!1;const bindLen=bindings.length;if(bindLen>0&&checkAndUpdateBinding(view,def,0,v0)&&(changed=!0),bindLen>1&&checkAndUpdateBinding(view,def,1,v1)&&(changed=!0),bindLen>2&&checkAndUpdateBinding(view,def,2,v2)&&(changed=!0),bindLen>3&&checkAndUpdateBinding(view,def,3,v3)&&(changed=!0),bindLen>4&&checkAndUpdateBinding(view,def,4,v4)&&(changed=!0),bindLen>5&&checkAndUpdateBinding(view,def,5,v5)&&(changed=!0),bindLen>6&&checkAndUpdateBinding(view,def,6,v6)&&(changed=!0),bindLen>7&&checkAndUpdateBinding(view,def,7,v7)&&(changed=!0),bindLen>8&&checkAndUpdateBinding(view,def,8,v8)&&(changed=!0),bindLen>9&&checkAndUpdateBinding(view,def,9,v9)&&(changed=!0),changed){const data=asPureExpressionData(view,def.nodeIndex);let value;switch(201347067&def.flags){case 32:value=new Array(bindings.length),bindLen>0&&(value[0]=v0),bindLen>1&&(value[1]=v1),bindLen>2&&(value[2]=v2),bindLen>3&&(value[3]=v3),bindLen>4&&(value[4]=v4),bindLen>5&&(value[5]=v5),bindLen>6&&(value[6]=v6),bindLen>7&&(value[7]=v7),bindLen>8&&(value[8]=v8),bindLen>9&&(value[9]=v9);break;case 64:value={},bindLen>0&&(value[bindings[0].name]=v0),bindLen>1&&(value[bindings[1].name]=v1),bindLen>2&&(value[bindings[2].name]=v2),bindLen>3&&(value[bindings[3].name]=v3),bindLen>4&&(value[bindings[4].name]=v4),bindLen>5&&(value[bindings[5].name]=v5),bindLen>6&&(value[bindings[6].name]=v6),bindLen>7&&(value[bindings[7].name]=v7),bindLen>8&&(value[bindings[8].name]=v8),bindLen>9&&(value[bindings[9].name]=v9);break;case 128:const pipe=v0;switch(bindLen){case 1:value=pipe.transform(v0);break;case 2:value=pipe.transform(v1);break;case 3:value=pipe.transform(v1,v2);break;case 4:value=pipe.transform(v1,v2,v3);break;case 5:value=pipe.transform(v1,v2,v3,v4);break;case 6:value=pipe.transform(v1,v2,v3,v4,v5);break;case 7:value=pipe.transform(v1,v2,v3,v4,v5,v6);break;case 8:value=pipe.transform(v1,v2,v3,v4,v5,v6,v7);break;case 9:value=pipe.transform(v1,v2,v3,v4,v5,v6,v7,v8);break;case 10:value=pipe.transform(v1,v2,v3,v4,v5,v6,v7,v8,v9)}}data.value=value}return changed}(view,nodeDef,v0,v1,v2,v3,v4,v5,v6,v7,v8,v9);default:throw"unreachable"}}(view,nodeDef,v0,v1,v2,v3,v4,v5,v6,v7,v8,v9):function(view,nodeDef,values){switch(201347067&nodeDef.flags){case 1:return function(view,def,values){let changed=!1;for(let i=0;i<values.length;i++)checkAndUpdateElementValue(view,def,i,values[i])&&(changed=!0);return changed}(view,nodeDef,values);case 2:return function(view,def,values){const bindings=def.bindings;let changed=!1;for(let i=0;i<values.length;i++)checkAndUpdateBinding(view,def,i,values[i])&&(changed=!0);if(changed){let value="";for(let i=0;i<values.length;i++)value+=_addInterpolationPart(values[i],bindings[i]);value=def.text.prefix+value;const renderNode=asTextData(view,def.nodeIndex).renderText;view.renderer.setValue(renderNode,value)}return changed}(view,nodeDef,values);case 16384:return function(view,def,values){const providerData=asProviderData(view,def.nodeIndex),directive=providerData.instance;let changed=!1,changes=void 0;for(let i=0;i<values.length;i++)checkBinding(view,def,i,values[i])&&(changed=!0,changes=updateProp(view,providerData,def,i,values[i],changes));return changes&&directive.ngOnChanges(changes),65536&def.flags&&shouldCallLifecycleInitHook(view,256,def.nodeIndex)&&directive.ngOnInit(),262144&def.flags&&directive.ngDoCheck(),changed}(view,nodeDef,values);case 32:case 64:case 128:return function(view,def,values){const bindings=def.bindings;let changed=!1;for(let i=0;i<values.length;i++)checkAndUpdateBinding(view,def,i,values[i])&&(changed=!0);if(changed){const data=asPureExpressionData(view,def.nodeIndex);let value;switch(201347067&def.flags){case 32:value=values;break;case 64:value={};for(let i=0;i<values.length;i++)value[bindings[i].name]=values[i];break;case 128:const pipe=values[0],params=values.slice(1);value=pipe.transform(...params)}data.value=value}return changed}(view,nodeDef,values);default:throw"unreachable"}}(view,nodeDef,v0)}function markProjectedViewsForCheck(view){const def=view.def;if(4&def.nodeFlags)for(let i=0;i<def.nodes.length;i++){const nodeDef=def.nodes[i];if(4&nodeDef.flags){const projectedViews=asElementData(view,i).template._projectedViews;if(projectedViews)for(let i=0;i<projectedViews.length;i++){const projectedView=projectedViews[i];projectedView.state|=32,markParentViewsForCheckProjectedViews(projectedView,view)}}else 0==(4&nodeDef.childFlags)&&(i+=nodeDef.childCount)}}function checkNoChangesNode(view,nodeDef,argStyle,v0,v1,v2,v3,v4,v5,v6,v7,v8,v9){return 0===argStyle?function(view,nodeDef,v0,v1,v2,v3,v4,v5,v6,v7,v8,v9){const bindLen=nodeDef.bindings.length;bindLen>0&&checkBindingNoChanges(view,nodeDef,0,v0),bindLen>1&&checkBindingNoChanges(view,nodeDef,1,v1),bindLen>2&&checkBindingNoChanges(view,nodeDef,2,v2),bindLen>3&&checkBindingNoChanges(view,nodeDef,3,v3),bindLen>4&&checkBindingNoChanges(view,nodeDef,4,v4),bindLen>5&&checkBindingNoChanges(view,nodeDef,5,v5),bindLen>6&&checkBindingNoChanges(view,nodeDef,6,v6),bindLen>7&&checkBindingNoChanges(view,nodeDef,7,v7),bindLen>8&&checkBindingNoChanges(view,nodeDef,8,v8),bindLen>9&&checkBindingNoChanges(view,nodeDef,9,v9)}(view,nodeDef,v0,v1,v2,v3,v4,v5,v6,v7,v8,v9):function(view,nodeDef,values){for(let i=0;i<values.length;i++)checkBindingNoChanges(view,nodeDef,i,values[i])}(view,nodeDef,v0),!1}function checkNoChangesQuery(view,nodeDef){if(asQueryList(view,nodeDef.nodeIndex).dirty)throw expressionChangedAfterItHasBeenCheckedError(Services.createDebugContext(view,nodeDef.nodeIndex),`Query ${nodeDef.query.id} not dirty`,`Query ${nodeDef.query.id} dirty`,0!=(1&view.state))}function destroyView(view){if(!(128&view.state)){if(execEmbeddedViewsAction(view,ViewAction.Destroy),execComponentViewsAction(view,ViewAction.Destroy),callLifecycleHooksChildrenFirst(view,131072),view.disposables)for(let i=0;i<view.disposables.length;i++)view.disposables[i]();!function(view){if(!(16&view.state))return;const dvcElementData=declaredViewContainer(view);if(dvcElementData){const projectedViews=dvcElementData.template._projectedViews;projectedViews&&(removeFromArray(projectedViews,projectedViews.indexOf(view)),Services.dirtyParentQueries(view))}}(view),view.renderer.destroyNode&&function(view){const len=view.def.nodes.length;for(let i=0;i<len;i++){const def=view.def.nodes[i];1&def.flags?view.renderer.destroyNode(asElementData(view,i).renderElement):2&def.flags?view.renderer.destroyNode(asTextData(view,i).renderText):(67108864&def.flags||134217728&def.flags)&&asQueryList(view,i).destroy()}}(view),isComponentView(view)&&view.renderer.destroy(),view.state|=128}}const ViewAction=function(){var ViewAction={CreateViewNodes:0,CheckNoChanges:1,CheckNoChangesProjectedViews:2,CheckAndUpdate:3,CheckAndUpdateProjectedViews:4,Destroy:5};return ViewAction[ViewAction.CreateViewNodes]="CreateViewNodes",ViewAction[ViewAction.CheckNoChanges]="CheckNoChanges",ViewAction[ViewAction.CheckNoChangesProjectedViews]="CheckNoChangesProjectedViews",ViewAction[ViewAction.CheckAndUpdate]="CheckAndUpdate",ViewAction[ViewAction.CheckAndUpdateProjectedViews]="CheckAndUpdateProjectedViews",ViewAction[ViewAction.Destroy]="Destroy",ViewAction}();function execComponentViewsAction(view,action){const def=view.def;if(33554432&def.nodeFlags)for(let i=0;i<def.nodes.length;i++){const nodeDef=def.nodes[i];33554432&nodeDef.flags?callViewAction(asElementData(view,i).componentView,action):0==(33554432&nodeDef.childFlags)&&(i+=nodeDef.childCount)}}function execEmbeddedViewsAction(view,action){const def=view.def;if(16777216&def.nodeFlags)for(let i=0;i<def.nodes.length;i++){const nodeDef=def.nodes[i];if(16777216&nodeDef.flags){const embeddedViews=asElementData(view,i).viewContainer._embeddedViews;for(let k=0;k<embeddedViews.length;k++)callViewAction(embeddedViews[k],action)}else 0==(16777216&nodeDef.childFlags)&&(i+=nodeDef.childCount)}}function callViewAction(view,action){const viewState=view.state;switch(action){case ViewAction.CheckNoChanges:0==(128&viewState)&&(12==(12&viewState)?checkNoChangesView(view):64&viewState&&execProjectedViewsAction(view,ViewAction.CheckNoChangesProjectedViews));break;case ViewAction.CheckNoChangesProjectedViews:0==(128&viewState)&&(32&viewState?checkNoChangesView(view):64&viewState&&execProjectedViewsAction(view,action));break;case ViewAction.CheckAndUpdate:0==(128&viewState)&&(12==(12&viewState)?checkAndUpdateView(view):64&viewState&&execProjectedViewsAction(view,ViewAction.CheckAndUpdateProjectedViews));break;case ViewAction.CheckAndUpdateProjectedViews:0==(128&viewState)&&(32&viewState?checkAndUpdateView(view):64&viewState&&execProjectedViewsAction(view,action));break;case ViewAction.Destroy:destroyView(view);break;case ViewAction.CreateViewNodes:createViewNodes(view)}}function execProjectedViewsAction(view,action){execEmbeddedViewsAction(view,action),execComponentViewsAction(view,action)}function execQueriesAction(view,queryFlags,staticDynamicQueryFlag,checkType){if(!(view.def.nodeFlags&queryFlags&&view.def.nodeFlags&staticDynamicQueryFlag))return;const nodeCount=view.def.nodes.length;for(let i=0;i<nodeCount;i++){const nodeDef=view.def.nodes[i];if(nodeDef.flags&queryFlags&&nodeDef.flags&staticDynamicQueryFlag)switch(Services.setCurrentNode(view,nodeDef.nodeIndex),checkType){case 0:checkAndUpdateQuery(view,nodeDef);break;case 1:checkNoChangesQuery(view,nodeDef)}nodeDef.childFlags&queryFlags&&nodeDef.childFlags&staticDynamicQueryFlag||(i+=nodeDef.childCount)}}let initialized=!1;function createProdRootView(elInjector,projectableNodes,rootSelectorOrNode,def,ngModule,context){const rendererFactory=ngModule.injector.get(RendererFactory2);return createRootView(createRootData(elInjector,ngModule,rendererFactory,projectableNodes,rootSelectorOrNode),def,context)}function debugCreateRootView(elInjector,projectableNodes,rootSelectorOrNode,def,ngModule,context){const rendererFactory=ngModule.injector.get(RendererFactory2),root=createRootData(elInjector,ngModule,new DebugRendererFactory2(rendererFactory),projectableNodes,rootSelectorOrNode),defWithOverride=applyProviderOverridesToView(def);return callWithDebugContext(DebugAction.create,createRootView,null,[root,defWithOverride,context])}function createRootData(elInjector,ngModule,rendererFactory,projectableNodes,rootSelectorOrNode){const sanitizer=ngModule.injector.get(Sanitizer),errorHandler=ngModule.injector.get(ErrorHandler),renderer=rendererFactory.createRenderer(null,null);return{ngModule:ngModule,injector:elInjector,projectableNodes:projectableNodes,selectorOrNode:rootSelectorOrNode,sanitizer:sanitizer,rendererFactory:rendererFactory,renderer:renderer,errorHandler:errorHandler}}function debugCreateEmbeddedView(parentView,anchorDef,viewDef,context){const defWithOverride=applyProviderOverridesToView(viewDef);return callWithDebugContext(DebugAction.create,createEmbeddedView,null,[parentView,anchorDef,defWithOverride,context])}function debugCreateComponentView(parentView,nodeDef,viewDef,hostElement){return viewDef=viewDefOverrides.get(nodeDef.element.componentProvider.provider.token)||applyProviderOverridesToView(viewDef),callWithDebugContext(DebugAction.create,createComponentView,null,[parentView,nodeDef,viewDef,hostElement])}function debugCreateNgModuleRef(moduleType,parentInjector,bootstrapComponents,def){return createNgModuleRef(moduleType,parentInjector,bootstrapComponents,function(def){const{hasOverrides:hasOverrides,hasDeprecatedOverrides:hasDeprecatedOverrides}=function(def){let hasOverrides=!1,hasDeprecatedOverrides=!1;return 0===providerOverrides.size||(def.providers.forEach(node=>{const override=providerOverrides.get(node.token);3840&node.flags&&override&&(hasOverrides=!0,hasDeprecatedOverrides=hasDeprecatedOverrides||override.deprecatedBehavior)}),def.modules.forEach(module=>{providerOverridesWithScope.forEach((override,token)=>{getInjectableDef(token).providedIn===module&&(hasOverrides=!0,hasDeprecatedOverrides=hasDeprecatedOverrides||override.deprecatedBehavior)})})),{hasOverrides:hasOverrides,hasDeprecatedOverrides:hasDeprecatedOverrides}}(def);return hasOverrides?(function(def){for(let i=0;i<def.providers.length;i++){const provider=def.providers[i];hasDeprecatedOverrides&&(provider.flags|=4096);const override=providerOverrides.get(provider.token);override&&(provider.flags=-3841&provider.flags|override.flags,provider.deps=splitDepsDsl(override.deps),provider.value=override.value)}if(providerOverridesWithScope.size>0){let moduleSet=new Set(def.modules);providerOverridesWithScope.forEach((override,token)=>{if(moduleSet.has(getInjectableDef(token).providedIn)){let provider={token:token,flags:override.flags|(hasDeprecatedOverrides?4096:0),deps:splitDepsDsl(override.deps),value:override.value,index:def.providers.length};def.providers.push(provider),def.providersByKey[tokenKey(token)]=provider}})}}(def=def.factory(()=>NOOP)),def):def}(def))}const providerOverrides=new Map,providerOverridesWithScope=new Map,viewDefOverrides=new Map;function debugOverrideProvider(override){let injectableDef;providerOverrides.set(override.token,override),"function"==typeof override.token&&(injectableDef=getInjectableDef(override.token))&&"function"==typeof injectableDef.providedIn&&providerOverridesWithScope.set(override.token,override)}function debugOverrideComponentView(comp,compFactory){const hostViewDef=resolveDefinition(compFactory.viewDefFactory),compViewDef=resolveDefinition(hostViewDef.nodes[0].element.componentView);viewDefOverrides.set(comp,compViewDef)}function debugClearOverrides(){providerOverrides.clear(),providerOverridesWithScope.clear(),viewDefOverrides.clear()}function applyProviderOverridesToView(def){if(0===providerOverrides.size)return def;const elementIndicesWithOverwrittenProviders=function(def){const elIndicesWithOverwrittenProviders=[];let lastElementDef=null;for(let i=0;i<def.nodes.length;i++){const nodeDef=def.nodes[i];1&nodeDef.flags&&(lastElementDef=nodeDef),lastElementDef&&3840&nodeDef.flags&&providerOverrides.has(nodeDef.provider.token)&&(elIndicesWithOverwrittenProviders.push(lastElementDef.nodeIndex),lastElementDef=null)}return elIndicesWithOverwrittenProviders}(def);if(0===elementIndicesWithOverwrittenProviders.length)return def;def=def.factory(()=>NOOP);for(let i=0;i<elementIndicesWithOverwrittenProviders.length;i++)applyProviderOverridesToElement(def,elementIndicesWithOverwrittenProviders[i]);return def;function applyProviderOverridesToElement(viewDef,elIndex){for(let i=elIndex+1;i<viewDef.nodes.length;i++){const nodeDef=viewDef.nodes[i];if(1&nodeDef.flags)return;if(3840&nodeDef.flags){const provider=nodeDef.provider,override=providerOverrides.get(provider.token);override&&(nodeDef.flags=-3841&nodeDef.flags|override.flags,provider.deps=splitDepsDsl(override.deps),provider.value=override.value)}}}}function prodCheckAndUpdateNode(view,checkIndex,argStyle,v0,v1,v2,v3,v4,v5,v6,v7,v8,v9){const nodeDef=view.def.nodes[checkIndex];return checkAndUpdateNode(view,nodeDef,argStyle,v0,v1,v2,v3,v4,v5,v6,v7,v8,v9),224&nodeDef.flags?asPureExpressionData(view,checkIndex).value:void 0}function prodCheckNoChangesNode(view,checkIndex,argStyle,v0,v1,v2,v3,v4,v5,v6,v7,v8,v9){const nodeDef=view.def.nodes[checkIndex];return checkNoChangesNode(view,nodeDef,argStyle,v0,v1,v2,v3,v4,v5,v6,v7,v8,v9),224&nodeDef.flags?asPureExpressionData(view,checkIndex).value:void 0}function debugCheckAndUpdateView(view){return callWithDebugContext(DebugAction.detectChanges,checkAndUpdateView,null,[view])}function debugCheckNoChangesView(view){return callWithDebugContext(DebugAction.checkNoChanges,checkNoChangesView,null,[view])}function debugDestroyView(view){return callWithDebugContext(DebugAction.destroy,destroyView,null,[view])}const DebugAction=function(){var DebugAction={create:0,detectChanges:1,checkNoChanges:2,destroy:3,handleEvent:4};return DebugAction[DebugAction.create]="create",DebugAction[DebugAction.detectChanges]="detectChanges",DebugAction[DebugAction.checkNoChanges]="checkNoChanges",DebugAction[DebugAction.destroy]="destroy",DebugAction[DebugAction.handleEvent]="handleEvent",DebugAction}();let _currentAction,_currentView,_currentNodeIndex;function debugSetCurrentNode(view,nodeIndex){_currentView=view,_currentNodeIndex=nodeIndex}function debugHandleEvent(view,nodeIndex,eventName,event){return debugSetCurrentNode(view,nodeIndex),callWithDebugContext(DebugAction.handleEvent,view.def.handleEvent,null,[view,nodeIndex,eventName,event])}function debugUpdateDirectives(view,checkType){if(128&view.state)throw viewDestroyedError(DebugAction[_currentAction]);return debugSetCurrentNode(view,nextDirectiveWithBinding(view,0)),view.def.updateDirectives((function(view,nodeIndex,argStyle,...values){const nodeDef=view.def.nodes[nodeIndex];return 0===checkType?debugCheckAndUpdateNode(view,nodeDef,argStyle,values):debugCheckNoChangesNode(view,nodeDef,argStyle,values),16384&nodeDef.flags&&debugSetCurrentNode(view,nextDirectiveWithBinding(view,nodeIndex)),224&nodeDef.flags?asPureExpressionData(view,nodeDef.nodeIndex).value:void 0}),view)}function debugUpdateRenderer(view,checkType){if(128&view.state)throw viewDestroyedError(DebugAction[_currentAction]);return debugSetCurrentNode(view,nextRenderNodeWithBinding(view,0)),view.def.updateRenderer((function(view,nodeIndex,argStyle,...values){const nodeDef=view.def.nodes[nodeIndex];return 0===checkType?debugCheckAndUpdateNode(view,nodeDef,argStyle,values):debugCheckNoChangesNode(view,nodeDef,argStyle,values),3&nodeDef.flags&&debugSetCurrentNode(view,nextRenderNodeWithBinding(view,nodeIndex)),224&nodeDef.flags?asPureExpressionData(view,nodeDef.nodeIndex).value:void 0}),view)}function debugCheckAndUpdateNode(view,nodeDef,argStyle,givenValues){if(checkAndUpdateNode(view,nodeDef,argStyle,...givenValues)){const values=1===argStyle?givenValues[0]:givenValues;if(16384&nodeDef.flags){const bindingValues={};for(let i=0;i<nodeDef.bindings.length;i++){const binding=nodeDef.bindings[i],value=values[i];8&binding.flags&&(bindingValues[(name=binding.nonMinifiedName,"ng-reflect-"+name.replace(/[$@]/g,"_").replace(CAMEL_CASE_REGEXP,(...m)=>"-"+m[1].toLowerCase()))]=normalizeDebugBindingValue(value))}const elDef=nodeDef.parent,el=asElementData(view,elDef.nodeIndex).renderElement;if(elDef.element.name)for(let attr in bindingValues){const value=bindingValues[attr];null!=value?view.renderer.setAttribute(el,attr,value):view.renderer.removeAttribute(el,attr)}else view.renderer.setValue(el,"bindings="+JSON.stringify(bindingValues,null,2))}}var name}function debugCheckNoChangesNode(view,nodeDef,argStyle,values){checkNoChangesNode(view,nodeDef,argStyle,...values)}function nextDirectiveWithBinding(view,nodeIndex){for(let i=nodeIndex;i<view.def.nodes.length;i++){const nodeDef=view.def.nodes[i];if(16384&nodeDef.flags&&nodeDef.bindings&&nodeDef.bindings.length)return i}return null}function nextRenderNodeWithBinding(view,nodeIndex){for(let i=nodeIndex;i<view.def.nodes.length;i++){const nodeDef=view.def.nodes[i];if(3&nodeDef.flags&&nodeDef.bindings&&nodeDef.bindings.length)return i}return null}class DebugContext_{constructor(view,nodeIndex){this.view=view,this.nodeIndex=nodeIndex,null==nodeIndex&&(this.nodeIndex=nodeIndex=0),this.nodeDef=view.def.nodes[nodeIndex];let elDef=this.nodeDef,elView=view;for(;elDef&&0==(1&elDef.flags);)elDef=elDef.parent;if(!elDef)for(;!elDef&&elView;)elDef=viewParentEl(elView),elView=elView.parent;this.elDef=elDef,this.elView=elView}get elOrCompView(){return asElementData(this.elView,this.elDef.nodeIndex).componentView||this.view}get injector(){return createInjector$1(this.elView,this.elDef)}get component(){return this.elOrCompView.component}get context(){return this.elOrCompView.context}get providerTokens(){const tokens=[];if(this.elDef)for(let i=this.elDef.nodeIndex+1;i<=this.elDef.nodeIndex+this.elDef.childCount;i++){const childDef=this.elView.def.nodes[i];20224&childDef.flags&&tokens.push(childDef.provider.token),i+=childDef.childCount}return tokens}get references(){const references={};if(this.elDef){collectReferences(this.elView,this.elDef,references);for(let i=this.elDef.nodeIndex+1;i<=this.elDef.nodeIndex+this.elDef.childCount;i++){const childDef=this.elView.def.nodes[i];20224&childDef.flags&&collectReferences(this.elView,childDef,references),i+=childDef.childCount}}return references}get componentRenderElement(){const elData=function(view){for(;view&&!isComponentView(view);)view=view.parent;return view.parent?asElementData(view.parent,viewParentEl(view).nodeIndex):null}(this.elOrCompView);return elData?elData.renderElement:void 0}get renderNode(){return 2&this.nodeDef.flags?renderNode(this.view,this.nodeDef):renderNode(this.elView,this.elDef)}logError(console,...values){let logViewDef,logNodeIndex;2&this.nodeDef.flags?(logViewDef=this.view.def,logNodeIndex=this.nodeDef.nodeIndex):(logViewDef=this.elView.def,logNodeIndex=this.elDef.nodeIndex);const renderNodeIndex=function(viewDef,nodeIndex){let renderNodeIndex=-1;for(let i=0;i<=nodeIndex;i++)3&viewDef.nodes[i].flags&&renderNodeIndex++;return renderNodeIndex}(logViewDef,logNodeIndex);let currRenderNodeIndex=-1;logViewDef.factory(()=>(currRenderNodeIndex++,currRenderNodeIndex===renderNodeIndex?console.error.bind(console,...values):NOOP)),currRenderNodeIndex<renderNodeIndex&&(console.error("Illegal state: the ViewDefinitionFactory did not call the logger!"),console.error(...values))}}function collectReferences(view,nodeDef,references){for(let refName in nodeDef.references)references[refName]=getQueryValue(view,nodeDef,nodeDef.references[refName])}function callWithDebugContext(action,fn,self,args){const oldAction=_currentAction,oldView=_currentView,oldNodeIndex=_currentNodeIndex;try{_currentAction=action;const result=fn.apply(self,args);return _currentView=oldView,_currentNodeIndex=oldNodeIndex,_currentAction=oldAction,result}catch(e){if(getDebugContext(e)||!_currentView)throw e;throw function(err,context){return err instanceof Error||(err=new Error(err.toString())),_addDebugContext(err,context),err}(e,getCurrentDebugContext())}}function getCurrentDebugContext(){return _currentView?new DebugContext_(_currentView,_currentNodeIndex):null}class DebugRendererFactory2{constructor(delegate){this.delegate=delegate}createRenderer(element,renderData){return new DebugRenderer2(this.delegate.createRenderer(element,renderData))}begin(){this.delegate.begin&&this.delegate.begin()}end(){this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.delegate.whenRenderingDone?this.delegate.whenRenderingDone():Promise.resolve(null)}}class DebugRenderer2{constructor(delegate){this.delegate=delegate,this.debugContextFactory=getCurrentDebugContext,this.data=this.delegate.data}createDebugContext(nativeElement){return this.debugContextFactory(nativeElement)}destroyNode(node){const debugNode=getDebugNode(node);!function(node){_nativeNodeToDebugNode.delete(node.nativeNode)}(debugNode),debugNode instanceof DebugNode__PRE_R3__&&(debugNode.listeners.length=0),this.delegate.destroyNode&&this.delegate.destroyNode(node)}destroy(){this.delegate.destroy()}createElement(name,namespace){const el=this.delegate.createElement(name,namespace),debugCtx=this.createDebugContext(el);if(debugCtx){const debugEl=new DebugElement__PRE_R3__(el,null,debugCtx);debugEl.name=name,indexDebugNode(debugEl)}return el}createComment(value){const comment=this.delegate.createComment(value),debugCtx=this.createDebugContext(comment);return debugCtx&&indexDebugNode(new DebugNode__PRE_R3__(comment,null,debugCtx)),comment}createText(value){const text=this.delegate.createText(value),debugCtx=this.createDebugContext(text);return debugCtx&&indexDebugNode(new DebugNode__PRE_R3__(text,null,debugCtx)),text}appendChild(parent,newChild){const debugEl=getDebugNode(parent),debugChildEl=getDebugNode(newChild);debugEl&&debugChildEl&&debugEl instanceof DebugElement__PRE_R3__&&debugEl.addChild(debugChildEl),this.delegate.appendChild(parent,newChild)}insertBefore(parent,newChild,refChild){const debugEl=getDebugNode(parent),debugChildEl=getDebugNode(newChild),debugRefEl=getDebugNode(refChild);debugEl&&debugChildEl&&debugEl instanceof DebugElement__PRE_R3__&&debugEl.insertBefore(debugRefEl,debugChildEl),this.delegate.insertBefore(parent,newChild,refChild)}removeChild(parent,oldChild){const debugEl=getDebugNode(parent),debugChildEl=getDebugNode(oldChild);debugEl&&debugChildEl&&debugEl instanceof DebugElement__PRE_R3__&&debugEl.removeChild(debugChildEl),this.delegate.removeChild(parent,oldChild)}selectRootElement(selectorOrNode,preserveContent){const el=this.delegate.selectRootElement(selectorOrNode,preserveContent),debugCtx=getCurrentDebugContext();return debugCtx&&indexDebugNode(new DebugElement__PRE_R3__(el,null,debugCtx)),el}setAttribute(el,name,value,namespace){const debugEl=getDebugNode(el);debugEl&&debugEl instanceof DebugElement__PRE_R3__&&(debugEl.attributes[namespace?namespace+":"+name:name]=value),this.delegate.setAttribute(el,name,value,namespace)}removeAttribute(el,name,namespace){const debugEl=getDebugNode(el);debugEl&&debugEl instanceof DebugElement__PRE_R3__&&(debugEl.attributes[namespace?namespace+":"+name:name]=null),this.delegate.removeAttribute(el,name,namespace)}addClass(el,name){const debugEl=getDebugNode(el);debugEl&&debugEl instanceof DebugElement__PRE_R3__&&(debugEl.classes[name]=!0),this.delegate.addClass(el,name)}removeClass(el,name){const debugEl=getDebugNode(el);debugEl&&debugEl instanceof DebugElement__PRE_R3__&&(debugEl.classes[name]=!1),this.delegate.removeClass(el,name)}setStyle(el,style,value,flags){const debugEl=getDebugNode(el);debugEl&&debugEl instanceof DebugElement__PRE_R3__&&(debugEl.styles[style]=value),this.delegate.setStyle(el,style,value,flags)}removeStyle(el,style,flags){const debugEl=getDebugNode(el);debugEl&&debugEl instanceof DebugElement__PRE_R3__&&(debugEl.styles[style]=null),this.delegate.removeStyle(el,style,flags)}setProperty(el,name,value){const debugEl=getDebugNode(el);debugEl&&debugEl instanceof DebugElement__PRE_R3__&&(debugEl.properties[name]=value),this.delegate.setProperty(el,name,value)}listen(target,eventName,callback){if("string"!=typeof target){const debugEl=getDebugNode(target);debugEl&&debugEl.listeners.push(new DebugEventListener(eventName,callback))}return this.delegate.listen(target,eventName,callback)}parentNode(node){return this.delegate.parentNode(node)}nextSibling(node){return this.delegate.nextSibling(node)}setValue(node,value){return this.delegate.setValue(node,value)}}function createNgModuleFactory(ngModuleType,bootstrapComponents,defFactory){return new NgModuleFactory_(ngModuleType,bootstrapComponents,defFactory)}class NgModuleFactory_ extends NgModuleFactory{constructor(moduleType,_bootstrapComponents,_ngModuleDefFactory){super(),this.moduleType=moduleType,this._bootstrapComponents=_bootstrapComponents,this._ngModuleDefFactory=_ngModuleDefFactory}create(parentInjector){!function(){if(initialized)return;initialized=!0;const services=isDevMode()?{setCurrentNode:debugSetCurrentNode,createRootView:debugCreateRootView,createEmbeddedView:debugCreateEmbeddedView,createComponentView:debugCreateComponentView,createNgModuleRef:debugCreateNgModuleRef,overrideProvider:debugOverrideProvider,overrideComponentView:debugOverrideComponentView,clearOverrides:debugClearOverrides,checkAndUpdateView:debugCheckAndUpdateView,checkNoChangesView:debugCheckNoChangesView,destroyView:debugDestroyView,createDebugContext:(view,nodeIndex)=>new DebugContext_(view,nodeIndex),handleEvent:debugHandleEvent,updateDirectives:debugUpdateDirectives,updateRenderer:debugUpdateRenderer}:{setCurrentNode:()=>{},createRootView:createProdRootView,createEmbeddedView:createEmbeddedView,createComponentView:createComponentView,createNgModuleRef:createNgModuleRef,overrideProvider:NOOP,overrideComponentView:NOOP,clearOverrides:NOOP,checkAndUpdateView:checkAndUpdateView,checkNoChangesView:checkNoChangesView,destroyView:destroyView,createDebugContext:(view,nodeIndex)=>new DebugContext_(view,nodeIndex),handleEvent:(view,nodeIndex,eventName,event)=>view.def.handleEvent(view,nodeIndex,eventName,event),updateDirectives:(view,checkType)=>view.def.updateDirectives(0===checkType?prodCheckAndUpdateNode:prodCheckNoChangesNode,view),updateRenderer:(view,checkType)=>view.def.updateRenderer(0===checkType?prodCheckAndUpdateNode:prodCheckNoChangesNode,view)};Services.setCurrentNode=services.setCurrentNode,Services.createRootView=services.createRootView,Services.createEmbeddedView=services.createEmbeddedView,Services.createComponentView=services.createComponentView,Services.createNgModuleRef=services.createNgModuleRef,Services.overrideProvider=services.overrideProvider,Services.overrideComponentView=services.overrideComponentView,Services.clearOverrides=services.clearOverrides,Services.checkAndUpdateView=services.checkAndUpdateView,Services.checkNoChangesView=services.checkNoChangesView,Services.destroyView=services.destroyView,Services.resolveDep=resolveDep,Services.createDebugContext=services.createDebugContext,Services.handleEvent=services.handleEvent,Services.updateDirectives=services.updateDirectives,Services.updateRenderer=services.updateRenderer,Services.dirtyParentQueries=dirtyParentQueries}();const def=function(def){const providers=Array.from(def.providers),modules=Array.from(def.modules),providersByKey={};for(const key in def.providersByKey)providersByKey[key]=def.providersByKey[key];return{factory:def.factory,isRoot:def.isRoot,providers:providers,modules:modules,providersByKey:providersByKey}}(resolveDefinition(this._ngModuleDefFactory));return Services.createNgModuleRef(this.moduleType,parentInjector||Injector.NULL,this._bootstrapComponents,def)}}class AppModule{}class AppComponent{constructor(){this.title="app"}}class PlatformLocation{}const LOCATION_INITIALIZED=new InjectionToken("Location Initialized");class LocationStrategy{}const APP_BASE_HREF=new InjectionToken("appBaseHref");class common_Location{constructor(platformStrategy,platformLocation){this._subject=new core_EventEmitter,this._urlChangeListeners=[],this._platformStrategy=platformStrategy;const browserBaseHref=this._platformStrategy.getBaseHref();this._platformLocation=platformLocation,this._baseHref=common_Location.stripTrailingSlash(_stripIndexHtml(browserBaseHref)),this._platformStrategy.onPopState(ev=>{this._subject.emit({url:this.path(!0),pop:!0,state:ev.state,type:ev.type})})}path(includeHash=!1){return this.normalize(this._platformStrategy.path(includeHash))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(path,query=""){return this.path()==this.normalize(path+common_Location.normalizeQueryParams(query))}normalize(url){return common_Location.stripTrailingSlash(function(baseHref,url){return baseHref&&url.startsWith(baseHref)?url.substring(baseHref.length):url}(this._baseHref,_stripIndexHtml(url)))}prepareExternalUrl(url){return url&&"/"!==url[0]&&(url="/"+url),this._platformStrategy.prepareExternalUrl(url)}go(path,query="",state=null){this._platformStrategy.pushState(state,"",path,query),this._notifyUrlChangeListeners(this.prepareExternalUrl(path+common_Location.normalizeQueryParams(query)),state)}replaceState(path,query="",state=null){this._platformStrategy.replaceState(state,"",path,query),this._notifyUrlChangeListeners(this.prepareExternalUrl(path+common_Location.normalizeQueryParams(query)),state)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}onUrlChange(fn){this._urlChangeListeners.push(fn),this.subscribe(v=>{this._notifyUrlChangeListeners(v.url,v.state)})}_notifyUrlChangeListeners(url="",state){this._urlChangeListeners.forEach(fn=>fn(url,state))}subscribe(onNext,onThrow,onReturn){return this._subject.subscribe({next:onNext,error:onThrow,complete:onReturn})}static normalizeQueryParams(params){return params&&"?"!==params[0]?"?"+params:params}static joinWithSlash(start,end){if(0==start.length)return end;if(0==end.length)return start;let slashes=0;return start.endsWith("/")&&slashes++,end.startsWith("/")&&slashes++,2==slashes?start+end.substring(1):1==slashes?start+end:start+"/"+end}static stripTrailingSlash(url){const match=url.match(/#|\?|$/),pathEndIdx=match&&match.index||url.length;return url.slice(0,pathEndIdx-("/"===url[pathEndIdx-1]?1:0))+url.slice(pathEndIdx)}}function _stripIndexHtml(url){return url.replace(/\/index.html$/,"")}class HashLocationStrategy extends LocationStrategy{constructor(_platformLocation,_baseHref){super(),this._platformLocation=_platformLocation,this._baseHref="",null!=_baseHref&&(this._baseHref=_baseHref)}onPopState(fn){this._platformLocation.onPopState(fn),this._platformLocation.onHashChange(fn)}getBaseHref(){return this._baseHref}path(includeHash=!1){let path=this._platformLocation.hash;return null==path&&(path="#"),path.length>0?path.substring(1):path}prepareExternalUrl(internal){const url=common_Location.joinWithSlash(this._baseHref,internal);return url.length>0?"#"+url:url}pushState(state,title,path,queryParams){let url=this.prepareExternalUrl(path+common_Location.normalizeQueryParams(queryParams));0==url.length&&(url=this._platformLocation.pathname),this._platformLocation.pushState(state,title,url)}replaceState(state,title,path,queryParams){let url=this.prepareExternalUrl(path+common_Location.normalizeQueryParams(queryParams));0==url.length&&(url=this._platformLocation.pathname),this._platformLocation.replaceState(state,title,url)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}}class PathLocationStrategy extends LocationStrategy{constructor(_platformLocation,href){if(super(),this._platformLocation=_platformLocation,null==href&&(href=this._platformLocation.getBaseHrefFromDOM()),null==href)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=href}onPopState(fn){this._platformLocation.onPopState(fn),this._platformLocation.onHashChange(fn)}getBaseHref(){return this._baseHref}prepareExternalUrl(internal){return common_Location.joinWithSlash(this._baseHref,internal)}path(includeHash=!1){const pathname=this._platformLocation.pathname+common_Location.normalizeQueryParams(this._platformLocation.search),hash=this._platformLocation.hash;return hash&&includeHash?`${pathname}${hash}`:pathname}pushState(state,title,url,queryParams){const externalUrl=this.prepareExternalUrl(url+common_Location.normalizeQueryParams(queryParams));this._platformLocation.pushState(state,title,externalUrl)}replaceState(state,title,url,queryParams){const externalUrl=this.prepareExternalUrl(url+common_Location.normalizeQueryParams(queryParams));this._platformLocation.replaceState(state,title,externalUrl)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}}const Plural=function(){var Plural={Zero:0,One:1,Two:2,Few:3,Many:4,Other:5};return Plural[Plural.Zero]="Zero",Plural[Plural.One]="One",Plural[Plural.Two]="Two",Plural[Plural.Few]="Few",Plural[Plural.Many]="Many",Plural[Plural.Other]="Other",Plural}(),DEPRECATED_PLURAL_FN=new InjectionToken("UseV4Plurals");class NgLocalization{}class NgLocaleLocalization extends NgLocalization{constructor(locale,deprecatedPluralFn){super(),this.locale=locale,this.deprecatedPluralFn=deprecatedPluralFn}getPluralCategory(value,locale){switch(this.deprecatedPluralFn?this.deprecatedPluralFn(locale||this.locale,value):function(locale){return function(locale){const normalizedLocale=locale.toLowerCase().replace(/_/g,"-");let match=LOCALE_DATA[normalizedLocale];if(match)return match;const parentLocale=normalizedLocale.split("-")[0];if(match=LOCALE_DATA[parentLocale],match)return match;if("en"===parentLocale)return localeEn;throw new Error(`Missing locale data for the locale "${locale}".`)}(locale)[LocaleDataIndex.PluralCase]}(locale||this.locale)(value)){case Plural.Zero:return"zero";case Plural.One:return"one";case Plural.Two:return"two";case Plural.Few:return"few";case Plural.Many:return"many";default:return"other"}}}function parseCookieValue(cookieStr,name){name=encodeURIComponent(name);for(const cookie of cookieStr.split(";")){const eqIndex=cookie.indexOf("="),[cookieName,cookieValue]=-1==eqIndex?[cookie,""]:[cookie.slice(0,eqIndex),cookie.slice(eqIndex+1)];if(cookieName.trim()===name)return decodeURIComponent(cookieValue)}return null}class NgClassImpl{}class common_NgClassR2Impl{constructor(_iterableDiffers,_keyValueDiffers,_ngEl,_renderer){this._iterableDiffers=_iterableDiffers,this._keyValueDiffers=_keyValueDiffers,this._ngEl=_ngEl,this._renderer=_renderer,this._initialClasses=[]}getValue(){return null}setClass(value){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof value?value.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}setNgClass(value){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof value?value.split(/\s+/):value,this._rawClass&&(isListLikeIterable$1(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}applyChanges(){if(this._iterableDiffer){const iterableChanges=this._iterableDiffer.diff(this._rawClass);iterableChanges&&this._applyIterableChanges(iterableChanges)}else if(this._keyValueDiffer){const keyValueChanges=this._keyValueDiffer.diff(this._rawClass);keyValueChanges&&this._applyKeyValueChanges(keyValueChanges)}}_applyKeyValueChanges(changes){changes.forEachAddedItem(record=>this._toggleClass(record.key,record.currentValue)),changes.forEachChangedItem(record=>this._toggleClass(record.key,record.currentValue)),changes.forEachRemovedItem(record=>{record.previousValue&&this._toggleClass(record.key,!1)})}_applyIterableChanges(changes){changes.forEachAddedItem(record=>{if("string"!=typeof record.item)throw new Error("NgClass can only toggle CSS classes expressed as strings, got "+stringify(record.item));this._toggleClass(record.item,!0)}),changes.forEachRemovedItem(record=>this._toggleClass(record.item,!1))}_applyClasses(rawClassVal){rawClassVal&&(Array.isArray(rawClassVal)||rawClassVal instanceof Set?rawClassVal.forEach(klass=>this._toggleClass(klass,!0)):Object.keys(rawClassVal).forEach(klass=>this._toggleClass(klass,!!rawClassVal[klass])))}_removeClasses(rawClassVal){rawClassVal&&(Array.isArray(rawClassVal)||rawClassVal instanceof Set?rawClassVal.forEach(klass=>this._toggleClass(klass,!1)):Object.keys(rawClassVal).forEach(klass=>this._toggleClass(klass,!1)))}_toggleClass(klass,enabled){(klass=klass.trim())&&klass.split(/\s+/g).forEach(klass=>{enabled?this._renderer.addClass(this._ngEl.nativeElement,klass):this._renderer.removeClass(this._ngEl.nativeElement,klass)})}}let NgClassBase=(()=>{class NgClassBase{constructor(_delegate){this._delegate=_delegate}getValue(){return this._delegate.getValue()}}return NgClassBase.ngDirectiveDef=void 0,NgClassBase})();class NgClass extends NgClassBase{constructor(delegate){super(delegate)}set klass(value){this._delegate.setClass(value)}set ngClass(value){this._delegate.setNgClass(value)}ngDoCheck(){this._delegate.applyChanges()}}class NgForOfContext{constructor($implicit,ngForOf,index,count){this.$implicit=$implicit,this.ngForOf=ngForOf,this.index=index,this.count=count}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}class common_NgForOf{constructor(_viewContainer,_template,_differs){this._viewContainer=_viewContainer,this._template=_template,this._differs=_differs,this._ngForOfDirty=!0,this._differ=null}set ngForOf(ngForOf){this._ngForOf=ngForOf,this._ngForOfDirty=!0}set ngForTrackBy(fn){isDevMode()&&null!=fn&&"function"!=typeof fn&&console&&console.warn&&console.warn(`trackBy must be a function, but received ${JSON.stringify(fn)}. See https://angular.io/docs/ts/latest/api/common/index/NgFor-directive.html#!#change-propagation for more information.`),this._trackByFn=fn}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(value){value&&(this._template=value)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const value=this._ngForOf;if(!this._differ&&value)try{this._differ=this._differs.find(value).create(this.ngForTrackBy)}catch(_a){throw new Error(`Cannot find a differ supporting object '${value}' of type '${type=value,type.name||typeof type}'. NgFor only supports binding to Iterables such as Arrays.`)}}var type;if(this._differ){const changes=this._differ.diff(this._ngForOf);changes&&this._applyChanges(changes)}}_applyChanges(changes){const insertTuples=[];changes.forEachOperation((item,adjustedPreviousIndex,currentIndex)=>{if(null==item.previousIndex){const view=this._viewContainer.createEmbeddedView(this._template,new NgForOfContext(null,this._ngForOf,-1,-1),null===currentIndex?void 0:currentIndex),tuple=new RecordViewTuple(item,view);insertTuples.push(tuple)}else if(null==currentIndex)this._viewContainer.remove(null===adjustedPreviousIndex?void 0:adjustedPreviousIndex);else if(null!==adjustedPreviousIndex){const view=this._viewContainer.get(adjustedPreviousIndex);this._viewContainer.move(view,currentIndex);const tuple=new RecordViewTuple(item,view);insertTuples.push(tuple)}});for(let i=0;i<insertTuples.length;i++)this._perViewChange(insertTuples[i].view,insertTuples[i].record);for(let i=0,ilen=this._viewContainer.length;i<ilen;i++){const viewRef=this._viewContainer.get(i);viewRef.context.index=i,viewRef.context.count=ilen,viewRef.context.ngForOf=this._ngForOf}changes.forEachIdentityChange(record=>{this._viewContainer.get(record.currentIndex).context.$implicit=record.item})}_perViewChange(view,record){view.context.$implicit=record.item}static ngTemplateContextGuard(dir,ctx){return!0}}class RecordViewTuple{constructor(record,view){this.record=record,this.view=view}}class NgIf{constructor(_viewContainer,templateRef){this._viewContainer=_viewContainer,this._context=new NgIfContext,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=templateRef}set ngIf(condition){this._context.$implicit=this._context.ngIf=condition,this._updateView()}set ngIfThen(templateRef){assertTemplate("ngIfThen",templateRef),this._thenTemplateRef=templateRef,this._thenViewRef=null,this._updateView()}set ngIfElse(templateRef){assertTemplate("ngIfElse",templateRef),this._elseTemplateRef=templateRef,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}}class NgIfContext{constructor(){this.$implicit=null,this.ngIf=null}}function assertTemplate(property,templateRef){if(templateRef&&!templateRef.createEmbeddedView)throw new Error(`${property} must be a TemplateRef, but received '${stringify(templateRef)}'.`)}class CommonModule{}const DOCUMENT=new InjectionToken("DocumentToken");let common_ViewportScroller=(()=>{class ViewportScroller{}return ViewportScroller.ngInjectableDef=ɵɵdefineInjectable({token:ViewportScroller,providedIn:"root",factory:()=>new BrowserViewportScroller(ɵɵinject(DOCUMENT),window,ɵɵinject(ErrorHandler))}),ViewportScroller})();class BrowserViewportScroller{constructor(document,window,errorHandler){this.document=document,this.window=window,this.errorHandler=errorHandler,this.offset=()=>[0,0]}setOffset(offset){this.offset=Array.isArray(offset)?()=>offset:offset}getScrollPosition(){return this.supportScrollRestoration()?[this.window.scrollX,this.window.scrollY]:[0,0]}scrollToPosition(position){this.supportScrollRestoration()&&this.window.scrollTo(position[0],position[1])}scrollToAnchor(anchor){if(this.supportScrollRestoration()){anchor=this.window.CSS&&this.window.CSS.escape?this.window.CSS.escape(anchor):anchor.replace(/(\"|\'\ |:|\.|\[|\]|,|=)/g,"\\$1");try{const elSelectedById=this.document.querySelector("#"+anchor);if(elSelectedById)return void this.scrollToElement(elSelectedById);const elSelectedByName=this.document.querySelector(`[name='${anchor}']`);if(elSelectedByName)return void this.scrollToElement(elSelectedByName)}catch(e){this.errorHandler.handleError(e)}}}setHistoryScrollRestoration(scrollRestoration){if(this.supportScrollRestoration()){const history=this.window.history;history&&history.scrollRestoration&&(history.scrollRestoration=scrollRestoration)}}scrollToElement(el){const rect=el.getBoundingClientRect(),left=rect.left+this.window.pageXOffset,top=rect.top+this.window.pageYOffset,offset=this.offset();this.window.scrollTo(left-offset[0],top-offset[1])}supportScrollRestoration(){try{return!!this.window&&!!this.window.scrollTo}catch(_a){return!1}}}function of(...args){let scheduler=args[args.length-1];return isScheduler(scheduler)?(args.pop(),scheduleArray(args,scheduler)):fromArray(args)}class BehaviorSubject_BehaviorSubject extends Subject_Subject{constructor(_value){super(),this._value=_value}get value(){return this.getValue()}_subscribe(subscriber){const subscription=super._subscribe(subscriber);return subscription&&!subscription.closed&&subscriber.next(this._value),subscription}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new ObjectUnsubscribedError;return this._value}next(value){super.next(this._value=value)}}const EmptyError=(()=>{function EmptyErrorImpl(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return EmptyErrorImpl.prototype=Object.create(Error.prototype),EmptyErrorImpl})();class OuterSubscriber_OuterSubscriber extends Subscriber_Subscriber{notifyNext(outerValue,innerValue,outerIndex,innerIndex,innerSub){this.destination.next(innerValue)}notifyError(error,innerSub){this.destination.error(error)}notifyComplete(innerSub){this.destination.complete()}}class InnerSubscriber_InnerSubscriber extends Subscriber_Subscriber{constructor(parent,outerValue,outerIndex){super(),this.parent=parent,this.outerValue=outerValue,this.outerIndex=outerIndex,this.index=0}_next(value){this.parent.notifyNext(this.outerValue,value,this.outerIndex,this.index++,this)}_error(error){this.parent.notifyError(error,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}function subscribeToResult(outerSubscriber,result,outerValue,outerIndex,innerSubscriber=new InnerSubscriber_InnerSubscriber(outerSubscriber,outerValue,outerIndex)){if(!innerSubscriber.closed)return result instanceof Observable_Observable?result.subscribe(innerSubscriber):subscribeTo(result)(innerSubscriber)}const NONE={};class CombineLatestOperator{constructor(resultSelector){this.resultSelector=resultSelector}call(subscriber,source){return source.subscribe(new combineLatest_CombineLatestSubscriber(subscriber,this.resultSelector))}}class combineLatest_CombineLatestSubscriber extends OuterSubscriber_OuterSubscriber{constructor(destination,resultSelector){super(destination),this.resultSelector=resultSelector,this.active=0,this.values=[],this.observables=[]}_next(observable){this.values.push(NONE),this.observables.push(observable)}_complete(){const observables=this.observables,len=observables.length;if(0===len)this.destination.complete();else{this.active=len,this.toRespond=len;for(let i=0;i<len;i++)this.add(subscribeToResult(this,observables[i],void 0,i))}}notifyComplete(unused){0==(this.active-=1)&&this.destination.complete()}notifyNext(_outerValue,innerValue,outerIndex){const values=this.values,toRespond=this.toRespond?values[outerIndex]===NONE?--this.toRespond:this.toRespond:0;values[outerIndex]=innerValue,0===toRespond&&(this.resultSelector?this._tryResultSelector(values):this.destination.next(values.slice()))}_tryResultSelector(values){let result;try{result=this.resultSelector.apply(this,values)}catch(err){return void this.destination.error(err)}this.destination.next(result)}}const empty_EMPTY=new Observable_Observable(subscriber=>subscriber.complete());function empty_empty(scheduler){return scheduler?function(scheduler){return new Observable_Observable(subscriber=>scheduler.schedule(()=>subscriber.complete()))}(scheduler):empty_EMPTY}function defer(observableFactory){return new Observable_Observable(subscriber=>{let input;try{input=observableFactory()}catch(err){return void subscriber.error(err)}return(input?from(input):empty_empty()).subscribe(subscriber)})}function concatAll(){return mergeAll(1)}function filter(predicate,thisArg){return function(source){return source.lift(new FilterOperator(predicate,thisArg))}}class FilterOperator{constructor(predicate,thisArg){this.predicate=predicate,this.thisArg=thisArg}call(subscriber,source){return source.subscribe(new filter_FilterSubscriber(subscriber,this.predicate,this.thisArg))}}class filter_FilterSubscriber extends Subscriber_Subscriber{constructor(destination,predicate,thisArg){super(destination),this.predicate=predicate,this.thisArg=thisArg,this.count=0}_next(value){let result;try{result=this.predicate.call(this.thisArg,value,this.count++)}catch(err){return void this.destination.error(err)}result&&this.destination.next(value)}}const ArgumentOutOfRangeError=(()=>{function ArgumentOutOfRangeErrorImpl(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return ArgumentOutOfRangeErrorImpl.prototype=Object.create(Error.prototype),ArgumentOutOfRangeErrorImpl})();function takeLast(count){return function(source){return 0===count?empty_empty():source.lift(new takeLast_TakeLastOperator(count))}}class takeLast_TakeLastOperator{constructor(total){if(this.total=total,this.total<0)throw new ArgumentOutOfRangeError}call(subscriber,source){return source.subscribe(new takeLast_TakeLastSubscriber(subscriber,this.total))}}class takeLast_TakeLastSubscriber extends Subscriber_Subscriber{constructor(destination,total){super(destination),this.total=total,this.ring=new Array,this.count=0}_next(value){const ring=this.ring,total=this.total,count=this.count++;ring.length<total?ring.push(value):ring[count%total]=value}_complete(){const destination=this.destination;let count=this.count;if(count>0){const total=this.count>=this.total?this.total:this.count,ring=this.ring;for(let i=0;i<total;i++){const idx=count++%total;destination.next(ring[idx])}}destination.complete()}}function throwIfEmpty(errorFactory=defaultErrorFactory){return source=>source.lift(new ThrowIfEmptyOperator(errorFactory))}class ThrowIfEmptyOperator{constructor(errorFactory){this.errorFactory=errorFactory}call(subscriber,source){return source.subscribe(new throwIfEmpty_ThrowIfEmptySubscriber(subscriber,this.errorFactory))}}class throwIfEmpty_ThrowIfEmptySubscriber extends Subscriber_Subscriber{constructor(destination,errorFactory){super(destination),this.errorFactory=errorFactory,this.hasValue=!1}_next(value){this.hasValue=!0,this.destination.next(value)}_complete(){if(this.hasValue)return this.destination.complete();{let err;try{err=this.errorFactory()}catch(e){err=e}this.destination.error(err)}}}function defaultErrorFactory(){return new EmptyError}function defaultIfEmpty(defaultValue=null){return source=>source.lift(new DefaultIfEmptyOperator(defaultValue))}class DefaultIfEmptyOperator{constructor(defaultValue){this.defaultValue=defaultValue}call(subscriber,source){return source.subscribe(new defaultIfEmpty_DefaultIfEmptySubscriber(subscriber,this.defaultValue))}}class defaultIfEmpty_DefaultIfEmptySubscriber extends Subscriber_Subscriber{constructor(destination,defaultValue){super(destination),this.defaultValue=defaultValue,this.isEmpty=!0}_next(value){this.isEmpty=!1,this.destination.next(value)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}function last_last(predicate,defaultValue){const hasDefaultValue=arguments.length>=2;return source=>source.pipe(predicate?filter((v,i)=>predicate(v,i,source)):identity,takeLast(1),hasDefaultValue?defaultIfEmpty(defaultValue):throwIfEmpty(()=>new EmptyError))}function catchError(selector){return function(source){const operator=new CatchOperator(selector),caught=source.lift(operator);return operator.caught=caught}}class CatchOperator{constructor(selector){this.selector=selector}call(subscriber,source){return source.subscribe(new catchError_CatchSubscriber(subscriber,this.selector,this.caught))}}class catchError_CatchSubscriber extends innerSubscribe_SimpleOuterSubscriber{constructor(destination,selector,caught){super(destination),this.selector=selector,this.caught=caught}error(err){if(!this.isStopped){let result;try{result=this.selector(err,this.caught)}catch(err2){return void super.error(err2)}this._unsubscribeAndRecycle();const innerSubscriber=new innerSubscribe_SimpleInnerSubscriber(this);this.add(innerSubscriber);const innerSubscription=innerSubscribe(result,innerSubscriber);innerSubscription!==innerSubscriber&&this.add(innerSubscription)}}}function take(count){return source=>0===count?empty_empty():source.lift(new take_TakeOperator(count))}class take_TakeOperator{constructor(total){if(this.total=total,this.total<0)throw new ArgumentOutOfRangeError}call(subscriber,source){return source.subscribe(new take_TakeSubscriber(subscriber,this.total))}}class take_TakeSubscriber extends Subscriber_Subscriber{constructor(destination,total){super(destination),this.total=total,this.count=0}_next(value){const total=this.total,count=++this.count;count<=total&&(this.destination.next(value),count===total&&(this.destination.complete(),this.unsubscribe()))}}function first_first(predicate,defaultValue){const hasDefaultValue=arguments.length>=2;return source=>source.pipe(predicate?filter((v,i)=>predicate(v,i,source)):identity,take(1),hasDefaultValue?defaultIfEmpty(defaultValue):throwIfEmpty(()=>new EmptyError))}class EveryOperator{constructor(predicate,thisArg,source){this.predicate=predicate,this.thisArg=thisArg,this.source=source}call(observer,source){return source.subscribe(new every_EverySubscriber(observer,this.predicate,this.thisArg,this.source))}}class every_EverySubscriber extends Subscriber_Subscriber{constructor(destination,predicate,thisArg,source){super(destination),this.predicate=predicate,this.thisArg=thisArg,this.source=source,this.index=0,this.thisArg=thisArg||this}notifyComplete(everyValueMatch){this.destination.next(everyValueMatch),this.destination.complete()}_next(value){let result=!1;try{result=this.predicate.call(this.thisArg,value,this.index++,this.source)}catch(err){return void this.destination.error(err)}result||this.notifyComplete(!1)}_complete(){this.notifyComplete(!0)}}function switchMap(project,resultSelector){return"function"==typeof resultSelector?source=>source.pipe(switchMap((a,i)=>from(project(a,i)).pipe(map((b,ii)=>resultSelector(a,b,i,ii))))):source=>source.lift(new SwitchMapOperator(project))}class SwitchMapOperator{constructor(project){this.project=project}call(subscriber,source){return source.subscribe(new switchMap_SwitchMapSubscriber(subscriber,this.project))}}class switchMap_SwitchMapSubscriber extends innerSubscribe_SimpleOuterSubscriber{constructor(destination,project){super(destination),this.project=project,this.index=0}_next(value){let result;const index=this.index++;try{result=this.project(value,index)}catch(error){return void this.destination.error(error)}this._innerSub(result)}_innerSub(result){const innerSubscription=this.innerSubscription;innerSubscription&&innerSubscription.unsubscribe();const innerSubscriber=new innerSubscribe_SimpleInnerSubscriber(this),destination=this.destination;destination.add(innerSubscriber),this.innerSubscription=innerSubscribe(result,innerSubscriber),this.innerSubscription!==innerSubscriber&&destination.add(this.innerSubscription)}_complete(){const{innerSubscription:innerSubscription}=this;innerSubscription&&!innerSubscription.closed||super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=void 0}notifyComplete(){this.innerSubscription=void 0,this.isStopped&&super._complete()}notifyNext(innerValue){this.destination.next(innerValue)}}function concat(...observables){return concatAll()(of(...observables))}function scan(accumulator,seed){let hasSeed=!1;return arguments.length>=2&&(hasSeed=!0),function(source){return source.lift(new ScanOperator(accumulator,seed,hasSeed))}}class ScanOperator{constructor(accumulator,seed,hasSeed=!1){this.accumulator=accumulator,this.seed=seed,this.hasSeed=hasSeed}call(subscriber,source){return source.subscribe(new scan_ScanSubscriber(subscriber,this.accumulator,this.seed,this.hasSeed))}}class scan_ScanSubscriber extends Subscriber_Subscriber{constructor(destination,accumulator,_seed,hasSeed){super(destination),this.accumulator=accumulator,this._seed=_seed,this.hasSeed=hasSeed,this.index=0}get seed(){return this._seed}set seed(value){this.hasSeed=!0,this._seed=value}_next(value){if(this.hasSeed)return this._tryNext(value);this.seed=value,this.destination.next(value)}_tryNext(value){const index=this.index++;let result;try{result=this.accumulator(this.seed,value,index)}catch(err){this.destination.error(err)}this.seed=result,this.destination.next(result)}}function concatMap(project,resultSelector){return mergeMap(project,resultSelector,1)}function noop_noop(){}function tap(nextOrObserver,error,complete){return function(source){return source.lift(new DoOperator(nextOrObserver,error,complete))}}class DoOperator{constructor(nextOrObserver,error,complete){this.nextOrObserver=nextOrObserver,this.error=error,this.complete=complete}call(subscriber,source){return source.subscribe(new tap_TapSubscriber(subscriber,this.nextOrObserver,this.error,this.complete))}}class tap_TapSubscriber extends Subscriber_Subscriber{constructor(destination,observerOrNext,error,complete){super(destination),this._tapNext=noop_noop,this._tapError=noop_noop,this._tapComplete=noop_noop,this._tapError=error||noop_noop,this._tapComplete=complete||noop_noop,isFunction(observerOrNext)?(this._context=this,this._tapNext=observerOrNext):observerOrNext&&(this._context=observerOrNext,this._tapNext=observerOrNext.next||noop_noop,this._tapError=observerOrNext.error||noop_noop,this._tapComplete=observerOrNext.complete||noop_noop)}_next(value){try{this._tapNext.call(this._context,value)}catch(err){return void this.destination.error(err)}this.destination.next(value)}_error(err){try{this._tapError.call(this._context,err)}catch(err){return void this.destination.error(err)}this.destination.error(err)}_complete(){try{this._tapComplete.call(this._context)}catch(err){return void this.destination.error(err)}return this.destination.complete()}}class FinallyOperator{constructor(callback){this.callback=callback}call(subscriber,source){return source.subscribe(new finalize_FinallySubscriber(subscriber,this.callback))}}class finalize_FinallySubscriber extends Subscriber_Subscriber{constructor(destination,callback){super(destination),this.add(new Subscription_Subscription(callback))}}let _DOM=null;function getDOM(){return _DOM}const _attrToPropMap={class:"className",innerHtml:"innerHTML",readonly:"readOnly",tabindex:"tabIndex"},_keyMap={"\b":"Backspace","\t":"Tab","":"Delete","":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},_chromeNumKeyPadMap={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","":"NumLock"},nodeContains=(()=>{if(_global.Node)return _global.Node.prototype.contains||function(node){return!!(16&this.compareDocumentPosition(node))}})();class platform_browser_BrowserDomAdapter extends class extends class{constructor(){this.resourceLoaderType=null}get attrToPropMap(){return this._attrToPropMap}set attrToPropMap(value){this._attrToPropMap=value}}{constructor(){super(),this._animationPrefix=null,this._transitionEnd=null;try{const element=this.createElement("div",document);if(null!=this.getStyle(element,"animationName"))this._animationPrefix="";else{const domPrefixes=["Webkit","Moz","O","ms"];for(let i=0;i<domPrefixes.length;i++)if(null!=this.getStyle(element,domPrefixes[i]+"AnimationName")){this._animationPrefix="-"+domPrefixes[i].toLowerCase()+"-";break}}const transEndEventNames={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};Object.keys(transEndEventNames).forEach(key=>{null!=this.getStyle(element,key)&&(this._transitionEnd=transEndEventNames[key])})}catch(_a){this._animationPrefix=null,this._transitionEnd=null}}getDistributedNodes(el){return el.getDistributedNodes()}resolveAndSetHref(el,baseUrl,href){el.href=null==href?baseUrl:baseUrl+"/../"+href}supportsDOMEvents(){return!0}supportsNativeShadowDOM(){return"function"==typeof document.body.createShadowRoot}getAnimationPrefix(){return this._animationPrefix?this._animationPrefix:""}getTransitionEnd(){return this._transitionEnd?this._transitionEnd:""}supportsAnimation(){return null!=this._animationPrefix&&null!=this._transitionEnd}}{parse(templateHtml){throw new Error("parse not implemented")}static makeCurrent(){var adapter;adapter=new platform_browser_BrowserDomAdapter,_DOM||(_DOM=adapter)}hasProperty(element,name){return name in element}setProperty(el,name,value){el[name]=value}getProperty(el,name){return el[name]}invoke(el,methodName,args){el[methodName](...args)}logError(error){window.console&&(console.error?console.error(error):console.log(error))}log(error){window.console&&window.console.log&&window.console.log(error)}logGroup(error){window.console&&window.console.group&&window.console.group(error)}logGroupEnd(){window.console&&window.console.groupEnd&&window.console.groupEnd()}get attrToPropMap(){return _attrToPropMap}contains(nodeA,nodeB){return nodeContains.call(nodeA,nodeB)}querySelector(el,selector){return el.querySelector(selector)}querySelectorAll(el,selector){return el.querySelectorAll(selector)}on(el,evt,listener){el.addEventListener(evt,listener,!1)}onAndCancel(el,evt,listener){return el.addEventListener(evt,listener,!1),()=>{el.removeEventListener(evt,listener,!1)}}dispatchEvent(el,evt){el.dispatchEvent(evt)}createMouseEvent(eventType){const evt=this.getDefaultDocument().createEvent("MouseEvent");return evt.initEvent(eventType,!0,!0),evt}createEvent(eventType){const evt=this.getDefaultDocument().createEvent("Event");return evt.initEvent(eventType,!0,!0),evt}preventDefault(evt){evt.preventDefault(),evt.returnValue=!1}isPrevented(evt){return evt.defaultPrevented||null!=evt.returnValue&&!evt.returnValue}getInnerHTML(el){return el.innerHTML}getTemplateContent(el){return"content"in el&&this.isTemplateElement(el)?el.content:null}getOuterHTML(el){return el.outerHTML}nodeName(node){return node.nodeName}nodeValue(node){return node.nodeValue}type(node){return node.type}content(node){return this.hasProperty(node,"content")?node.content:node}firstChild(el){return el.firstChild}nextSibling(el){return el.nextSibling}parentElement(el){return el.parentNode}childNodes(el){return el.childNodes}childNodesAsList(el){const childNodes=el.childNodes,res=new Array(childNodes.length);for(let i=0;i<childNodes.length;i++)res[i]=childNodes[i];return res}clearNodes(el){for(;el.firstChild;)el.removeChild(el.firstChild)}appendChild(el,node){el.appendChild(node)}removeChild(el,node){el.removeChild(node)}replaceChild(el,newChild,oldChild){el.replaceChild(newChild,oldChild)}remove(node){return node.parentNode&&node.parentNode.removeChild(node),node}insertBefore(parent,ref,node){parent.insertBefore(node,ref)}insertAllBefore(parent,ref,nodes){nodes.forEach(n=>parent.insertBefore(n,ref))}insertAfter(parent,ref,node){parent.insertBefore(node,ref.nextSibling)}setInnerHTML(el,value){el.innerHTML=value}getText(el){return el.textContent}setText(el,value){el.textContent=value}getValue(el){return el.value}setValue(el,value){el.value=value}getChecked(el){return el.checked}setChecked(el,value){el.checked=value}createComment(text){return this.getDefaultDocument().createComment(text)}createTemplate(html){const t=this.getDefaultDocument().createElement("template");return t.innerHTML=html,t}createElement(tagName,doc){return(doc=doc||this.getDefaultDocument()).createElement(tagName)}createElementNS(ns,tagName,doc){return(doc=doc||this.getDefaultDocument()).createElementNS(ns,tagName)}createTextNode(text,doc){return(doc=doc||this.getDefaultDocument()).createTextNode(text)}createScriptTag(attrName,attrValue,doc){const el=(doc=doc||this.getDefaultDocument()).createElement("SCRIPT");return el.setAttribute(attrName,attrValue),el}createStyleElement(css,doc){const style=(doc=doc||this.getDefaultDocument()).createElement("style");return this.appendChild(style,this.createTextNode(css,doc)),style}createShadowRoot(el){return el.createShadowRoot()}getShadowRoot(el){return el.shadowRoot}getHost(el){return el.host}clone(node){return node.cloneNode(!0)}getElementsByClassName(element,name){return element.getElementsByClassName(name)}getElementsByTagName(element,name){return element.getElementsByTagName(name)}classList(element){return Array.prototype.slice.call(element.classList,0)}addClass(element,className){element.classList.add(className)}removeClass(element,className){element.classList.remove(className)}hasClass(element,className){return element.classList.contains(className)}setStyle(element,styleName,styleValue){element.style[styleName]=styleValue}removeStyle(element,stylename){element.style[stylename]=""}getStyle(element,stylename){return element.style[stylename]}hasStyle(element,styleName,styleValue){const value=this.getStyle(element,styleName)||"";return styleValue?value==styleValue:value.length>0}tagName(element){return element.tagName}attributeMap(element){const res=new Map,elAttrs=element.attributes;for(let i=0;i<elAttrs.length;i++){const attrib=elAttrs.item(i);res.set(attrib.name,attrib.value)}return res}hasAttribute(element,attribute){return element.hasAttribute(attribute)}hasAttributeNS(element,ns,attribute){return element.hasAttributeNS(ns,attribute)}getAttribute(element,attribute){return element.getAttribute(attribute)}getAttributeNS(element,ns,name){return element.getAttributeNS(ns,name)}setAttribute(element,name,value){element.setAttribute(name,value)}setAttributeNS(element,ns,name,value){element.setAttributeNS(ns,name,value)}removeAttribute(element,attribute){element.removeAttribute(attribute)}removeAttributeNS(element,ns,name){element.removeAttributeNS(ns,name)}templateAwareRoot(el){return this.isTemplateElement(el)?this.content(el):el}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}getBoundingClientRect(el){try{return el.getBoundingClientRect()}catch(_a){return{top:0,bottom:0,left:0,right:0,width:0,height:0}}}getTitle(doc){return doc.title}setTitle(doc,newTitle){doc.title=newTitle||""}elementMatches(n,selector){return!!this.isElementNode(n)&&(n.matches&&n.matches(selector)||n.msMatchesSelector&&n.msMatchesSelector(selector)||n.webkitMatchesSelector&&n.webkitMatchesSelector(selector))}isTemplateElement(el){return this.isElementNode(el)&&"TEMPLATE"===el.nodeName}isTextNode(node){return node.nodeType===Node.TEXT_NODE}isCommentNode(node){return node.nodeType===Node.COMMENT_NODE}isElementNode(node){return node.nodeType===Node.ELEMENT_NODE}hasShadowRoot(node){return null!=node.shadowRoot&&node instanceof HTMLElement}isShadowRoot(node){return node instanceof DocumentFragment}importIntoDoc(node){return document.importNode(this.templateAwareRoot(node),!0)}adoptNode(node){return document.adoptNode(node)}getHref(el){return el.getAttribute("href")}getEventKey(event){let key=event.key;if(null==key){if(key=event.keyIdentifier,null==key)return"Unidentified";key.startsWith("U+")&&(key=String.fromCharCode(parseInt(key.substring(2),16)),3===event.location&&_chromeNumKeyPadMap.hasOwnProperty(key)&&(key=_chromeNumKeyPadMap[key]))}return _keyMap[key]||key}getGlobalEventTarget(doc,target){return"window"===target?window:"document"===target?doc:"body"===target?doc.body:null}getHistory(){return window.history}getLocation(){return window.location}getBaseHref(doc){const href=baseElement||(baseElement=document.querySelector("base"),baseElement)?baseElement.getAttribute("href"):null;return null==href?null:(url=href,urlParsingNode||(urlParsingNode=document.createElement("a")),urlParsingNode.setAttribute("href",url),"/"===urlParsingNode.pathname.charAt(0)?urlParsingNode.pathname:"/"+urlParsingNode.pathname);var url}resetBaseElement(){baseElement=null}getUserAgent(){return window.navigator.userAgent}setData(element,name,value){this.setAttribute(element,"data-"+name,value)}getData(element,name){return this.getAttribute(element,"data-"+name)}getComputedStyle(element){return getComputedStyle(element)}supportsWebAnimation(){return"function"==typeof Element.prototype.animate}performanceNow(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}supportsCookies(){return!0}getCookie(name){return parseCookieValue(document.cookie,name)}setCookie(name,value){document.cookie=encodeURIComponent(name)+"="+encodeURIComponent(value)}}let urlParsingNode,baseElement=null;function supportsState(){return!!window.history.pushState}const TRANSITION_ID=new InjectionToken("TRANSITION_ID");function appInitializerFactory(transitionId,document,injector){return()=>{injector.get(ApplicationInitStatus).donePromise.then(()=>{const dom=getDOM();Array.prototype.slice.apply(dom.querySelectorAll(document,"style[ng-transition]")).filter(el=>dom.getAttribute(el,"ng-transition")===transitionId).forEach(el=>dom.remove(el))})}}const SERVER_TRANSITION_PROVIDERS=[{provide:APP_INITIALIZER,useFactory:appInitializerFactory,deps:[TRANSITION_ID,DOCUMENT,Injector],multi:!0}];class platform_browser_BrowserGetTestability{static init(){var getter;getter=new platform_browser_BrowserGetTestability,_testabilityGetter=getter}addToWindow(registry){_global.getAngularTestability=(elem,findInAncestors=!0)=>{const testability=registry.findTestabilityInTree(elem,findInAncestors);if(null==testability)throw new Error("Could not find testability for element.");return testability},_global.getAllAngularTestabilities=()=>registry.getAllTestabilities(),_global.getAllAngularRootElements=()=>registry.getAllRootElements(),_global.frameworkStabilizers||(_global.frameworkStabilizers=[]),_global.frameworkStabilizers.push(callback=>{const testabilities=_global.getAllAngularTestabilities();let count=testabilities.length,didWork=!1;const decrement=function(didWork_){didWork=didWork||didWork_,count--,0==count&&callback(didWork)};testabilities.forEach((function(testability){testability.whenStable(decrement)}))})}findTestabilityInTree(registry,elem,findInAncestors){if(null==elem)return null;const t=registry.getTestability(elem);return null!=t?t:findInAncestors?getDOM().isShadowRoot(elem)?this.findTestabilityInTree(registry,getDOM().getHost(elem),!0):this.findTestabilityInTree(registry,getDOM().parentElement(elem),!0):null}}function exportNgVar(name,value){"undefined"!=typeof COMPILED&&COMPILED||((_global.ng=_global.ng||{})[name]=value)}const CORE_TOKENS=(()=>({ApplicationRef:core_ApplicationRef,NgZone:NgZone}))();function inspectNativeElement(element){return getDebugNode(element)}const EVENT_MANAGER_PLUGINS=new InjectionToken("EventManagerPlugins");class EventManager{constructor(plugins,_zone){this._zone=_zone,this._eventNameToPlugin=new Map,plugins.forEach(p=>p.manager=this),this._plugins=plugins.slice().reverse()}addEventListener(element,eventName,handler){return this._findPluginFor(eventName).addEventListener(element,eventName,handler)}addGlobalEventListener(target,eventName,handler){return this._findPluginFor(eventName).addGlobalEventListener(target,eventName,handler)}getZone(){return this._zone}_findPluginFor(eventName){const plugin=this._eventNameToPlugin.get(eventName);if(plugin)return plugin;const plugins=this._plugins;for(let i=0;i<plugins.length;i++){const plugin=plugins[i];if(plugin.supports(eventName))return this._eventNameToPlugin.set(eventName,plugin),plugin}throw new Error("No event manager plugin found for event "+eventName)}}class EventManagerPlugin{constructor(_doc){this._doc=_doc}addGlobalEventListener(element,eventName,handler){const target=getDOM().getGlobalEventTarget(this._doc,element);if(!target)throw new Error(`Unsupported event target ${target} for event ${eventName}`);return this.addEventListener(target,eventName,handler)}}class SharedStylesHost{constructor(){this._stylesSet=new Set}addStyles(styles){const additions=new Set;styles.forEach(style=>{this._stylesSet.has(style)||(this._stylesSet.add(style),additions.add(style))}),this.onStylesAdded(additions)}onStylesAdded(additions){}getAllStyles(){return Array.from(this._stylesSet)}}class DomSharedStylesHost extends SharedStylesHost{constructor(_doc){super(),this._doc=_doc,this._hostNodes=new Set,this._styleNodes=new Set,this._hostNodes.add(_doc.head)}_addStylesToHost(styles,host){styles.forEach(style=>{const styleEl=this._doc.createElement("style");styleEl.textContent=style,this._styleNodes.add(host.appendChild(styleEl))})}addHost(hostNode){this._addStylesToHost(this._stylesSet,hostNode),this._hostNodes.add(hostNode)}removeHost(hostNode){this._hostNodes.delete(hostNode)}onStylesAdded(additions){this._hostNodes.forEach(hostNode=>this._addStylesToHost(additions,hostNode))}ngOnDestroy(){this._styleNodes.forEach(styleNode=>getDOM().remove(styleNode))}}const NAMESPACE_URIS={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},COMPONENT_REGEX=/%COMP%/g;function flattenStyles(compId,styles,target){for(let i=0;i<styles.length;i++){let style=styles[i];Array.isArray(style)?flattenStyles(compId,style,target):(style=style.replace(COMPONENT_REGEX,compId),target.push(style))}return target}function decoratePreventDefault(eventHandler){return event=>{!1===eventHandler(event)&&(event.preventDefault(),event.returnValue=!1)}}class platform_browser_DomRendererFactory2{constructor(eventManager,sharedStylesHost,appId){this.eventManager=eventManager,this.sharedStylesHost=sharedStylesHost,this.appId=appId,this.rendererByCompId=new Map,this.defaultRenderer=new platform_browser_DefaultDomRenderer2(eventManager)}createRenderer(element,type){if(!element||!type)return this.defaultRenderer;switch(type.encapsulation){case ViewEncapsulation.Emulated:{let renderer=this.rendererByCompId.get(type.id);return renderer||(renderer=new EmulatedEncapsulationDomRenderer2(this.eventManager,this.sharedStylesHost,type,this.appId),this.rendererByCompId.set(type.id,renderer)),renderer.applyToHost(element),renderer}case ViewEncapsulation.Native:case ViewEncapsulation.ShadowDom:return new platform_browser_ShadowDomRenderer(this.eventManager,this.sharedStylesHost,element,type);default:if(!this.rendererByCompId.has(type.id)){const styles=flattenStyles(type.id,type.styles,[]);this.sharedStylesHost.addStyles(styles),this.rendererByCompId.set(type.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}class platform_browser_DefaultDomRenderer2{constructor(eventManager){this.eventManager=eventManager,this.data=Object.create(null)}destroy(){}createElement(name,namespace){return namespace?document.createElementNS(NAMESPACE_URIS[namespace]||namespace,name):document.createElement(name)}createComment(value){return document.createComment(value)}createText(value){return document.createTextNode(value)}appendChild(parent,newChild){parent.appendChild(newChild)}insertBefore(parent,newChild,refChild){parent&&parent.insertBefore(newChild,refChild)}removeChild(parent,oldChild){parent&&parent.removeChild(oldChild)}selectRootElement(selectorOrNode,preserveContent){let el="string"==typeof selectorOrNode?document.querySelector(selectorOrNode):selectorOrNode;if(!el)throw new Error(`The selector "${selectorOrNode}" did not match any elements`);return preserveContent||(el.textContent=""),el}parentNode(node){return node.parentNode}nextSibling(node){return node.nextSibling}setAttribute(el,name,value,namespace){if(namespace){name=namespace+":"+name;const namespaceUri=NAMESPACE_URIS[namespace];namespaceUri?el.setAttributeNS(namespaceUri,name,value):el.setAttribute(name,value)}else el.setAttribute(name,value)}removeAttribute(el,name,namespace){if(namespace){const namespaceUri=NAMESPACE_URIS[namespace];namespaceUri?el.removeAttributeNS(namespaceUri,name):el.removeAttribute(`${namespace}:${name}`)}else el.removeAttribute(name)}addClass(el,name){el.classList.add(name)}removeClass(el,name){el.classList.remove(name)}setStyle(el,style,value,flags){flags&RendererStyleFlags2.DashCase?el.style.setProperty(style,value,flags&RendererStyleFlags2.Important?"important":""):el.style[style]=value}removeStyle(el,style,flags){flags&RendererStyleFlags2.DashCase?el.style.removeProperty(style):el.style[style]=""}setProperty(el,name,value){checkNoSyntheticProp(name,"property"),el[name]=value}setValue(node,value){node.nodeValue=value}listen(target,event,callback){return checkNoSyntheticProp(event,"listener"),"string"==typeof target?this.eventManager.addGlobalEventListener(target,event,decoratePreventDefault(callback)):this.eventManager.addEventListener(target,event,decoratePreventDefault(callback))}}const AT_CHARCODE=(()=>"@".charCodeAt(0))();function checkNoSyntheticProp(name,nameKind){if(name.charCodeAt(0)===AT_CHARCODE)throw new Error(`Found the synthetic ${nameKind} ${name}. Please include either "BrowserAnimationsModule" or "NoopAnimationsModule" in your application.`)}class EmulatedEncapsulationDomRenderer2 extends platform_browser_DefaultDomRenderer2{constructor(eventManager,sharedStylesHost,component,appId){super(eventManager),this.component=component;const styles=flattenStyles(appId+"-"+component.id,component.styles,[]);sharedStylesHost.addStyles(styles),this.contentAttr="_ngcontent-%COMP%".replace(COMPONENT_REGEX,appId+"-"+component.id),this.hostAttr=function(componentShortId){return"_nghost-%COMP%".replace(COMPONENT_REGEX,componentShortId)}(appId+"-"+component.id)}applyToHost(element){super.setAttribute(element,this.hostAttr,"")}createElement(parent,name){const el=super.createElement(parent,name);return super.setAttribute(el,this.contentAttr,""),el}}class platform_browser_ShadowDomRenderer extends platform_browser_DefaultDomRenderer2{constructor(eventManager,sharedStylesHost,hostEl,component){super(eventManager),this.sharedStylesHost=sharedStylesHost,this.hostEl=hostEl,this.component=component,this.shadowRoot=component.encapsulation===ViewEncapsulation.ShadowDom?hostEl.attachShadow({mode:"open"}):hostEl.createShadowRoot(),this.sharedStylesHost.addHost(this.shadowRoot);const styles=flattenStyles(component.id,component.styles,[]);for(let i=0;i<styles.length;i++){const styleEl=document.createElement("style");styleEl.textContent=styles[i],this.shadowRoot.appendChild(styleEl)}}nodeOrShadowRoot(node){return node===this.hostEl?this.shadowRoot:node}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(parent,newChild){return super.appendChild(this.nodeOrShadowRoot(parent),newChild)}insertBefore(parent,newChild,refChild){return super.insertBefore(this.nodeOrShadowRoot(parent),newChild,refChild)}removeChild(parent,oldChild){return super.removeChild(this.nodeOrShadowRoot(parent),oldChild)}parentNode(node){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(node)))}}const __symbol__=(()=>"undefined"!=typeof Zone&&Zone.__symbol__||function(v){return"__zone_symbol__"+v})(),ADD_EVENT_LISTENER=__symbol__("addEventListener"),REMOVE_EVENT_LISTENER=__symbol__("removeEventListener"),symbolNames={},stopSymbol="__zone_symbol__propagationStopped",blackListedMap=(()=>{const blackListedEvents="undefined"!=typeof Zone&&Zone[__symbol__("BLACK_LISTED_EVENTS")];if(blackListedEvents){const res={};return blackListedEvents.forEach(eventName=>{res[eventName]=eventName}),res}})(),isBlackListedEvent=function(eventName){return!!blackListedMap&&blackListedMap.hasOwnProperty(eventName)},globalListener=function(event){const symbolName=symbolNames[event.type];if(!symbolName)return;const taskDatas=this[symbolName];if(!taskDatas)return;const args=[event];if(1===taskDatas.length){const taskData=taskDatas[0];return taskData.zone!==Zone.current?taskData.zone.run(taskData.handler,this,args):taskData.handler.apply(this,args)}{const copiedTasks=taskDatas.slice();for(let i=0;i<copiedTasks.length&&!0!==event[stopSymbol];i++){const taskData=copiedTasks[i];taskData.zone!==Zone.current?taskData.zone.run(taskData.handler,this,args):taskData.handler.apply(this,args)}}};class platform_browser_DomEventsPlugin extends EventManagerPlugin{constructor(doc,ngZone,platformId){super(doc),this.ngZone=ngZone,platformId&&function(platformId){return"server"===platformId}(platformId)||this.patchEvent()}patchEvent(){if("undefined"==typeof Event||!Event||!Event.prototype)return;if(Event.prototype.__zone_symbol__stopImmediatePropagation)return;const delegate=Event.prototype.__zone_symbol__stopImmediatePropagation=Event.prototype.stopImmediatePropagation;Event.prototype.stopImmediatePropagation=function(){this&&(this[stopSymbol]=!0),delegate&&delegate.apply(this,arguments)}}supports(eventName){return!0}addEventListener(element,eventName,handler){let callback=handler;if(!element[ADD_EVENT_LISTENER]||NgZone.isInAngularZone()&&!isBlackListedEvent(eventName))element.addEventListener(eventName,callback,!1);else{let symbolName=symbolNames[eventName];symbolName||(symbolName=symbolNames[eventName]=__symbol__("ANGULAR"+eventName+"FALSE"));let taskDatas=element[symbolName];const globalListenerRegistered=taskDatas&&taskDatas.length>0;taskDatas||(taskDatas=element[symbolName]=[]);const zone=isBlackListedEvent(eventName)?Zone.root:Zone.current;if(0===taskDatas.length)taskDatas.push({zone:zone,handler:callback});else{let callbackRegistered=!1;for(let i=0;i<taskDatas.length;i++)if(taskDatas[i].handler===callback){callbackRegistered=!0;break}callbackRegistered||taskDatas.push({zone:zone,handler:callback})}globalListenerRegistered||element[ADD_EVENT_LISTENER](eventName,globalListener,!1)}return()=>this.removeEventListener(element,eventName,callback)}removeEventListener(target,eventName,callback){let underlyingRemove=target[REMOVE_EVENT_LISTENER];if(!underlyingRemove)return target.removeEventListener.apply(target,[eventName,callback,!1]);let symbolName=symbolNames[eventName],taskDatas=symbolName&&target[symbolName];if(!taskDatas)return target.removeEventListener.apply(target,[eventName,callback,!1]);let found=!1;for(let i=0;i<taskDatas.length;i++)if(taskDatas[i].handler===callback){found=!0,taskDatas.splice(i,1);break}found?0===taskDatas.length&&underlyingRemove.apply(target,[eventName,globalListener,!1]):target.removeEventListener.apply(target,[eventName,callback,!1])}}const EVENT_NAMES={pan:!0,panstart:!0,panmove:!0,panend:!0,pancancel:!0,panleft:!0,panright:!0,panup:!0,pandown:!0,pinch:!0,pinchstart:!0,pinchmove:!0,pinchend:!0,pinchcancel:!0,pinchin:!0,pinchout:!0,press:!0,pressup:!0,rotate:!0,rotatestart:!0,rotatemove:!0,rotateend:!0,rotatecancel:!0,swipe:!0,swipeleft:!0,swiperight:!0,swipeup:!0,swipedown:!0,tap:!0},HAMMER_GESTURE_CONFIG=new InjectionToken("HammerGestureConfig"),HAMMER_LOADER=new InjectionToken("HammerLoader");class HammerGestureConfig{constructor(){this.events=[],this.overrides={}}buildHammer(element){const mc=new Hammer(element,this.options);mc.get("pinch").set({enable:!0}),mc.get("rotate").set({enable:!0});for(const eventName in this.overrides)mc.get(eventName).set(this.overrides[eventName]);return mc}}class HammerGesturesPlugin extends EventManagerPlugin{constructor(doc,_config,console,loader){super(doc),this._config=_config,this.console=console,this.loader=loader}supports(eventName){return!(!EVENT_NAMES.hasOwnProperty(eventName.toLowerCase())&&!this.isCustomEvent(eventName)||!window.Hammer&&!this.loader&&(this.console.warn(`The "${eventName}" event cannot be bound because Hammer.JS is not loaded and no custom loader has been specified.`),1))}addEventListener(element,eventName,handler){const zone=this.manager.getZone();if(eventName=eventName.toLowerCase(),!window.Hammer&&this.loader){let cancelRegistration=!1,deregister=()=>{cancelRegistration=!0};return this.loader().then(()=>{if(!window.Hammer)return this.console.warn("The custom HAMMER_LOADER completed, but Hammer.JS is not present."),void(deregister=()=>{});cancelRegistration||(deregister=this.addEventListener(element,eventName,handler))}).catch(()=>{this.console.warn(`The "${eventName}" event cannot be bound because the custom Hammer.JS loader failed.`),deregister=()=>{}}),()=>{deregister()}}return zone.runOutsideAngular(()=>{const mc=this._config.buildHammer(element),callback=function(eventObj){zone.runGuarded((function(){handler(eventObj)}))};return mc.on(eventName,callback),()=>{mc.off(eventName,callback),"function"==typeof mc.destroy&&mc.destroy()}})}isCustomEvent(eventName){return this._config.events.indexOf(eventName)>-1}}const MODIFIER_KEYS=["alt","control","meta","shift"],MODIFIER_KEY_GETTERS={alt:event=>event.altKey,control:event=>event.ctrlKey,meta:event=>event.metaKey,shift:event=>event.shiftKey};class KeyEventsPlugin extends EventManagerPlugin{constructor(doc){super(doc)}supports(eventName){return null!=KeyEventsPlugin.parseEventName(eventName)}addEventListener(element,eventName,handler){const parsedEvent=KeyEventsPlugin.parseEventName(eventName),outsideHandler=KeyEventsPlugin.eventCallback(parsedEvent.fullKey,handler,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>getDOM().onAndCancel(element,parsedEvent.domEventName,outsideHandler))}static parseEventName(eventName){const parts=eventName.toLowerCase().split("."),domEventName=parts.shift();if(0===parts.length||"keydown"!==domEventName&&"keyup"!==domEventName)return null;const key=KeyEventsPlugin._normalizeKey(parts.pop());let fullKey="";if(MODIFIER_KEYS.forEach(modifierName=>{const index=parts.indexOf(modifierName);index>-1&&(parts.splice(index,1),fullKey+=modifierName+".")}),fullKey+=key,0!=parts.length||0===key.length)return null;const result={};return result.domEventName=domEventName,result.fullKey=fullKey,result}static getEventFullKey(event){let fullKey="",key=getDOM().getEventKey(event);return key=key.toLowerCase()," "===key?key="space":"."===key&&(key="dot"),MODIFIER_KEYS.forEach(modifierName=>{modifierName!=key&&(0,MODIFIER_KEY_GETTERS[modifierName])(event)&&(fullKey+=modifierName+".")}),fullKey+=key,fullKey}static eventCallback(fullKey,handler,zone){return event=>{KeyEventsPlugin.getEventFullKey(event)===fullKey&&zone.runGuarded(()=>handler(event))}}static _normalizeKey(keyName){switch(keyName){case"esc":return"escape";default:return keyName}}}class DomSanitizer{}class platform_browser_DomSanitizerImpl extends DomSanitizer{constructor(_doc){super(),this._doc=_doc}sanitize(ctx,value){if(null==value)return null;switch(ctx){case SecurityContext.NONE:return value;case SecurityContext.HTML:return value instanceof SafeHtmlImpl?value.changingThisBreaksApplicationSecurity:(this.checkNotSafeValue(value,"HTML"),function(defaultDoc,unsafeHtmlInput){let inertBodyElement=null;try{inertBodyHelper=inertBodyHelper||new InertBodyHelper(defaultDoc);let unsafeHtml=unsafeHtmlInput?String(unsafeHtmlInput):"";inertBodyElement=inertBodyHelper.getInertBodyElement(unsafeHtml);let mXSSAttempts=5,parsedHtml=unsafeHtml;do{if(0===mXSSAttempts)throw new Error("Failed to sanitize html because the input is unstable");mXSSAttempts--,unsafeHtml=parsedHtml,parsedHtml=inertBodyElement.innerHTML,inertBodyElement=inertBodyHelper.getInertBodyElement(unsafeHtml)}while(unsafeHtml!==parsedHtml);const sanitizer=new SanitizingHtmlSerializer,safeHtml=sanitizer.sanitizeChildren(getTemplateContent(inertBodyElement)||inertBodyElement);return isDevMode()&&sanitizer.sanitizedSomething&&console.warn("WARNING: sanitizing HTML stripped some content, see http://g.co/ng/security#xss"),safeHtml}finally{if(inertBodyElement){const parent=getTemplateContent(inertBodyElement)||inertBodyElement;for(;parent.firstChild;)parent.removeChild(parent.firstChild)}}}(this._doc,String(value)));case SecurityContext.STYLE:return value instanceof SafeStyleImpl?value.changingThisBreaksApplicationSecurity:(this.checkNotSafeValue(value,"Style"),function(value){if(!(value=String(value).trim()))return"";const urlMatch=value.match(URL_RE);return urlMatch&&_sanitizeUrl(urlMatch[1])===urlMatch[1]||value.match(SAFE_STYLE_VALUE)&&function(value){let outsideSingle=!0,outsideDouble=!0;for(let i=0;i<value.length;i++){const c=value.charAt(i);"'"===c&&outsideDouble?outsideSingle=!outsideSingle:'"'===c&&outsideSingle&&(outsideDouble=!outsideDouble)}return outsideSingle&&outsideDouble}(value)?value:(isDevMode()&&console.warn(`WARNING: sanitizing unsafe style value ${value} (see http://g.co/ng/security#xss).`),"unsafe")}(value));case SecurityContext.SCRIPT:if(value instanceof SafeScriptImpl)return value.changingThisBreaksApplicationSecurity;throw this.checkNotSafeValue(value,"Script"),new Error("unsafe value used in a script context");case SecurityContext.URL:return value instanceof SafeResourceUrlImpl||value instanceof SafeUrlImpl?value.changingThisBreaksApplicationSecurity:(this.checkNotSafeValue(value,"URL"),_sanitizeUrl(String(value)));case SecurityContext.RESOURCE_URL:if(value instanceof SafeResourceUrlImpl)return value.changingThisBreaksApplicationSecurity;throw this.checkNotSafeValue(value,"ResourceURL"),new Error("unsafe value used in a resource URL context (see http://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${ctx} (see http://g.co/ng/security#xss)`)}}checkNotSafeValue(value,expectedType){if(value instanceof SafeValueImpl)throw new Error(`Required a safe ${expectedType}, got a ${value.getTypeName()} (see http://g.co/ng/security#xss)`)}bypassSecurityTrustHtml(value){return new SafeHtmlImpl(value)}bypassSecurityTrustStyle(value){return new SafeStyleImpl(value)}bypassSecurityTrustScript(value){return new SafeScriptImpl(value)}bypassSecurityTrustUrl(value){return new SafeUrlImpl(value)}bypassSecurityTrustResourceUrl(value){return new SafeResourceUrlImpl(value)}}class SafeValueImpl{constructor(changingThisBreaksApplicationSecurity){this.changingThisBreaksApplicationSecurity=changingThisBreaksApplicationSecurity}toString(){return"SafeValue must use [property]=binding: "+this.changingThisBreaksApplicationSecurity+" (see http://g.co/ng/security#xss)"}}class SafeHtmlImpl extends SafeValueImpl{getTypeName(){return"HTML"}}class SafeStyleImpl extends SafeValueImpl{getTypeName(){return"Style"}}class SafeScriptImpl extends SafeValueImpl{getTypeName(){return"Script"}}class SafeUrlImpl extends SafeValueImpl{getTypeName(){return"URL"}}class SafeResourceUrlImpl extends SafeValueImpl{getTypeName(){return"ResourceURL"}}const platformBrowser=createPlatformFactory(platformCore,"browser",[{provide:PLATFORM_ID,useValue:"browser"},{provide:PLATFORM_INITIALIZER,useValue:function(){platform_browser_BrowserDomAdapter.makeCurrent(),platform_browser_BrowserGetTestability.init()},multi:!0},{provide:PlatformLocation,useClass:class extends PlatformLocation{constructor(_doc){super(),this._doc=_doc,this._init()}_init(){this.location=getDOM().getLocation(),this._history=getDOM().getHistory()}getBaseHrefFromDOM(){return getDOM().getBaseHref(this._doc)}onPopState(fn){getDOM().getGlobalEventTarget(this._doc,"window").addEventListener("popstate",fn,!1)}onHashChange(fn){getDOM().getGlobalEventTarget(this._doc,"window").addEventListener("hashchange",fn,!1)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(newPath){this.location.pathname=newPath}pushState(state,title,url){supportsState()?this._history.pushState(state,title,url):this.location.hash=url}replaceState(state,title,url){supportsState()?this._history.replaceState(state,title,url):this.location.hash=url}forward(){this._history.forward()}back(){this._history.back()}getState(){return this._history.state}},deps:[DOCUMENT]},{provide:DOCUMENT,useFactory:function(){return document},deps:[]}]);function errorHandler(){return new ErrorHandler}class platform_browser_BrowserModule{constructor(parentModule){if(parentModule)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(params){return{ngModule:platform_browser_BrowserModule,providers:[{provide:APP_ID,useValue:params.appId},{provide:TRANSITION_ID,useExisting:APP_ID},SERVER_TRANSITION_PROVIDERS]}}}"undefined"!=typeof window&&window;class RouterEvent{constructor(id,url){this.id=id,this.url=url}}class NavigationStart extends RouterEvent{constructor(id,url,navigationTrigger="imperative",restoredState=null){super(id,url),this.navigationTrigger=navigationTrigger,this.restoredState=restoredState}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class NavigationEnd extends RouterEvent{constructor(id,url,urlAfterRedirects){super(id,url),this.urlAfterRedirects=urlAfterRedirects}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class NavigationCancel extends RouterEvent{constructor(id,url,reason){super(id,url),this.reason=reason}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class NavigationError extends RouterEvent{constructor(id,url,error){super(id,url),this.error=error}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class RoutesRecognized extends RouterEvent{constructor(id,url,urlAfterRedirects,state){super(id,url),this.urlAfterRedirects=urlAfterRedirects,this.state=state}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class GuardsCheckStart extends RouterEvent{constructor(id,url,urlAfterRedirects,state){super(id,url),this.urlAfterRedirects=urlAfterRedirects,this.state=state}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class GuardsCheckEnd extends RouterEvent{constructor(id,url,urlAfterRedirects,state,shouldActivate){super(id,url),this.urlAfterRedirects=urlAfterRedirects,this.state=state,this.shouldActivate=shouldActivate}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class ResolveStart extends RouterEvent{constructor(id,url,urlAfterRedirects,state){super(id,url),this.urlAfterRedirects=urlAfterRedirects,this.state=state}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class ResolveEnd extends RouterEvent{constructor(id,url,urlAfterRedirects,state){super(id,url),this.urlAfterRedirects=urlAfterRedirects,this.state=state}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class RouteConfigLoadStart{constructor(route){this.route=route}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class RouteConfigLoadEnd{constructor(route){this.route=route}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class ChildActivationStart{constructor(snapshot){this.snapshot=snapshot}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ChildActivationEnd{constructor(snapshot){this.snapshot=snapshot}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ActivationStart{constructor(snapshot){this.snapshot=snapshot}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ActivationEnd{constructor(snapshot){this.snapshot=snapshot}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Scroll{constructor(routerEvent,position,anchor){this.routerEvent=routerEvent,this.position=position,this.anchor=anchor}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class ɵEmptyOutletComponent{}class ParamsAsMap{constructor(params){this.params=params||{}}has(name){return this.params.hasOwnProperty(name)}get(name){if(this.has(name)){const v=this.params[name];return Array.isArray(v)?v[0]:v}return null}getAll(name){if(this.has(name)){const v=this.params[name];return Array.isArray(v)?v:[v]}return[]}get keys(){return Object.keys(this.params)}}function convertToParamMap(params){return new ParamsAsMap(params)}function navigationCancelingError(message){const error=Error("NavigationCancelingError: "+message);return error.ngNavigationCancelingError=!0,error}function defaultUrlMatcher(segments,segmentGroup,route){const parts=route.path.split("/");if(parts.length>segments.length)return null;if("full"===route.pathMatch&&(segmentGroup.hasChildren()||parts.length<segments.length))return null;const posParams={};for(let index=0;index<parts.length;index++){const part=parts[index],segment=segments[index];if(part.startsWith(":"))posParams[part.substring(1)]=segment;else if(part!==segment.path)return null}return{consumed:segments.slice(0,parts.length),posParams:posParams}}class LoadedRouterConfig{constructor(routes,module){this.routes=routes,this.module=module}}function validateConfig(config,parentPath=""){for(let i=0;i<config.length;i++){const route=config[i];router_validateNode(route,getFullPath(parentPath,route))}}function router_validateNode(route,fullPath){if(!route)throw new Error(`\n      Invalid configuration of route '${fullPath}': Encountered undefined route.\n      The reason might be an extra comma.\n\n      Example:\n      const routes: Routes = [\n        { path: '', redirectTo: '/dashboard', pathMatch: 'full' },\n        { path: 'dashboard',  component: DashboardComponent },, << two commas\n        { path: 'detail/:id', component: HeroDetailComponent }\n      ];\n    `);if(Array.isArray(route))throw new Error(`Invalid configuration of route '${fullPath}': Array cannot be specified`);if(!route.component&&!route.children&&!route.loadChildren&&route.outlet&&"primary"!==route.outlet)throw new Error(`Invalid configuration of route '${fullPath}': a componentless route without children or loadChildren cannot have a named outlet set`);if(route.redirectTo&&route.children)throw new Error(`Invalid configuration of route '${fullPath}': redirectTo and children cannot be used together`);if(route.redirectTo&&route.loadChildren)throw new Error(`Invalid configuration of route '${fullPath}': redirectTo and loadChildren cannot be used together`);if(route.children&&route.loadChildren)throw new Error(`Invalid configuration of route '${fullPath}': children and loadChildren cannot be used together`);if(route.redirectTo&&route.component)throw new Error(`Invalid configuration of route '${fullPath}': redirectTo and component cannot be used together`);if(route.path&&route.matcher)throw new Error(`Invalid configuration of route '${fullPath}': path and matcher cannot be used together`);if(void 0===route.redirectTo&&!route.component&&!route.children&&!route.loadChildren)throw new Error(`Invalid configuration of route '${fullPath}'. One of the following must be provided: component, redirectTo, children or loadChildren`);if(void 0===route.path&&void 0===route.matcher)throw new Error(`Invalid configuration of route '${fullPath}': routes must have either a path or a matcher specified`);if("string"==typeof route.path&&"/"===route.path.charAt(0))throw new Error(`Invalid configuration of route '${fullPath}': path cannot start with a slash`);if(""===route.path&&void 0!==route.redirectTo&&void 0===route.pathMatch)throw new Error(`Invalid configuration of route '{path: "${fullPath}", redirectTo: "${route.redirectTo}"}': please provide 'pathMatch'. The default value of 'pathMatch' is 'prefix', but often the intent is to use 'full'.`);if(void 0!==route.pathMatch&&"full"!==route.pathMatch&&"prefix"!==route.pathMatch)throw new Error(`Invalid configuration of route '${fullPath}': pathMatch can only be set to 'prefix' or 'full'`);route.children&&validateConfig(route.children,fullPath)}function getFullPath(parentPath,currentRoute){return currentRoute?parentPath||currentRoute.path?parentPath&&!currentRoute.path?parentPath+"/":!parentPath&&currentRoute.path?currentRoute.path:`${parentPath}/${currentRoute.path}`:"":parentPath}function standardizeConfig(r){const children=r.children&&r.children.map(standardizeConfig),c=children?Object.assign({},r,{children:children}):Object.assign({},r);return!c.component&&(children||c.loadChildren)&&c.outlet&&"primary"!==c.outlet&&(c.component=ɵEmptyOutletComponent),c}function shallowEqual(a,b){const k1=Object.keys(a),k2=Object.keys(b);if(!k1||!k2||k1.length!=k2.length)return!1;let key;for(let i=0;i<k1.length;i++)if(key=k1[i],a[key]!==b[key])return!1;return!0}function router_flatten(arr){return Array.prototype.concat.apply([],arr)}function router_last(a){return a.length>0?a[a.length-1]:null}function forEach(map,callback){for(const prop in map)map.hasOwnProperty(prop)&&callback(map[prop],prop)}function wrapIntoObservable(value){return isObservable(value)?value:core_isPromise(value)?from(Promise.resolve(value)):of(value)}function containsTree(container,containee,exact){return exact?function(container,containee){return shallowEqual(container,containee)}(container.queryParams,containee.queryParams)&&function equalSegmentGroups(container,containee){if(!equalPath(container.segments,containee.segments))return!1;if(container.numberOfChildren!==containee.numberOfChildren)return!1;for(const c in containee.children){if(!container.children[c])return!1;if(!equalSegmentGroups(container.children[c],containee.children[c]))return!1}return!0}(container.root,containee.root):function(container,containee){return Object.keys(containee).length<=Object.keys(container).length&&Object.keys(containee).every(key=>containee[key]===container[key])}(container.queryParams,containee.queryParams)&&function containsSegmentGroup(container,containee){return function containsSegmentGroupHelper(container,containee,containeePaths){if(container.segments.length>containeePaths.length)return!!equalPath(container.segments.slice(0,containeePaths.length),containeePaths)&&!containee.hasChildren();if(container.segments.length===containeePaths.length){if(!equalPath(container.segments,containeePaths))return!1;for(const c in containee.children){if(!container.children[c])return!1;if(!containsSegmentGroup(container.children[c],containee.children[c]))return!1}return!0}{const current=containeePaths.slice(0,container.segments.length),next=containeePaths.slice(container.segments.length);return!!equalPath(container.segments,current)&&!!container.children.primary&&containsSegmentGroupHelper(container.children.primary,containee,next)}}(container,containee,containee.segments)}(container.root,containee.root)}class UrlTree{constructor(root,queryParams,fragment){this.root=root,this.queryParams=queryParams,this.fragment=fragment}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=convertToParamMap(this.queryParams)),this._queryParamMap}toString(){return DEFAULT_SERIALIZER.serialize(this)}}class UrlSegmentGroup{constructor(segments,children){this.segments=segments,this.children=children,this.parent=null,forEach(children,(v,k)=>v.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return serializePaths(this)}}class UrlSegment{constructor(path,parameters){this.path=path,this.parameters=parameters}get parameterMap(){return this._parameterMap||(this._parameterMap=convertToParamMap(this.parameters)),this._parameterMap}toString(){return serializePath(this)}}function equalPath(as,bs){return as.length===bs.length&&as.every((a,i)=>a.path===bs[i].path)}function mapChildrenIntoArray(segment,fn){let res=[];return forEach(segment.children,(child,childOutlet)=>{"primary"===childOutlet&&(res=res.concat(fn(child,childOutlet)))}),forEach(segment.children,(child,childOutlet)=>{"primary"!==childOutlet&&(res=res.concat(fn(child,childOutlet)))}),res}class UrlSerializer{}class DefaultUrlSerializer{parse(url){const p=new UrlParser(url);return new UrlTree(p.parseRootSegment(),p.parseQueryParams(),p.parseFragment())}serialize(tree){return`${"/"+function serializeSegment(segment,root){if(!segment.hasChildren())return serializePaths(segment);if(root){const primary=segment.children.primary?serializeSegment(segment.children.primary,!1):"",children=[];return forEach(segment.children,(v,k)=>{"primary"!==k&&children.push(`${k}:${serializeSegment(v,!1)}`)}),children.length>0?`${primary}(${children.join("//")})`:primary}{const children=mapChildrenIntoArray(segment,(v,k)=>"primary"===k?[serializeSegment(segment.children.primary,!1)]:[`${k}:${serializeSegment(v,!1)}`]);return`${serializePaths(segment)}/(${children.join("//")})`}}(tree.root,!0)}${function(params){const strParams=Object.keys(params).map(name=>{const value=params[name];return Array.isArray(value)?value.map(v=>`${encodeUriQuery(name)}=${encodeUriQuery(v)}`).join("&"):`${encodeUriQuery(name)}=${encodeUriQuery(value)}`});return strParams.length?"?"+strParams.join("&"):""}(tree.queryParams)}${"string"==typeof tree.fragment?"#"+encodeURI(tree.fragment):""}`}}const DEFAULT_SERIALIZER=new DefaultUrlSerializer;function serializePaths(segment){return segment.segments.map(p=>serializePath(p)).join("/")}function encodeUriString(s){return encodeURIComponent(s).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function encodeUriQuery(s){return encodeUriString(s).replace(/%3B/gi,";")}function encodeUriSegment(s){return encodeUriString(s).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function decode(s){return decodeURIComponent(s)}function decodeQuery(s){return decode(s.replace(/\+/g,"%20"))}function serializePath(path){return`${encodeUriSegment(path.path)}${params=path.parameters,Object.keys(params).map(key=>`;${encodeUriSegment(key)}=${encodeUriSegment(params[key])}`).join("")}`;var params}const SEGMENT_RE=/^[^\/()?;=#]+/;function matchSegments(str){const match=str.match(SEGMENT_RE);return match?match[0]:""}const QUERY_PARAM_RE=/^[^=?&#]+/,QUERY_PARAM_VALUE_RE=/^[^?&#]+/;class UrlParser{constructor(url){this.url=url,this.remaining=url}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new UrlSegmentGroup([],{}):new UrlSegmentGroup([],this.parseChildren())}parseQueryParams(){const params={};if(this.consumeOptional("?"))do{this.parseQueryParam(params)}while(this.consumeOptional("&"));return params}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const segments=[];for(this.peekStartsWith("(")||segments.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),segments.push(this.parseSegment());let children={};this.peekStartsWith("/(")&&(this.capture("/"),children=this.parseParens(!0));let res={};return this.peekStartsWith("(")&&(res=this.parseParens(!1)),(segments.length>0||Object.keys(children).length>0)&&(res.primary=new UrlSegmentGroup(segments,children)),res}parseSegment(){const path=matchSegments(this.remaining);if(""===path&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(path),new UrlSegment(decode(path),this.parseMatrixParams())}parseMatrixParams(){const params={};for(;this.consumeOptional(";");)this.parseParam(params);return params}parseParam(params){const key=matchSegments(this.remaining);if(!key)return;this.capture(key);let value="";if(this.consumeOptional("=")){const valueMatch=matchSegments(this.remaining);valueMatch&&(value=valueMatch,this.capture(value))}params[decode(key)]=decode(value)}parseQueryParam(params){const key=function(str){const match=str.match(QUERY_PARAM_RE);return match?match[0]:""}(this.remaining);if(!key)return;this.capture(key);let value="";if(this.consumeOptional("=")){const valueMatch=function(str){const match=str.match(QUERY_PARAM_VALUE_RE);return match?match[0]:""}(this.remaining);valueMatch&&(value=valueMatch,this.capture(value))}const decodedKey=decodeQuery(key),decodedVal=decodeQuery(value);if(params.hasOwnProperty(decodedKey)){let currentVal=params[decodedKey];Array.isArray(currentVal)||(currentVal=[currentVal],params[decodedKey]=currentVal),currentVal.push(decodedVal)}else params[decodedKey]=decodedVal}parseParens(allowPrimary){const segments={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const path=matchSegments(this.remaining),next=this.remaining[path.length];if("/"!==next&&")"!==next&&";"!==next)throw new Error(`Cannot parse url '${this.url}'`);let outletName=void 0;path.indexOf(":")>-1?(outletName=path.substr(0,path.indexOf(":")),this.capture(outletName),this.capture(":")):allowPrimary&&(outletName="primary");const children=this.parseChildren();segments[outletName]=1===Object.keys(children).length?children.primary:new UrlSegmentGroup([],children),this.consumeOptional("//")}return segments}peekStartsWith(str){return this.remaining.startsWith(str)}consumeOptional(str){return!!this.peekStartsWith(str)&&(this.remaining=this.remaining.substring(str.length),!0)}capture(str){if(!this.consumeOptional(str))throw new Error(`Expected "${str}".`)}}class Tree{constructor(root){this._root=root}get root(){return this._root.value}parent(t){const p=this.pathFromRoot(t);return p.length>1?p[p.length-2]:null}children(t){const n=findNode(t,this._root);return n?n.children.map(t=>t.value):[]}firstChild(t){const n=findNode(t,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(t){const p=findPath(t,this._root);return p.length<2?[]:p[p.length-2].children.map(c=>c.value).filter(cc=>cc!==t)}pathFromRoot(t){return findPath(t,this._root).map(s=>s.value)}}function findNode(value,node){if(value===node.value)return node;for(const child of node.children){const node=findNode(value,child);if(node)return node}return null}function findPath(value,node){if(value===node.value)return[node];for(const child of node.children){const path=findPath(value,child);if(path.length)return path.unshift(node),path}return[]}class TreeNode{constructor(value,children){this.value=value,this.children=children}toString(){return`TreeNode(${this.value})`}}function nodeChildrenAsMap(node){const map={};return node&&node.children.forEach(child=>map[child.value.outlet]=child),map}class RouterState extends Tree{constructor(root,snapshot){super(root),this.snapshot=snapshot,setRouterState(this,root)}toString(){return this.snapshot.toString()}}function createEmptyState(urlTree,rootComponent){const snapshot=function(urlTree,rootComponent){const activated=new ActivatedRouteSnapshot([],{},{},"",{},"primary",rootComponent,null,urlTree.root,-1,{});return new RouterStateSnapshot("",new TreeNode(activated,[]))}(urlTree,rootComponent),emptyUrl=new BehaviorSubject_BehaviorSubject([new UrlSegment("",{})]),emptyParams=new BehaviorSubject_BehaviorSubject({}),emptyData=new BehaviorSubject_BehaviorSubject({}),emptyQueryParams=new BehaviorSubject_BehaviorSubject({}),fragment=new BehaviorSubject_BehaviorSubject(""),activated=new router_ActivatedRoute(emptyUrl,emptyParams,emptyQueryParams,fragment,emptyData,"primary",rootComponent,snapshot.root);return activated.snapshot=snapshot.root,new RouterState(new TreeNode(activated,[]),snapshot)}class router_ActivatedRoute{constructor(url,params,queryParams,fragment,data,outlet,component,futureSnapshot){this.url=url,this.params=params,this.queryParams=queryParams,this.fragment=fragment,this.data=data,this.outlet=outlet,this.component=component,this._futureSnapshot=futureSnapshot}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(map(p=>convertToParamMap(p)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(map(p=>convertToParamMap(p)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function inheritedParamsDataResolve(route,paramsInheritanceStrategy="emptyOnly"){const pathFromRoot=route.pathFromRoot;let inheritingStartingFrom=0;if("always"!==paramsInheritanceStrategy)for(inheritingStartingFrom=pathFromRoot.length-1;inheritingStartingFrom>=1;){const current=pathFromRoot[inheritingStartingFrom],parent=pathFromRoot[inheritingStartingFrom-1];if(current.routeConfig&&""===current.routeConfig.path)inheritingStartingFrom--;else{if(parent.component)break;inheritingStartingFrom--}}return function(pathFromRoot){return pathFromRoot.reduce((res,curr)=>({params:Object.assign({},res.params,curr.params),data:Object.assign({},res.data,curr.data),resolve:Object.assign({},res.resolve,curr._resolvedData)}),{params:{},data:{},resolve:{}})}(pathFromRoot.slice(inheritingStartingFrom))}class ActivatedRouteSnapshot{constructor(url,params,queryParams,fragment,data,outlet,component,routeConfig,urlSegment,lastPathIndex,resolve){this.url=url,this.params=params,this.queryParams=queryParams,this.fragment=fragment,this.data=data,this.outlet=outlet,this.component=component,this.routeConfig=routeConfig,this._urlSegment=urlSegment,this._lastPathIndex=lastPathIndex,this._resolve=resolve}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=convertToParamMap(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=convertToParamMap(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(segment=>segment.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class RouterStateSnapshot extends Tree{constructor(url,root){super(root),this.url=url,setRouterState(this,root)}toString(){return serializeNode(this._root)}}function setRouterState(state,node){node.value._routerState=state,node.children.forEach(c=>setRouterState(state,c))}function serializeNode(node){const c=node.children.length>0?` { ${node.children.map(serializeNode).join(", ")} } `:"";return`${node.value}${c}`}function advanceActivatedRoute(route){if(route.snapshot){const currentSnapshot=route.snapshot,nextSnapshot=route._futureSnapshot;route.snapshot=nextSnapshot,shallowEqual(currentSnapshot.queryParams,nextSnapshot.queryParams)||route.queryParams.next(nextSnapshot.queryParams),currentSnapshot.fragment!==nextSnapshot.fragment&&route.fragment.next(nextSnapshot.fragment),shallowEqual(currentSnapshot.params,nextSnapshot.params)||route.params.next(nextSnapshot.params),function(a,b){if(a.length!==b.length)return!1;for(let i=0;i<a.length;++i)if(!shallowEqual(a[i],b[i]))return!1;return!0}(currentSnapshot.url,nextSnapshot.url)||route.url.next(nextSnapshot.url),shallowEqual(currentSnapshot.data,nextSnapshot.data)||route.data.next(nextSnapshot.data)}else route.snapshot=route._futureSnapshot,route.data.next(route._futureSnapshot.data)}function equalParamsAndUrlSegments(a,b){var as,bs;return shallowEqual(a.params,b.params)&&equalPath(as=a.url,bs=b.url)&&as.every((a,i)=>shallowEqual(a.parameters,bs[i].parameters))&&!(!a.parent!=!b.parent)&&(!a.parent||equalParamsAndUrlSegments(a.parent,b.parent))}function isMatrixParams(command){return"object"==typeof command&&null!=command&&!command.outlets&&!command.segmentPath}function router_tree(oldSegmentGroup,newSegmentGroup,urlTree,queryParams,fragment){let qp={};return queryParams&&forEach(queryParams,(value,name)=>{qp[name]=Array.isArray(value)?value.map(v=>""+v):""+value}),new UrlTree(urlTree.root===oldSegmentGroup?newSegmentGroup:function replaceSegment(current,oldSegment,newSegment){const children={};return forEach(current.children,(c,outletName)=>{children[outletName]=c===oldSegment?newSegment:replaceSegment(c,oldSegment,newSegment)}),new UrlSegmentGroup(current.segments,children)}(urlTree.root,oldSegmentGroup,newSegmentGroup),qp,fragment)}class Navigation{constructor(isAbsolute,numberOfDoubleDots,commands){if(this.isAbsolute=isAbsolute,this.numberOfDoubleDots=numberOfDoubleDots,this.commands=commands,isAbsolute&&commands.length>0&&isMatrixParams(commands[0]))throw new Error("Root segment cannot have matrix parameters");const cmdWithOutlet=commands.find(c=>"object"==typeof c&&null!=c&&c.outlets);if(cmdWithOutlet&&cmdWithOutlet!==router_last(commands))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Position{constructor(segmentGroup,processChildren,index){this.segmentGroup=segmentGroup,this.processChildren=processChildren,this.index=index}}function getPath(command){return"object"==typeof command&&null!=command&&command.outlets?command.outlets.primary:""+command}function updateSegmentGroup(segmentGroup,startIndex,commands){if(segmentGroup||(segmentGroup=new UrlSegmentGroup([],{})),0===segmentGroup.segments.length&&segmentGroup.hasChildren())return updateSegmentGroupChildren(segmentGroup,startIndex,commands);const m=function(segmentGroup,startIndex,commands){let currentCommandIndex=0,currentPathIndex=startIndex;const noMatch={match:!1,pathIndex:0,commandIndex:0};for(;currentPathIndex<segmentGroup.segments.length;){if(currentCommandIndex>=commands.length)return noMatch;const path=segmentGroup.segments[currentPathIndex],curr=getPath(commands[currentCommandIndex]),next=currentCommandIndex<commands.length-1?commands[currentCommandIndex+1]:null;if(currentPathIndex>0&&void 0===curr)break;if(curr&&next&&"object"==typeof next&&void 0===next.outlets){if(!compare(curr,next,path))return noMatch;currentCommandIndex+=2}else{if(!compare(curr,{},path))return noMatch;currentCommandIndex++}currentPathIndex++}return{match:!0,pathIndex:currentPathIndex,commandIndex:currentCommandIndex}}(segmentGroup,startIndex,commands),slicedCommands=commands.slice(m.commandIndex);if(m.match&&m.pathIndex<segmentGroup.segments.length){const g=new UrlSegmentGroup(segmentGroup.segments.slice(0,m.pathIndex),{});return g.children.primary=new UrlSegmentGroup(segmentGroup.segments.slice(m.pathIndex),segmentGroup.children),updateSegmentGroupChildren(g,0,slicedCommands)}return m.match&&0===slicedCommands.length?new UrlSegmentGroup(segmentGroup.segments,{}):m.match&&!segmentGroup.hasChildren()?createNewSegmentGroup(segmentGroup,startIndex,commands):m.match?updateSegmentGroupChildren(segmentGroup,0,slicedCommands):createNewSegmentGroup(segmentGroup,startIndex,commands)}function updateSegmentGroupChildren(segmentGroup,startIndex,commands){if(0===commands.length)return new UrlSegmentGroup(segmentGroup.segments,{});{const outlets=function(commands){return"object"!=typeof commands[0]||void 0===commands[0].outlets?{primary:commands}:commands[0].outlets}(commands),children={};return forEach(outlets,(commands,outlet)=>{null!==commands&&(children[outlet]=updateSegmentGroup(segmentGroup.children[outlet],startIndex,commands))}),forEach(segmentGroup.children,(child,childOutlet)=>{void 0===outlets[childOutlet]&&(children[childOutlet]=child)}),new UrlSegmentGroup(segmentGroup.segments,children)}}function createNewSegmentGroup(segmentGroup,startIndex,commands){const paths=segmentGroup.segments.slice(0,startIndex);let i=0;for(;i<commands.length;){if("object"==typeof commands[i]&&void 0!==commands[i].outlets){const children=createNewSegmentChildren(commands[i].outlets);return new UrlSegmentGroup(paths,children)}if(0===i&&isMatrixParams(commands[0])){paths.push(new UrlSegment(segmentGroup.segments[startIndex].path,commands[0])),i++;continue}const curr=getPath(commands[i]),next=i<commands.length-1?commands[i+1]:null;curr&&next&&isMatrixParams(next)?(paths.push(new UrlSegment(curr,router_stringify(next))),i+=2):(paths.push(new UrlSegment(curr,{})),i++)}return new UrlSegmentGroup(paths,{})}function createNewSegmentChildren(outlets){const children={};return forEach(outlets,(commands,outlet)=>{null!==commands&&(children[outlet]=createNewSegmentGroup(new UrlSegmentGroup([],{}),0,commands))}),children}function router_stringify(params){const res={};return forEach(params,(v,k)=>res[k]=""+v),res}function compare(path,params,segment){return path==segment.path&&shallowEqual(params,segment.parameters)}class ActivateRoutes{constructor(routeReuseStrategy,futureState,currState,forwardEvent){this.routeReuseStrategy=routeReuseStrategy,this.futureState=futureState,this.currState=currState,this.forwardEvent=forwardEvent}activate(parentContexts){const futureRoot=this.futureState._root,currRoot=this.currState?this.currState._root:null;this.deactivateChildRoutes(futureRoot,currRoot,parentContexts),advanceActivatedRoute(this.futureState.root),this.activateChildRoutes(futureRoot,currRoot,parentContexts)}deactivateChildRoutes(futureNode,currNode,contexts){const children=nodeChildrenAsMap(currNode);futureNode.children.forEach(futureChild=>{const childOutletName=futureChild.value.outlet;this.deactivateRoutes(futureChild,children[childOutletName],contexts),delete children[childOutletName]}),forEach(children,(v,childName)=>{this.deactivateRouteAndItsChildren(v,contexts)})}deactivateRoutes(futureNode,currNode,parentContext){const future=futureNode.value,curr=currNode?currNode.value:null;if(future===curr)if(future.component){const context=parentContext.getContext(future.outlet);context&&this.deactivateChildRoutes(futureNode,currNode,context.children)}else this.deactivateChildRoutes(futureNode,currNode,parentContext);else curr&&this.deactivateRouteAndItsChildren(currNode,parentContext)}deactivateRouteAndItsChildren(route,parentContexts){this.routeReuseStrategy.shouldDetach(route.value.snapshot)?this.detachAndStoreRouteSubtree(route,parentContexts):this.deactivateRouteAndOutlet(route,parentContexts)}detachAndStoreRouteSubtree(route,parentContexts){const context=parentContexts.getContext(route.value.outlet);if(context&&context.outlet){const componentRef=context.outlet.detach(),contexts=context.children.onOutletDeactivated();this.routeReuseStrategy.store(route.value.snapshot,{componentRef:componentRef,route:route,contexts:contexts})}}deactivateRouteAndOutlet(route,parentContexts){const context=parentContexts.getContext(route.value.outlet);if(context){const children=nodeChildrenAsMap(route),contexts=route.value.component?context.children:parentContexts;forEach(children,(v,k)=>this.deactivateRouteAndItsChildren(v,contexts)),context.outlet&&(context.outlet.deactivate(),context.children.onOutletDeactivated())}}activateChildRoutes(futureNode,currNode,contexts){const children=nodeChildrenAsMap(currNode);futureNode.children.forEach(c=>{this.activateRoutes(c,children[c.value.outlet],contexts),this.forwardEvent(new ActivationEnd(c.value.snapshot))}),futureNode.children.length&&this.forwardEvent(new ChildActivationEnd(futureNode.value.snapshot))}activateRoutes(futureNode,currNode,parentContexts){const future=futureNode.value,curr=currNode?currNode.value:null;if(advanceActivatedRoute(future),future===curr)if(future.component){const context=parentContexts.getOrCreateContext(future.outlet);this.activateChildRoutes(futureNode,currNode,context.children)}else this.activateChildRoutes(futureNode,currNode,parentContexts);else if(future.component){const context=parentContexts.getOrCreateContext(future.outlet);if(this.routeReuseStrategy.shouldAttach(future.snapshot)){const stored=this.routeReuseStrategy.retrieve(future.snapshot);this.routeReuseStrategy.store(future.snapshot,null),context.children.onOutletReAttached(stored.contexts),context.attachRef=stored.componentRef,context.route=stored.route.value,context.outlet&&context.outlet.attach(stored.componentRef,stored.route.value),advanceActivatedRouteNodeAndItsChildren(stored.route)}else{const config=function(snapshot){for(let s=snapshot.parent;s;s=s.parent){const route=s.routeConfig;if(route&&route._loadedConfig)return route._loadedConfig;if(route&&route.component)return null}return null}(future.snapshot),cmpFactoryResolver=config?config.module.componentFactoryResolver:null;context.attachRef=null,context.route=future,context.resolver=cmpFactoryResolver,context.outlet&&context.outlet.activateWith(future,cmpFactoryResolver),this.activateChildRoutes(futureNode,null,context.children)}}else this.activateChildRoutes(futureNode,null,parentContexts)}}function advanceActivatedRouteNodeAndItsChildren(node){advanceActivatedRoute(node.value),node.children.forEach(advanceActivatedRouteNodeAndItsChildren)}function router_isFunction(v){return"function"==typeof v}function isUrlTree(v){return v instanceof UrlTree}class NoMatch{constructor(segmentGroup){this.segmentGroup=segmentGroup||null}}class AbsoluteRedirect{constructor(urlTree){this.urlTree=urlTree}}function noMatch(segmentGroup){return new Observable_Observable(obs=>obs.error(new NoMatch(segmentGroup)))}function absoluteRedirect(newTree){return new Observable_Observable(obs=>obs.error(new AbsoluteRedirect(newTree)))}function namedOutletsRedirect(redirectTo){return new Observable_Observable(obs=>obs.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${redirectTo}'`)))}class router_ApplyRedirects{constructor(moduleInjector,configLoader,urlSerializer,urlTree,config){this.configLoader=configLoader,this.urlSerializer=urlSerializer,this.urlTree=urlTree,this.config=config,this.allowRedirects=!0,this.ngModule=moduleInjector.get(NgModuleRef)}apply(){return this.expandSegmentGroup(this.ngModule,this.config,this.urlTree.root,"primary").pipe(map(rootSegmentGroup=>this.createUrlTree(rootSegmentGroup,this.urlTree.queryParams,this.urlTree.fragment))).pipe(catchError(e=>{if(e instanceof AbsoluteRedirect)return this.allowRedirects=!1,this.match(e.urlTree);if(e instanceof NoMatch)throw this.noMatchError(e);throw e}))}match(tree){return this.expandSegmentGroup(this.ngModule,this.config,tree.root,"primary").pipe(map(rootSegmentGroup=>this.createUrlTree(rootSegmentGroup,tree.queryParams,tree.fragment))).pipe(catchError(e=>{if(e instanceof NoMatch)throw this.noMatchError(e);throw e}))}noMatchError(e){return new Error(`Cannot match any routes. URL Segment: '${e.segmentGroup}'`)}createUrlTree(rootCandidate,queryParams,fragment){const root=rootCandidate.segments.length>0?new UrlSegmentGroup([],{primary:rootCandidate}):rootCandidate;return new UrlTree(root,queryParams,fragment)}expandSegmentGroup(ngModule,routes,segmentGroup,outlet){return 0===segmentGroup.segments.length&&segmentGroup.hasChildren()?this.expandChildren(ngModule,routes,segmentGroup).pipe(map(children=>new UrlSegmentGroup([],children))):this.expandSegment(ngModule,segmentGroup,routes,segmentGroup.segments,outlet,!0)}expandChildren(ngModule,routes,segmentGroup){return function(obj,fn){if(0===Object.keys(obj).length)return of({});const waitHead=[],waitTail=[],res={};return forEach(obj,(a,k)=>{const mapped=fn(k,a).pipe(map(r=>res[k]=r));"primary"===k?waitHead.push(mapped):waitTail.push(mapped)}),of.apply(null,waitHead.concat(waitTail)).pipe(concatAll(),last_last(),map(()=>res))}(segmentGroup.children,(childOutlet,child)=>this.expandSegmentGroup(ngModule,routes,child,childOutlet))}expandSegment(ngModule,segmentGroup,routes,segments,outlet,allowRedirects){return of(...routes).pipe(map(r=>this.expandSegmentAgainstRoute(ngModule,segmentGroup,routes,r,segments,outlet,allowRedirects).pipe(catchError(e=>{if(e instanceof NoMatch)return of(null);throw e}))),concatAll(),first_first(s=>!!s),catchError((e,_)=>{if(e instanceof EmptyError||"EmptyError"===e.name){if(this.noLeftoversInUrl(segmentGroup,segments,outlet))return of(new UrlSegmentGroup([],{}));throw new NoMatch(segmentGroup)}throw e}))}noLeftoversInUrl(segmentGroup,segments,outlet){return 0===segments.length&&!segmentGroup.children[outlet]}expandSegmentAgainstRoute(ngModule,segmentGroup,routes,route,paths,outlet,allowRedirects){return getOutlet(route)!==outlet?noMatch(segmentGroup):void 0===route.redirectTo?this.matchSegmentAgainstRoute(ngModule,segmentGroup,route,paths):allowRedirects&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(ngModule,segmentGroup,routes,route,paths,outlet):noMatch(segmentGroup)}expandSegmentAgainstRouteUsingRedirect(ngModule,segmentGroup,routes,route,segments,outlet){return"**"===route.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(ngModule,routes,route,outlet):this.expandRegularSegmentAgainstRouteUsingRedirect(ngModule,segmentGroup,routes,route,segments,outlet)}expandWildCardWithParamsAgainstRouteUsingRedirect(ngModule,routes,route,outlet){const newTree=this.applyRedirectCommands([],route.redirectTo,{});return route.redirectTo.startsWith("/")?absoluteRedirect(newTree):this.lineralizeSegments(route,newTree).pipe(mergeMap(newSegments=>{const group=new UrlSegmentGroup(newSegments,{});return this.expandSegment(ngModule,group,routes,newSegments,outlet,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(ngModule,segmentGroup,routes,route,segments,outlet){const{matched:matched,consumedSegments:consumedSegments,lastChild:lastChild,positionalParamSegments:positionalParamSegments}=match(segmentGroup,route,segments);if(!matched)return noMatch(segmentGroup);const newTree=this.applyRedirectCommands(consumedSegments,route.redirectTo,positionalParamSegments);return route.redirectTo.startsWith("/")?absoluteRedirect(newTree):this.lineralizeSegments(route,newTree).pipe(mergeMap(newSegments=>this.expandSegment(ngModule,segmentGroup,routes,newSegments.concat(segments.slice(lastChild)),outlet,!1)))}matchSegmentAgainstRoute(ngModule,rawSegmentGroup,route,segments){if("**"===route.path)return route.loadChildren?this.configLoader.load(ngModule.injector,route).pipe(map(cfg=>(route._loadedConfig=cfg,new UrlSegmentGroup(segments,{})))):of(new UrlSegmentGroup(segments,{}));const{matched:matched,consumedSegments:consumedSegments,lastChild:lastChild}=match(rawSegmentGroup,route,segments);if(!matched)return noMatch(rawSegmentGroup);const rawSlicedSegments=segments.slice(lastChild);return this.getChildConfig(ngModule,route,segments).pipe(mergeMap(routerConfig=>{const childModule=routerConfig.module,childConfig=routerConfig.routes,{segmentGroup:segmentGroup,slicedSegments:slicedSegments}=function(segmentGroup,consumedSegments,slicedSegments,config){return slicedSegments.length>0&&function(segmentGroup,segments,routes){return routes.some(r=>isEmptyPathRedirect(segmentGroup,segments,r)&&"primary"!==getOutlet(r))}(segmentGroup,slicedSegments,config)?{segmentGroup:mergeTrivialChildren(new UrlSegmentGroup(consumedSegments,function(routes,primarySegmentGroup){const res={};res.primary=primarySegmentGroup;for(const r of routes)""===r.path&&"primary"!==getOutlet(r)&&(res[getOutlet(r)]=new UrlSegmentGroup([],{}));return res}(config,new UrlSegmentGroup(slicedSegments,segmentGroup.children)))),slicedSegments:[]}:0===slicedSegments.length&&function(segmentGroup,segments,routes){return routes.some(r=>isEmptyPathRedirect(segmentGroup,segments,r))}(segmentGroup,slicedSegments,config)?{segmentGroup:mergeTrivialChildren(new UrlSegmentGroup(segmentGroup.segments,function(segmentGroup,slicedSegments,routes,children){const res={};for(const r of routes)isEmptyPathRedirect(segmentGroup,slicedSegments,r)&&!children[getOutlet(r)]&&(res[getOutlet(r)]=new UrlSegmentGroup([],{}));return Object.assign({},children,res)}(segmentGroup,slicedSegments,config,segmentGroup.children))),slicedSegments:slicedSegments}:{segmentGroup:segmentGroup,slicedSegments:slicedSegments}}(rawSegmentGroup,consumedSegments,rawSlicedSegments,childConfig);return 0===slicedSegments.length&&segmentGroup.hasChildren()?this.expandChildren(childModule,childConfig,segmentGroup).pipe(map(children=>new UrlSegmentGroup(consumedSegments,children))):0===childConfig.length&&0===slicedSegments.length?of(new UrlSegmentGroup(consumedSegments,{})):this.expandSegment(childModule,segmentGroup,childConfig,slicedSegments,"primary",!0).pipe(map(cs=>new UrlSegmentGroup(consumedSegments.concat(cs.segments),cs.children)))}))}getChildConfig(ngModule,route,segments){return route.children?of(new LoadedRouterConfig(route.children,ngModule)):route.loadChildren?void 0!==route._loadedConfig?of(route._loadedConfig):function(moduleInjector,route,segments){const canLoad=route.canLoad;return canLoad&&0!==canLoad.length?from(canLoad).pipe(map(injectionToken=>{const guard=moduleInjector.get(injectionToken);let guardVal;if(function(guard){return guard&&router_isFunction(guard.canLoad)}(guard))guardVal=guard.canLoad(route,segments);else{if(!router_isFunction(guard))throw new Error("Invalid CanLoad guard");guardVal=guard(route,segments)}return wrapIntoObservable(guardVal)})).pipe(concatAll(),(predicate=result=>!0===result,source=>source.lift(new EveryOperator(predicate,void 0,source)))):of(!0);var predicate}(ngModule.injector,route,segments).pipe(mergeMap(shouldLoad=>shouldLoad?this.configLoader.load(ngModule.injector,route).pipe(map(cfg=>(route._loadedConfig=cfg,cfg))):function(route){return new Observable_Observable(obs=>obs.error(navigationCancelingError(`Cannot load children because the guard of the route "path: '${route.path}'" returned false`)))}(route))):of(new LoadedRouterConfig([],ngModule))}lineralizeSegments(route,urlTree){let res=[],c=urlTree.root;for(;;){if(res=res.concat(c.segments),0===c.numberOfChildren)return of(res);if(c.numberOfChildren>1||!c.children.primary)return namedOutletsRedirect(route.redirectTo);c=c.children.primary}}applyRedirectCommands(segments,redirectTo,posParams){return this.applyRedirectCreatreUrlTree(redirectTo,this.urlSerializer.parse(redirectTo),segments,posParams)}applyRedirectCreatreUrlTree(redirectTo,urlTree,segments,posParams){const newRoot=this.createSegmentGroup(redirectTo,urlTree.root,segments,posParams);return new UrlTree(newRoot,this.createQueryParams(urlTree.queryParams,this.urlTree.queryParams),urlTree.fragment)}createQueryParams(redirectToParams,actualParams){const res={};return forEach(redirectToParams,(v,k)=>{if("string"==typeof v&&v.startsWith(":")){const sourceName=v.substring(1);res[k]=actualParams[sourceName]}else res[k]=v}),res}createSegmentGroup(redirectTo,group,segments,posParams){const updatedSegments=this.createSegments(redirectTo,group.segments,segments,posParams);let children={};return forEach(group.children,(child,name)=>{children[name]=this.createSegmentGroup(redirectTo,child,segments,posParams)}),new UrlSegmentGroup(updatedSegments,children)}createSegments(redirectTo,redirectToSegments,actualSegments,posParams){return redirectToSegments.map(s=>s.path.startsWith(":")?this.findPosParam(redirectTo,s,posParams):this.findOrReturn(s,actualSegments))}findPosParam(redirectTo,redirectToUrlSegment,posParams){const pos=posParams[redirectToUrlSegment.path.substring(1)];if(!pos)throw new Error(`Cannot redirect to '${redirectTo}'. Cannot find '${redirectToUrlSegment.path}'.`);return pos}findOrReturn(redirectToUrlSegment,actualSegments){let idx=0;for(const s of actualSegments){if(s.path===redirectToUrlSegment.path)return actualSegments.splice(idx),s;idx++}return redirectToUrlSegment}}function match(segmentGroup,route,segments){if(""===route.path)return"full"===route.pathMatch&&(segmentGroup.hasChildren()||segments.length>0)?{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}:{matched:!0,consumedSegments:[],lastChild:0,positionalParamSegments:{}};const res=(route.matcher||defaultUrlMatcher)(segments,segmentGroup,route);return res?{matched:!0,consumedSegments:res.consumed,lastChild:res.consumed.length,positionalParamSegments:res.posParams}:{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}}function mergeTrivialChildren(s){if(1===s.numberOfChildren&&s.children.primary){const c=s.children.primary;return new UrlSegmentGroup(s.segments.concat(c.segments),c.children)}return s}function isEmptyPathRedirect(segmentGroup,segments,r){return(!(segmentGroup.hasChildren()||segments.length>0)||"full"!==r.pathMatch)&&""===r.path&&void 0!==r.redirectTo}function getOutlet(route){return route.outlet||"primary"}class CanActivate{constructor(path){this.path=path,this.route=this.path[this.path.length-1]}}class CanDeactivate{constructor(component,route){this.component=component,this.route=route}}function getAllRouteGuards(future,curr,parentContexts){const futureRoot=future._root;return function getChildRouteGuards(futureNode,currNode,contexts,futurePath,checks={canDeactivateChecks:[],canActivateChecks:[]}){const prevChildren=nodeChildrenAsMap(currNode);return futureNode.children.forEach(c=>{!function(futureNode,currNode,parentContexts,futurePath,checks={canDeactivateChecks:[],canActivateChecks:[]}){const future=futureNode.value,curr=currNode?currNode.value:null,context=parentContexts?parentContexts.getContext(futureNode.value.outlet):null;if(curr&&future.routeConfig===curr.routeConfig){const shouldRun=function(curr,future,mode){if("function"==typeof mode)return mode(curr,future);switch(mode){case"pathParamsChange":return!equalPath(curr.url,future.url);case"pathParamsOrQueryParamsChange":return!equalPath(curr.url,future.url)||!shallowEqual(curr.queryParams,future.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!equalParamsAndUrlSegments(curr,future)||!shallowEqual(curr.queryParams,future.queryParams);case"paramsChange":default:return!equalParamsAndUrlSegments(curr,future)}}(curr,future,future.routeConfig.runGuardsAndResolvers);shouldRun?checks.canActivateChecks.push(new CanActivate(futurePath)):(future.data=curr.data,future._resolvedData=curr._resolvedData),getChildRouteGuards(futureNode,currNode,future.component?context?context.children:null:parentContexts,futurePath,checks),shouldRun&&checks.canDeactivateChecks.push(new CanDeactivate(context&&context.outlet&&context.outlet.component||null,curr))}else curr&&deactivateRouteAndItsChildren(currNode,context,checks),checks.canActivateChecks.push(new CanActivate(futurePath)),getChildRouteGuards(futureNode,null,future.component?context?context.children:null:parentContexts,futurePath,checks)}(c,prevChildren[c.value.outlet],contexts,futurePath.concat([c.value]),checks),delete prevChildren[c.value.outlet]}),forEach(prevChildren,(v,k)=>deactivateRouteAndItsChildren(v,contexts.getContext(k),checks)),checks}(futureRoot,curr?curr._root:null,parentContexts,[futureRoot.value])}function getToken(token,snapshot,moduleInjector){const config=function(snapshot){if(!snapshot)return null;for(let s=snapshot.parent;s;s=s.parent){const route=s.routeConfig;if(route&&route._loadedConfig)return route._loadedConfig}return null}(snapshot);return(config?config.module.injector:moduleInjector).get(token)}function deactivateRouteAndItsChildren(route,context,checks){const children=nodeChildrenAsMap(route),r=route.value;forEach(children,(node,childName)=>{deactivateRouteAndItsChildren(node,r.component?context?context.children.getContext(childName):null:context,checks)}),checks.canDeactivateChecks.push(new CanDeactivate(r.component&&context&&context.outlet&&context.outlet.isActivated?context.outlet.component:null,r))}const INITIAL_VALUE=Symbol("INITIAL_VALUE");function prioritizedGuardValue(){return switchMap(obs=>function(...observables){let resultSelector=void 0,scheduler=void 0;return isScheduler(observables[observables.length-1])&&(scheduler=observables.pop()),"function"==typeof observables[observables.length-1]&&(resultSelector=observables.pop()),1===observables.length&&isArray(observables[0])&&(observables=observables[0]),fromArray(observables,scheduler).lift(new CombineLatestOperator(resultSelector))}(...obs.map(o=>o.pipe(take(1),function(...array){const scheduler=array[array.length-1];return isScheduler(scheduler)?(array.pop(),source=>concat(array,source,scheduler)):source=>concat(array,source)}(INITIAL_VALUE)))).pipe(scan((acc,list)=>{let isPending=!1;return list.reduce((innerAcc,val,i)=>{if(innerAcc!==INITIAL_VALUE)return innerAcc;if(val===INITIAL_VALUE&&(isPending=!0),!isPending){if(!1===val)return val;if(i===list.length-1||isUrlTree(val))return val}return innerAcc},acc)},INITIAL_VALUE),filter(item=>item!==INITIAL_VALUE),map(item=>isUrlTree(item)?item:!0===item),take(1)))}function fireActivationStart(snapshot,forwardEvent){return null!==snapshot&&forwardEvent&&forwardEvent(new ActivationStart(snapshot)),of(!0)}function fireChildActivationStart(snapshot,forwardEvent){return null!==snapshot&&forwardEvent&&forwardEvent(new ChildActivationStart(snapshot)),of(!0)}function runCanActivate(futureRSS,futureARS,moduleInjector){const canActivate=futureARS.routeConfig?futureARS.routeConfig.canActivate:null;return canActivate&&0!==canActivate.length?of(canActivate.map(c=>defer(()=>{const guard=getToken(c,futureARS,moduleInjector);let observable;if(function(guard){return guard&&router_isFunction(guard.canActivate)}(guard))observable=wrapIntoObservable(guard.canActivate(futureARS,futureRSS));else{if(!router_isFunction(guard))throw new Error("Invalid CanActivate guard");observable=wrapIntoObservable(guard(futureARS,futureRSS))}return observable.pipe(first_first())}))).pipe(prioritizedGuardValue()):of(!0)}function runCanActivateChild(futureRSS,path,moduleInjector){const futureARS=path[path.length-1],canActivateChildGuardsMapped=path.slice(0,path.length-1).reverse().map(p=>function(p){const canActivateChild=p.routeConfig?p.routeConfig.canActivateChild:null;return canActivateChild&&0!==canActivateChild.length?{node:p,guards:canActivateChild}:null}(p)).filter(_=>null!==_).map(d=>defer(()=>of(d.guards.map(c=>{const guard=getToken(c,d.node,moduleInjector);let observable;if(function(guard){return guard&&router_isFunction(guard.canActivateChild)}(guard))observable=wrapIntoObservable(guard.canActivateChild(futureARS,futureRSS));else{if(!router_isFunction(guard))throw new Error("Invalid CanActivateChild guard");observable=wrapIntoObservable(guard(futureARS,futureRSS))}return observable.pipe(first_first())})).pipe(prioritizedGuardValue())));return of(canActivateChildGuardsMapped).pipe(prioritizedGuardValue())}class NoMatch$1{}class router_Recognizer{constructor(rootComponentType,config,urlTree,url,paramsInheritanceStrategy,relativeLinkResolution){this.rootComponentType=rootComponentType,this.config=config,this.urlTree=urlTree,this.url=url,this.paramsInheritanceStrategy=paramsInheritanceStrategy,this.relativeLinkResolution=relativeLinkResolution}recognize(){try{const rootSegmentGroup=split$1(this.urlTree.root,[],[],this.config,this.relativeLinkResolution).segmentGroup,children=this.processSegmentGroup(this.config,rootSegmentGroup,"primary"),root=new ActivatedRouteSnapshot([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},"primary",this.rootComponentType,null,this.urlTree.root,-1,{}),rootNode=new TreeNode(root,children),routeState=new RouterStateSnapshot(this.url,rootNode);return this.inheritParamsAndData(routeState._root),of(routeState)}catch(e){return new Observable_Observable(obs=>obs.error(e))}}inheritParamsAndData(routeNode){const route=routeNode.value,i=inheritedParamsDataResolve(route,this.paramsInheritanceStrategy);route.params=Object.freeze(i.params),route.data=Object.freeze(i.data),routeNode.children.forEach(n=>this.inheritParamsAndData(n))}processSegmentGroup(config,segmentGroup,outlet){return 0===segmentGroup.segments.length&&segmentGroup.hasChildren()?this.processChildren(config,segmentGroup):this.processSegment(config,segmentGroup,segmentGroup.segments,outlet)}processChildren(config,segmentGroup){const children=mapChildrenIntoArray(segmentGroup,(child,childOutlet)=>this.processSegmentGroup(config,child,childOutlet));return function(nodes){const names={};nodes.forEach(n=>{const routeWithSameOutletName=names[n.value.outlet];if(routeWithSameOutletName){const p=routeWithSameOutletName.url.map(s=>s.toString()).join("/"),c=n.value.url.map(s=>s.toString()).join("/");throw new Error(`Two segments cannot have the same outlet name: '${p}' and '${c}'.`)}names[n.value.outlet]=n.value})}(children),children.sort((a,b)=>"primary"===a.value.outlet?-1:"primary"===b.value.outlet?1:a.value.outlet.localeCompare(b.value.outlet)),children}processSegment(config,segmentGroup,segments,outlet){for(const r of config)try{return this.processSegmentAgainstRoute(r,segmentGroup,segments,outlet)}catch(e){if(!(e instanceof NoMatch$1))throw e}if(this.noLeftoversInUrl(segmentGroup,segments,outlet))return[];throw new NoMatch$1}noLeftoversInUrl(segmentGroup,segments,outlet){return 0===segments.length&&!segmentGroup.children[outlet]}processSegmentAgainstRoute(route,rawSegment,segments,outlet){if(route.redirectTo)throw new NoMatch$1;if((route.outlet||"primary")!==outlet)throw new NoMatch$1;let snapshot,consumedSegments=[],rawSlicedSegments=[];if("**"===route.path){const params=segments.length>0?router_last(segments).parameters:{};snapshot=new ActivatedRouteSnapshot(segments,params,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,getData(route),outlet,route.component,route,getSourceSegmentGroup(rawSegment),getPathIndexShift(rawSegment)+segments.length,getResolve(route))}else{const result=function(segmentGroup,route,segments){if(""===route.path){if("full"===route.pathMatch&&(segmentGroup.hasChildren()||segments.length>0))throw new NoMatch$1;return{consumedSegments:[],lastChild:0,parameters:{}}}const res=(route.matcher||defaultUrlMatcher)(segments,segmentGroup,route);if(!res)throw new NoMatch$1;const posParams={};forEach(res.posParams,(v,k)=>{posParams[k]=v.path});const parameters=res.consumed.length>0?Object.assign({},posParams,res.consumed[res.consumed.length-1].parameters):posParams;return{consumedSegments:res.consumed,lastChild:res.consumed.length,parameters:parameters}}(rawSegment,route,segments);consumedSegments=result.consumedSegments,rawSlicedSegments=segments.slice(result.lastChild),snapshot=new ActivatedRouteSnapshot(consumedSegments,result.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,getData(route),outlet,route.component,route,getSourceSegmentGroup(rawSegment),getPathIndexShift(rawSegment)+consumedSegments.length,getResolve(route))}const childConfig=function(route){return route.children?route.children:route.loadChildren?route._loadedConfig.routes:[]}(route),{segmentGroup:segmentGroup,slicedSegments:slicedSegments}=split$1(rawSegment,consumedSegments,rawSlicedSegments,childConfig,this.relativeLinkResolution);if(0===slicedSegments.length&&segmentGroup.hasChildren()){const children=this.processChildren(childConfig,segmentGroup);return[new TreeNode(snapshot,children)]}if(0===childConfig.length&&0===slicedSegments.length)return[new TreeNode(snapshot,[])];const children=this.processSegment(childConfig,segmentGroup,slicedSegments,"primary");return[new TreeNode(snapshot,children)]}}function getSourceSegmentGroup(segmentGroup){let s=segmentGroup;for(;s._sourceSegment;)s=s._sourceSegment;return s}function getPathIndexShift(segmentGroup){let s=segmentGroup,res=s._segmentIndexShift?s._segmentIndexShift:0;for(;s._sourceSegment;)s=s._sourceSegment,res+=s._segmentIndexShift?s._segmentIndexShift:0;return res-1}function split$1(segmentGroup,consumedSegments,slicedSegments,config,relativeLinkResolution){if(slicedSegments.length>0&&function(segmentGroup,slicedSegments,routes){return routes.some(r=>emptyPathMatch(segmentGroup,slicedSegments,r)&&"primary"!==getOutlet$1(r))}(segmentGroup,slicedSegments,config)){const s=new UrlSegmentGroup(consumedSegments,function(segmentGroup,consumedSegments,routes,primarySegment){const res={};res.primary=primarySegment,primarySegment._sourceSegment=segmentGroup,primarySegment._segmentIndexShift=consumedSegments.length;for(const r of routes)if(""===r.path&&"primary"!==getOutlet$1(r)){const s=new UrlSegmentGroup([],{});s._sourceSegment=segmentGroup,s._segmentIndexShift=consumedSegments.length,res[getOutlet$1(r)]=s}return res}(segmentGroup,consumedSegments,config,new UrlSegmentGroup(slicedSegments,segmentGroup.children)));return s._sourceSegment=segmentGroup,s._segmentIndexShift=consumedSegments.length,{segmentGroup:s,slicedSegments:[]}}if(0===slicedSegments.length&&function(segmentGroup,slicedSegments,routes){return routes.some(r=>emptyPathMatch(segmentGroup,slicedSegments,r))}(segmentGroup,slicedSegments,config)){const s=new UrlSegmentGroup(segmentGroup.segments,function(segmentGroup,consumedSegments,slicedSegments,routes,children,relativeLinkResolution){const res={};for(const r of routes)if(emptyPathMatch(segmentGroup,slicedSegments,r)&&!children[getOutlet$1(r)]){const s=new UrlSegmentGroup([],{});s._sourceSegment=segmentGroup,s._segmentIndexShift="legacy"===relativeLinkResolution?segmentGroup.segments.length:consumedSegments.length,res[getOutlet$1(r)]=s}return Object.assign({},children,res)}(segmentGroup,consumedSegments,slicedSegments,config,segmentGroup.children,relativeLinkResolution));return s._sourceSegment=segmentGroup,s._segmentIndexShift=consumedSegments.length,{segmentGroup:s,slicedSegments:slicedSegments}}const s=new UrlSegmentGroup(segmentGroup.segments,segmentGroup.children);return s._sourceSegment=segmentGroup,s._segmentIndexShift=consumedSegments.length,{segmentGroup:s,slicedSegments:slicedSegments}}function emptyPathMatch(segmentGroup,slicedSegments,r){return(!(segmentGroup.hasChildren()||slicedSegments.length>0)||"full"!==r.pathMatch)&&""===r.path&&void 0===r.redirectTo}function getOutlet$1(route){return route.outlet||"primary"}function getData(route){return route.data||{}}function getResolve(route){return route.resolve||{}}function getResolver(injectionToken,futureARS,futureRSS,moduleInjector){const resolver=getToken(injectionToken,futureARS,moduleInjector);return wrapIntoObservable(resolver.resolve?resolver.resolve(futureARS,futureRSS):resolver(futureARS,futureRSS))}function switchTap(next){return function(source){return source.pipe(switchMap(v=>{const nextResult=next(v);return nextResult?from(nextResult).pipe(map(()=>v)):from([v])}))}}class RouteReuseStrategy{}class DefaultRouteReuseStrategy{shouldDetach(route){return!1}store(route,detachedTree){}shouldAttach(route){return!1}retrieve(route){return null}shouldReuseRoute(future,curr){return future.routeConfig===curr.routeConfig}}const ROUTES=new InjectionToken("ROUTES");class router_RouterConfigLoader{constructor(loader,compiler,onLoadStartListener,onLoadEndListener){this.loader=loader,this.compiler=compiler,this.onLoadStartListener=onLoadStartListener,this.onLoadEndListener=onLoadEndListener}load(parentInjector,route){return this.onLoadStartListener&&this.onLoadStartListener(route),this.loadModuleFactory(route.loadChildren).pipe(map(factory=>{this.onLoadEndListener&&this.onLoadEndListener(route);const module=factory.create(parentInjector);return new LoadedRouterConfig(router_flatten(module.injector.get(ROUTES)).map(standardizeConfig),module)}))}loadModuleFactory(loadChildren){return"string"==typeof loadChildren?from(this.loader.load(loadChildren)):wrapIntoObservable(loadChildren()).pipe(mergeMap(t=>t instanceof NgModuleFactory?of(t):from(this.compiler.compileModuleAsync(t))))}}class UrlHandlingStrategy{}class DefaultUrlHandlingStrategy{shouldProcessUrl(url){return!0}extract(url){return url}merge(newUrlPart,wholeUrl){return newUrlPart}}function defaultErrorHandler(error){throw error}function defaultMalformedUriErrorHandler(error,urlSerializer,url){return urlSerializer.parse("/")}function defaultRouterHook(snapshot,runExtras){return of(null)}class router_Router{constructor(rootComponentType,urlSerializer,rootContexts,location,injector,loader,compiler,config){this.rootComponentType=rootComponentType,this.urlSerializer=urlSerializer,this.rootContexts=rootContexts,this.location=location,this.config=config,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.navigationId=0,this.isNgZoneEnabled=!1,this.events=new Subject_Subject,this.errorHandler=defaultErrorHandler,this.malformedUriErrorHandler=defaultMalformedUriErrorHandler,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:defaultRouterHook,afterPreactivation:defaultRouterHook},this.urlHandlingStrategy=new DefaultUrlHandlingStrategy,this.routeReuseStrategy=new DefaultRouteReuseStrategy,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="legacy",this.ngModule=injector.get(NgModuleRef),this.console=injector.get(Console);const ngZone=injector.get(NgZone);this.isNgZoneEnabled=ngZone instanceof NgZone,this.resetConfig(config),this.currentUrlTree=new UrlTree(new UrlSegmentGroup([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new router_RouterConfigLoader(loader,compiler,r=>this.triggerEvent(new RouteConfigLoadStart(r)),r=>this.triggerEvent(new RouteConfigLoadEnd(r))),this.routerState=createEmptyState(this.currentUrlTree,this.rootComponentType),this.transitions=new BehaviorSubject_BehaviorSubject({id:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}setupNavigations(transitions){const eventsSubject=this.events;return transitions.pipe(filter(t=>0!==t.id),map(t=>Object.assign({},t,{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl)})),switchMap(t=>{let completed=!1,errored=!1;return of(t).pipe(tap(t=>{this.currentNavigation={id:t.id,initialUrl:t.currentRawUrl,extractedUrl:t.extractedUrl,trigger:t.source,extras:t.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign({},this.lastSuccessfulNavigation,{previousNavigation:null}):null}}),switchMap(t=>{const urlTransition=!this.navigated||t.extractedUrl.toString()!==this.browserUrlTree.toString();if(("reload"===this.onSameUrlNavigation||urlTransition)&&this.urlHandlingStrategy.shouldProcessUrl(t.rawUrl))return of(t).pipe(switchMap(t=>{const transition=this.transitions.getValue();return eventsSubject.next(new NavigationStart(t.id,this.serializeUrl(t.extractedUrl),t.source,t.restoredState)),transition!==this.transitions.getValue()?empty_EMPTY:[t]}),switchMap(t=>Promise.resolve(t)),(moduleInjector=this.ngModule.injector,configLoader=this.configLoader,urlSerializer=this.urlSerializer,config=this.config,function(source){return source.pipe(switchMap(t=>function(moduleInjector,configLoader,urlSerializer,urlTree,config){return new router_ApplyRedirects(moduleInjector,configLoader,urlSerializer,urlTree,config).apply()}(moduleInjector,configLoader,urlSerializer,t.extractedUrl,config).pipe(map(urlAfterRedirects=>Object.assign({},t,{urlAfterRedirects:urlAfterRedirects})))))}),tap(t=>{this.currentNavigation=Object.assign({},this.currentNavigation,{finalUrl:t.urlAfterRedirects})}),function(rootComponentType,config,serializer,paramsInheritanceStrategy,relativeLinkResolution){return function(source){return source.pipe(mergeMap(t=>function(rootComponentType,config,urlTree,url,paramsInheritanceStrategy="emptyOnly",relativeLinkResolution="legacy"){return new router_Recognizer(rootComponentType,config,urlTree,url,paramsInheritanceStrategy,relativeLinkResolution).recognize()}(rootComponentType,config,t.urlAfterRedirects,serializer(t.urlAfterRedirects),paramsInheritanceStrategy,relativeLinkResolution).pipe(map(targetSnapshot=>Object.assign({},t,{targetSnapshot:targetSnapshot})))))}}(this.rootComponentType,this.config,url=>this.serializeUrl(url),this.paramsInheritanceStrategy,this.relativeLinkResolution),tap(t=>{"eager"===this.urlUpdateStrategy&&(t.extras.skipLocationChange||this.setBrowserUrl(t.urlAfterRedirects,!!t.extras.replaceUrl,t.id,t.extras.state),this.browserUrlTree=t.urlAfterRedirects)}),tap(t=>{const routesRecognized=new RoutesRecognized(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);eventsSubject.next(routesRecognized)}));var moduleInjector,configLoader,urlSerializer,config;if(urlTransition&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:id,extractedUrl:extractedUrl,source:source,restoredState:restoredState,extras:extras}=t,navStart=new NavigationStart(id,this.serializeUrl(extractedUrl),source,restoredState);eventsSubject.next(navStart);const targetSnapshot=createEmptyState(extractedUrl,this.rootComponentType).snapshot;return of(Object.assign({},t,{targetSnapshot:targetSnapshot,urlAfterRedirects:extractedUrl,extras:Object.assign({},extras,{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=t.rawUrl,this.browserUrlTree=t.urlAfterRedirects,t.resolve(null),empty_EMPTY}),switchTap(t=>{const{targetSnapshot:targetSnapshot,id:navigationId,extractedUrl:appliedUrlTree,rawUrl:rawUrlTree,extras:{skipLocationChange:skipLocationChange,replaceUrl:replaceUrl}}=t;return this.hooks.beforePreactivation(targetSnapshot,{navigationId:navigationId,appliedUrlTree:appliedUrlTree,rawUrlTree:rawUrlTree,skipLocationChange:!!skipLocationChange,replaceUrl:!!replaceUrl})}),tap(t=>{const guardsStart=new GuardsCheckStart(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(guardsStart)}),map(t=>Object.assign({},t,{guards:getAllRouteGuards(t.targetSnapshot,t.currentSnapshot,this.rootContexts)})),function(moduleInjector,forwardEvent){return function(source){return source.pipe(mergeMap(t=>{const{targetSnapshot:targetSnapshot,currentSnapshot:currentSnapshot,guards:{canActivateChecks:canActivateChecks,canDeactivateChecks:canDeactivateChecks}}=t;return 0===canDeactivateChecks.length&&0===canActivateChecks.length?of(Object.assign({},t,{guardsResult:!0})):function(checks,futureRSS,currRSS,moduleInjector){return from(checks).pipe(mergeMap(check=>function(component,currARS,currRSS,futureRSS,moduleInjector){const canDeactivate=currARS&&currARS.routeConfig?currARS.routeConfig.canDeactivate:null;return canDeactivate&&0!==canDeactivate.length?of(canDeactivate.map(c=>{const guard=getToken(c,currARS,moduleInjector);let observable;if(function(guard){return guard&&router_isFunction(guard.canDeactivate)}(guard))observable=wrapIntoObservable(guard.canDeactivate(component,currARS,currRSS,futureRSS));else{if(!router_isFunction(guard))throw new Error("Invalid CanDeactivate guard");observable=wrapIntoObservable(guard(component,currARS,currRSS,futureRSS))}return observable.pipe(first_first())})).pipe(prioritizedGuardValue()):of(!0)}(check.component,check.route,currRSS,futureRSS,moduleInjector)),first_first(result=>!0!==result,!0))}(canDeactivateChecks,targetSnapshot,currentSnapshot,moduleInjector).pipe(mergeMap(canDeactivate=>canDeactivate&&"boolean"==typeof canDeactivate?function(futureSnapshot,checks,moduleInjector,forwardEvent){return from(checks).pipe(concatMap(check=>from([fireChildActivationStart(check.route.parent,forwardEvent),fireActivationStart(check.route,forwardEvent),runCanActivateChild(futureSnapshot,check.path,moduleInjector),runCanActivate(futureSnapshot,check.route,moduleInjector)]).pipe(concatAll(),first_first(result=>!0!==result,!0))),first_first(result=>!0!==result,!0))}(targetSnapshot,canActivateChecks,moduleInjector,forwardEvent):of(canDeactivate)),map(guardsResult=>Object.assign({},t,{guardsResult:guardsResult})))}))}}(this.ngModule.injector,evt=>this.triggerEvent(evt)),tap(t=>{if(isUrlTree(t.guardsResult)){const error=navigationCancelingError(`Redirecting to "${this.serializeUrl(t.guardsResult)}"`);throw error.url=t.guardsResult,error}}),tap(t=>{const guardsEnd=new GuardsCheckEnd(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot,!!t.guardsResult);this.triggerEvent(guardsEnd)}),filter(t=>{if(!t.guardsResult){this.resetUrlToCurrentUrlTree();const navCancel=new NavigationCancel(t.id,this.serializeUrl(t.extractedUrl),"");return eventsSubject.next(navCancel),t.resolve(!1),!1}return!0}),switchTap(t=>{if(t.guards.canActivateChecks.length)return of(t).pipe(tap(t=>{const resolveStart=new ResolveStart(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(resolveStart)}),(paramsInheritanceStrategy=this.paramsInheritanceStrategy,moduleInjector=this.ngModule.injector,function(source){return source.pipe(mergeMap(t=>{const{targetSnapshot:targetSnapshot,guards:{canActivateChecks:canActivateChecks}}=t;return canActivateChecks.length?from(canActivateChecks).pipe(concatMap(check=>function(futureARS,futureRSS,paramsInheritanceStrategy,moduleInjector){return function(resolve,futureARS,futureRSS,moduleInjector){const keys=Object.keys(resolve);if(0===keys.length)return of({});if(1===keys.length){const key=keys[0];return getResolver(resolve[key],futureARS,futureRSS,moduleInjector).pipe(map(value=>({[key]:value})))}const data={};return from(keys).pipe(mergeMap(key=>getResolver(resolve[key],futureARS,futureRSS,moduleInjector).pipe(map(value=>(data[key]=value,value))))).pipe(last_last(),map(()=>data))}(futureARS._resolve,futureARS,futureRSS,moduleInjector).pipe(map(resolvedData=>(futureARS._resolvedData=resolvedData,futureARS.data=Object.assign({},futureARS.data,inheritedParamsDataResolve(futureARS,paramsInheritanceStrategy).resolve),null)))}(check.route,targetSnapshot,paramsInheritanceStrategy,moduleInjector)),function(accumulator,seed){return arguments.length>=2?function(source){return pipe(scan(accumulator,seed),takeLast(1),defaultIfEmpty(seed))(source)}:function(source){return pipe(scan((acc,value,index)=>accumulator(acc,value,index+1)),takeLast(1))(source)}}((_,__)=>_),map(_=>t)):of(t)}))}),tap(t=>{const resolveEnd=new ResolveEnd(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(resolveEnd)}));var paramsInheritanceStrategy,moduleInjector}),switchTap(t=>{const{targetSnapshot:targetSnapshot,id:navigationId,extractedUrl:appliedUrlTree,rawUrl:rawUrlTree,extras:{skipLocationChange:skipLocationChange,replaceUrl:replaceUrl}}=t;return this.hooks.afterPreactivation(targetSnapshot,{navigationId:navigationId,appliedUrlTree:appliedUrlTree,rawUrlTree:rawUrlTree,skipLocationChange:!!skipLocationChange,replaceUrl:!!replaceUrl})}),map(t=>{const targetRouterState=function(routeReuseStrategy,curr,prevState){const root=function createNode(routeReuseStrategy,curr,prevState){if(prevState&&routeReuseStrategy.shouldReuseRoute(curr.value,prevState.value.snapshot)){const value=prevState.value;value._futureSnapshot=curr.value;const children=function(routeReuseStrategy,curr,prevState){return curr.children.map(child=>{for(const p of prevState.children)if(routeReuseStrategy.shouldReuseRoute(p.value.snapshot,child.value))return createNode(routeReuseStrategy,child,p);return createNode(routeReuseStrategy,child)})}(routeReuseStrategy,curr,prevState);return new TreeNode(value,children)}{const detachedRouteHandle=routeReuseStrategy.retrieve(curr.value);if(detachedRouteHandle){const tree=detachedRouteHandle.route;return function setFutureSnapshotsOfActivatedRoutes(curr,result){if(curr.value.routeConfig!==result.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(curr.children.length!==result.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");result.value._futureSnapshot=curr.value;for(let i=0;i<curr.children.length;++i)setFutureSnapshotsOfActivatedRoutes(curr.children[i],result.children[i])}(curr,tree),tree}{const value=new router_ActivatedRoute(new BehaviorSubject_BehaviorSubject((c=curr.value).url),new BehaviorSubject_BehaviorSubject(c.params),new BehaviorSubject_BehaviorSubject(c.queryParams),new BehaviorSubject_BehaviorSubject(c.fragment),new BehaviorSubject_BehaviorSubject(c.data),c.outlet,c.component,c),children=curr.children.map(c=>createNode(routeReuseStrategy,c));return new TreeNode(value,children)}}var c}(routeReuseStrategy,curr._root,prevState?prevState._root:void 0);return new RouterState(root,curr)}(this.routeReuseStrategy,t.targetSnapshot,t.currentRouterState);return Object.assign({},t,{targetRouterState:targetRouterState})}),tap(t=>{this.currentUrlTree=t.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl),this.routerState=t.targetRouterState,"deferred"===this.urlUpdateStrategy&&(t.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,!!t.extras.replaceUrl,t.id,t.extras.state),this.browserUrlTree=t.urlAfterRedirects)}),(rootContexts=this.rootContexts,routeReuseStrategy=this.routeReuseStrategy,forwardEvent=evt=>this.triggerEvent(evt),map(t=>(new ActivateRoutes(routeReuseStrategy,t.targetRouterState,t.currentRouterState,forwardEvent).activate(rootContexts),t))),tap({next(){completed=!0},complete(){completed=!0}}),(callback=()=>{if(!completed&&!errored){this.resetUrlToCurrentUrlTree();const navCancel=new NavigationCancel(t.id,this.serializeUrl(t.extractedUrl),`Navigation ID ${t.id} is not equal to the current navigation id ${this.navigationId}`);eventsSubject.next(navCancel),t.resolve(!1)}this.currentNavigation=null},source=>source.lift(new FinallyOperator(callback))),catchError(e=>{if(errored=!0,(error=e)&&error.ngNavigationCancelingError){const redirecting=isUrlTree(e.url);redirecting||(this.navigated=!0,this.resetStateAndUrl(t.currentRouterState,t.currentUrlTree,t.rawUrl));const navCancel=new NavigationCancel(t.id,this.serializeUrl(t.extractedUrl),e.message);eventsSubject.next(navCancel),t.resolve(!1),redirecting&&this.navigateByUrl(e.url)}else{this.resetStateAndUrl(t.currentRouterState,t.currentUrlTree,t.rawUrl);const navError=new NavigationError(t.id,this.serializeUrl(t.extractedUrl),e);eventsSubject.next(navError);try{t.resolve(this.errorHandler(e))}catch(ee){t.reject(ee)}}var error;return empty_EMPTY}));var callback,rootContexts,routeReuseStrategy,forwardEvent}))}resetRootComponentType(rootComponentType){this.rootComponentType=rootComponentType,this.routerState.root.component=this.rootComponentType}getTransition(){const transition=this.transitions.value;return transition.urlAfterRedirects=this.browserUrlTree,transition}setTransition(t){this.transitions.next(Object.assign({},this.getTransition(),t))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(change=>{let rawUrlTree=this.parseUrl(change.url);const source="popstate"===change.type?"popstate":"hashchange",state=change.state&&change.state.navigationId?change.state:null;setTimeout(()=>{this.scheduleNavigation(rawUrlTree,source,state,{replaceUrl:!0})},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(event){this.events.next(event)}resetConfig(config){validateConfig(config),this.config=config.map(standardizeConfig),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=null)}createUrlTree(commands,navigationExtras={}){const{relativeTo:relativeTo,queryParams:queryParams,fragment:fragment,preserveQueryParams:preserveQueryParams,queryParamsHandling:queryParamsHandling,preserveFragment:preserveFragment}=navigationExtras;isDevMode()&&preserveQueryParams&&console&&console.warn&&console.warn("preserveQueryParams is deprecated, use queryParamsHandling instead.");const a=relativeTo||this.routerState.root,f=preserveFragment?this.currentUrlTree.fragment:fragment;let q=null;if(queryParamsHandling)switch(queryParamsHandling){case"merge":q=Object.assign({},this.currentUrlTree.queryParams,queryParams);break;case"preserve":q=this.currentUrlTree.queryParams;break;default:q=queryParams||null}else q=preserveQueryParams?this.currentUrlTree.queryParams:queryParams||null;return null!==q&&(q=this.removeEmptyProps(q)),function(route,urlTree,commands,queryParams,fragment){if(0===commands.length)return router_tree(urlTree.root,urlTree.root,urlTree,queryParams,fragment);const nav=function(commands){if("string"==typeof commands[0]&&1===commands.length&&"/"===commands[0])return new Navigation(!0,0,commands);let numberOfDoubleDots=0,isAbsolute=!1;const res=commands.reduce((res,cmd,cmdIdx)=>{if("object"==typeof cmd&&null!=cmd){if(cmd.outlets){const outlets={};return forEach(cmd.outlets,(commands,name)=>{outlets[name]="string"==typeof commands?commands.split("/"):commands}),[...res,{outlets:outlets}]}if(cmd.segmentPath)return[...res,cmd.segmentPath]}return"string"!=typeof cmd?[...res,cmd]:0===cmdIdx?(cmd.split("/").forEach((urlPart,partIndex)=>{0==partIndex&&"."===urlPart||(0==partIndex&&""===urlPart?isAbsolute=!0:".."===urlPart?numberOfDoubleDots++:""!=urlPart&&res.push(urlPart))}),res):[...res,cmd]},[]);return new Navigation(isAbsolute,numberOfDoubleDots,res)}(commands);if(nav.toRoot())return router_tree(urlTree.root,new UrlSegmentGroup([],{}),urlTree,queryParams,fragment);const startingPosition=function(nav,tree,route){if(nav.isAbsolute)return new Position(tree.root,!0,0);if(-1===route.snapshot._lastPathIndex)return new Position(route.snapshot._urlSegment,!0,0);const modifier=isMatrixParams(nav.commands[0])?0:1;return function(group,index,numberOfDoubleDots){let g=group,ci=index,dd=numberOfDoubleDots;for(;dd>ci;){if(dd-=ci,g=g.parent,!g)throw new Error("Invalid number of '../'");ci=g.segments.length}return new Position(g,!1,ci-dd)}(route.snapshot._urlSegment,route.snapshot._lastPathIndex+modifier,nav.numberOfDoubleDots)}(nav,urlTree,route),segmentGroup=startingPosition.processChildren?updateSegmentGroupChildren(startingPosition.segmentGroup,startingPosition.index,nav.commands):updateSegmentGroup(startingPosition.segmentGroup,startingPosition.index,nav.commands);return router_tree(startingPosition.segmentGroup,segmentGroup,urlTree,queryParams,fragment)}(a,this.currentUrlTree,commands,q,f)}navigateByUrl(url,extras={skipLocationChange:!1}){isDevMode()&&this.isNgZoneEnabled&&!NgZone.isInAngularZone()&&this.console.warn("Navigation triggered outside Angular zone, did you forget to call 'ngZone.run()'?");const urlTree=isUrlTree(url)?url:this.parseUrl(url),mergedTree=this.urlHandlingStrategy.merge(urlTree,this.rawUrlTree);return this.scheduleNavigation(mergedTree,"imperative",null,extras)}navigate(commands,extras={skipLocationChange:!1}){return function(commands){for(let i=0;i<commands.length;i++){const cmd=commands[i];if(null==cmd)throw new Error(`The requested path contains ${cmd} segment at index ${i}`)}}(commands),this.navigateByUrl(this.createUrlTree(commands,extras),extras)}serializeUrl(url){return this.urlSerializer.serialize(url)}parseUrl(url){let urlTree;try{urlTree=this.urlSerializer.parse(url)}catch(e){urlTree=this.malformedUriErrorHandler(e,this.urlSerializer,url)}return urlTree}isActive(url,exact){if(isUrlTree(url))return containsTree(this.currentUrlTree,url,exact);const urlTree=this.parseUrl(url);return containsTree(this.currentUrlTree,urlTree,exact)}removeEmptyProps(params){return Object.keys(params).reduce((result,key)=>{const value=params[key];return null!=value&&(result[key]=value),result},{})}processNavigations(){this.navigations.subscribe(t=>{this.navigated=!0,this.lastSuccessfulId=t.id,this.events.next(new NavigationEnd(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.currentNavigation=null,t.resolve(!0)},e=>{this.console.warn("Unhandled Navigation Error: ")})}scheduleNavigation(rawUrl,source,restoredState,extras){const lastNavigation=this.getTransition();if(lastNavigation&&"imperative"!==source&&"imperative"===lastNavigation.source&&lastNavigation.rawUrl.toString()===rawUrl.toString())return Promise.resolve(!0);if(lastNavigation&&"hashchange"==source&&"popstate"===lastNavigation.source&&lastNavigation.rawUrl.toString()===rawUrl.toString())return Promise.resolve(!0);if(lastNavigation&&"popstate"==source&&"hashchange"===lastNavigation.source&&lastNavigation.rawUrl.toString()===rawUrl.toString())return Promise.resolve(!0);let resolve=null,reject=null;const promise=new Promise((res,rej)=>{resolve=res,reject=rej}),id=++this.navigationId;return this.setTransition({id:id,source:source,restoredState:restoredState,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:rawUrl,extras:extras,resolve:resolve,reject:reject,promise:promise,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),promise.catch(e=>Promise.reject(e))}setBrowserUrl(url,replaceUrl,id,state){const path=this.urlSerializer.serialize(url);state=state||{},this.location.isCurrentPathEqualTo(path)||replaceUrl?this.location.replaceState(path,"",Object.assign({},state,{navigationId:id})):this.location.go(path,"",Object.assign({},state,{navigationId:id}))}resetStateAndUrl(storedState,storedUrl,rawUrl){this.routerState=storedState,this.currentUrlTree=storedUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,rawUrl),this.resetUrlToCurrentUrlTree()}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",{navigationId:this.lastSuccessfulId})}}class OutletContext{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new ChildrenOutletContexts,this.attachRef=null}}class ChildrenOutletContexts{constructor(){this.contexts=new Map}onChildOutletCreated(childName,outlet){const context=this.getOrCreateContext(childName);context.outlet=outlet,this.contexts.set(childName,context)}onChildOutletDestroyed(childName){const context=this.getContext(childName);context&&(context.outlet=null)}onOutletDeactivated(){const contexts=this.contexts;return this.contexts=new Map,contexts}onOutletReAttached(contexts){this.contexts=contexts}getOrCreateContext(childName){let context=this.getContext(childName);return context||(context=new OutletContext,this.contexts.set(childName,context)),context}getContext(childName){return this.contexts.get(childName)||null}}class router_RouterOutlet{constructor(parentContexts,location,resolver,name,changeDetector){this.parentContexts=parentContexts,this.location=location,this.resolver=resolver,this.changeDetector=changeDetector,this.activated=null,this._activatedRoute=null,this.activateEvents=new core_EventEmitter,this.deactivateEvents=new core_EventEmitter,this.name=name||"primary",parentContexts.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const context=this.parentContexts.getContext(this.name);context&&context.route&&(context.attachRef?this.attach(context.attachRef,context.route):this.activateWith(context.route,context.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const cmp=this.activated;return this.activated=null,this._activatedRoute=null,cmp}attach(ref,activatedRoute){this.activated=ref,this._activatedRoute=activatedRoute,this.location.insert(ref.hostView)}deactivate(){if(this.activated){const c=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(c)}}activateWith(activatedRoute,resolver){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=activatedRoute;const factory=(resolver=resolver||this.resolver).resolveComponentFactory(activatedRoute._futureSnapshot.routeConfig.component),childContexts=this.parentContexts.getOrCreateContext(this.name).children,injector=new OutletInjector(activatedRoute,childContexts,this.location.injector);this.activated=this.location.createComponent(factory,this.location.length,injector),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}class OutletInjector{constructor(route,childContexts,parent){this.route=route,this.childContexts=childContexts,this.parent=parent}get(token,notFoundValue){return token===router_ActivatedRoute?this.route:token===ChildrenOutletContexts?this.childContexts:this.parent.get(token,notFoundValue)}}class PreloadingStrategy{}class router_PreloadAllModules{preload(route,fn){return fn().pipe(catchError(()=>of(null)))}}class router_NoPreloading{preload(route,fn){return of(null)}}class router_RouterPreloader{constructor(router,moduleLoader,compiler,injector,preloadingStrategy){this.router=router,this.injector=injector,this.preloadingStrategy=preloadingStrategy,this.loader=new router_RouterConfigLoader(moduleLoader,compiler,r=>router.triggerEvent(new RouteConfigLoadStart(r)),r=>router.triggerEvent(new RouteConfigLoadEnd(r)))}setUpPreloading(){this.subscription=this.router.events.pipe(filter(e=>e instanceof NavigationEnd),concatMap(()=>this.preload())).subscribe(()=>{})}preload(){const ngModule=this.injector.get(NgModuleRef);return this.processRoutes(ngModule,this.router.config)}ngOnDestroy(){this.subscription.unsubscribe()}processRoutes(ngModule,routes){const res=[];for(const route of routes)if(route.loadChildren&&!route.canLoad&&route._loadedConfig){const childConfig=route._loadedConfig;res.push(this.processRoutes(childConfig.module,childConfig.routes))}else route.loadChildren&&!route.canLoad?res.push(this.preloadConfig(ngModule,route)):route.children&&res.push(this.processRoutes(ngModule,route.children));return from(res).pipe(mergeAll(),map(_=>{}))}preloadConfig(ngModule,route){return this.preloadingStrategy.preload(route,()=>this.loader.load(ngModule.injector,route).pipe(mergeMap(config=>(route._loadedConfig=config,this.processRoutes(config.module,config.routes)))))}}class RouterScroller{constructor(router,viewportScroller,options={}){this.router=router,this.viewportScroller=viewportScroller,this.options=options,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},options.scrollPositionRestoration=options.scrollPositionRestoration||"disabled",options.anchorScrolling=options.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(e=>{e instanceof NavigationStart?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof NavigationEnd&&(this.lastId=e.id,this.scheduleScrollEvent(e,this.router.parseUrl(e.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(e=>{e instanceof Scroll&&(e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(routerEvent,anchor){this.router.triggerEvent(new Scroll(routerEvent,"popstate"===this.lastSource?this.store[this.restoredId]:null,anchor))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}const ROUTER_CONFIGURATION=new InjectionToken("ROUTER_CONFIGURATION"),ROUTER_FORROOT_GUARD=new InjectionToken("ROUTER_FORROOT_GUARD"),ROUTER_PROVIDERS=[common_Location,{provide:UrlSerializer,useClass:DefaultUrlSerializer},{provide:router_Router,useFactory:setupRouter,deps:[core_ApplicationRef,UrlSerializer,ChildrenOutletContexts,common_Location,Injector,NgModuleFactoryLoader,Compiler,ROUTES,ROUTER_CONFIGURATION,[UrlHandlingStrategy,new Optional],[RouteReuseStrategy,new Optional]]},ChildrenOutletContexts,{provide:router_ActivatedRoute,useFactory:rootRoute,deps:[router_Router]},{provide:NgModuleFactoryLoader,useClass:SystemJsNgModuleLoader},router_RouterPreloader,router_NoPreloading,router_PreloadAllModules,{provide:ROUTER_CONFIGURATION,useValue:{enableTracing:!1}}];function routerNgProbeToken(){return new NgProbeToken("Router",router_Router)}class router_RouterModule{constructor(guard,router){}static forRoot(routes,config){return{ngModule:router_RouterModule,providers:[ROUTER_PROVIDERS,provideRoutes(routes),{provide:ROUTER_FORROOT_GUARD,useFactory:provideForRootGuard,deps:[[router_Router,new Optional,new SkipSelf]]},{provide:ROUTER_CONFIGURATION,useValue:config||{}},{provide:LocationStrategy,useFactory:provideLocationStrategy,deps:[PlatformLocation,[new Inject(APP_BASE_HREF),new Optional],ROUTER_CONFIGURATION]},{provide:RouterScroller,useFactory:createRouterScroller,deps:[router_Router,common_ViewportScroller,ROUTER_CONFIGURATION]},{provide:PreloadingStrategy,useExisting:config&&config.preloadingStrategy?config.preloadingStrategy:router_NoPreloading},{provide:NgProbeToken,multi:!0,useFactory:routerNgProbeToken},[router_RouterInitializer,{provide:APP_INITIALIZER,multi:!0,useFactory:getAppInitializer,deps:[router_RouterInitializer]},{provide:ROUTER_INITIALIZER,useFactory:getBootstrapListener,deps:[router_RouterInitializer]},{provide:APP_BOOTSTRAP_LISTENER,multi:!0,useExisting:ROUTER_INITIALIZER}]]}}static forChild(routes){return{ngModule:router_RouterModule,providers:[provideRoutes(routes)]}}}function createRouterScroller(router,viewportScroller,config){return config.scrollOffset&&viewportScroller.setOffset(config.scrollOffset),new RouterScroller(router,viewportScroller,config)}function provideLocationStrategy(platformLocationStrategy,baseHref,options={}){return options.useHash?new HashLocationStrategy(platformLocationStrategy,baseHref):new PathLocationStrategy(platformLocationStrategy,baseHref)}function provideForRootGuard(router){if(router)throw new Error("RouterModule.forRoot() called twice. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function provideRoutes(routes){return[{provide:ANALYZE_FOR_ENTRY_COMPONENTS,multi:!0,useValue:routes},{provide:ROUTES,multi:!0,useValue:routes}]}function setupRouter(ref,urlSerializer,contexts,location,injector,loader,compiler,config,opts={},urlHandlingStrategy,routeReuseStrategy){const router=new router_Router(null,urlSerializer,contexts,location,injector,loader,compiler,router_flatten(config));if(urlHandlingStrategy&&(router.urlHandlingStrategy=urlHandlingStrategy),routeReuseStrategy&&(router.routeReuseStrategy=routeReuseStrategy),opts.errorHandler&&(router.errorHandler=opts.errorHandler),opts.malformedUriErrorHandler&&(router.malformedUriErrorHandler=opts.malformedUriErrorHandler),opts.enableTracing){const dom=getDOM();router.events.subscribe(e=>{dom.logGroup("Router Event: "+e.constructor.name),dom.log(e.toString()),dom.log(e),dom.logGroupEnd()})}return opts.onSameUrlNavigation&&(router.onSameUrlNavigation=opts.onSameUrlNavigation),opts.paramsInheritanceStrategy&&(router.paramsInheritanceStrategy=opts.paramsInheritanceStrategy),opts.urlUpdateStrategy&&(router.urlUpdateStrategy=opts.urlUpdateStrategy),opts.relativeLinkResolution&&(router.relativeLinkResolution=opts.relativeLinkResolution),router}function rootRoute(router){return router.routerState.root}class router_RouterInitializer{constructor(injector){this.injector=injector,this.initNavigation=!1,this.resultOfPreactivationDone=new Subject_Subject}appInitializer(){return this.injector.get(LOCATION_INITIALIZED,Promise.resolve(null)).then(()=>{let resolve=null;const res=new Promise(r=>resolve=r),router=this.injector.get(router_Router),opts=this.injector.get(ROUTER_CONFIGURATION);if(this.isLegacyDisabled(opts)||this.isLegacyEnabled(opts))resolve(!0);else if("disabled"===opts.initialNavigation)router.setUpLocationChangeListener(),resolve(!0);else{if("enabled"!==opts.initialNavigation)throw new Error(`Invalid initialNavigation options: '${opts.initialNavigation}'`);router.hooks.afterPreactivation=()=>this.initNavigation?of(null):(this.initNavigation=!0,resolve(!0),this.resultOfPreactivationDone),router.initialNavigation()}return res})}bootstrapListener(bootstrappedComponentRef){const opts=this.injector.get(ROUTER_CONFIGURATION),preloader=this.injector.get(router_RouterPreloader),routerScroller=this.injector.get(RouterScroller),router=this.injector.get(router_Router),ref=this.injector.get(core_ApplicationRef);bootstrappedComponentRef===ref.components[0]&&(this.isLegacyEnabled(opts)?router.initialNavigation():this.isLegacyDisabled(opts)&&router.setUpLocationChangeListener(),preloader.setUpPreloading(),routerScroller.init(),router.resetRootComponentType(ref.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}isLegacyEnabled(opts){return"legacy_enabled"===opts.initialNavigation||!0===opts.initialNavigation||void 0===opts.initialNavigation}isLegacyDisabled(opts){return"legacy_disabled"===opts.initialNavigation||!1===opts.initialNavigation}}function getAppInitializer(r){return r.appInitializer.bind(r)}function getBootstrapListener(r){return r.bootstrapListener.bind(r)}const ROUTER_INITIALIZER=new InjectionToken("Router Initializer");var RenderType_ɵangular_packages_router_router_l=createRendererType2({encapsulation:2,styles:[],data:{}});function View_ɵangular_packages_router_router_l_0(_l){return viewDef(0,[(_l()(),elementDef(0,16777216,null,null,1,"router-outlet",[],null,null,null,null,null)),directiveDef(1,212992,null,0,router_RouterOutlet,[ChildrenOutletContexts,ViewContainerRef,ComponentFactoryResolver,[8,null],ChangeDetectorRef],null,null)],(function(_ck,_v){_ck(_v,1,0)}),null)}function View_ɵangular_packages_router_router_l_Host_0(_l){return viewDef(0,[(_l()(),elementDef(0,0,null,null,1,"ng-component",[],null,null,null,View_ɵangular_packages_router_router_l_0,RenderType_ɵangular_packages_router_router_l)),directiveDef(1,49152,null,0,ɵEmptyOutletComponent,[],null,null)],null,null)}var ɵangular_packages_router_router_lNgFactory=createComponentFactory("ng-component",ɵEmptyOutletComponent,View_ɵangular_packages_router_router_l_Host_0,{},{},[]);function forkJoinInternal(sources,keys){return new Observable_Observable(subscriber=>{const len=sources.length;if(0===len)return void subscriber.complete();const values=new Array(len);let completed=0,emitted=0;for(let i=0;i<len;i++){const source=from(sources[i]);let hasValue=!1;subscriber.add(source.subscribe({next:value=>{hasValue||(hasValue=!0,emitted++),values[i]=value},error:err=>subscriber.error(err),complete:()=>{completed++,completed!==len&&hasValue||(emitted===len&&subscriber.next(keys?keys.reduce((result,key,i)=>(result[key]=values[i],result),{}):values),subscriber.complete())}}))}})}const NG_VALUE_ACCESSOR=new InjectionToken("NgValueAccessor"),COMPOSITION_BUFFER_MODE=new InjectionToken("CompositionEventMode");class DefaultValueAccessor{constructor(_renderer,_elementRef,_compositionMode){this._renderer=_renderer,this._elementRef=_elementRef,this._compositionMode=_compositionMode,this.onChange=_=>{},this.onTouched=()=>{},this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function(){const userAgent=getDOM()?getDOM().getUserAgent():"";return/android (\d+)/.test(userAgent.toLowerCase())}())}writeValue(value){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==value?"":value)}registerOnChange(fn){this.onChange=fn}registerOnTouched(fn){this.onTouched=fn}setDisabledState(isDisabled){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",isDisabled)}_handleInput(value){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(value)}_compositionStart(){this._composing=!0}_compositionEnd(value){this._composing=!1,this._compositionMode&&this.onChange(value)}}class AbstractControlDirective{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}reset(value){this.control&&this.control.reset(value)}hasError(errorCode,path){return!!this.control&&this.control.hasError(errorCode,path)}getError(errorCode,path){return this.control?this.control.getError(errorCode,path):null}}class ControlContainer extends AbstractControlDirective{get formDirective(){return null}get path(){return null}}function unimplemented(){throw new Error("unimplemented")}class NgControl extends AbstractControlDirective{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null,this._rawValidators=[],this._rawAsyncValidators=[]}get validator(){return unimplemented()}get asyncValidator(){return unimplemented()}}class AbstractControlStatus{constructor(cd){this._cd=cd}get ngClassUntouched(){return!!this._cd.control&&this._cd.control.untouched}get ngClassTouched(){return!!this._cd.control&&this._cd.control.touched}get ngClassPristine(){return!!this._cd.control&&this._cd.control.pristine}get ngClassDirty(){return!!this._cd.control&&this._cd.control.dirty}get ngClassValid(){return!!this._cd.control&&this._cd.control.valid}get ngClassInvalid(){return!!this._cd.control&&this._cd.control.invalid}get ngClassPending(){return!!this._cd.control&&this._cd.control.pending}}class NgControlStatus extends AbstractControlStatus{constructor(cd){super(cd)}}class NgControlStatusGroup extends AbstractControlStatus{constructor(cd){super(cd)}}function isEmptyInputValue(value){return null==value||0===value.length}const EMAIL_REGEXP=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class forms_Validators{static min(min){return control=>{if(isEmptyInputValue(control.value)||isEmptyInputValue(min))return null;const value=parseFloat(control.value);return!isNaN(value)&&value<min?{min:{min:min,actual:control.value}}:null}}static max(max){return control=>{if(isEmptyInputValue(control.value)||isEmptyInputValue(max))return null;const value=parseFloat(control.value);return!isNaN(value)&&value>max?{max:{max:max,actual:control.value}}:null}}static required(control){return isEmptyInputValue(control.value)?{required:!0}:null}static requiredTrue(control){return!0===control.value?null:{required:!0}}static email(control){return isEmptyInputValue(control.value)||EMAIL_REGEXP.test(control.value)?null:{email:!0}}static minLength(minLength){return control=>{if(isEmptyInputValue(control.value))return null;const length=control.value?control.value.length:0;return length<minLength?{minlength:{requiredLength:minLength,actualLength:length}}:null}}static maxLength(maxLength){return control=>{const length=control.value?control.value.length:0;return length>maxLength?{maxlength:{requiredLength:maxLength,actualLength:length}}:null}}static pattern(pattern){if(!pattern)return forms_Validators.nullValidator;let regex,regexStr;return"string"==typeof pattern?(regexStr="","^"!==pattern.charAt(0)&&(regexStr+="^"),regexStr+=pattern,"$"!==pattern.charAt(pattern.length-1)&&(regexStr+="$"),regex=new RegExp(regexStr)):(regexStr=pattern.toString(),regex=pattern),control=>{if(isEmptyInputValue(control.value))return null;const value=control.value;return regex.test(value)?null:{pattern:{requiredPattern:regexStr,actualValue:value}}}}static nullValidator(control){return null}static compose(validators){if(!validators)return null;const presentValidators=validators.filter(isPresent);return 0==presentValidators.length?null:function(control){return _mergeErrors(function(control,validators){return validators.map(v=>v(control))}(control,presentValidators))}}static composeAsync(validators){if(!validators)return null;const presentValidators=validators.filter(isPresent);return 0==presentValidators.length?null:function(control){return function(...sources){if(1===sources.length){const first=sources[0];if(isArray(first))return forkJoinInternal(first,null);if(isObject(first)&&Object.getPrototypeOf(first)===Object.prototype){const keys=Object.keys(first);return forkJoinInternal(keys.map(key=>first[key]),keys)}}if("function"==typeof sources[sources.length-1]){const resultSelector=sources.pop();return forkJoinInternal(sources=1===sources.length&&isArray(sources[0])?sources[0]:sources,null).pipe(map(args=>resultSelector(...args)))}return forkJoinInternal(sources,null)}(function(control,validators){return validators.map(v=>v(control))}(control,presentValidators).map(toObservable)).pipe(map(_mergeErrors))}}}function isPresent(o){return null!=o}function toObservable(r){const obs=core_isPromise(r)?from(r):r;if(!isObservable(obs))throw new Error("Expected validator to return Promise or Observable.");return obs}function _mergeErrors(arrayOfErrors){const res=arrayOfErrors.reduce((res,errors)=>null!=errors?Object.assign({},res,errors):res,{});return 0===Object.keys(res).length?null:res}function normalizeValidator(validator){return validator.validate?c=>validator.validate(c):validator}function normalizeAsyncValidator(validator){return validator.validate?c=>validator.validate(c):validator}class RadioControlRegistry{constructor(){this._accessors=[]}add(control,accessor){this._accessors.push([control,accessor])}remove(accessor){for(let i=this._accessors.length-1;i>=0;--i)if(this._accessors[i][1]===accessor)return void this._accessors.splice(i,1)}select(accessor){this._accessors.forEach(c=>{this._isSameGroup(c,accessor)&&c[1]!==accessor&&c[1].fireUncheck(accessor.value)})}_isSameGroup(controlPair,accessor){return!!controlPair[0].control&&controlPair[0]._parent===accessor._control._parent&&controlPair[1].name===accessor.name}}const FormErrorExamples_formGroupName='\n    <div [formGroup]="myGroup">\n       <div formGroupName="person">\n          <input formControlName="firstName">\n       </div>\n    </div>\n\n    In your class:\n\n    this.myGroup = new FormGroup({\n       person: new FormGroup({ firstName: new FormControl() })\n    });',FormErrorExamples_ngModelGroup='\n    <form>\n       <div ngModelGroup="person">\n          <input [(ngModel)]="person.name" name="firstName">\n       </div>\n    </form>';function _buildValueString(id,value){return null==id?""+value:(value&&"object"==typeof value&&(value="Object"),`${id}: ${value}`.slice(0,50))}class NgSelectOption{constructor(_element,_renderer,_select){this._element=_element,this._renderer=_renderer,this._select=_select,this._select&&(this.id=this._select._registerOption())}set ngValue(value){null!=this._select&&(this._select._optionMap.set(this.id,value),this._setElementValue(_buildValueString(this.id,value)),this._select.writeValue(this._select.value))}set value(value){this._setElementValue(value),this._select&&this._select.writeValue(this._select.value)}_setElementValue(value){this._renderer.setProperty(this._element.nativeElement,"value",value)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}function _buildValueString$1(id,value){return null==id?""+value:("string"==typeof value&&(value=`'${value}'`),value&&"object"==typeof value&&(value="Object"),`${id}: ${value}`.slice(0,50))}class ɵNgSelectMultipleOption{constructor(_element,_renderer,_select){this._element=_element,this._renderer=_renderer,this._select=_select,this._select&&(this.id=this._select._registerOption(this))}set ngValue(value){null!=this._select&&(this._value=value,this._setElementValue(_buildValueString$1(this.id,value)),this._select.writeValue(this._select.value))}set value(value){this._select?(this._value=value,this._setElementValue(_buildValueString$1(this.id,value)),this._select.writeValue(this._select.value)):this._setElementValue(value)}_setElementValue(value){this._renderer.setProperty(this._element.nativeElement,"value",value)}_setSelected(selected){this._renderer.setProperty(this._element.nativeElement,"selected",selected)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}function controlPath(name,parent){return[...parent.path,name]}function setUpControl(control,dir){control||forms_throwError(dir,"Cannot find control with"),dir.valueAccessor||forms_throwError(dir,"No value accessor for form control with"),control.validator=forms_Validators.compose([control.validator,dir.validator]),control.asyncValidator=forms_Validators.composeAsync([control.asyncValidator,dir.asyncValidator]),dir.valueAccessor.writeValue(control.value),function(control,dir){dir.valueAccessor.registerOnChange(newValue=>{control._pendingValue=newValue,control._pendingChange=!0,control._pendingDirty=!0,"change"===control.updateOn&&updateControl(control,dir)})}(control,dir),function(control,dir){control.registerOnChange((newValue,emitModelEvent)=>{dir.valueAccessor.writeValue(newValue),emitModelEvent&&dir.viewToModelUpdate(newValue)})}(control,dir),function(control,dir){dir.valueAccessor.registerOnTouched(()=>{control._pendingTouched=!0,"blur"===control.updateOn&&control._pendingChange&&updateControl(control,dir),"submit"!==control.updateOn&&control.markAsTouched()})}(control,dir),dir.valueAccessor.setDisabledState&&control.registerOnDisabledChange(isDisabled=>{dir.valueAccessor.setDisabledState(isDisabled)}),dir._rawValidators.forEach(validator=>{validator.registerOnValidatorChange&&validator.registerOnValidatorChange(()=>control.updateValueAndValidity())}),dir._rawAsyncValidators.forEach(validator=>{validator.registerOnValidatorChange&&validator.registerOnValidatorChange(()=>control.updateValueAndValidity())})}function updateControl(control,dir){control._pendingDirty&&control.markAsDirty(),control.setValue(control._pendingValue,{emitModelToViewChange:!1}),dir.viewToModelUpdate(control._pendingValue),control._pendingChange=!1}function forms_throwError(dir,message){let messageEnd;throw messageEnd=dir.path.length>1?`path: '${dir.path.join(" -> ")}'`:dir.path[0]?`name: '${dir.path}'`:"unspecified name attribute",new Error(`${message} ${messageEnd}`)}function composeValidators(validators){return null!=validators?forms_Validators.compose(validators.map(normalizeValidator)):null}function composeAsyncValidators(validators){return null!=validators?forms_Validators.composeAsync(validators.map(normalizeAsyncValidator)):null}const BUILTIN_ACCESSORS=[class{constructor(_renderer,_elementRef){this._renderer=_renderer,this._elementRef=_elementRef,this.onChange=_=>{},this.onTouched=()=>{}}writeValue(value){this._renderer.setProperty(this._elementRef.nativeElement,"checked",value)}registerOnChange(fn){this.onChange=fn}registerOnTouched(fn){this.onTouched=fn}setDisabledState(isDisabled){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",isDisabled)}},class{constructor(_renderer,_elementRef){this._renderer=_renderer,this._elementRef=_elementRef,this.onChange=_=>{},this.onTouched=()=>{}}writeValue(value){this._renderer.setProperty(this._elementRef.nativeElement,"value",parseFloat(value))}registerOnChange(fn){this.onChange=value=>{fn(""==value?null:parseFloat(value))}}registerOnTouched(fn){this.onTouched=fn}setDisabledState(isDisabled){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",isDisabled)}},class{constructor(_renderer,_elementRef){this._renderer=_renderer,this._elementRef=_elementRef,this.onChange=_=>{},this.onTouched=()=>{}}writeValue(value){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==value?"":value)}registerOnChange(fn){this.onChange=value=>{fn(""==value?null:parseFloat(value))}}registerOnTouched(fn){this.onTouched=fn}setDisabledState(isDisabled){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",isDisabled)}},class{constructor(_renderer,_elementRef){this._renderer=_renderer,this._elementRef=_elementRef,this._optionMap=new Map,this._idCounter=0,this.onChange=_=>{},this.onTouched=()=>{},this._compareWith=looseIdentical}set compareWith(fn){if("function"!=typeof fn)throw new Error("compareWith must be a function, but received "+JSON.stringify(fn));this._compareWith=fn}writeValue(value){this.value=value;const id=this._getOptionId(value);null==id&&this._renderer.setProperty(this._elementRef.nativeElement,"selectedIndex",-1);const valueString=_buildValueString(id,value);this._renderer.setProperty(this._elementRef.nativeElement,"value",valueString)}registerOnChange(fn){this.onChange=valueString=>{this.value=this._getOptionValue(valueString),fn(this.value)}}registerOnTouched(fn){this.onTouched=fn}setDisabledState(isDisabled){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",isDisabled)}_registerOption(){return(this._idCounter++).toString()}_getOptionId(value){for(const id of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(id),value))return id;return null}_getOptionValue(valueString){const id=function(valueString){return valueString.split(":")[0]}(valueString);return this._optionMap.has(id)?this._optionMap.get(id):valueString}},class{constructor(_renderer,_elementRef){this._renderer=_renderer,this._elementRef=_elementRef,this._optionMap=new Map,this._idCounter=0,this.onChange=_=>{},this.onTouched=()=>{},this._compareWith=looseIdentical}set compareWith(fn){if("function"!=typeof fn)throw new Error("compareWith must be a function, but received "+JSON.stringify(fn));this._compareWith=fn}writeValue(value){let optionSelectedStateSetter;if(this.value=value,Array.isArray(value)){const ids=value.map(v=>this._getOptionId(v));optionSelectedStateSetter=(opt,o)=>{opt._setSelected(ids.indexOf(o.toString())>-1)}}else optionSelectedStateSetter=(opt,o)=>{opt._setSelected(!1)};this._optionMap.forEach(optionSelectedStateSetter)}registerOnChange(fn){this.onChange=_=>{const selected=[];if(_.hasOwnProperty("selectedOptions")){const options=_.selectedOptions;for(let i=0;i<options.length;i++){const opt=options.item(i),val=this._getOptionValue(opt.value);selected.push(val)}}else{const options=_.options;for(let i=0;i<options.length;i++){const opt=options.item(i);if(opt.selected){const val=this._getOptionValue(opt.value);selected.push(val)}}}this.value=selected,fn(selected)}}registerOnTouched(fn){this.onTouched=fn}setDisabledState(isDisabled){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",isDisabled)}_registerOption(value){const id=(this._idCounter++).toString();return this._optionMap.set(id,value),id}_getOptionId(value){for(const id of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(id)._value,value))return id;return null}_getOptionValue(valueString){const id=function(valueString){return valueString.split(":")[0]}(valueString);return this._optionMap.has(id)?this._optionMap.get(id)._value:valueString}},class{constructor(_renderer,_elementRef,_registry,_injector){this._renderer=_renderer,this._elementRef=_elementRef,this._registry=_registry,this._injector=_injector,this.onChange=()=>{},this.onTouched=()=>{}}ngOnInit(){this._control=this._injector.get(NgControl),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(value){this._state=value===this.value,this._renderer.setProperty(this._elementRef.nativeElement,"checked",this._state)}registerOnChange(fn){this._fn=fn,this.onChange=()=>{fn(this.value),this._registry.select(this)}}fireUncheck(value){this.writeValue(value)}registerOnTouched(fn){this.onTouched=fn}setDisabledState(isDisabled){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",isDisabled)}_checkName(){this.name&&this.formControlName&&this.name!==this.formControlName&&this._throwNameError(),!this.name&&this.formControlName&&(this.name=this.formControlName)}_throwNameError(){throw new Error('\n      If you define both a name and a formControlName attribute on your radio button, their values\n      must match. Ex: <input type="radio" formControlName="food" name="food">\n    ')}}];function coerceToValidator(validatorOrOpts){const validator=isOptionsObj(validatorOrOpts)?validatorOrOpts.validators:validatorOrOpts;return Array.isArray(validator)?composeValidators(validator):validator||null}function coerceToAsyncValidator(asyncValidator,validatorOrOpts){const origAsyncValidator=isOptionsObj(validatorOrOpts)?validatorOrOpts.asyncValidators:asyncValidator;return Array.isArray(origAsyncValidator)?composeAsyncValidators(origAsyncValidator):origAsyncValidator||null}function isOptionsObj(validatorOrOpts){return null!=validatorOrOpts&&!Array.isArray(validatorOrOpts)&&"object"==typeof validatorOrOpts}class forms_AbstractControl{constructor(validator,asyncValidator){this.validator=validator,this.asyncValidator=asyncValidator,this._onCollectionChange=()=>{},this.pristine=!0,this.touched=!1,this._onDisabledChange=[]}get parent(){return this._parent}get valid(){return"VALID"===this.status}get invalid(){return"INVALID"===this.status}get pending(){return"PENDING"==this.status}get disabled(){return"DISABLED"===this.status}get enabled(){return"DISABLED"!==this.status}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(newValidator){this.validator=coerceToValidator(newValidator)}setAsyncValidators(newValidator){this.asyncValidator=coerceToAsyncValidator(newValidator)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(opts={}){this.touched=!0,this._parent&&!opts.onlySelf&&this._parent.markAsTouched(opts)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(control=>control.markAllAsTouched())}markAsUntouched(opts={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(control=>{control.markAsUntouched({onlySelf:!0})}),this._parent&&!opts.onlySelf&&this._parent._updateTouched(opts)}markAsDirty(opts={}){this.pristine=!1,this._parent&&!opts.onlySelf&&this._parent.markAsDirty(opts)}markAsPristine(opts={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(control=>{control.markAsPristine({onlySelf:!0})}),this._parent&&!opts.onlySelf&&this._parent._updatePristine(opts)}markAsPending(opts={}){this.status="PENDING",!1!==opts.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!opts.onlySelf&&this._parent.markAsPending(opts)}disable(opts={}){const skipPristineCheck=this._parentMarkedDirty(opts.onlySelf);this.status="DISABLED",this.errors=null,this._forEachChild(control=>{control.disable(Object.assign({},opts,{onlySelf:!0}))}),this._updateValue(),!1!==opts.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign({},opts,{skipPristineCheck:skipPristineCheck})),this._onDisabledChange.forEach(changeFn=>changeFn(!0))}enable(opts={}){const skipPristineCheck=this._parentMarkedDirty(opts.onlySelf);this.status="VALID",this._forEachChild(control=>{control.enable(Object.assign({},opts,{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:opts.emitEvent}),this._updateAncestors(Object.assign({},opts,{skipPristineCheck:skipPristineCheck})),this._onDisabledChange.forEach(changeFn=>changeFn(!1))}_updateAncestors(opts){this._parent&&!opts.onlySelf&&(this._parent.updateValueAndValidity(opts),opts.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(parent){this._parent=parent}updateValueAndValidity(opts={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),"VALID"!==this.status&&"PENDING"!==this.status||this._runAsyncValidator(opts.emitEvent)),!1!==opts.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!opts.onlySelf&&this._parent.updateValueAndValidity(opts)}_updateTreeValidity(opts={emitEvent:!0}){this._forEachChild(ctrl=>ctrl._updateTreeValidity(opts)),this.updateValueAndValidity({onlySelf:!0,emitEvent:opts.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?"DISABLED":"VALID"}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(emitEvent){if(this.asyncValidator){this.status="PENDING";const obs=toObservable(this.asyncValidator(this));this._asyncValidationSubscription=obs.subscribe(errors=>this.setErrors(errors,{emitEvent:emitEvent}))}}_cancelExistingSubscription(){this._asyncValidationSubscription&&this._asyncValidationSubscription.unsubscribe()}setErrors(errors,opts={}){this.errors=errors,this._updateControlsErrors(!1!==opts.emitEvent)}get(path){return function(control,path,delimiter){return null==path?null:(path instanceof Array||(path=path.split(".")),path instanceof Array&&0===path.length?null:path.reduce((v,name)=>v instanceof FormGroup?v.controls.hasOwnProperty(name)?v.controls[name]:null:v instanceof FormArray&&v.at(name)||null,control))}(this,path)}getError(errorCode,path){const control=path?this.get(path):this;return control&&control.errors?control.errors[errorCode]:null}hasError(errorCode,path){return!!this.getError(errorCode,path)}get root(){let x=this;for(;x._parent;)x=x._parent;return x}_updateControlsErrors(emitEvent){this.status=this._calculateStatus(),emitEvent&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(emitEvent)}_initObservables(){this.valueChanges=new core_EventEmitter,this.statusChanges=new core_EventEmitter}_calculateStatus(){return this._allControlsDisabled()?"DISABLED":this.errors?"INVALID":this._anyControlsHaveStatus("PENDING")?"PENDING":this._anyControlsHaveStatus("INVALID")?"INVALID":"VALID"}_anyControlsHaveStatus(status){return this._anyControls(control=>control.status===status)}_anyControlsDirty(){return this._anyControls(control=>control.dirty)}_anyControlsTouched(){return this._anyControls(control=>control.touched)}_updatePristine(opts={}){this.pristine=!this._anyControlsDirty(),this._parent&&!opts.onlySelf&&this._parent._updatePristine(opts)}_updateTouched(opts={}){this.touched=this._anyControlsTouched(),this._parent&&!opts.onlySelf&&this._parent._updateTouched(opts)}_isBoxedValue(formState){return"object"==typeof formState&&null!==formState&&2===Object.keys(formState).length&&"value"in formState&&"disabled"in formState}_registerOnCollectionChange(fn){this._onCollectionChange=fn}_setUpdateStrategy(opts){isOptionsObj(opts)&&null!=opts.updateOn&&(this._updateOn=opts.updateOn)}_parentMarkedDirty(onlySelf){return!onlySelf&&this._parent&&this._parent.dirty&&!this._parent._anyControlsDirty()}}class FormControl extends forms_AbstractControl{constructor(formState=null,validatorOrOpts,asyncValidator){super(coerceToValidator(validatorOrOpts),coerceToAsyncValidator(asyncValidator,validatorOrOpts)),this._onChange=[],this._applyFormState(formState),this._setUpdateStrategy(validatorOrOpts),this.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),this._initObservables()}setValue(value,options={}){this.value=this._pendingValue=value,this._onChange.length&&!1!==options.emitModelToViewChange&&this._onChange.forEach(changeFn=>changeFn(this.value,!1!==options.emitViewToModelChange)),this.updateValueAndValidity(options)}patchValue(value,options={}){this.setValue(value,options)}reset(formState=null,options={}){this._applyFormState(formState),this.markAsPristine(options),this.markAsUntouched(options),this.setValue(this.value,options),this._pendingChange=!1}_updateValue(){}_anyControls(condition){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(fn){this._onChange.push(fn)}_clearChangeFns(){this._onChange=[],this._onDisabledChange=[],this._onCollectionChange=()=>{}}registerOnDisabledChange(fn){this._onDisabledChange.push(fn)}_forEachChild(cb){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(formState){this._isBoxedValue(formState)?(this.value=this._pendingValue=formState.value,formState.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=formState}}class FormGroup extends forms_AbstractControl{constructor(controls,validatorOrOpts,asyncValidator){super(coerceToValidator(validatorOrOpts),coerceToAsyncValidator(asyncValidator,validatorOrOpts)),this.controls=controls,this._initObservables(),this._setUpdateStrategy(validatorOrOpts),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!1})}registerControl(name,control){return this.controls[name]?this.controls[name]:(this.controls[name]=control,control.setParent(this),control._registerOnCollectionChange(this._onCollectionChange),control)}addControl(name,control){this.registerControl(name,control),this.updateValueAndValidity(),this._onCollectionChange()}removeControl(name){this.controls[name]&&this.controls[name]._registerOnCollectionChange(()=>{}),delete this.controls[name],this.updateValueAndValidity(),this._onCollectionChange()}setControl(name,control){this.controls[name]&&this.controls[name]._registerOnCollectionChange(()=>{}),delete this.controls[name],control&&this.registerControl(name,control),this.updateValueAndValidity(),this._onCollectionChange()}contains(controlName){return this.controls.hasOwnProperty(controlName)&&this.controls[controlName].enabled}setValue(value,options={}){this._checkAllValuesPresent(value),Object.keys(value).forEach(name=>{this._throwIfControlMissing(name),this.controls[name].setValue(value[name],{onlySelf:!0,emitEvent:options.emitEvent})}),this.updateValueAndValidity(options)}patchValue(value,options={}){Object.keys(value).forEach(name=>{this.controls[name]&&this.controls[name].patchValue(value[name],{onlySelf:!0,emitEvent:options.emitEvent})}),this.updateValueAndValidity(options)}reset(value={},options={}){this._forEachChild((control,name)=>{control.reset(value[name],{onlySelf:!0,emitEvent:options.emitEvent})}),this._updatePristine(options),this._updateTouched(options),this.updateValueAndValidity(options)}getRawValue(){return this._reduceChildren({},(acc,control,name)=>(acc[name]=control instanceof FormControl?control.value:control.getRawValue(),acc))}_syncPendingControls(){let subtreeUpdated=this._reduceChildren(!1,(updated,child)=>!!child._syncPendingControls()||updated);return subtreeUpdated&&this.updateValueAndValidity({onlySelf:!0}),subtreeUpdated}_throwIfControlMissing(name){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet.  If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[name])throw new Error(`Cannot find form control with name: ${name}.`)}_forEachChild(cb){Object.keys(this.controls).forEach(k=>cb(this.controls[k],k))}_setUpControls(){this._forEachChild(control=>{control.setParent(this),control._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(condition){let res=!1;return this._forEachChild((control,name)=>{res=res||this.contains(name)&&condition(control)}),res}_reduceValue(){return this._reduceChildren({},(acc,control,name)=>((control.enabled||this.disabled)&&(acc[name]=control.value),acc))}_reduceChildren(initValue,fn){let res=initValue;return this._forEachChild((control,name)=>{res=fn(res,control,name)}),res}_allControlsDisabled(){for(const controlName of Object.keys(this.controls))if(this.controls[controlName].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_checkAllValuesPresent(value){this._forEachChild((control,name)=>{if(void 0===value[name])throw new Error(`Must supply a value for form control with name: '${name}'.`)})}}class FormArray extends forms_AbstractControl{constructor(controls,validatorOrOpts,asyncValidator){super(coerceToValidator(validatorOrOpts),coerceToAsyncValidator(asyncValidator,validatorOrOpts)),this.controls=controls,this._initObservables(),this._setUpdateStrategy(validatorOrOpts),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!1})}at(index){return this.controls[index]}push(control){this.controls.push(control),this._registerControl(control),this.updateValueAndValidity(),this._onCollectionChange()}insert(index,control){this.controls.splice(index,0,control),this._registerControl(control),this.updateValueAndValidity()}removeAt(index){this.controls[index]&&this.controls[index]._registerOnCollectionChange(()=>{}),this.controls.splice(index,1),this.updateValueAndValidity()}setControl(index,control){this.controls[index]&&this.controls[index]._registerOnCollectionChange(()=>{}),this.controls.splice(index,1),control&&(this.controls.splice(index,0,control),this._registerControl(control)),this.updateValueAndValidity(),this._onCollectionChange()}get length(){return this.controls.length}setValue(value,options={}){this._checkAllValuesPresent(value),value.forEach((newValue,index)=>{this._throwIfControlMissing(index),this.at(index).setValue(newValue,{onlySelf:!0,emitEvent:options.emitEvent})}),this.updateValueAndValidity(options)}patchValue(value,options={}){value.forEach((newValue,index)=>{this.at(index)&&this.at(index).patchValue(newValue,{onlySelf:!0,emitEvent:options.emitEvent})}),this.updateValueAndValidity(options)}reset(value=[],options={}){this._forEachChild((control,index)=>{control.reset(value[index],{onlySelf:!0,emitEvent:options.emitEvent})}),this._updatePristine(options),this._updateTouched(options),this.updateValueAndValidity(options)}getRawValue(){return this.controls.map(control=>control instanceof FormControl?control.value:control.getRawValue())}clear(){this.controls.length<1||(this._forEachChild(control=>control._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity())}_syncPendingControls(){let subtreeUpdated=this.controls.reduce((updated,child)=>!!child._syncPendingControls()||updated,!1);return subtreeUpdated&&this.updateValueAndValidity({onlySelf:!0}),subtreeUpdated}_throwIfControlMissing(index){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet.  If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(index))throw new Error("Cannot find form control at index "+index)}_forEachChild(cb){this.controls.forEach((control,index)=>{cb(control,index)})}_updateValue(){this.value=this.controls.filter(control=>control.enabled||this.disabled).map(control=>control.value)}_anyControls(condition){return this.controls.some(control=>control.enabled&&condition(control))}_setUpControls(){this._forEachChild(control=>this._registerControl(control))}_checkAllValuesPresent(value){this._forEachChild((control,i)=>{if(void 0===value[i])throw new Error(`Must supply a value for form control at index: ${i}.`)})}_allControlsDisabled(){for(const control of this.controls)if(control.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(control){control.setParent(this),control._registerOnCollectionChange(this._onCollectionChange)}}const resolvedPromise=(()=>Promise.resolve(null))();class forms_NgForm extends ControlContainer{constructor(validators,asyncValidators){super(),this.submitted=!1,this._directives=[],this.ngSubmit=new core_EventEmitter,this.form=new FormGroup({},composeValidators(validators),composeAsyncValidators(asyncValidators))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(dir){resolvedPromise.then(()=>{const container=this._findContainer(dir.path);dir.control=container.registerControl(dir.name,dir.control),setUpControl(dir.control,dir),dir.control.updateValueAndValidity({emitEvent:!1}),this._directives.push(dir)})}getControl(dir){return this.form.get(dir.path)}removeControl(dir){resolvedPromise.then(()=>{const container=this._findContainer(dir.path);container&&container.removeControl(dir.name),function(list,el){const index=list.indexOf(el);index>-1&&list.splice(index,1)}(this._directives,dir)})}addFormGroup(dir){resolvedPromise.then(()=>{const container=this._findContainer(dir.path),group=new FormGroup({});(function(control,dir){null==control&&forms_throwError(dir,"Cannot find control with"),control.validator=forms_Validators.compose([control.validator,dir.validator]),control.asyncValidator=forms_Validators.composeAsync([control.asyncValidator,dir.asyncValidator])})(group,dir),container.registerControl(dir.name,group),group.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(dir){resolvedPromise.then(()=>{const container=this._findContainer(dir.path);container&&container.removeControl(dir.name)})}getFormGroup(dir){return this.form.get(dir.path)}updateModel(dir,value){resolvedPromise.then(()=>{this.form.get(dir.path).setValue(value)})}setValue(value){this.control.setValue(value)}onSubmit($event){return this.submitted=!0,directives=this._directives,this.form._syncPendingControls(),directives.forEach(dir=>{const control=dir.control;"submit"===control.updateOn&&control._pendingChange&&(dir.viewToModelUpdate(control._pendingValue),control._pendingChange=!1)}),this.ngSubmit.emit($event),!1;var directives}onReset(){this.resetForm()}resetForm(value){this.form.reset(value),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(path){return path.pop(),path.length?this.form.get(path):this.form}}class TemplateDrivenErrors{static modelParentException(){throw new Error('\n      ngModel cannot be used to register form controls with a parent formGroup directive.  Try using\n      formGroup\'s partner directive "formControlName" instead.  Example:\n\n      \n    <div [formGroup]="myGroup">\n      <input formControlName="firstName">\n    </div>\n\n    In your class:\n\n    this.myGroup = new FormGroup({\n       firstName: new FormControl()\n    });\n\n      Or, if you\'d like to avoid registering this form control, indicate that it\'s standalone in ngModelOptions:\n\n      Example:\n\n      \n    <div [formGroup]="myGroup">\n       <input formControlName="firstName">\n       <input [(ngModel)]="showMoreControls" [ngModelOptions]="{standalone: true}">\n    </div>\n  ')}static formGroupNameException(){throw new Error(`\n      ngModel cannot be used to register form controls with a parent formGroupName or formArrayName directive.\n\n      Option 1: Use formControlName instead of ngModel (reactive strategy):\n\n      ${FormErrorExamples_formGroupName}\n\n      Option 2:  Update ngModel's parent be ngModelGroup (template-driven strategy):\n\n      ${FormErrorExamples_ngModelGroup}`)}static missingNameException(){throw new Error('If ngModel is used within a form tag, either the name attribute must be set or the form\n      control must be defined as \'standalone\' in ngModelOptions.\n\n      Example 1: <input [(ngModel)]="person.firstName" name="first">\n      Example 2: <input [(ngModel)]="person.firstName" [ngModelOptions]="{standalone: true}">')}static modelGroupParentException(){throw new Error(`\n      ngModelGroup cannot be used with a parent formGroup directive.\n\n      Option 1: Use formGroupName instead of ngModelGroup (reactive strategy):\n\n      ${FormErrorExamples_formGroupName}\n\n      Option 2:  Use a regular form tag instead of the formGroup directive (template-driven strategy):\n\n      ${FormErrorExamples_ngModelGroup}`)}static ngFormWarning(){console.warn("\n    It looks like you're using 'ngForm'.\n\n    Support for using the 'ngForm' element selector has been deprecated in Angular v6 and will be removed\n    in Angular v9.\n\n    Use 'ng-form' instead.\n\n    Before:\n    <ngForm #myForm=\"ngForm\">\n\n    After:\n    <ng-form #myForm=\"ngForm\">\n    ")}}const NG_FORM_SELECTOR_WARNING=new InjectionToken("NgFormSelectorWarning");class AbstractFormGroupDirective extends ControlContainer{ngOnInit(){this._checkParentType(),this.formDirective.addFormGroup(this)}ngOnDestroy(){this.formDirective&&this.formDirective.removeFormGroup(this)}get control(){return this.formDirective.getFormGroup(this)}get path(){return controlPath(this.name,this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}get validator(){return composeValidators(this._validators)}get asyncValidator(){return composeAsyncValidators(this._asyncValidators)}_checkParentType(){}}class NgModelGroup extends AbstractFormGroupDirective{constructor(parent,validators,asyncValidators){super(),this._parent=parent,this._validators=validators,this._asyncValidators=asyncValidators}_checkParentType(){this._parent instanceof NgModelGroup||this._parent instanceof forms_NgForm||TemplateDrivenErrors.modelGroupParentException()}}const resolvedPromise$1=(()=>Promise.resolve(null))();class forms_NgModel extends NgControl{constructor(parent,validators,asyncValidators,valueAccessors){super(),this.control=new FormControl,this._registered=!1,this.update=new core_EventEmitter,this._parent=parent,this._rawValidators=validators||[],this._rawAsyncValidators=asyncValidators||[],this.valueAccessor=function(dir,valueAccessors){if(!valueAccessors)return null;Array.isArray(valueAccessors)||forms_throwError(dir,"Value accessor was not provided as an array for form control with");let defaultAccessor=void 0,builtinAccessor=void 0,customAccessor=void 0;return valueAccessors.forEach(v=>{var valueAccessor;v.constructor===DefaultValueAccessor?defaultAccessor=v:(valueAccessor=v,BUILTIN_ACCESSORS.some(a=>valueAccessor.constructor===a)?(builtinAccessor&&forms_throwError(dir,"More than one built-in value accessor matches form control with"),builtinAccessor=v):(customAccessor&&forms_throwError(dir,"More than one custom value accessor matches form control with"),customAccessor=v))}),customAccessor||builtinAccessor||defaultAccessor||(forms_throwError(dir,"No valid value accessor for form control with"),null)}(this,valueAccessors)}ngOnChanges(changes){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in changes&&this._updateDisabled(changes),function(changes,viewModel){if(!changes.hasOwnProperty("model"))return!1;const change=changes.model;return!!change.isFirstChange()||!looseIdentical(viewModel,change.currentValue)}(changes,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._parent?controlPath(this.name,this._parent):[this.name]}get formDirective(){return this._parent?this._parent.formDirective:null}get validator(){return composeValidators(this._rawValidators)}get asyncValidator(){return composeAsyncValidators(this._rawAsyncValidators)}viewToModelUpdate(newValue){this.viewModel=newValue,this.update.emit(newValue)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){setUpControl(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){!(this._parent instanceof NgModelGroup)&&this._parent instanceof AbstractFormGroupDirective?TemplateDrivenErrors.formGroupNameException():this._parent instanceof NgModelGroup||this._parent instanceof forms_NgForm||TemplateDrivenErrors.modelParentException()}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()||this.name||TemplateDrivenErrors.missingNameException()}_updateValue(value){resolvedPromise$1.then(()=>{this.control.setValue(value,{emitViewToModelChange:!1})})}_updateDisabled(changes){const disabledValue=changes.isDisabled.currentValue,isDisabled=""===disabledValue||disabledValue&&"false"!==disabledValue;resolvedPromise$1.then(()=>{isDisabled&&!this.control.disabled?this.control.disable():!isDisabled&&this.control.disabled&&this.control.enable()})}}class ɵNgNoValidate{}class ɵInternalFormsSharedModule{}class FormsModule{static withConfig(opts){return{ngModule:FormsModule,providers:[{provide:NG_FORM_SELECTOR_WARNING,useValue:opts.warnOnDeprecatedNgFormSelector}]}}}function __awaiter(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P((function(resolve){resolve(result.value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))}var es5=__webpack_require__("3h4Y");class Action_Action extends Subscription_Subscription{constructor(scheduler,work){super()}schedule(state,delay=0){return this}}class AsyncAction_AsyncAction extends Action_Action{constructor(scheduler,work){super(scheduler,work),this.scheduler=scheduler,this.work=work,this.pending=!1}schedule(state,delay=0){if(this.closed)return this;this.state=state;const id=this.id,scheduler=this.scheduler;return null!=id&&(this.id=this.recycleAsyncId(scheduler,id,delay)),this.pending=!0,this.delay=delay,this.id=this.id||this.requestAsyncId(scheduler,this.id,delay),this}requestAsyncId(scheduler,id,delay=0){return setInterval(scheduler.flush.bind(scheduler,this),delay)}recycleAsyncId(scheduler,id,delay=0){if(null!==delay&&this.delay===delay&&!1===this.pending)return id;clearInterval(id)}execute(state,delay){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const error=this._execute(state,delay);if(error)return error;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(state,delay){let errored=!1,errorValue=void 0;try{this.work(state)}catch(e){errored=!0,errorValue=!!e&&e||new Error(e)}if(errored)return this.unsubscribe(),errorValue}_unsubscribe(){const id=this.id,scheduler=this.scheduler,actions=scheduler.actions,index=actions.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==index&&actions.splice(index,1),null!=id&&(this.id=this.recycleAsyncId(scheduler,id,null)),this.delay=null}}class QueueAction_QueueAction extends AsyncAction_AsyncAction{constructor(scheduler,work){super(scheduler,work),this.scheduler=scheduler,this.work=work}schedule(state,delay=0){return delay>0?super.schedule(state,delay):(this.delay=delay,this.state=state,this.scheduler.flush(this),this)}execute(state,delay){return delay>0||this.closed?super.execute(state,delay):this._execute(state,delay)}requestAsyncId(scheduler,id,delay=0){return null!==delay&&delay>0||null===delay&&this.delay>0?super.requestAsyncId(scheduler,id,delay):scheduler.flush(this)}}let Scheduler=(()=>{class Scheduler{constructor(SchedulerAction,now=Scheduler.now){this.SchedulerAction=SchedulerAction,this.now=now}schedule(work,delay=0,state){return new this.SchedulerAction(this,work).schedule(state,delay)}}return Scheduler.now=()=>Date.now(),Scheduler})();class AsyncScheduler_AsyncScheduler extends Scheduler{constructor(SchedulerAction,now=Scheduler.now){super(SchedulerAction,()=>AsyncScheduler_AsyncScheduler.delegate&&AsyncScheduler_AsyncScheduler.delegate!==this?AsyncScheduler_AsyncScheduler.delegate.now():now()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(work,delay=0,state){return AsyncScheduler_AsyncScheduler.delegate&&AsyncScheduler_AsyncScheduler.delegate!==this?AsyncScheduler_AsyncScheduler.delegate.schedule(work,delay,state):super.schedule(work,delay,state)}flush(action){const{actions:actions}=this;if(this.active)return void actions.push(action);let error;this.active=!0;do{if(error=action.execute(action.state,action.delay))break}while(action=actions.shift());if(this.active=!1,error){for(;action=actions.shift();)action.unsubscribe();throw error}}}class QueueScheduler_QueueScheduler extends AsyncScheduler_AsyncScheduler{}const queue=new QueueScheduler_QueueScheduler(QueueAction_QueueAction);let Notification_Notification=(()=>{class Notification{constructor(kind,value,error){this.kind=kind,this.value=value,this.error=error,this.hasValue="N"===kind}observe(observer){switch(this.kind){case"N":return observer.next&&observer.next(this.value);case"E":return observer.error&&observer.error(this.error);case"C":return observer.complete&&observer.complete()}}do(next,error,complete){switch(this.kind){case"N":return next&&next(this.value);case"E":return error&&error(this.error);case"C":return complete&&complete()}}accept(nextOrObserver,error,complete){return nextOrObserver&&"function"==typeof nextOrObserver.next?this.observe(nextOrObserver):this.do(nextOrObserver,error,complete)}toObservable(){switch(this.kind){case"N":return of(this.value);case"E":return error=this.error,new Observable_Observable(subscriber=>subscriber.error(error));case"C":return empty_empty()}var error;throw new Error("unexpected notification kind value")}static createNext(value){return void 0!==value?new Notification("N",value):Notification.undefinedValueNotification}static createError(err){return new Notification("E",void 0,err)}static createComplete(){return Notification.completeNotification}}return Notification.completeNotification=new Notification("C"),Notification.undefinedValueNotification=new Notification("N",void 0),Notification})();class observeOn_ObserveOnSubscriber extends Subscriber_Subscriber{constructor(destination,scheduler,delay=0){super(destination),this.scheduler=scheduler,this.delay=delay}static dispatch(arg){const{notification:notification,destination:destination}=arg;notification.observe(destination),this.unsubscribe()}scheduleMessage(notification){this.destination.add(this.scheduler.schedule(observeOn_ObserveOnSubscriber.dispatch,this.delay,new ObserveOnMessage(notification,this.destination)))}_next(value){this.scheduleMessage(Notification_Notification.createNext(value))}_error(err){this.scheduleMessage(Notification_Notification.createError(err)),this.unsubscribe()}_complete(){this.scheduleMessage(Notification_Notification.createComplete()),this.unsubscribe()}}class ObserveOnMessage{constructor(notification,destination){this.notification=notification,this.destination=destination}}class ReplaySubject_ReplaySubject extends Subject_Subject{constructor(bufferSize=Number.POSITIVE_INFINITY,windowTime=Number.POSITIVE_INFINITY,scheduler){super(),this.scheduler=scheduler,this._events=[],this._infiniteTimeWindow=!1,this._bufferSize=bufferSize<1?1:bufferSize,this._windowTime=windowTime<1?1:windowTime,windowTime===Number.POSITIVE_INFINITY?(this._infiniteTimeWindow=!0,this.next=this.nextInfiniteTimeWindow):this.next=this.nextTimeWindow}nextInfiniteTimeWindow(value){if(!this.isStopped){const _events=this._events;_events.push(value),_events.length>this._bufferSize&&_events.shift()}super.next(value)}nextTimeWindow(value){this.isStopped||(this._events.push(new ReplayEvent(this._getNow(),value)),this._trimBufferThenGetEvents()),super.next(value)}_subscribe(subscriber){const _infiniteTimeWindow=this._infiniteTimeWindow,_events=_infiniteTimeWindow?this._events:this._trimBufferThenGetEvents(),scheduler=this.scheduler,len=_events.length;let subscription;if(this.closed)throw new ObjectUnsubscribedError;if(this.isStopped||this.hasError?subscription=Subscription_Subscription.EMPTY:(this.observers.push(subscriber),subscription=new SubjectSubscription_SubjectSubscription(this,subscriber)),scheduler&&subscriber.add(subscriber=new observeOn_ObserveOnSubscriber(subscriber,scheduler)),_infiniteTimeWindow)for(let i=0;i<len&&!subscriber.closed;i++)subscriber.next(_events[i]);else for(let i=0;i<len&&!subscriber.closed;i++)subscriber.next(_events[i].value);return this.hasError?subscriber.error(this.thrownError):this.isStopped&&subscriber.complete(),subscription}_getNow(){return(this.scheduler||queue).now()}_trimBufferThenGetEvents(){const now=this._getNow(),_bufferSize=this._bufferSize,_windowTime=this._windowTime,_events=this._events,eventsCount=_events.length;let spliceCount=0;for(;spliceCount<eventsCount&&!(now-_events[spliceCount].time<_windowTime);)spliceCount++;return eventsCount>_bufferSize&&(spliceCount=Math.max(spliceCount,eventsCount-_bufferSize)),spliceCount>0&&_events.splice(0,spliceCount),_events}}class ReplayEvent{constructor(time,value){this.time=time,this.value=value}}class HttpHandler{}class HttpBackend{}class HttpHeaders{constructor(headers){this.normalizedNames=new Map,this.lazyUpdate=null,headers?this.lazyInit="string"==typeof headers?()=>{this.headers=new Map,headers.split("\n").forEach(line=>{const index=line.indexOf(":");if(index>0){const name=line.slice(0,index),key=name.toLowerCase(),value=line.slice(index+1).trim();this.maybeSetNormalizedName(name,key),this.headers.has(key)?this.headers.get(key).push(value):this.headers.set(key,[value])}})}:()=>{this.headers=new Map,Object.keys(headers).forEach(name=>{let values=headers[name];const key=name.toLowerCase();"string"==typeof values&&(values=[values]),values.length>0&&(this.headers.set(key,values),this.maybeSetNormalizedName(name,key))})}:this.headers=new Map}has(name){return this.init(),this.headers.has(name.toLowerCase())}get(name){this.init();const values=this.headers.get(name.toLowerCase());return values&&values.length>0?values[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(name){return this.init(),this.headers.get(name.toLowerCase())||null}append(name,value){return this.clone({name:name,value:value,op:"a"})}set(name,value){return this.clone({name:name,value:value,op:"s"})}delete(name,value){return this.clone({name:name,value:value,op:"d"})}maybeSetNormalizedName(name,lcName){this.normalizedNames.has(lcName)||this.normalizedNames.set(lcName,name)}init(){this.lazyInit&&(this.lazyInit instanceof HttpHeaders?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(update=>this.applyUpdate(update)),this.lazyUpdate=null))}copyFrom(other){other.init(),Array.from(other.headers.keys()).forEach(key=>{this.headers.set(key,other.headers.get(key)),this.normalizedNames.set(key,other.normalizedNames.get(key))})}clone(update){const clone=new HttpHeaders;return clone.lazyInit=this.lazyInit&&this.lazyInit instanceof HttpHeaders?this.lazyInit:this,clone.lazyUpdate=(this.lazyUpdate||[]).concat([update]),clone}applyUpdate(update){const key=update.name.toLowerCase();switch(update.op){case"a":case"s":let value=update.value;if("string"==typeof value&&(value=[value]),0===value.length)return;this.maybeSetNormalizedName(update.name,key);const base=("a"===update.op?this.headers.get(key):void 0)||[];base.push(...value),this.headers.set(key,base);break;case"d":const toDelete=update.value;if(toDelete){let existing=this.headers.get(key);if(!existing)return;existing=existing.filter(value=>-1===toDelete.indexOf(value)),0===existing.length?(this.headers.delete(key),this.normalizedNames.delete(key)):this.headers.set(key,existing)}else this.headers.delete(key),this.normalizedNames.delete(key)}}forEach(fn){this.init(),Array.from(this.normalizedNames.keys()).forEach(key=>fn(this.normalizedNames.get(key),this.headers.get(key)))}}class HttpUrlEncodingCodec{encodeKey(key){return standardEncoding(key)}encodeValue(value){return standardEncoding(value)}decodeKey(key){return decodeURIComponent(key)}decodeValue(value){return decodeURIComponent(value)}}function standardEncoding(v){return encodeURIComponent(v).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/gi,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%2B/gi,"+").replace(/%3D/gi,"=").replace(/%3F/gi,"?").replace(/%2F/gi,"/")}class HttpParams{constructor(options={}){if(this.updates=null,this.cloneFrom=null,this.encoder=options.encoder||new HttpUrlEncodingCodec,options.fromString){if(options.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(rawParams,codec){const map=new Map;return rawParams.length>0&&rawParams.split("&").forEach(param=>{const eqIdx=param.indexOf("="),[key,val]=-1==eqIdx?[codec.decodeKey(param),""]:[codec.decodeKey(param.slice(0,eqIdx)),codec.decodeValue(param.slice(eqIdx+1))],list=map.get(key)||[];list.push(val),map.set(key,list)}),map}(options.fromString,this.encoder)}else options.fromObject?(this.map=new Map,Object.keys(options.fromObject).forEach(key=>{const value=options.fromObject[key];this.map.set(key,Array.isArray(value)?value:[value])})):this.map=null}has(param){return this.init(),this.map.has(param)}get(param){this.init();const res=this.map.get(param);return res?res[0]:null}getAll(param){return this.init(),this.map.get(param)||null}keys(){return this.init(),Array.from(this.map.keys())}append(param,value){return this.clone({param:param,value:value,op:"a"})}set(param,value){return this.clone({param:param,value:value,op:"s"})}delete(param,value){return this.clone({param:param,value:value,op:"d"})}toString(){return this.init(),this.keys().map(key=>{const eKey=this.encoder.encodeKey(key);return this.map.get(key).map(value=>eKey+"="+this.encoder.encodeValue(value)).join("&")}).join("&")}clone(update){const clone=new HttpParams({encoder:this.encoder});return clone.cloneFrom=this.cloneFrom||this,clone.updates=(this.updates||[]).concat([update]),clone}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(key=>this.map.set(key,this.cloneFrom.map.get(key))),this.updates.forEach(update=>{switch(update.op){case"a":case"s":const base=("a"===update.op?this.map.get(update.param):void 0)||[];base.push(update.value),this.map.set(update.param,base);break;case"d":if(void 0===update.value){this.map.delete(update.param);break}{let base=this.map.get(update.param)||[];const idx=base.indexOf(update.value);-1!==idx&&base.splice(idx,1),base.length>0?this.map.set(update.param,base):this.map.delete(update.param)}}}),this.cloneFrom=this.updates=null)}}function isArrayBuffer(value){return"undefined"!=typeof ArrayBuffer&&value instanceof ArrayBuffer}function isBlob(value){return"undefined"!=typeof Blob&&value instanceof Blob}function isFormData(value){return"undefined"!=typeof FormData&&value instanceof FormData}class HttpRequest{constructor(method,url,third,fourth){let options;if(this.url=url,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=method.toUpperCase(),function(method){switch(method){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||fourth?(this.body=void 0!==third?third:null,options=fourth):options=third,options&&(this.reportProgress=!!options.reportProgress,this.withCredentials=!!options.withCredentials,options.responseType&&(this.responseType=options.responseType),options.headers&&(this.headers=options.headers),options.params&&(this.params=options.params)),this.headers||(this.headers=new HttpHeaders),this.params){const params=this.params.toString();if(0===params.length)this.urlWithParams=url;else{const qIdx=url.indexOf("?");this.urlWithParams=url+(-1===qIdx?"?":qIdx<url.length-1?"&":"")+params}}else this.params=new HttpParams,this.urlWithParams=url}serializeBody(){return null===this.body?null:isArrayBuffer(this.body)||isBlob(this.body)||isFormData(this.body)||"string"==typeof this.body?this.body:this.body instanceof HttpParams?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||isFormData(this.body)?null:isBlob(this.body)?this.body.type||null:isArrayBuffer(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof HttpParams?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||Array.isArray(this.body)?"application/json":null}clone(update={}){const method=update.method||this.method,url=update.url||this.url,responseType=update.responseType||this.responseType,body=void 0!==update.body?update.body:this.body,withCredentials=void 0!==update.withCredentials?update.withCredentials:this.withCredentials,reportProgress=void 0!==update.reportProgress?update.reportProgress:this.reportProgress;let headers=update.headers||this.headers,params=update.params||this.params;return void 0!==update.setHeaders&&(headers=Object.keys(update.setHeaders).reduce((headers,name)=>headers.set(name,update.setHeaders[name]),headers)),update.setParams&&(params=Object.keys(update.setParams).reduce((params,param)=>params.set(param,update.setParams[param]),params)),new HttpRequest(method,url,body,{params:params,headers:headers,reportProgress:reportProgress,responseType:responseType,withCredentials:withCredentials})}}const HttpEventType=function(){var HttpEventType={Sent:0,UploadProgress:1,ResponseHeader:2,DownloadProgress:3,Response:4,User:5};return HttpEventType[HttpEventType.Sent]="Sent",HttpEventType[HttpEventType.UploadProgress]="UploadProgress",HttpEventType[HttpEventType.ResponseHeader]="ResponseHeader",HttpEventType[HttpEventType.DownloadProgress]="DownloadProgress",HttpEventType[HttpEventType.Response]="Response",HttpEventType[HttpEventType.User]="User",HttpEventType}();class HttpResponseBase{constructor(init,defaultStatus=200,defaultStatusText="OK"){this.headers=init.headers||new HttpHeaders,this.status=void 0!==init.status?init.status:defaultStatus,this.statusText=init.statusText||defaultStatusText,this.url=init.url||null,this.ok=this.status>=200&&this.status<300}}class HttpHeaderResponse extends HttpResponseBase{constructor(init={}){super(init),this.type=HttpEventType.ResponseHeader}clone(update={}){return new HttpHeaderResponse({headers:update.headers||this.headers,status:void 0!==update.status?update.status:this.status,statusText:update.statusText||this.statusText,url:update.url||this.url||void 0})}}class HttpResponse extends HttpResponseBase{constructor(init={}){super(init),this.type=HttpEventType.Response,this.body=void 0!==init.body?init.body:null}clone(update={}){return new HttpResponse({body:void 0!==update.body?update.body:this.body,headers:update.headers||this.headers,status:void 0!==update.status?update.status:this.status,statusText:update.statusText||this.statusText,url:update.url||this.url||void 0})}}class HttpErrorResponse extends HttpResponseBase{constructor(init){super(init,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?"Http failure during parsing for "+(init.url||"(unknown url)"):`Http failure response for ${init.url||"(unknown url)"}: ${init.status} ${init.statusText}`,this.error=init.error||null}}function addBody(options,body){return{body:body,headers:options.headers,observe:options.observe,params:options.params,reportProgress:options.reportProgress,responseType:options.responseType,withCredentials:options.withCredentials}}class http_HttpClient{constructor(handler){this.handler=handler}request(first,url,options={}){let req;if(first instanceof HttpRequest)req=first;else{let headers=void 0;headers=options.headers instanceof HttpHeaders?options.headers:new HttpHeaders(options.headers);let params=void 0;options.params&&(params=options.params instanceof HttpParams?options.params:new HttpParams({fromObject:options.params})),req=new HttpRequest(first,url,void 0!==options.body?options.body:null,{headers:headers,params:params,reportProgress:options.reportProgress,responseType:options.responseType||"json",withCredentials:options.withCredentials})}const events$=of(req).pipe(concatMap(req=>this.handler.handle(req)));if(first instanceof HttpRequest||"events"===options.observe)return events$;const res$=events$.pipe(filter(event=>event instanceof HttpResponse));switch(options.observe||"body"){case"body":switch(req.responseType){case"arraybuffer":return res$.pipe(map(res=>{if(null!==res.body&&!(res.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return res.body}));case"blob":return res$.pipe(map(res=>{if(null!==res.body&&!(res.body instanceof Blob))throw new Error("Response is not a Blob.");return res.body}));case"text":return res$.pipe(map(res=>{if(null!==res.body&&"string"!=typeof res.body)throw new Error("Response is not a string.");return res.body}));case"json":default:return res$.pipe(map(res=>res.body))}case"response":return res$;default:throw new Error(`Unreachable: unhandled observe type ${options.observe}}`)}}delete(url,options={}){return this.request("DELETE",url,options)}get(url,options={}){return this.request("GET",url,options)}head(url,options={}){return this.request("HEAD",url,options)}jsonp(url,callbackParam){return this.request("JSONP",url,{params:(new HttpParams).append(callbackParam,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(url,options={}){return this.request("OPTIONS",url,options)}patch(url,body,options={}){return this.request("PATCH",url,addBody(options,body))}post(url,body,options={}){return this.request("POST",url,addBody(options,body))}put(url,body,options={}){return this.request("PUT",url,addBody(options,body))}}class HttpInterceptorHandler{constructor(next,interceptor){this.next=next,this.interceptor=interceptor}handle(req){return this.interceptor.intercept(req,this.next)}}const HTTP_INTERCEPTORS=new InjectionToken("HTTP_INTERCEPTORS");class NoopInterceptor{intercept(req,next){return next.handle(req)}}const XSSI_PREFIX=/^\)\]\}',?\n/;class XhrFactory{}class BrowserXhr{constructor(){}build(){return new XMLHttpRequest}}class http_HttpXhrBackend{constructor(xhrFactory){this.xhrFactory=xhrFactory}handle(req){if("JSONP"===req.method)throw new Error("Attempted to construct Jsonp request without JsonpClientModule installed.");return new Observable_Observable(observer=>{const xhr=this.xhrFactory.build();if(xhr.open(req.method,req.urlWithParams),req.withCredentials&&(xhr.withCredentials=!0),req.headers.forEach((name,values)=>xhr.setRequestHeader(name,values.join(","))),req.headers.has("Accept")||xhr.setRequestHeader("Accept","application/json, text/plain, */*"),!req.headers.has("Content-Type")){const detectedType=req.detectContentTypeHeader();null!==detectedType&&xhr.setRequestHeader("Content-Type",detectedType)}if(req.responseType){const responseType=req.responseType.toLowerCase();xhr.responseType="json"!==responseType?responseType:"text"}const reqBody=req.serializeBody();let headerResponse=null;const partialFromXhr=()=>{if(null!==headerResponse)return headerResponse;const status=1223===xhr.status?204:xhr.status,statusText=xhr.statusText||"OK",headers=new HttpHeaders(xhr.getAllResponseHeaders()),url=function(xhr){return"responseURL"in xhr&&xhr.responseURL?xhr.responseURL:/^X-Request-URL:/m.test(xhr.getAllResponseHeaders())?xhr.getResponseHeader("X-Request-URL"):null}(xhr)||req.url;return headerResponse=new HttpHeaderResponse({headers:headers,status:status,statusText:statusText,url:url}),headerResponse},onLoad=()=>{let{headers:headers,status:status,statusText:statusText,url:url}=partialFromXhr(),body=null;204!==status&&(body=void 0===xhr.response?xhr.responseText:xhr.response),0===status&&(status=body?200:0);let ok=status>=200&&status<300;if("json"===req.responseType&&"string"==typeof body){const originalBody=body;body=body.replace(XSSI_PREFIX,"");try{body=""!==body?JSON.parse(body):null}catch(error){body=originalBody,ok&&(ok=!1,body={error:error,text:body})}}ok?(observer.next(new HttpResponse({body:body,headers:headers,status:status,statusText:statusText,url:url||void 0})),observer.complete()):observer.error(new HttpErrorResponse({error:body,headers:headers,status:status,statusText:statusText,url:url||void 0}))},onError=error=>{const{url:url}=partialFromXhr(),res=new HttpErrorResponse({error:error,status:xhr.status||0,statusText:xhr.statusText||"Unknown Error",url:url||void 0});observer.error(res)};let sentHeaders=!1;const onDownProgress=event=>{sentHeaders||(observer.next(partialFromXhr()),sentHeaders=!0);let progressEvent={type:HttpEventType.DownloadProgress,loaded:event.loaded};event.lengthComputable&&(progressEvent.total=event.total),"text"===req.responseType&&xhr.responseText&&(progressEvent.partialText=xhr.responseText),observer.next(progressEvent)},onUpProgress=event=>{let progress={type:HttpEventType.UploadProgress,loaded:event.loaded};event.lengthComputable&&(progress.total=event.total),observer.next(progress)};return xhr.addEventListener("load",onLoad),xhr.addEventListener("error",onError),req.reportProgress&&(xhr.addEventListener("progress",onDownProgress),null!==reqBody&&xhr.upload&&xhr.upload.addEventListener("progress",onUpProgress)),xhr.send(reqBody),observer.next({type:HttpEventType.Sent}),()=>{xhr.removeEventListener("error",onError),xhr.removeEventListener("load",onLoad),req.reportProgress&&(xhr.removeEventListener("progress",onDownProgress),null!==reqBody&&xhr.upload&&xhr.upload.removeEventListener("progress",onUpProgress)),xhr.abort()}})}}const XSRF_COOKIE_NAME=new InjectionToken("XSRF_COOKIE_NAME"),XSRF_HEADER_NAME=new InjectionToken("XSRF_HEADER_NAME");class HttpXsrfTokenExtractor{}class http_HttpXsrfCookieExtractor{constructor(doc,platform,cookieName){this.doc=doc,this.platform=platform,this.cookieName=cookieName,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const cookieString=this.doc.cookie||"";return cookieString!==this.lastCookieString&&(this.parseCount++,this.lastToken=parseCookieValue(cookieString,this.cookieName),this.lastCookieString=cookieString),this.lastToken}}class HttpXsrfInterceptor{constructor(tokenService,headerName){this.tokenService=tokenService,this.headerName=headerName}intercept(req,next){const lcUrl=req.url.toLowerCase();if("GET"===req.method||"HEAD"===req.method||lcUrl.startsWith("http://")||lcUrl.startsWith("https://"))return next.handle(req);const token=this.tokenService.getToken();return null===token||req.headers.has(this.headerName)||(req=req.clone({headers:req.headers.set(this.headerName,token)})),next.handle(req)}}class HttpInterceptingHandler{constructor(backend,injector){this.backend=backend,this.injector=injector,this.chain=null}handle(req){if(null===this.chain){const interceptors=this.injector.get(HTTP_INTERCEPTORS,[]);this.chain=interceptors.reduceRight((next,interceptor)=>new HttpInterceptorHandler(next,interceptor),this.backend)}return this.chain.handle(req)}}class HttpClientXsrfModule{static disable(){return{ngModule:HttpClientXsrfModule,providers:[{provide:HttpXsrfInterceptor,useClass:NoopInterceptor}]}}static withOptions(options={}){return{ngModule:HttpClientXsrfModule,providers:[options.cookieName?{provide:XSRF_COOKIE_NAME,useValue:options.cookieName}:[],options.headerName?{provide:XSRF_HEADER_NAME,useValue:options.headerName}:[]]}}}class HttpClientModule{}let videochat_service_VideoChatService=(()=>{class VideoChatService{constructor(http){this.http=http,this.roomBroadcast=new ReplaySubject_ReplaySubject,this.$roomsUpdated=this.roomBroadcast.asObservable(),this.rootUrl="http://4b58-111-119-187-63.ngrok.io/api/video/"}getAuthToken(){return __awaiter(this,void 0,void 0,(function*(){const auth=yield this.http.get(this.rootUrl+"token").toPromise();return console.log(auth),auth}))}getAllRooms(){return this.http.get(this.rootUrl+"rooms").toPromise()}joinOrCreateRoom(name,tracks){return __awaiter(this,void 0,void 0,(function*(){let room=null;try{const token=yield this.getAuthToken();console.log(token),room=yield Object(es5.connect)(token,{name:name,tracks:tracks,dominantSpeaker:!0})}catch(error){console.error("Unable to connect to Room: "+error.message)}finally{room&&this.roomBroadcast.next(!0)}return room}))}nudge(){this.roomBroadcast.next(!0)}}return VideoChatService.ngInjectableDef=ɵɵdefineInjectable({factory:function(){return new VideoChatService(ɵɵinject(http_HttpClient))},token:VideoChatService,providedIn:"root"}),VideoChatService})();class rooms_component_RoomsComponent{constructor(videoChatService){this.videoChatService=videoChatService,this.roomChanged=new core_EventEmitter}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){yield this.updateRooms()}))}ngOnDestroy(){}onTryAddRoom(){this.roomName&&this.onAddRoom(this.roomName)}onAddRoom(roomName){this.roomName=null,this.roomChanged.emit(roomName)}onJoinRoom(roomName){this.roomChanged.emit(roomName)}updateRooms(){return __awaiter(this,void 0,void 0,(function*(){this.rooms=yield this.videoChatService.getAllRooms()}))}}var RenderType_RoomsComponent=createRendererType2({encapsulation:0,styles:[[""]],data:{}});function View_RoomsComponent_1(_l){return viewDef(0,[(_l()(),elementDef(0,0,null,null,2,"div",[["class","list-group-item d-flex justify-content-between align-items-center"]],null,null,null,null,null)),(_l()(),elementDef(1,0,null,null,1,"p",[["class","lead"]],null,null,null,null,null)),(_l()(),textDef(-1,null,[" Add a room to begin. Other online participants can join or create rooms. "]))],null,null)}function View_RoomsComponent_2(_l){return viewDef(0,[(_l()(),elementDef(0,0,null,null,6,"a",[["class","list-group-item list-group-item-action d-flex justify-content-between align-items-center"],["href","#"]],null,[[null,"click"]],(function(_v,en,$event){var ad=!0;return"click"===en&&(ad=!1!==_v.component.onJoinRoom(_v.context.$implicit.name)&&ad),ad}),null,null)),providerDef(512,null,NgClassImpl,common_NgClassR2Impl,[IterableDiffers,KeyValueDiffers,ElementRef,Renderer2]),directiveDef(2,278528,null,0,NgClass,[NgClassImpl],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),pureObjectDef(3,{active:0}),(_l()(),textDef(4,null,[" "," "])),(_l()(),elementDef(5,0,null,null,1,"span",[["class","badge badge-primary badge-pill"]],null,null,null,null,null)),(_l()(),textDef(6,null,[" "," / "," "]))],(function(_ck,_v){var currVal_1=_ck(_v,3,0,_v.component.activeRoomName===_v.context.$implicit.name);_ck(_v,2,0,"list-group-item list-group-item-action d-flex justify-content-between align-items-center",currVal_1)}),(function(_ck,_v){_ck(_v,4,0,_v.context.$implicit.name),_ck(_v,6,0,_v.context.$implicit.participantCount,_v.context.$implicit.maxParticipants)}))}function View_RoomsComponent_0(_l){return viewDef(0,[(_l()(),elementDef(0,0,null,null,20,"div",[["class","jumbotron"]],null,null,null,null,null)),(_l()(),elementDef(1,0,null,null,2,"h5",[["class","display-4"]],null,null,null,null,null)),(_l()(),elementDef(2,0,null,null,0,"i",[["class","fas fa-video"]],null,null,null,null,null)),(_l()(),textDef(-1,null,[" Rooms"])),(_l()(),elementDef(4,0,null,null,16,"div",[["class","list-group"]],null,null,null,null,null)),(_l()(),elementDef(5,0,null,null,11,"div",[["class","list-group-item d-flex justify-content-between align-items-center"]],null,null,null,null,null)),(_l()(),elementDef(6,0,null,null,10,"div",[["class","input-group"]],null,null,null,null,null)),(_l()(),elementDef(7,0,null,null,5,"input",[["aria-label","Room Name"],["class","form-control form-control-lg"],["placeholder","Room Name"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"keydown.enter"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(_v,en,$event){var ad=!0,_co=_v.component;return"input"===en&&(ad=!1!==nodeValue(_v,8)._handleInput($event.target.value)&&ad),"blur"===en&&(ad=!1!==nodeValue(_v,8).onTouched()&&ad),"compositionstart"===en&&(ad=!1!==nodeValue(_v,8)._compositionStart()&&ad),"compositionend"===en&&(ad=!1!==nodeValue(_v,8)._compositionEnd($event.target.value)&&ad),"ngModelChange"===en&&(ad=!1!==(_co.roomName=$event)&&ad),"keydown.enter"===en&&(ad=!1!==_co.onTryAddRoom()&&ad),ad}),null,null)),directiveDef(8,16384,null,0,DefaultValueAccessor,[Renderer2,ElementRef,[2,COMPOSITION_BUFFER_MODE]],null,null),providerDef(1024,null,NG_VALUE_ACCESSOR,(function(p0_0){return[p0_0]}),[DefaultValueAccessor]),directiveDef(10,671744,null,0,forms_NgModel,[[8,null],[8,null],[8,null],[6,NG_VALUE_ACCESSOR]],{model:[0,"model"]},{update:"ngModelChange"}),providerDef(2048,null,NgControl,null,[forms_NgModel]),directiveDef(12,16384,null,0,NgControlStatus,[[4,NgControl]],null,null),(_l()(),elementDef(13,0,null,null,3,"div",[["class","input-group-append"]],null,null,null,null,null)),(_l()(),elementDef(14,0,null,null,2,"button",[["class","btn btn-lg btn-outline-secondary twitter-red"],["type","button"]],[[8,"disabled",0]],[[null,"click"]],(function(_v,en,$event){var ad=!0,_co=_v.component;return"click"===en&&(ad=!1!==_co.onAddRoom(_co.roomName)&&ad),ad}),null,null)),(_l()(),elementDef(15,0,null,null,0,"i",[["class","far fa-plus-square"]],null,null,null,null,null)),(_l()(),textDef(-1,null,[" Create "])),(_l()(),anchorDef(16777216,null,null,1,null,View_RoomsComponent_1)),directiveDef(18,16384,null,0,NgIf,[ViewContainerRef,TemplateRef],{ngIf:[0,"ngIf"]},null),(_l()(),anchorDef(16777216,null,null,1,null,View_RoomsComponent_2)),directiveDef(20,278528,null,0,common_NgForOf,[ViewContainerRef,TemplateRef,IterableDiffers],{ngForOf:[0,"ngForOf"]},null)],(function(_ck,_v){var _co=_v.component;_ck(_v,10,0,_co.roomName),_ck(_v,18,0,!_co.rooms||!_co.rooms.length),_ck(_v,20,0,_co.rooms)}),(function(_ck,_v){var _co=_v.component;_ck(_v,7,0,nodeValue(_v,12).ngClassUntouched,nodeValue(_v,12).ngClassTouched,nodeValue(_v,12).ngClassPristine,nodeValue(_v,12).ngClassDirty,nodeValue(_v,12).ngClassValid,nodeValue(_v,12).ngClassInvalid,nodeValue(_v,12).ngClassPending),_ck(_v,14,0,!_co.roomName)}))}let storage_service_StorageService=(()=>{class StorageService{get(key){return localStorage.getItem(this.formatAppStorageKey(key))}set(key,value){value&&"null"!==value&&localStorage.setItem(this.formatAppStorageKey(key),value)}remove(key){localStorage.removeItem(this.formatAppStorageKey(key))}formatAppStorageKey(key){return"iEvangelist.videoChat."+key}}return StorageService.ngInjectableDef=ɵɵdefineInjectable({factory:function(){return new StorageService},token:StorageService,providedIn:"root"}),StorageService})();class camera_component_CameraComponent{constructor(storageService,renderer){this.storageService=storageService,this.renderer=renderer,this.isInitializing=!0,this.videoTrack=null}ngAfterViewInit(){return __awaiter(this,void 0,void 0,(function*(){if(this.previewElement&&this.previewElement.nativeElement){const selectedVideoInput=this.storageService.get("videoInputId");yield this.initializeDevice(selectedVideoInput)}}))}initializePreview(deviceId){return __awaiter(this,void 0,void 0,(function*(){yield this.initializeDevice(deviceId)}))}finalizePreview(){try{this.videoTrack&&this.videoTrack.detach().forEach(element=>element.remove()),this.videoTrack=null}catch(e){console.error(e)}}initializeDevice(deviceId){return __awaiter(this,void 0,void 0,(function*(){try{this.isInitializing=!0,this.finalizePreview(),this.videoTrack=deviceId?yield Object(es5.createLocalVideoTrack)({deviceId:deviceId}):yield Object(es5.createLocalVideoTrack)();const videoElement=this.videoTrack.attach();this.renderer.setStyle(videoElement,"height","100%"),this.renderer.setStyle(videoElement,"width","100%"),this.renderer.appendChild(this.previewElement.nativeElement,videoElement)}finally{this.isInitializing=!1}}))}}var RenderType_CameraComponent=createRendererType2({encapsulation:0,styles:[[""]],data:{}});function View_CameraComponent_1(_l){return viewDef(0,[(_l()(),elementDef(0,0,null,null,1,"div",[],null,null,null,null,null)),(_l()(),textDef(-1,null,["Loading preview... Please wait."]))],null,null)}function View_CameraComponent_0(_l){return viewDef(0,[queryDef(671088640,1,{previewElement:0}),(_l()(),elementDef(1,0,[[1,0],["preview",1]],null,2,"div",[["id","preview"]],null,null,null,null,null)),(_l()(),anchorDef(16777216,null,null,1,null,View_CameraComponent_1)),directiveDef(3,16384,null,0,NgIf,[ViewContainerRef,TemplateRef],{ngIf:[0,"ngIf"]},null)],(function(_ck,_v){_ck(_v,3,0,_v.component.isInitializing)}),null)}class participants_component_ParticipantsComponent{constructor(renderer){this.renderer=renderer,this.participantsChanged=new core_EventEmitter,this.leaveRoom=new core_EventEmitter}get participantCount(){return this.participants?this.participants.size:0}get isAlone(){return 0===this.participantCount}clear(){this.participants&&this.participants.clear()}initialize(participants){this.participants=participants,this.participants&&this.participants.forEach(participant=>this.registerParticipantEvents(participant))}add(participant){this.participants&&participant&&(this.participants.set(participant.sid,participant),this.registerParticipantEvents(participant))}remove(participant){this.participants&&this.participants.has(participant.sid)&&this.participants.delete(participant.sid)}loudest(participant){this.dominantSpeaker=participant}onLeaveRoom(){this.leaveRoom.emit(!0)}registerParticipantEvents(participant){participant&&(participant.tracks.forEach(publication=>this.subscribe(publication)),participant.on("trackPublished",publication=>this.subscribe(publication)),participant.on("trackUnpublished",publication=>{publication&&publication.track&&this.detachRemoteTrack(publication.track)}))}subscribe(publication){publication&&publication.on&&(publication.on("subscribed",track=>this.attachRemoteTrack(track)),publication.on("unsubscribed",track=>this.detachRemoteTrack(track)))}attachRemoteTrack(track){if(this.isAttachable(track)){const element=track.attach();this.renderer.data.id=track.sid,this.renderer.setStyle(element,"width","95%"),this.renderer.setStyle(element,"margin-left","2.5%"),this.renderer.appendChild(this.listRef.nativeElement,element),this.participantsChanged.emit(!0)}}detachRemoteTrack(track){this.isDetachable(track)&&(track.detach().forEach(el=>el.remove()),this.participantsChanged.emit(!0))}isAttachable(track){return!!track&&(void 0!==track.attach||void 0!==track.attach)}isDetachable(track){return!!track&&(void 0!==track.detach||void 0!==track.detach)}}var RenderType_ParticipantsComponent=createRendererType2({encapsulation:0,styles:[[""]],data:{}});function View_ParticipantsComponent_0(_l){return viewDef(0,[queryDef(671088640,1,{listRef:0}),(_l()(),elementDef(1,0,null,null,20,"div",[["id","participant-list"]],null,null,null,null,null)),(_l()(),elementDef(2,0,null,null,9,"div",[["id","alone"]],null,null,null,null,null)),providerDef(512,null,NgClassImpl,common_NgClassR2Impl,[IterableDiffers,KeyValueDiffers,ElementRef,Renderer2]),directiveDef(4,278528,null,0,NgClass,[NgClassImpl],{ngClass:[0,"ngClass"]},null),pureObjectDef(5,{table:0,"d-none":1}),(_l()(),elementDef(6,0,null,null,5,"p",[["class","text-center text-monospace h3"],["style","display: table-cell"]],null,null,null,null,null)),(_l()(),textDef(-1,null,[" You're the only one in this room. "])),(_l()(),elementDef(8,0,null,null,0,"i",[["class","far fa-frown"]],null,null,null,null,null)),(_l()(),elementDef(9,0,null,null,0,"br",[],null,null,null,null,null)),(_l()(),elementDef(10,0,null,null,0,"br",[],null,null,null,null,null)),(_l()(),textDef(-1,null,[" As others join, they'll start showing up here... "])),(_l()(),elementDef(12,0,null,null,9,"div",[],null,null,null,null,null)),providerDef(512,null,NgClassImpl,common_NgClassR2Impl,[IterableDiffers,KeyValueDiffers,ElementRef,Renderer2]),directiveDef(14,278528,null,0,NgClass,[NgClassImpl],{ngClass:[0,"ngClass"]},null),pureObjectDef(15,{"d-none":0}),(_l()(),elementDef(16,0,null,null,4,"nav",[["class","navbar navbar-expand-lg navbar-dark bg-light shadow"]],null,null,null,null,null)),(_l()(),elementDef(17,0,null,null,3,"ul",[["class","navbar-nav ml-auto"]],null,null,null,null,null)),(_l()(),elementDef(18,0,null,null,2,"li",[["class","nav-item"]],null,null,null,null,null)),(_l()(),elementDef(19,0,null,null,1,"button",[["class","btn btn-lg leave-room"],["title","Click to leave this room."],["type","button"]],null,[[null,"click"]],(function(_v,en,$event){var ad=!0;return"click"===en&&(ad=!1!==_v.component.onLeaveRoom()&&ad),ad}),null,null)),(_l()(),textDef(20,null,[' Leave "','" Room? '])),(_l()(),elementDef(21,0,[[1,0],["list",1]],null,0,"div",[],null,null,null,null,null))],(function(_ck,_v){var _co=_v.component,currVal_0=_ck(_v,5,0,_co.isAlone,!_co.isAlone);_ck(_v,4,0,currVal_0);var currVal_1=_ck(_v,15,0,_co.isAlone);_ck(_v,14,0,currVal_1)}),(function(_ck,_v){_ck(_v,20,0,_v.component.activeRoomName)}))}let IdGenerator=(()=>{class IdGenerator{static getNext(){return++IdGenerator.id}}return IdGenerator.id=0,IdGenerator})();class device_select_component_DeviceSelectComponent{constructor(storageService){this.storageService=storageService,this.localDevices=[],this.settingsChanged=new core_EventEmitter,this.id="device-select-"+IdGenerator.getNext()}get devices(){return this.localDevices}set devices(devices){this.selectedId=this.getOrAdd(this.key,this.localDevices=devices)}onSettingsChanged(deviceId){this.setAndEmitSelections(this.key,this.selectedId=deviceId)}getOrAdd(key,devices){const existingId=this.storageService.get(key);if(devices&&devices.length>0){const defaultDevice=devices.find(d=>d.deviceId===existingId)||devices[0];return this.storageService.set(key,defaultDevice.deviceId),defaultDevice.deviceId}return null}setAndEmitSelections(key,deviceId){this.storageService.set(key,deviceId),this.settingsChanged.emit(this.devices.find(d=>d.deviceId===deviceId))}}var RenderType_DeviceSelectComponent=createRendererType2({encapsulation:2,styles:[],data:{}});function View_DeviceSelectComponent_1(_l){return viewDef(0,[(_l()(),elementDef(0,0,null,null,3,"option",[],[[8,"selected",0]],null,null,null,null)),directiveDef(1,147456,null,0,NgSelectOption,[ElementRef,Renderer2,[8,null]],{value:[0,"value"]},null),directiveDef(2,147456,null,0,ɵNgSelectMultipleOption,[ElementRef,Renderer2,[8,null]],{value:[0,"value"]},null),(_l()(),textDef(3,null,[" "," "]))],(function(_ck,_v){_ck(_v,1,0,_v.context.$implicit.deviceId),_ck(_v,2,0,_v.context.$implicit.deviceId)}),(function(_ck,_v){_ck(_v,0,0,_v.context.$implicit.deviceId===_v.component.selectedId),_ck(_v,3,0,_v.context.$implicit.label)}))}function View_DeviceSelectComponent_0(_l){return viewDef(0,[(_l()(),elementDef(0,0,null,null,1,"label",[["class","h5"]],[[8,"htmlFor",0]],null,null,null,null)),(_l()(),textDef(1,null,["",""])),(_l()(),elementDef(2,0,null,null,2,"select",[["class","custom-select"]],[[8,"id",0]],[[null,"change"]],(function(_v,en,$event){var ad=!0;return"change"===en&&(ad=!1!==_v.component.onSettingsChanged($event.target.value)&&ad),ad}),null,null)),(_l()(),anchorDef(16777216,null,null,1,null,View_DeviceSelectComponent_1)),directiveDef(4,278528,null,0,common_NgForOf,[ViewContainerRef,TemplateRef,IterableDiffers],{ngForOf:[0,"ngForOf"]},null)],(function(_ck,_v){_ck(_v,4,0,_v.component.devices)}),(function(_ck,_v){var _co=_v.component;_ck(_v,0,0,inlineInterpolate(1,"",_co.id,"")),_ck(_v,1,0,_co.label),_ck(_v,2,0,inlineInterpolate(1,"",_co.id,""))}))}let device_service_DeviceService=(()=>{class DeviceService{constructor(){this.deviceBroadcast=new ReplaySubject_ReplaySubject,navigator&&navigator.mediaDevices&&(navigator.mediaDevices.ondevicechange=_=>{this.deviceBroadcast.next(this.getDeviceOptions())}),this.$devicesUpdated=this.deviceBroadcast.asObservable(),this.deviceBroadcast.next(this.getDeviceOptions())}isGrantedMediaPermissions(){return __awaiter(this,void 0,void 0,(function*(){if(navigator&&navigator.userAgent&&navigator.userAgent.indexOf("Chrome")<0)return!0;try{return!!(yield navigator.mediaDevices.getUserMedia({video:!0}))||!!(yield navigator.mediaDevices.getUserMedia({video:!0}))}catch(e){return!0}}))}getDeviceOptions(){return __awaiter(this,void 0,void 0,(function*(){const isGranted=yield this.isGrantedMediaPermissions();if(navigator&&navigator.mediaDevices&&isGranted){let devices=yield this.tryGetDevices();return devices.every(d=>!d.label)&&(devices=yield this.tryGetDevices()),devices.filter(d=>!!d.label)}return null}))}tryGetDevices(){return __awaiter(this,void 0,void 0,(function*(){const mediaDevices=yield navigator.mediaDevices.enumerateDevices();return["audioinput","audiooutput","videoinput"].reduce((options,kind)=>options[kind]=mediaDevices.filter(device=>device.kind===kind),[])}))}}return DeviceService.ngInjectableDef=ɵɵdefineInjectable({factory:function(){return new DeviceService},token:DeviceService,providedIn:"root"}),DeviceService})();const async_async=new AsyncScheduler_AsyncScheduler(AsyncAction_AsyncAction);class DebounceTimeOperator{constructor(dueTime,scheduler){this.dueTime=dueTime,this.scheduler=scheduler}call(subscriber,source){return source.subscribe(new debounceTime_DebounceTimeSubscriber(subscriber,this.dueTime,this.scheduler))}}class debounceTime_DebounceTimeSubscriber extends Subscriber_Subscriber{constructor(destination,dueTime,scheduler){super(destination),this.dueTime=dueTime,this.scheduler=scheduler,this.debouncedSubscription=null,this.lastValue=null,this.hasValue=!1}_next(value){this.clearDebounce(),this.lastValue=value,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(dispatchNext,this.dueTime,this))}_complete(){this.debouncedNext(),this.destination.complete()}debouncedNext(){if(this.clearDebounce(),this.hasValue){const{lastValue:lastValue}=this;this.lastValue=null,this.hasValue=!1,this.destination.next(lastValue)}}clearDebounce(){const debouncedSubscription=this.debouncedSubscription;null!==debouncedSubscription&&(this.remove(debouncedSubscription),debouncedSubscription.unsubscribe(),this.debouncedSubscription=null)}}function dispatchNext(subscriber){subscriber.debouncedNext()}class settings_component_SettingsComponent{constructor(deviceService){this.deviceService=deviceService,this.devices=[],this.settingsChanged=new core_EventEmitter}get hasAudioInputOptions(){return this.devices&&this.devices.filter(d=>"audioinput"===d.kind).length>0}get hasAudioOutputOptions(){return this.devices&&this.devices.filter(d=>"audiooutput"===d.kind).length>0}get hasVideoInputOptions(){return this.devices&&this.devices.filter(d=>"videoinput"===d.kind).length>0}ngOnInit(){this.subscription=this.deviceService.$devicesUpdated.pipe(function(dueTime,scheduler=async_async){return source=>source.lift(new DebounceTimeOperator(dueTime,scheduler))}(350)).subscribe(deviceListPromise=>__awaiter(this,void 0,void 0,(function*(){this.devices=yield deviceListPromise,this.handleDeviceAvailabilityChanges()})))}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}onSettingsChanged(deviceInfo){return __awaiter(this,void 0,void 0,(function*(){this.settingsChanged.emit(deviceInfo)}))}showPreviewCamera(){return __awaiter(this,void 0,void 0,(function*(){if(this.isPreviewing=!0,!this.camera.videoTrack||this.videoDeviceId!==this.video.selectedId){this.videoDeviceId=this.video.selectedId;const videoDevice=this.devices.find(d=>d.deviceId===this.video.selectedId);yield this.camera.initializePreview(videoDevice.deviceId)}return this.camera.videoTrack}))}hidePreviewCamera(){return this.isPreviewing=!1,this.camera.finalizePreview(),this.devices.find(d=>d.deviceId===this.video.selectedId)}handleDeviceAvailabilityChanges(){if(this.devices&&this.devices.length&&this.video&&this.video.selectedId){let videoDevice=this.devices.find(d=>d.deviceId===this.video.selectedId);videoDevice||(videoDevice=this.devices.find(d=>"videoinput"===d.kind),videoDevice&&(this.video.selectedId=videoDevice.deviceId,this.onSettingsChanged(videoDevice)))}}}var RenderType_SettingsComponent=createRendererType2({encapsulation:0,styles:[[""]],data:{}});function View_SettingsComponent_1(_l){return viewDef(0,[(_l()(),elementDef(0,0,null,null,2,"div",[["class","form-group"]],null,null,null,null,null)),(_l()(),elementDef(1,0,null,null,1,"app-device-select",[],null,[[null,"settingsChanged"]],(function(_v,en,$event){var ad=!0;return"settingsChanged"===en&&(ad=!1!==_v.component.onSettingsChanged($event)&&ad),ad}),View_DeviceSelectComponent_0,RenderType_DeviceSelectComponent)),directiveDef(2,49152,null,0,device_select_component_DeviceSelectComponent,[storage_service_StorageService],{label:[0,"label"],kind:[1,"kind"],devices:[2,"devices"]},{settingsChanged:"settingsChanged"})],(function(_ck,_v){_ck(_v,2,0,"Audio Input Source","audioinput",_v.component.devices)}),null)}function View_SettingsComponent_2(_l){return viewDef(0,[(_l()(),elementDef(0,0,null,null,2,"div",[["class","form-group"]],null,null,null,null,null)),(_l()(),elementDef(1,0,null,null,1,"app-device-select",[],null,[[null,"settingsChanged"]],(function(_v,en,$event){var ad=!0;return"settingsChanged"===en&&(ad=!1!==_v.component.onSettingsChanged($event)&&ad),ad}),View_DeviceSelectComponent_0,RenderType_DeviceSelectComponent)),directiveDef(2,49152,null,0,device_select_component_DeviceSelectComponent,[storage_service_StorageService],{label:[0,"label"],kind:[1,"kind"],devices:[2,"devices"]},{settingsChanged:"settingsChanged"})],(function(_ck,_v){_ck(_v,2,0,"Audio Output Source","audiooutput",_v.component.devices)}),null)}function View_SettingsComponent_3(_l){return viewDef(0,[(_l()(),elementDef(0,0,null,null,2,"div",[["class","form-group"]],null,null,null,null,null)),(_l()(),elementDef(1,0,null,null,1,"app-device-select",[],null,[[null,"settingsChanged"]],(function(_v,en,$event){var ad=!0;return"settingsChanged"===en&&(ad=!1!==_v.component.onSettingsChanged($event)&&ad),ad}),View_DeviceSelectComponent_0,RenderType_DeviceSelectComponent)),directiveDef(2,49152,[[2,4],["videoSelect",4]],0,device_select_component_DeviceSelectComponent,[storage_service_StorageService],{label:[0,"label"],kind:[1,"kind"],devices:[2,"devices"]},{settingsChanged:"settingsChanged"})],(function(_ck,_v){_ck(_v,2,0,"Video Input Source","videoinput",_v.component.devices)}),null)}function View_SettingsComponent_0(_l){return viewDef(0,[queryDef(671088640,1,{camera:0}),queryDef(671088640,2,{video:0}),(_l()(),elementDef(2,0,null,null,17,"div",[["class","jumbotron"]],null,null,null,null,null)),(_l()(),elementDef(3,0,null,null,2,"h4",[["class","display-4"]],null,null,null,null,null)),(_l()(),elementDef(4,0,null,null,0,"i",[["class","fas fa-cogs"]],null,null,null,null,null)),(_l()(),textDef(-1,null,[" Settings"])),(_l()(),elementDef(6,0,null,null,10,"form",[["class","form"],["novalidate",""]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"submit"],[null,"reset"]],(function(_v,en,$event){var ad=!0;return"submit"===en&&(ad=!1!==nodeValue(_v,8).onSubmit($event)&&ad),"reset"===en&&(ad=!1!==nodeValue(_v,8).onReset()&&ad),ad}),null,null)),directiveDef(7,16384,null,0,ɵNgNoValidate,[],null,null),directiveDef(8,4210688,null,0,forms_NgForm,[[8,null],[8,null]],null,null),providerDef(2048,null,ControlContainer,null,[forms_NgForm]),directiveDef(10,16384,null,0,NgControlStatusGroup,[[4,ControlContainer]],null,null),(_l()(),anchorDef(16777216,null,null,1,null,View_SettingsComponent_1)),directiveDef(12,16384,null,0,NgIf,[ViewContainerRef,TemplateRef],{ngIf:[0,"ngIf"]},null),(_l()(),anchorDef(16777216,null,null,1,null,View_SettingsComponent_2)),directiveDef(14,16384,null,0,NgIf,[ViewContainerRef,TemplateRef],{ngIf:[0,"ngIf"]},null),(_l()(),anchorDef(16777216,null,null,1,null,View_SettingsComponent_3)),directiveDef(16,16384,null,0,NgIf,[ViewContainerRef,TemplateRef],{ngIf:[0,"ngIf"]},null),(_l()(),elementDef(17,0,null,null,2,"div",[],[[4,"display",null]],null,null,null,null)),(_l()(),elementDef(18,0,null,null,1,"app-camera",[],null,null,null,View_CameraComponent_0,RenderType_CameraComponent)),directiveDef(19,4243456,[[1,4],["camera",4]],0,camera_component_CameraComponent,[storage_service_StorageService,Renderer2],null,null)],(function(_ck,_v){var _co=_v.component;_ck(_v,12,0,_co.hasAudioInputOptions),_ck(_v,14,0,_co.hasAudioOutputOptions),_ck(_v,16,0,_co.hasVideoInputOptions)}),(function(_ck,_v){var _co=_v.component;_ck(_v,6,0,nodeValue(_v,10).ngClassUntouched,nodeValue(_v,10).ngClassTouched,nodeValue(_v,10).ngClassPristine,nodeValue(_v,10).ngClassDirty,nodeValue(_v,10).ngClassValid,nodeValue(_v,10).ngClassInvalid,nodeValue(_v,10).ngClassPending),_ck(_v,17,0,_co.isPreviewing?"block":"none")}))}class home_component_HomeComponent{constructor(videoChatService){this.videoChatService=videoChatService}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){}))}onSettingsChanged(deviceInfo){return __awaiter(this,void 0,void 0,(function*(){if(yield this.camera.initializePreview(deviceInfo.deviceId),this.settings.isPreviewing){const track=yield this.settings.showPreviewCamera();if(this.activeRoom){const localParticipant=this.activeRoom.localParticipant;localParticipant.videoTracks.forEach(publication=>publication.unpublish()),yield localParticipant.publishTrack(track)}}}))}onLeaveRoom(_){return __awaiter(this,void 0,void 0,(function*(){this.activeRoom&&(this.activeRoom.disconnect(),this.activeRoom=null);const videoDevice=this.settings.hidePreviewCamera();yield this.camera.initializePreview(videoDevice&&videoDevice.deviceId),this.participants.clear()}))}onRoomChanged(roomName){return __awaiter(this,void 0,void 0,(function*(){if(roomName){this.activeRoom&&this.activeRoom.disconnect(),this.camera.finalizePreview();const tracks=yield Promise.all([Object(es5.createLocalAudioTrack)(),this.settings.showPreviewCamera()]);this.activeRoom=yield this.videoChatService.joinOrCreateRoom(roomName,tracks),this.participants.initialize(this.activeRoom.participants),this.registerRoomEvents()}}))}onParticipantsChanged(_){this.videoChatService.nudge()}registerRoomEvents(){this.activeRoom.on("disconnected",room=>room.localParticipant.tracks.forEach(publication=>this.detachLocalTrack(publication.track))).on("participantConnected",participant=>this.participants.add(participant)).on("participantDisconnected",participant=>this.participants.remove(participant)).on("dominantSpeakerChanged",dominantSpeaker=>this.participants.loudest(dominantSpeaker))}detachLocalTrack(track){this.isDetachable(track)&&track.detach().forEach(el=>el.remove())}isDetachable(track){return!!track&&(void 0!==track.detach||void 0!==track.detach)}}var RenderType_HomeComponent=createRendererType2({encapsulation:0,styles:[['.grid-container[_ngcontent-%COMP%]{display:grid;height:100vh;grid-template-columns:2fr 4fr 2fr;grid-template-rows:1fr 7fr 1fr;grid-template-areas:"top-left . top-right" "left content right" "bottom-left . bottom-right"}.grid-content[_ngcontent-%COMP%]{grid-area:content;display:flex;justify-content:center;align-items:center;background-color:#383838;border-top:6px solid #f22f46;border-bottom:6px solid #f22f46}.grid-left[_ngcontent-%COMP%]{grid-area:left;background:linear-gradient(to left,#383838 0,transparent 100%);border-top:6px solid #f22f46;border-bottom:6px solid #f22f46}.grid-right[_ngcontent-%COMP%]{grid-area:right;background:linear-gradient(to right,#383838 0,transparent 100%);border-top:6px solid #f22f46;border-bottom:6px solid #f22f46}.grid-bottom-left[_ngcontent-%COMP%], .grid-bottom-right[_ngcontent-%COMP%], .grid-top-left[_ngcontent-%COMP%], .grid-top-right[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.grid-top-left[_ngcontent-%COMP%]{grid-area:top-left}.grid-top-right[_ngcontent-%COMP%]{grid-area:top-right}.grid-bottom-left[_ngcontent-%COMP%]{grid-area:bottom-left}.grid-bottom-right[_ngcontent-%COMP%]{grid-area:bottom-right}']],data:{}});function View_HomeComponent_0(_l){return viewDef(0,[queryDef(671088640,1,{rooms:0}),queryDef(671088640,2,{camera:0}),queryDef(671088640,3,{settings:0}),queryDef(671088640,4,{participants:0}),(_l()(),elementDef(4,0,null,null,18,"div",[["class","grid-container"]],null,null,null,null,null)),(_l()(),elementDef(5,0,null,null,3,"div",[["class","grid-bottom-right"]],null,null,null,null,null)),(_l()(),elementDef(6,0,null,null,2,"a",[["href","https://twitter.com/davidpine7"],["target","_blank"]],null,null,null,null,null)),(_l()(),elementDef(7,0,null,null,0,"i",[["class","fab fa-twitter"]],null,null,null,null,null)),(_l()(),textDef(-1,null,[" @davidpine7"])),(_l()(),elementDef(9,0,null,null,2,"div",[["class","grid-left"]],null,null,null,null,null)),(_l()(),elementDef(10,0,null,null,1,"app-rooms",[],null,[[null,"roomChanged"]],(function(_v,en,$event){var ad=!0;return"roomChanged"===en&&(ad=!1!==_v.component.onRoomChanged($event)&&ad),ad}),View_RoomsComponent_0,RenderType_RoomsComponent)),directiveDef(11,245760,[[1,4],["rooms",4]],0,rooms_component_RoomsComponent,[videochat_service_VideoChatService],{activeRoomName:[0,"activeRoomName"]},{roomChanged:"roomChanged"}),(_l()(),elementDef(12,0,null,null,4,"div",[["class","grid-content"]],null,null,null,null,null)),(_l()(),elementDef(13,0,null,null,1,"app-camera",[],[[4,"display",null]],null,null,View_CameraComponent_0,RenderType_CameraComponent)),directiveDef(14,4243456,[[2,4],["camera",4]],0,camera_component_CameraComponent,[storage_service_StorageService,Renderer2],null,null),(_l()(),elementDef(15,0,null,null,1,"app-participants",[],[[4,"display",null]],[[null,"leaveRoom"],[null,"participantsChanged"]],(function(_v,en,$event){var ad=!0,_co=_v.component;return"leaveRoom"===en&&(ad=!1!==_co.onLeaveRoom($event)&&ad),"participantsChanged"===en&&(ad=!1!==_co.onParticipantsChanged($event)&&ad),ad}),View_ParticipantsComponent_0,RenderType_ParticipantsComponent)),directiveDef(16,49152,[[4,4],["participants",4]],0,participants_component_ParticipantsComponent,[Renderer2],{activeRoomName:[0,"activeRoomName"]},{participantsChanged:"participantsChanged",leaveRoom:"leaveRoom"}),(_l()(),elementDef(17,0,null,null,2,"div",[["class","grid-right"]],null,null,null,null,null)),(_l()(),elementDef(18,0,null,null,1,"app-settings",[],null,[[null,"settingsChanged"]],(function(_v,en,$event){var ad=!0;return"settingsChanged"===en&&(ad=!1!==_v.component.onSettingsChanged($event)&&ad),ad}),View_SettingsComponent_0,RenderType_SettingsComponent)),directiveDef(19,245760,[[3,4],["settings",4]],0,settings_component_SettingsComponent,[device_service_DeviceService],null,{settingsChanged:"settingsChanged"}),(_l()(),elementDef(20,0,null,null,2,"div",[["class","grid-top-left"]],null,null,null,null,null)),(_l()(),elementDef(21,0,null,null,1,"a",[["href","https://www.twilio.com/video"],["target","_blank"]],null,null,null,null,null)),(_l()(),textDef(-1,null,[" Powered by Twilio "]))],(function(_ck,_v){var _co=_v.component;_ck(_v,11,0,_co.activeRoom?_co.activeRoom.name:null),_ck(_v,16,0,_co.activeRoom?_co.activeRoom.name:null),_ck(_v,19,0)}),(function(_ck,_v){var _co=_v.component;_ck(_v,13,0,_co.activeRoom?"none":"block"),_ck(_v,15,0,_co.activeRoom?"block":"none")}))}function View_HomeComponent_Host_0(_l){return viewDef(0,[(_l()(),elementDef(0,0,null,null,1,"app-home",[],null,null,null,View_HomeComponent_0,RenderType_HomeComponent)),directiveDef(1,114688,null,0,home_component_HomeComponent,[videochat_service_VideoChatService],null,null)],(function(_ck,_v){_ck(_v,1,0)}),null)}var HomeComponentNgFactory=createComponentFactory("app-home",home_component_HomeComponent,View_HomeComponent_Host_0,{},{},[]);class CounterComponent{constructor(){this.currentCount=0}incrementCounter(){this.currentCount++}}var RenderType_CounterComponent=createRendererType2({encapsulation:2,styles:[],data:{}});function View_CounterComponent_0(_l){return viewDef(0,[(_l()(),elementDef(0,0,null,null,1,"h1",[],null,null,null,null,null)),(_l()(),textDef(-1,null,["Counter"])),(_l()(),elementDef(2,0,null,null,1,"p",[],null,null,null,null,null)),(_l()(),textDef(-1,null,["This is a simple example of an Angular component."])),(_l()(),elementDef(4,0,null,null,3,"p",[["aria-live","polite"]],null,null,null,null,null)),(_l()(),textDef(-1,null,["Current count: "])),(_l()(),elementDef(6,0,null,null,1,"strong",[],null,null,null,null,null)),(_l()(),textDef(7,null,["",""])),(_l()(),elementDef(8,0,null,null,1,"button",[["class","btn btn-primary"]],null,[[null,"click"]],(function(_v,en,$event){var ad=!0;return"click"===en&&(ad=!1!==_v.component.incrementCounter()&&ad),ad}),null,null)),(_l()(),textDef(-1,null,["Increment"]))],null,(function(_ck,_v){_ck(_v,7,0,_v.component.currentCount)}))}function View_CounterComponent_Host_0(_l){return viewDef(0,[(_l()(),elementDef(0,0,null,null,1,"app-counter-component",[],null,null,null,View_CounterComponent_0,RenderType_CounterComponent)),directiveDef(1,49152,null,0,CounterComponent,[],null,null)],null,null)}var CounterComponentNgFactory=createComponentFactory("app-counter-component",CounterComponent,View_CounterComponent_Host_0,{},{},[]);class FetchDataComponent{constructor(http,baseUrl){http.get(baseUrl+"weatherforecast").subscribe(result=>{this.forecasts=result},error=>console.error(error))}}var RenderType_FetchDataComponent=createRendererType2({encapsulation:2,styles:[],data:{}});function View_FetchDataComponent_1(_l){return viewDef(0,[(_l()(),elementDef(0,0,null,null,2,"p",[],null,null,null,null,null)),(_l()(),elementDef(1,0,null,null,1,"em",[],null,null,null,null,null)),(_l()(),textDef(-1,null,["Loading..."]))],null,null)}function View_FetchDataComponent_3(_l){return viewDef(0,[(_l()(),elementDef(0,0,null,null,8,"tr",[],null,null,null,null,null)),(_l()(),elementDef(1,0,null,null,1,"td",[],null,null,null,null,null)),(_l()(),textDef(2,null,["",""])),(_l()(),elementDef(3,0,null,null,1,"td",[],null,null,null,null,null)),(_l()(),textDef(4,null,["",""])),(_l()(),elementDef(5,0,null,null,1,"td",[],null,null,null,null,null)),(_l()(),textDef(6,null,["",""])),(_l()(),elementDef(7,0,null,null,1,"td",[],null,null,null,null,null)),(_l()(),textDef(8,null,["",""]))],null,(function(_ck,_v){_ck(_v,2,0,_v.context.$implicit.date),_ck(_v,4,0,_v.context.$implicit.temperatureC),_ck(_v,6,0,_v.context.$implicit.temperatureF),_ck(_v,8,0,_v.context.$implicit.summary)}))}function View_FetchDataComponent_2(_l){return viewDef(0,[(_l()(),elementDef(0,0,null,null,13,"table",[["aria-labelledby","tableLabel"],["class","table table-striped"]],null,null,null,null,null)),(_l()(),elementDef(1,0,null,null,9,"thead",[],null,null,null,null,null)),(_l()(),elementDef(2,0,null,null,8,"tr",[],null,null,null,null,null)),(_l()(),elementDef(3,0,null,null,1,"th",[],null,null,null,null,null)),(_l()(),textDef(-1,null,["Date"])),(_l()(),elementDef(5,0,null,null,1,"th",[],null,null,null,null,null)),(_l()(),textDef(-1,null,["Temp. (C)"])),(_l()(),elementDef(7,0,null,null,1,"th",[],null,null,null,null,null)),(_l()(),textDef(-1,null,["Temp. (F)"])),(_l()(),elementDef(9,0,null,null,1,"th",[],null,null,null,null,null)),(_l()(),textDef(-1,null,["Summary"])),(_l()(),elementDef(11,0,null,null,2,"tbody",[],null,null,null,null,null)),(_l()(),anchorDef(16777216,null,null,1,null,View_FetchDataComponent_3)),directiveDef(13,278528,null,0,common_NgForOf,[ViewContainerRef,TemplateRef,IterableDiffers],{ngForOf:[0,"ngForOf"]},null)],(function(_ck,_v){_ck(_v,13,0,_v.component.forecasts)}),null)}function View_FetchDataComponent_0(_l){return viewDef(0,[(_l()(),elementDef(0,0,null,null,1,"h1",[["id","tableLabel"]],null,null,null,null,null)),(_l()(),textDef(-1,null,["Weather forecast"])),(_l()(),elementDef(2,0,null,null,1,"p",[],null,null,null,null,null)),(_l()(),textDef(-1,null,["This component demonstrates fetching data from the server."])),(_l()(),anchorDef(16777216,null,null,1,null,View_FetchDataComponent_1)),directiveDef(5,16384,null,0,NgIf,[ViewContainerRef,TemplateRef],{ngIf:[0,"ngIf"]},null),(_l()(),anchorDef(16777216,null,null,1,null,View_FetchDataComponent_2)),directiveDef(7,16384,null,0,NgIf,[ViewContainerRef,TemplateRef],{ngIf:[0,"ngIf"]},null)],(function(_ck,_v){var _co=_v.component;_ck(_v,5,0,!_co.forecasts),_ck(_v,7,0,_co.forecasts)}),null)}function View_FetchDataComponent_Host_0(_l){return viewDef(0,[(_l()(),elementDef(0,0,null,null,1,"app-fetch-data",[],null,null,null,View_FetchDataComponent_0,RenderType_FetchDataComponent)),directiveDef(1,49152,null,0,FetchDataComponent,[http_HttpClient,"BASE_URL"],null,null)],null,null)}var FetchDataComponentNgFactory=createComponentFactory("app-fetch-data",FetchDataComponent,View_FetchDataComponent_Host_0,{},{},[]),RenderType_AppComponent=createRendererType2({encapsulation:2,styles:[],data:{}});function View_AppComponent_0(_l){return viewDef(0,[(_l()(),elementDef(0,0,null,null,1,"app-home",[],null,null,null,View_HomeComponent_0,RenderType_HomeComponent)),directiveDef(1,114688,null,0,home_component_HomeComponent,[videochat_service_VideoChatService],null,null)],(function(_ck,_v){_ck(_v,1,0)}),null)}function View_AppComponent_Host_0(_l){return viewDef(0,[(_l()(),elementDef(0,0,null,null,1,"app-root",[],null,null,null,View_AppComponent_0,RenderType_AppComponent)),directiveDef(1,49152,null,0,AppComponent,[],null,null)],null,null)}var AppComponentNgFactory=createComponentFactory("app-root",AppComponent,View_AppComponent_Host_0,{},{},[]),AppModuleNgFactory=createNgModuleFactory(AppModule,[AppComponent],(function(_l){return function(providers){const providersByKey={},modules=[];let isRoot=!1;for(let i=0;i<providers.length;i++){const provider=providers[i];provider.token===APP_ROOT&&!0===provider.value&&(isRoot=!0),1073741824&provider.flags&&modules.push(provider.token),provider.index=i,providersByKey[tokenKey(provider.token)]=provider}return{factory:null,providersByKey:providersByKey,providers:providers,modules:modules,isRoot:isRoot}}([moduleProvideDef(512,ComponentFactoryResolver,CodegenComponentFactoryResolver,[[8,[ɵangular_packages_router_router_lNgFactory,HomeComponentNgFactory,CounterComponentNgFactory,FetchDataComponentNgFactory,AppComponentNgFactory]],[3,ComponentFactoryResolver],NgModuleRef]),moduleProvideDef(5120,LOCALE_ID$1,_localeFactory,[[3,LOCALE_ID$1]]),moduleProvideDef(4608,NgLocalization,NgLocaleLocalization,[LOCALE_ID$1,[2,DEPRECATED_PLURAL_FN]]),moduleProvideDef(5120,SCHEDULER,zoneSchedulerFactory,[NgZone]),moduleProvideDef(5120,IterableDiffers,_iterableDiffersFactory,[]),moduleProvideDef(5120,KeyValueDiffers,_keyValueDiffersFactory,[]),moduleProvideDef(4608,DomSanitizer,platform_browser_DomSanitizerImpl,[DOCUMENT]),moduleProvideDef(6144,Sanitizer,null,[DomSanitizer]),moduleProvideDef(4608,HAMMER_GESTURE_CONFIG,HammerGestureConfig,[]),moduleProvideDef(5120,EVENT_MANAGER_PLUGINS,(function(p0_0,p0_1,p0_2,p1_0,p2_0,p2_1,p2_2,p2_3){return[new platform_browser_DomEventsPlugin(p0_0,p0_1,p0_2),new KeyEventsPlugin(p1_0),new HammerGesturesPlugin(p2_0,p2_1,p2_2,p2_3)]}),[DOCUMENT,NgZone,PLATFORM_ID,DOCUMENT,DOCUMENT,HAMMER_GESTURE_CONFIG,Console,[2,HAMMER_LOADER]]),moduleProvideDef(4608,EventManager,EventManager,[EVENT_MANAGER_PLUGINS,NgZone]),moduleProvideDef(135680,DomSharedStylesHost,DomSharedStylesHost,[DOCUMENT]),moduleProvideDef(4608,platform_browser_DomRendererFactory2,platform_browser_DomRendererFactory2,[EventManager,DomSharedStylesHost,APP_ID]),moduleProvideDef(6144,RendererFactory2,null,[platform_browser_DomRendererFactory2]),moduleProvideDef(6144,SharedStylesHost,null,[DomSharedStylesHost]),moduleProvideDef(4608,Testability,Testability,[NgZone]),moduleProvideDef(4608,HttpXsrfTokenExtractor,http_HttpXsrfCookieExtractor,[DOCUMENT,PLATFORM_ID,XSRF_COOKIE_NAME]),moduleProvideDef(4608,HttpXsrfInterceptor,HttpXsrfInterceptor,[HttpXsrfTokenExtractor,XSRF_HEADER_NAME]),moduleProvideDef(5120,HTTP_INTERCEPTORS,(function(p0_0){return[p0_0]}),[HttpXsrfInterceptor]),moduleProvideDef(4608,BrowserXhr,BrowserXhr,[]),moduleProvideDef(6144,XhrFactory,null,[BrowserXhr]),moduleProvideDef(4608,http_HttpXhrBackend,http_HttpXhrBackend,[XhrFactory]),moduleProvideDef(6144,HttpBackend,null,[http_HttpXhrBackend]),moduleProvideDef(4608,HttpHandler,HttpInterceptingHandler,[HttpBackend,Injector]),moduleProvideDef(4608,http_HttpClient,http_HttpClient,[HttpHandler]),moduleProvideDef(4608,RadioControlRegistry,RadioControlRegistry,[]),moduleProvideDef(5120,router_ActivatedRoute,rootRoute,[router_Router]),moduleProvideDef(4608,router_NoPreloading,router_NoPreloading,[]),moduleProvideDef(6144,PreloadingStrategy,null,[router_NoPreloading]),moduleProvideDef(135680,router_RouterPreloader,router_RouterPreloader,[router_Router,NgModuleFactoryLoader,Compiler,Injector,PreloadingStrategy]),moduleProvideDef(4608,router_PreloadAllModules,router_PreloadAllModules,[]),moduleProvideDef(5120,RouterScroller,createRouterScroller,[router_Router,common_ViewportScroller,ROUTER_CONFIGURATION]),moduleProvideDef(5120,ROUTER_INITIALIZER,getBootstrapListener,[router_RouterInitializer]),moduleProvideDef(5120,APP_BOOTSTRAP_LISTENER,(function(p0_0){return[p0_0]}),[ROUTER_INITIALIZER]),moduleProvideDef(1073742336,CommonModule,CommonModule,[]),moduleProvideDef(1024,ErrorHandler,errorHandler,[]),moduleProvideDef(1024,NgProbeToken,(function(){return[routerNgProbeToken()]}),[]),moduleProvideDef(256,APP_ID,"ng-cli-universal",[]),moduleProvideDef(2048,TRANSITION_ID,null,[APP_ID]),moduleProvideDef(512,router_RouterInitializer,router_RouterInitializer,[Injector]),moduleProvideDef(1024,APP_INITIALIZER,(function(p0_0,p1_0,p1_1,p1_2,p2_0){return[(coreTokens=p0_0,exportNgVar("probe",inspectNativeElement),exportNgVar("coreTokens",Object.assign({},CORE_TOKENS,(coreTokens||[]).reduce((prev,t)=>(prev[t.name]=t.token,prev),{}))),()=>inspectNativeElement),appInitializerFactory(p1_0,p1_1,p1_2),getAppInitializer(p2_0)];var coreTokens}),[[2,NgProbeToken],TRANSITION_ID,DOCUMENT,Injector,router_RouterInitializer]),moduleProvideDef(512,ApplicationInitStatus,ApplicationInitStatus,[[2,APP_INITIALIZER]]),moduleProvideDef(131584,core_ApplicationRef,core_ApplicationRef,[NgZone,Console,Injector,ErrorHandler,ComponentFactoryResolver,ApplicationInitStatus]),moduleProvideDef(1073742336,ApplicationModule,ApplicationModule,[core_ApplicationRef]),moduleProvideDef(1073742336,platform_browser_BrowserModule,platform_browser_BrowserModule,[[3,platform_browser_BrowserModule]]),moduleProvideDef(1073742336,HttpClientXsrfModule,HttpClientXsrfModule,[]),moduleProvideDef(1073742336,HttpClientModule,HttpClientModule,[]),moduleProvideDef(1073742336,ɵInternalFormsSharedModule,ɵInternalFormsSharedModule,[]),moduleProvideDef(1073742336,FormsModule,FormsModule,[]),moduleProvideDef(1024,ROUTER_FORROOT_GUARD,provideForRootGuard,[[3,router_Router]]),moduleProvideDef(512,UrlSerializer,DefaultUrlSerializer,[]),moduleProvideDef(512,ChildrenOutletContexts,ChildrenOutletContexts,[]),moduleProvideDef(256,ROUTER_CONFIGURATION,{},[]),moduleProvideDef(1024,LocationStrategy,provideLocationStrategy,[PlatformLocation,[2,APP_BASE_HREF],ROUTER_CONFIGURATION]),moduleProvideDef(512,common_Location,common_Location,[LocationStrategy,PlatformLocation]),moduleProvideDef(512,Compiler,Compiler,[]),moduleProvideDef(512,NgModuleFactoryLoader,SystemJsNgModuleLoader,[Compiler,[2,SystemJsNgModuleLoaderConfig]]),moduleProvideDef(1024,ROUTES,(function(){return[[{path:"",component:home_component_HomeComponent,pathMatch:"full"},{path:"counter",component:CounterComponent},{path:"fetch-data",component:FetchDataComponent}]]}),[]),moduleProvideDef(1024,router_Router,setupRouter,[core_ApplicationRef,UrlSerializer,ChildrenOutletContexts,common_Location,Injector,NgModuleFactoryLoader,Compiler,ROUTES,ROUTER_CONFIGURATION,[2,UrlHandlingStrategy],[2,RouteReuseStrategy]]),moduleProvideDef(1073742336,router_RouterModule,router_RouterModule,[[2,ROUTER_FORROOT_GUARD],[2,router_Router]]),moduleProvideDef(1073742336,AppModule,AppModule,[]),moduleProvideDef(256,APP_ROOT,!0,[]),moduleProvideDef(256,XSRF_COOKIE_NAME,"XSRF-TOKEN",[]),moduleProvideDef(256,XSRF_HEADER_NAME,"X-XSRF-TOKEN",[])])}));function getBaseUrl(){return document.getElementsByTagName("base")[0].href}__webpack_require__.d(__webpack_exports__,"getBaseUrl",(function(){return getBaseUrl}));const providers=[{provide:"BASE_URL",useFactory:getBaseUrl,deps:[]}];(function(){if(_runModeLocked)throw new Error("Cannot enable prod mode after platform setup.");_devMode=!1})(),platformBrowser(providers).bootstrapModuleFactory(AppModuleNgFactory).catch(err=>console.log(err))},zYCr:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),LocalTrackStats=function(_super){function LocalTrackStats(trackId,statsReport,prepareForInsights){var _this=_super.call(this,trackId,statsReport)||this;return Object.defineProperties(_this,{bytesSent:{value:"number"==typeof statsReport.bytesSent?statsReport.bytesSent:prepareForInsights?0:null,enumerable:!0},packetsSent:{value:"number"==typeof statsReport.packetsSent?statsReport.packetsSent:prepareForInsights?0:null,enumerable:!0},roundTripTime:{value:"number"==typeof statsReport.roundTripTime?statsReport.roundTripTime:prepareForInsights?0:null,enumerable:!0}}),_this}return __extends(LocalTrackStats,_super),LocalTrackStats}(__webpack_require__("0iCT"));module.exports=LocalTrackStats},zbom:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),EventEmitter=__webpack_require__("+qE3"),nInstances=0,MediaSignaling=function(_super){function MediaSignaling(getReceiver,channel,options){var _this=_super.call(this)||this;return Object.defineProperties(_this,{_instanceId:{value:nInstances++},channel:{value:channel},_log:{value:options.log.createLog("default",_this)},_getReceiver:{value:getReceiver},_receiverPromise:{value:null,writable:!0},_transport:{value:null,writable:!0}}),_this}return __extends(MediaSignaling,_super),Object.defineProperty(MediaSignaling.prototype,"isSetup",{get:function(){return!!this._receiverPromise},enumerable:!1,configurable:!0}),MediaSignaling.prototype.toString=function(){return"[MediaSignaling #"+this._instanceId+":"+this.channel+"]"},MediaSignaling.prototype.setup=function(id){var _this=this;this._teardown(),this._log.info("setting up msp transport for id:",id);var receiverPromise=this._getReceiver(id).then((function(receiver){if("data"!==receiver.kind&&_this._log.error("Expected a DataTrackReceiver"),_this._receiverPromise===receiverPromise){try{_this._transport=receiver.toDataTransport(),_this.emit("ready",_this._transport)}catch(ex){_this._log.error("Failed to toDataTransport: "+ex.message)}receiver.once("close",(function(){return _this._teardown()}))}}));this._receiverPromise=receiverPromise},MediaSignaling.prototype._teardown=function(){this._transport&&(this._log.info("Tearing down"),this._transport=null,this._receiverPromise=null,this.emit("teardown"))},MediaSignaling}(EventEmitter);module.exports=MediaSignaling}},[[0,0]]]);